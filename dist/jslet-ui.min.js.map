{"version":3,"sources":["jslet-ui.js"],"names":["root","factory","define","amd","require","exports","module","this","jslet","ui","Control","Class","create","initialize","el","ctrlParams","Z","allProperties","_evalParams","isValidTemplateTag","template","ctrlClass","getControlClass","type","htmlTemplate","Error","formatMessage","locale","DBControl","invalidHtmlTag","_styleClass","styleClass","undefined","_childControls","setParams","checkRequiredProperty","beforeBind","id","nextId","bind","jqEl","jQuery","addClass","afterBind","ctrlType","name","prop","call","requiredProperties","arrProps","split","cnt","length","i","trim","expectedProperty","addChildControl","childCtrl","push","removeAllChildControls","innerHTML","len","destroy","$super","_dataset","dataset","isString","data","dataModule","get","Checker","test","required","isClass","Dataset","className","dsName","getDatasetInParentElement","addLinkedControl","refreshControl","evt","evtType","eventType","RefreshEvent","UPDATEALL","CHANGEMETA","metaName","_field","fieldName","doMetaChanged","UPDATELOOKUP","doLookupChanged","isMetaChanged","SCROLL","INSERT","DELETE","doValueChanged","UPDATERECORD","UPDATECOLUMN","pEl","getParentElement","removeLinkedControl","DBFieldControl","_valueIndex","_enableInvalidTip","_tableId","_tabIndex","field","fldName","k","lastIndexOf","_fieldMeta","substring","fieldMeta","valueIndex","isNumber","parseInt","tabIndex","value","tbIdx","existField","fldObj","getField","tip","title","setTabIndex","tabIdx","tableId","getValue","getFieldValue","getText","isEditing","getFieldText","getFieldError","renderInvalid","errObj","parent","message","removeClass","canFocus","focus","flag","disabled","readOnly","visible","gotoField","innerFocus","selectText","e","console","warn","cannotFocusControl","p","startsWith","indexOf","Function","invalidJsletProp","controls","SimpleMap","register","ctrlName","set","toLowerCase","createControl","jsletparam","width","height","hidden","container","document","createElement","ctrlParam","controlType","DBTEXT","firstChild","removeChild","style","display","appendChild","body","bindControl","attr","unbindControl","rebindControl","install","pElement","onJsletReady","isFunction","isRtl","jqBody","hasClass","htmlTags","find","existIds","duplicatedId","global","afterInstall","uninstall","menuManager","off","hideAll","DnD","oldX","oldY","x","y","deltaX","deltaY","bindedControl","dragDelta","dragged","mouseDowned","self","_docMouseDown","event","fix","window","pageX","pageY","_doMouseDown","_docMouseMove","Math","abs","_doDragStart","_doDragging","_doMouseMove","_docMouseUp","_doDragEnd","_doMouseUp","_docKeydown","which","_doDragCancel","_docSelectStart","preventDefault","ctrl","doc","on","dnd","EditMask","_mask","_keepChar","_transform","_literalChars","_parsedMask","_format","_target","_buffer","prototype","maskChars","#","regexpr","RegExp","0","9","L","l","A","a","C","c","transforms","setMask","mask","keepChar","transform","checker","inArray","_parseMask","attach","target","jqText","_doKeypress","_doKeydown","_doBur","currentTarget","_doCut","originalEvent","clipboardData","_doPaste","detach","setValue","_clearBuffer","pos","ch","vch","fixedChar","prePos","preValuePos","valuePos","_getFixedCharAndPos","charAt","_showValue","maskObj","result","isMask","join","validateValue","cfg","begin","prevChar","notFound","iteralCnt","slice","_validateChar","maskChar","inputChar","maskCfg","regExpr","_getValidPos","toLeft","end","_packEmpty","str","_updateBuffer","_moveCursor","textutil","setCursorPos","chCode","String","fromCharCode","toUpperCase","getCursorPos","legnth","msk","setTimeout","getSelectedText","range","setData","pasteValue","getData","txtEl","start","v","setSelectionRange","createTextRange","moveStart","moveEnd","select","selectionStart","selectionEnd","selection","createRange","text","duplicate","collapse","FocusManager","_onChangingFocus","_focusKeyCode","_containerIds","_activeDataset","_activeField","_activeValueIndex","_initialize","onChangingFocus","focusKeyCode","pushContainer","containerId","popContainer","pop","activeDataset","activeField","activeValueIndex","tabPrev","_getContainer","proxy","_doChangingFocus","tabNext","jqContainer","ele","reverse","dsObj","getDataset","focusedFlds","mergedFocusedFields","cancelFocus","focusedFields","idx","focusEditControl","isTabableElement","tagName","typeAttr","handleHostKeyDown","defaultFocusKeyCode","keyCode","shiftKey","stopImmediatePropagation","keydown","focusManager","$","selectNextTabbableOrFocusable","selector","isLoop","selectables","sortByTabIndex","current","nextIndex","currEle","currentIndex","index","eq","selectPrevTabbableOrFocusable","prevIndex","items","item","item1","j","splice","focusable","element","expr","filters","parents","addBack","filter","css","map","mapName","img","nodeName","isTabIndexNotNaN","isNaN","parentNode","href","focusNext","focusPrev","extend","createPseudo","dataName","elem","match","tabbable","isTabIndexNaN","ResizeEventBus","handler","resize","sender","clearTimeout","ctrls","jsletCtrl","_activePopup","hide","checkSizeChanged","subscribe","ctrlObj","RESIZABLE","unsubscribe","removeAttr","resizeEventBus","htmlclass","GlobalZIndex","KeyCode","BACKSPACE","TAB","ENTER","SHIFT","CONTROL","ALT","CAPSLOCK","ESCAPE","SPACE","PAGEUP","PAGEDOWN","END","HOME","LEFT","UP","RIGHT","DOWN","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","IME","PopupPanel","onHidePopup","isShowing","documentClickHandler","srcEle","isChild","excludedElement","inPopupPanel","_stopMouseEvent","_createPanel","_popupPanel","position","zIndex","show","left","top","ajustX","ajustY","jqWin","winWidth","scrollLeft","winHeight","scrollTop","panel","w","outerWidth","h","outerHeight","shadow","_popupShadow","setContent","content","oldContent","childNodes","border","getPopupPanel","htmlElement","level","parentElement","findFirstParent","conditionFn","stopConditionFn","findJsletParent","testNode","TextMeasurer","updateText","lastText","rule","felementWidth","felement","createRule","margin","padding","overflow","setElement","fontSize","fontStyle","fontWeight","fontFamily","lineHeight","textTransform","letterSpacing","setElementWidth","getSize","ruleObj","getWidth","getHeight","textMeasurer","getCssValue","styleName","odiv","setEditableStyle","formElement","onlySetStyle","scrollbarSize","child","appendTo","children","innerWidth","remove","Accordion","params","_selectedIndex","_onChanged","_items","selectedIndex","isGTEZero","onChanged","isArray","caption","renderAll","panels","headHeight","captionCnt","before","jqCaptions","click","_doCaptionClick","contentHeight","innerHeight","wrap","setSelectedIndex","jqCaption","isRenderAll","jqBodies","pnlCnt","slideUp","slideDown","Calendar","_value","_onDateSelected","_minDate","_maxDate","_currYear","_currMonth","_currDate","isDate","minDate","maxDate","onDateSelected","yearPrev","monthPrev","monthNext","yearNext","Sun","Mon","Tue","Wed","Thu","Fri","Sat","today","html","jqTable","_doTableClick","dvalue","Date","d","getFullYear","getMonth","getDate","_fireSelectedEvent","incYear","incMonth","ctrlKey","incDate","_getNotNullDate","deltaDay","setDate","deltaMonth","oldDate","setMonth","newDate","deltaYear","setFullYear","_innerSetValue","oldValue","getTime","m","_setCurrDateCls","_refreshDateCell","_checkNaviState","btnToday","minY","minM","btnYearPrev","visibility","btnMonthPrev","maxY","maxM","btnYearNext","jslet_disabled","btnMonthNext","year","month","monthnames","monthNames","mname","otitle","otable","rows","tBodies","firstDay","w1","getDay","oneDayMs","date","otr","otd","oa","rowCnt","tdCnt","cells","jslet_date_value","node","jqLink","currM","currY","currD","FieldSet","_caption","_collapsed","collapsed","tmpl","nodes","obody","_doExpandBtnClick","fsBody","_menus","menuid","unregister","menu","menus","menuBarShown","_contextObject","MenuBar","_onItemClick","onItemClick","_createMenuBar","_preHoverItem","isPopup","_createBarItem","_menubarclick","_showSubMenu","omi","itemCfg","jsletvar","subMenu","Menu","jqMi","offset","posX","_activeMenuItem","obar","onClick","stopPropagation","_inPopupMenu","each","_invoker","_activeSubMenu","invoker","_createMenuPopup","timerId","ctxElement","showContextMenu","contextObj","_createMenuItem","_createLine","arrMi","nodeType","_ItemClick","checked","itemType","setChecked","_hideSubMenu","delayTime","func","jqPmi","_ItemOver","defaultClickHandler","isCheckBox","isRadioBox","iconClass","disabledIconClass","mi","onmouseover","onclick","onmouseout","setDisabled","menuId","Object","context","cfg1","icon","group","allMi","jqIcon","OverlayPanel","color","backgroundColor","bottom","right","oldResizeHanlder","onresize","scrollWidth","scrollHeight","overlayPanel","setZIndex","SplitPanel","directions","_direction","_floatIndex","_onExpanded","_onSize","splitter","_oldSize","floatIndex","direction","onExpanded","onSize","isHori","panelDivs","lastIndex","containerSize","sumSize","jqPanel","oPanel","minSize","maxSize","Infinity","expanded","size","splitterTracker","jqTracker","fixedSize","clsName","splitterClsName","splitterSize","after","floatPanel","minBtnCls","splitters","_splitterMouseDown","splitBtns","jqBtn","jqSplitter","expand","oSplitter","_splitterDragStart","_splitterDragging","_splitterDragEnd","_splitterDragCancel","changeSize","notChangeSize","prev","next","jqFp","draggingId","dragRangeMin","dragRangeMax","fpMax","delta","endDelta","newSize","currSize","oFp","TabItem","header","closable","useIFrame","url","contentId","TabControl","_activeIndex","_newable","_closable","_onActiveIndexChanged","_onAddTabItem","_onRemoveTabItem","_onCreateContextMenu","_itemsWidth","_containerWidth","_ready","_leftIndex","_rightIndex","_maxHeaderWidth","_tabControlWidth","_tabControlHeight","_contextItemIndex","_onContentLoading","_onContentLoaded","activeIndex","_chgActiveIndex","activeItemId","itemId","activeItem","newable","onAddTabItem","onActiveIndexChanged","onRemoveTabItem","onCreateContextMenu","onContentLoading","onContentLoaded","_createContextMenu","oul","newTab","_newTabItem","addTabItem","_calcItemsWidth","jqNavBtn","_setVisiTabItems","oitem","_renderTabItem","addItem","tabHeader","_getTabItemCfg","panelContainer","tabDisabled","jqPanels","jqItem","_checkTabItemCount","jqTabPanels","canChanged","oli","itemContainer","_totalItemsWidth","_setNavBtnVisible","leftIndex","rightIndex","leftPos","jqBtnLeft","isHidden","jqBtnRight","totalCnt","_createHeader","canClose","lastNode","insertBefore","_changeTabItem","_doCloseBtnClick","contextMenu","oncontextmenu","removeTabItem","_createBody","jqDiv","ocontent","pNode","s","newItemCfg","noDuplicate","tabItems","newId","reloadTabItem","setContentLoadedState","tabItemId","setContentChangedState","changed","hasChangedFlag","hasChanged","tabItemIndex","isBatch","MessageBox","confirm","contentChanged","button","_innerRemoveTabItem","active","canRemoved","animate","elItem","tabPanel","_getNextValidIndex","isLeft","reload","currIdx","jqFrame","close","closeOther","closeAll","currWidth","menuCfg","_menuItemClick","head","TipPanel","_hideTimerId","_showTimerId","_oldElement","_tipPanel","tips","leftOrEvent","arguments","isSameCtrl","globalTip","WaitingBox","overlayColor","tipsAtNewLine","overlay","box","tipPanel","jqPnl","ph","pw","jqBox","round","Window","_resizable","_minimizable","_maximizable","_iconClass","_width","_height","_minWidth","_minHeight","_maxWidth","_maxHeight","_isCenter","_animation","_onSizeChanged","_onPositionChanged","_onActive","_onClosed","_stopEventBubbling","_isModal","_state","resizable","minimizable","maximizable","isCenter","animation","stopEventBubbling","isGTZero","minWidth","minHeight","maxWidth","maxHeight","onSizeChanged","onPositionChanged","onActive","onClosed","_doWinMouseMove","_doWinMouseDown","_changeBodyHeight","jqHeader","temp_dragging","cursor","activate","maximize","restore","_createTrackerMask","trackerMask","setPosition","_removeTrackerMask","_createTracker","_changeTrackerSize","tracker","_removeTracker","jqClose","jqMin","minimize","jqMax","btnMax","offsetP","offsetParent","jqOffsetP","fadeIn","showModal","fadeOut","action","pnode","_tempHeight","_tempWidth","_getHeaerHeight","bringToFront","notUpdateLeftTop","getCaptionPanel","changeCaption","captionDiv","getContentPanel","showError","bodyDiv","jqNode","winIdx","maxIndex","styleObj","getStyleObject","_checkSize","srcEl","jqSrcEl","wdelta","hdelta","ojslet","holder","onmousedown","buttons","callbackFn","hasInput","defaultValue","validateFn","opt","owin","iconHtml","btnName","btnCount","btnHtml","inputHtml","replace","toolBar","inputCtrl","obtn","toolBtn","alert","timeout","omsgBox","info","error","isNam","isYesNo","prompt","isMultiLine","TableCellEditor","tableCtrl","_create","colCfg","columns","_tableCtrl","_sysColumns","tblDataset","innerColumns","isBool","editorTabIndex","alignStr","dataType","DataType","BOOLEAN","widthCssName","_editPanel","rowHeight","_currField","showEditor","cellPos","jqEditor","currentField","hideEditor","FindDialog","dbContainer","findData","recordCount","findingValue","jqFindingValue","val","currRecno","isStart","recno","found","findByField","_findingField","findDialog","_dialog","_containerEl","placeholder","_left","_top","dlgEl","jqFind","findingField","oldField","label","FilterDialog","fields","DBTableFilterPanel","tblCtrl","_filterDatasetObj","FilterDataset","_filterDataset","filterDataset","_dbtable","_jqFilterBtn","_currFieldName","_currFilterExpr","jqFilterBtn","changeField","dsFilter","lkDs","lookup","cancel","filtered","appendRecord","setFieldValue","_panel","cancelFilter","FilterPanel","ok","clear","clearAll","isEmpty","deleteRecord","getFilterExpr","_setFilterBtnStyle","dataList","_clearFilterBtnStyle","checkFilterBtnStyle","dsHost","dsFilterExpr","filterText","getFilterExprText","getAttribute","ExportDialog","hasSchemaSection","_exportDataset","_hasSchemaSection","_dlgId","fldCfg","nullText","exportLKDs","createDataset","keyField","codeField","nameField","parentField","isFireGlobalEvent","onCheckSelectable","hasChildren","expFldCfg","valueStyle","FieldValueStyle","MULTIPLE","exportDsClone","lkObj","FieldLookup","saveSchema","deleteSchema","fileName","exportData","jqExpportFile","showInfo","exportCsvFile","includeFields","exportDataset","exportDs","_refreshFields","addFields","fieldNames","isDetailDs","detailDs","subDataset","getNormalFields","fldChildren","all","getFields","first","description","InputSettingDialog","doProxyFieldChanged","dataRec","proxyFldName","proxyFldObj","hostFldObj","scale","editMask","displayFormat","dateFormat","displayControl","validChars","hostLkObj","displayFields","onlyLeafLevel","editControl","editorObj","compareValue","NORMAL","displayWidth","labelLabel","labelDefaultValue","proxyHostFieldName","proxyFieldChanged","labelFocused","labelValueFollow","_inputSettingDs","logChanges","indexFields","custContextFn","changingFldName","contextRules","condition","rules","customized","enableContextRule","onFieldChanged","propName","propValue","_isInit","_settings","hostDsName","hostFldName","dsSetting","fldSetting","_hostDataset","_onRestoreDefault","hostDataset","onClosedFn","onRestoreDefault","onRestoreDefaultFn","disableControls","_initializeFields","enableControls","creating","_createDialog","tblFields","expandAll","onRowClick","toggle","hostDs","isKeepFields","isDsFld","focused","valueFollow","save","propSetting","defaultInputSettingDialog","DBChart","chartTypes","legendPositions","_chartType","_categoryFields","_valueFields","_chartTitle","_legendPos","_fieldValidated","chartType","testValue","categoryField","_categoryField","valueFields","chartTitle","legendPos","_validateFields","fieldNotFound","_getLineData","xLabels","yValues","oldRecno","recnoSilence","legendLabels","valueFldName","valueArr","isInit","valueFldCnt","recCnt","_getPieData","_drawLineChart","chartData","jqplot","use_excanvas","seriesDefaults","rendererOptions","smooth","pointLabels","formatString","legend","labels","axes","xaxis","renderer","CategoryAxisRenderer","ticks","_drawPieChart","PieRenderer","_drawBarChart","isStack","stackSeries","BarRenderer","highlighter","drawChart","updateAllEvent","swf","DBEditPanel","_totalColumns","_columnCount","_labelCols","_onlySpecifiedFields","_fields","_hasLabel","_metaChangedDebounce","debounce","columnCount","labelCols","between","onlySpecifiedFields","hasLabel","colSpan","prefix","suffix","inFirstCol","showLine","_calcLayout","fldLayouts","layoutcnt","allFlds","fcnt","editFld","dftDataCols","floor","layout","itemCnt","r","colsInRow","_innerLabelCols","dataCols","_innerDataCols","row","getEditField","dbctrl","editor","oLabel","editorCfg","ohr","octrlDiv","opanel","ctrlId","dbCtrl","layouts","DBLabel","_renderEditPart","ctrlDiv","layoutCfg","hasPrefix","hasSuffix","otherPartWidth","_renderOtherPart","editorEl","_renderEditor","arrPrefixOrSuffix","fixCfg","partEl","jqCtrlDiv","totalWidth","append","DBInspector","colCnt","cfgFld","visibleFlds","columnCnt","min","arrLabelWidth","startWidth","displayLabel","totalLabelWidth","tHead","createTHead","insertRow","insertCell","rowNo","fldCtrl","oldRowNo","preRowIndex","noWrap","DBINSPECTOR","labelColCls","editorColCls","align","TABLECLASS","currentrow","scrollBarWidth","selectColWidth","hoverrow","TableColumn","colNum","displayOrder","disableHeadSort","mergeSame","noRefresh","cellRender","TableSubgroup","hasExpander","TableHead","rowSpan","subHeads","AbstractDBTable","_fixedRows","_fixedCols","_hasSeqCol","_reverseSeqCol","_seqColHeader","_hasSelectCol","_noborder","_editable","_hideHead","_onlySpecifiedCol","_disableHeadSort","_aggraded","_autoClearSelection","_selectBy","_rowHeight","_headRowHeight","_treeField","_columns","_onRowClick","_onRowDblClick","_onCellClick","_onCustomSort","_onSelect","_onSelectAll","_beforeSelect","_afterSelect","_beforeSelectAll","_afterSelectAll","_onFillRow","_onFillCell","_defaultCellRender","_hasFindDialog","_hasFilterDialog","_repairHeight","subgroup","_isHoriOverflow","_oldHeight","_currRow","_currColNum","_editingField","_editorTabIndex","_rowHeightChanged","_cellEditor","fixedRows","fixedCols","cols","headRowHeight","hasSeqCol","reverseSeqCol","seqColHeader","hasSelectCol","noborder","editable","hideHead","aggraded","autoClearSelection","onlySpecifiedCol","selectBy","treeField","defaultCellRender","isObject","currColNum","oldColNum","_adjustCurrentCellPos","_showCurrentCell","_findDialog","onRowDblClick","onCellClick","onSelect","onSelectAll","beforeSelect","afterSelect","beforeSelectAll","afterSelectAll","onCustomSort","onFillRow","onFillCell","hasFindDialog","hasFilterDialog","cellEditor","colObj","getColNumByField","gotoColumn","lastColNum","getFieldByColNum","_calcTabIndex","masterFldObj","getMasterFieldObject","charHeight","charWidth","defaultCharWidth","_widthStyleId","_initializeVm","notFF","onmousewheel","wheelEvent","num","wheelDelta","detail","status","DataSetStatus","BROWSE","listvm","setVisibleStartRow","getVisibleStartRow","_filterPanel","btnEle","tblPos","jsletColCfg","isSeqCol","_processRowSelection","altKey","_doBeforeSelect","_processSelection","_doCellClick","_isCellEditable","isBoolColumn","F","showFindDialog","E","gotoNextError","copySelection","selectAllCells","isTabKey","tabPrior","movePriorCell","moveNextCell","priorRow","nextRow","priorPage","nextPage","headSectionHt","nextError","firstError","fitExcel","selectedText","getSelectionText","Clipboard","putText","selectAll","_refreshSelection","editingFields","_getEditingFields","focusMngr","onChangingFocusFn","activeElement","prior","ListViewModel","onTopRownoChanged","rowno","_fillData","_syncScrollBar","_showCurrentRow","onVisibleCountChanged","onCurrentRownoChanged","preRowno","getCurrentRecno","fixed","currRow","_getTrByRowno","_innerDestroy","_calcParams","refreshModel","_createFrame","_updateSortFlag","hasCtrlKey","hasShiftKey","hasAltKey","_getSelectionFields","startColNum","endColNum","tmp","isSelected","add","_preRecno","_preColNum","_preTmpRecno","_preTmpColNum","removeAll","_processColumnSelection","_prepareColumn","getColumnObj","colCnt1","cobj","seqColWidth","DBTable","sequenceCellRender","isSelectCol","selectCellRender","isSubgroup","subgroupCellRender","tmpColumns","colCnt2","fldcnt","getTopField","isUnique","n","sort","cobj1","cobj2","ord1","ord2","innerHeads","ohead","depth","_convertField2Head","maxHeadRows","_calcHeadSpan","preColCnt","fixedColNum","heads","childCnt","parentHeadObj","max","getType","boolCellRender","treeCellRender","sWidth","fixedSectionHt","checkAggraded","footSectionHt","hasFixedCol","fixedColWidth","_setScrollBarMaxValue","maxValue","jqVScrollBar","contentSectionHt","_changeColWidthCssRule","cssName","styleEle","getElementById","styleSheet","sheet","cssRules","cssRule","selectorText","_changeColWidth","deltaW","designMode","_changeContentWidth","_refreshSeqColWidth","oldSeqColWidth","getTotalWidth","totalWidthStr","leftHeadTbl","leftFixedTbl","leftContentTbl","rightHeadTbl","rightFixedTbl","rightContentTbl","rightFootTbl","_checkHoriOverflow","generateWidthStyle","styleHtml","checkDropable","currCell","srcRowIndex","dragTransfer","rowIndex","srcCellIndex","cellIndex","currRowIndex","currCellIndex","srcFldName","currFldName","srcPFldObj","currPFldObj","dbtableframe","norecord","leftFootTbl","jqRightHead","_doSplitHookDown","_doSplitHookUp","isDraggingColumn","_doHeadClick","_head_label_cliecked","transfer","dataTransfer","dropEffect","effectAllowed","destField","_moveColumn","jqLeftFixedTbl","jqRightFixedTbl","jqLeftContentTbl","jqRightContentTbl","hasLeft","_keep_silence_","_isCurrCellInView","temp","focusing","bodyMleft","currColId","_renderHeader","noRecordDiv","_renderBody","destCellIndex","moveOneRow","srcStart","srcEnd","destStart","destEnd","colNo","srcCells","destCells","destCell","insertAfter","moveOneTableColumn","rowObj","preColNo","srcCell","srcColCfg","destColCfg","destFldName","moveField","currField","dataRows","_changeColNum","headRows","srcCellLen","destCellLen","firstDestColNum","newStart","_calcAndSetContentHeight","rh","setVisibleCount","getVisibleCount","getNeedShowRowCount","contentWidth","clientWidth","_refreshHeadCell","oth","ochild","createHeader","sh","_createHeadCell","sorttitle","travHead","arrHeadCfg","ccnt","leftHeadObj","rightHeadObj","jqTr1","jqTr2","sortedCell","indexField","ohook","tblContainer","jqTblContainer","bodyMTop","jqHook","currLeft","splitDiv","lastChild","_getColumnByField","ctrlKeyPressed","_doSort","sortField","isMultiSort","toggleIndexField","leftHeadCells","rightHeadCells","sortFields","mergedIndexFields","allHeadCells","sortDiv","cellCnt","sortFlag","sortObj","order","_doSelectBoxClick","ocheck","oJslet","_doRowDblClick","_doRowClick","jsletrecno","recnoToRowno","setCurrentRowno","_renderCell","isFirstCol","createCell","_renderRow","sectionNum","onlyRefreshContent","rightBody","leftBody","isfirstCol","startRow","fldCnt","ondblclick","sysColLen","_renderTotalSection","_fillTotalSection","aggradeValues","aggradedValues","otrLeft","otrRight","sysColCnt","totalValue","aggradeValueObj","labelDisplayed","canShowLabel","totalLabel","textAlign","NUMBER","sum","count","dispFmt","displayValue","formatNumber","allCnt","noRecord","_fillRow","isFixed","clen","recNo","contentRows","sameValueNodes","isFirst","actualCnt","_fillCell","cellPanel","isSameAsPrevious","cell","sameNode","refreshCell","getFieldErrorByRecno","jqTd","refreshCurrentRow","contentBody","fixedBody","selected","_getLeftRowByRecno","checkVisible","fixedRow","_getCurrCellEl","cellEl","contentRow","jqContentPanel","contentPanel","currTd","currTdLeft","offsetLeft","currTdWidth","offsetWidth","containerWidth","containerLeft","borderW","oldScrLeft","currColLeft","scrWidth","prevCell","ocells","jqCell","_showSelected","sw","scrBar","expandedByRecno","collapseAll","_doMetaChanged","currFld","ocheckbox","col","AGGRADED","BEFORESCROLL","preRecno","scrollEvent","SELECTRECORD","defaultChecked","SELECTALL","leftFixedBody","leftContentBody","isEditable","fieldDisabled","fieldReadOnly","newHeight","reset","parsedHeads","CellRender","DefaultCellRender","alignment","getFieldTextByRecno","urlExpr","calcUrl","urlTarget","jqCellPanel","SequenceCellRender","existRecordError","getRecordErrorInfo","SelectCellRender","jqCheck","checkSelectable","selectedByRecno","SubgroupCellRender","BoolCellRender","getFieldValueByRecno","TreeCellRender","aborted","arrSpan","getLevel","iconWidth","indentWidth","oindent","expBtn","jqExpBtn","getIconClass","iconCls","otext","Splitter","_splitDiv","isDragging","unattach","onSplitEnd","onSplitCancel","DBTreeView","_displayFields","_hasCheckBox","_readOnly","_correlateCheck","_onlyCheckChildren","_iconClassField","_expandLevel","_onItemDblClick","_beforeCheckBoxClick","_afterCheckBoxClick","_onGetIconClass","_onRenderItem","dispFields","dispField","iconClassField","hasCheckBox","correlateCheck","onlyCheckChildren","expandLevel","onItemDblClick","beforeCheckBoxClick","afterCheckBoxClick","onGetIconClass","onRenderItem","scrBarSize","_keyField","ti","evaluator","Expression","oldWidth","oldHeight","nodeHeight","strHeight","treePanelHeight","parseFloat","treePanelWidth","nodeCount","_initVm","_initFrame","lines","NODETYPE","treePnl","sb","numb","ceil","_skip_","getCurrentRowno","_doCurrentRowChanged","allCount","prevRowno","onNeedShowRowsCountChanged","onCheckStateChanged","_doCheckBoxClick","jsletrowno","prevRow","_getTextTd","TREENODECLASS","_doExpand","treeNode","_syncToDs","getCurrentRow","hasCheckbox","checkNode","vCnt","topRowno","availbleCnt","_isRendering","nodeWidth","preRowNo","ajustScrBar","maxNodeWidth","endRow","_fillNode","_getCheckClassName","TREECHECKBOXCLASS","mixedChecked","unChecked","nodeTbl","requiredCnt","pitem","islast","TREELINECLASS","empty","line","oexpander","minusBottom","plusBottom","minus","plus","joinBottom","oIcon","iconClsId","isLeaf","keyValue","eval","oText","isbold","_updateCheckboxState","checkAll","uncheckAll","checkChildNodes","syncDataset","noLineMinus","noLinePlus","childChecked","treeNodeLevel","isTree","visibleCount","visibleStartRow","visibleEndRow","needShowRows","allRows","currentRowno","currentRecno","initial","ds","_parentField","pId","tmpNode","tmpKeyValue","currRec","pnodes","parentValue","keyvalue","getRecord","_updateParentNodeBoldByChecked","_setLastFlag","_refreshNeedShowRows","_updateParentNodeBoldByNotChecked","cnode","notFireChangedEvent","_findVisibleNode","currCnt","_innerFindNode","rownoToRecno","notFireEvt","maxVisibleNo","setVisibleEndRow","getVisibleEndRow","skipSetCurrentRowno","_skipSetCurrentRowno","lowestRowno","maxRow","_iterateNode","_callbackFn","state","relativeCheck","_updateChildState","_updateParentState","childNode","newState","childState","pState","DBPlace","_expandChildWidth","expandChildWidth","param","BETWEEN","DBText","_beforeUpdateToDataset","_enterProcessed","_autoSelectAll","_position","beforeUpdateToDataset","enableInvalidTip","autoSelectAll","doFocus","doBlur","doKeydown","doKeypress","_skipFocusEvent","updateToDataset","_isBluring","K","editRecord","existStr","getRemainingString","cursorPos","fieldValidator","checkInputChar","inputText","STRING","chs","isForce","afterRefreshControl","editMaskCfg","maxLength","getEditLength","antiXss","htmlDecode","setFieldText","updateRecordEvent","onKeyDown","DBPassword","DBTextArea","DBCustomComboBox","_textReadOnly","textReadOnly","btnCls","comboButtonCls","dbtext","textCtrl","_textField","buttonClick","blur","dbbtn","popupUp","DBAutoComplete","MatchModes","_lookupField","_minChars","_minDelay","_beforePopup","_filterFields","_defaultFilterFields","_onGetFilterField","_matchMode","_timeoutHandler","lookupField","minChars","minDelay","matchMode","beforePopup","filterFields","onGetFilterField","_isSelecting","canBlur","lkf","lkds","closePopup","doChange","_invokePopup","confirmSelect","isPop","_populate","_getDefaultFilterFields","lookupFldObj","codeFld","nameFld","codeFldObj","nameFldObj","arrFields","_getFilterFields","lkFldObj","inputValue","filterFlds","eventFunc","getFunction","filterValue","lkFld","oldFlag","autoRefreshHostDataset","editFilter","fixedFilter","DBAutoCompletePanel","dlgWidth","showPopup","_destroyPopPanel","autoCompleteObj","dlgHeight","comboCfg","lkDataset","popup","lkfld","totalChars","cnth","tableparam","fldValue","doClosePopup","DBBetweenEdit","_minEleId","_maxEleId","lbl","betweenLabel","arrTd","minTd","maxTd","DBCheckBox","_beforeClick","_skipRefresh","beforeClick","_doClick","DBCheckBoxGroup","_itemIds","hasSelectAllBox","_hasSelectAllBox","activeEle","activeId","delegateTarget","chkEle","chkBoxes","checkbox","checkboxs","chkcnt","values","valueCnt","lookupNotFound","lkCnt","noOptions","isNewRow","_innerEditFilterExpr","editItemDisabled","disableOption","getCurrentDisplayValue","currCheckBox","_is_silence_","chkBox","allBoxes","isAllSelected","limitCount","valueCountLimit","invalidCheckedCount","itemIds","DBComboSelect","showStyles","_showStyle","_popupWidth","_popupHeight","_contentPanel","_pickupField","_onGetSearchField","_autoSelected","textField","popupHeight","popupWidth","showStyle","onGetSearchField","autoSelected","DBComboSelectPanel","customButtonLabel","onCustomButtonClick","comboSelectObj","_isShowing","fieldObject","searchBoxEle","_restoreLkDsEvent","_confirmSelectDebounce","_confirmSelect","lookupDs","isMultiple","_initSelected","showType","otree","_setLookupDsEvent","_showTips","_focus","dispCtrl","_oldLkDsCheckSelectable","_oldLkDsListener","datasetListener","DatasetEvent","AFTERSELECT","jqPh","_findData","treeParam","_confirmAndClose","tableParam","findByKey","arrKeyValues","valueSeparator","selectByKeyValue","findFldName","searchField","findFldNames","isMulti","selectedKeyValues","DBDataLabel","DBDatePicker","dateValue","dataRange","DBHtml","DBImage","_locked","_baseUrl","_altField","baseUrl","altField","locked","alt","lockedImageTips","src","srcURL","altText","isLabel","METANAMES","subType","REQUIREDCHAR","DBList","pfld","DBLookupLabel","lookupValue","returnField","DBRadioGroup","radioEle","radios","radio","DBRangeSelect","_beginItem","_endItem","_step","beginItem","endItem","step","multiple","_doChanged","_currOption","inProcessing","renderOptions","arrhtm","arrValue","optCnt","options","vcnt","opts","DBRating","_itemCount","_splitCount","_itemWidth","_required","itemCount","splitCount","itemWidth","_mouseDown","_mouseMove","_mouseOut","_mouseUp","rating","jqRating","x1","oRow","splitWidth","valueNo","_setBackgroundPos","_getPosX","_selectedItem","_selectedPx","bgX","backgroundPositionX","backgroundPosition","ratingRow","CHECKED","UNCHECKED","FOCUS","DBSelect","_groupField","_lookupDataset","groupField","lookupDataset","_doCheckLimitCount","_setDefaultValue","firstItemValue","dftValue","changedStatus","groupLookup","groupFldObj","extraIndex","groupIsLookup","indfld","groupValue","groupDisplayValue","preGroupValue","optValue","_checkOptionEditable","DBSpinEdit","tag","_createControl","upButton","downButton","_isDisabled","decValue","incValue","minValue","Number","NEGATIVE_INFINITY","POSITIVE_INFINITY","setValueToDataset","silence","_getRange","jqUpBtn","jqDownBtn","DBTimePicker","_is12Hour","_hasSecond","is12Hour","hasSecond","minTimePart","hour","minute","second","maxTimePart","_splitTime","minHour","maxHour","_getOptions","timePart","jqHour","jqMinute","jqAmPm","getHours","getMinutes","getSeconds","parts","_prefix","DATE","setHours","setMinutes","setSeconds","DBError","ERROR","DBPageBar","_showPageSize","_pageSizeList","_currPageCount","showPageSize","pageSizeList","pageSize","last","refresh","pageNum","_jqPageSize","pgSizeList","pageNo","requery","_jqFirstBtn","_jqPriorBtn","_jqNextBtn","_jqLastBtn","_jqRefreshBtn","_jqPageNum","pageCount","CHANGEPAGE","_refreshPageNum","_refreshButtonStatus","pageCnt","prevDisabled","nextDisabled"],"mappings":"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","file":"jslet-ui.min.js","sourcesContent":["/*!\r\n * Jslet JavaScript framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Group and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/* jshint ignore:start */\r\n\"use strict\";\r\n(function (root, factory) {\r\n    if (typeof define === 'function') {\r\n    \tif(define.amd) {\r\n\t        define('jslet-ui', ['jslet-data'], factory);\r\n\t    } else {\r\n\t    \tdefine(function(require, exports, module) {\r\n\t    \t\trequire('jslet-css');\r\n\t    \t\trequire('jslet-data');\r\n\t    \t\tmodule.exports = factory();\r\n\t    \t});\r\n\t    }\r\n    } else {\r\n    \tfactory();\r\n    }\r\n})(this, function () {\r\n/* jshint ignore:end */\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n\"use strict\";\r\nif(!jslet.ui) {\r\n\tjslet.ui = {};\r\n}\r\n\r\n/**\r\n* @class\r\n* Control Class, base class for all control\r\n*/\r\njslet.ui.Control = jslet.Class.create({\r\n\t/**\r\n\t * Constructor method\r\n\t * \r\n\t * @param {Html Element} el Html element\r\n\t * @param {String or Object} ctrlParams Parameters of this control, \r\n\t * it would be a JSON string or plan object, like: '{prop1: value1, prop2: value2}';\r\n\t */\r\n\tinitialize: function (el, ctrlParams) {\r\n\t\tvar Z = this;\r\n\t\tZ.el = el;\r\n\r\n\t\tZ.allProperties = null;\r\n\t\tctrlParams = jslet.ui._evalParams(ctrlParams);\r\n\t\tif (Z.isValidTemplateTag\t&& !Z.isValidTemplateTag(Z.el)) {\r\n\t\t\tvar ctrlClass = jslet.ui.getControlClass(ctrlParams.type), template;\r\n\t\t\tif (ctrlClass) {\r\n\t\t\t\ttemplate = ctrlClass.htmlTemplate;\r\n\t\t\t} else {\r\n\t\t\t\ttemplate = '';\r\n\t\t\t}\r\n\t\t\tthrow new Error(jslet.formatMessage(jslet.locale.DBControl.invalidHtmlTag, template));\r\n\t\t}\r\n\t\tZ._styleClass = null;\r\n\t\t\r\n\t\tZ.styleClass = function(styleClass) {\r\n\t\t\tif(styleClass === undefined) {\r\n\t\t\t\treturn Z._styleClass;\r\n\t\t\t}\r\n\t\t\tZ._styleClass = styleClass;\r\n\t\t};\r\n\t\t\r\n\t\tZ._childControls = null;\r\n\t\tZ.setParams(ctrlParams);\r\n\t\tZ.checkRequiredProperty();\r\n\t\tZ.el.jslet = this;\r\n\t\tZ.beforeBind();\r\n\t\tif(!Z.el.id) {\r\n\t\t\tZ.el.id = jslet.nextId();\r\n\t\t}\r\n\t\tZ.bind();\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tif(Z._styleClass) {\r\n\t\t\tjqEl.addClass(Z._styleClass);\r\n\t\t}\r\n\t\tZ.afterBind();\r\n\t},\r\n\r\n\tbeforeBind: function() {\r\n\t\t\r\n\t},\r\n\t\r\n\tbind: function() {\r\n\t\t\r\n\t},\r\n\t\r\n\tafterBind: function() {\r\n\t\t\r\n\t},\r\n\t\r\n\t/**\r\n\t * @protected\r\n\t */\r\n\tsetParams: function (ctrlParams) {\r\n\t\tif (!ctrlParams) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar ctrlType = ctrlParams.type;\r\n\t\tthis.styleClass(ctrlParams.styleClass);\r\n\t\t\r\n\t\tfor(var name in ctrlParams) {\r\n\t\t\tvar prop = this[name];\r\n\t\t\tif(name == 'type' || name == 'styleClass') {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif(prop && prop.call) {\r\n\t\t\t\tprop.call(this, ctrlParams[name]);\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(ctrlType +  \" NOT support control property: \" + name);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tcheckRequiredProperty: function () {\r\n\t\tif (!this.requiredProperties) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar arrProps = this.requiredProperties.split(','),\r\n\t\tcnt = arrProps.length, name;\r\n\t\tfor (var i = 0; i < cnt; i++) {\r\n\t\t\tname = arrProps[i].trim();\r\n\t\t\tif (!this[name]) {\r\n\t\t\t\tthrow new Error(jslet.formatMessage(jslet.locale.DBControl.expectedProperty, [name]));\r\n\t\t\t}\r\n\t\t}//end for\r\n\t},\r\n\t\r\n\taddChildControl: function(childCtrl) {\r\n\t\tvar Z = this;\r\n\t\tif(!Z._childControls) {\r\n\t\t\tZ._childControls = [];\r\n\t\t}\r\n\t\tif(childCtrl) {\r\n\t\t\tZ._childControls.push(childCtrl);\r\n\t\t}\r\n\t},\r\n\t\r\n\tremoveAllChildControls: function() {\r\n\t\tvar Z = this, childCtrl;\r\n        if(Z.el) {\r\n            Z.el.innerHTML = '';\r\n        }\r\n\t\tif(!Z._childControls) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfor(var i = 0, len = Z._childControls.length; i < len; i++) {\r\n\t\t\tchildCtrl = Z._childControls[i];\r\n\t\t\tchildCtrl.destroy();\r\n\t\t}\r\n\t\tZ._childControls = null;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Destroy method\r\n\t */\r\n\tdestroy: function(){\r\n\t\tif(this.el) {\r\n\t\t\tthis.el.jslet = null;\r\n\t\t\tthis.el = null;\r\n\t\t}\r\n\t}\r\n});\r\n\r\n/**\r\n * @class\r\n * Base data sensitive control\r\n */\r\njslet.ui.DBControl = jslet.Class.create(jslet.ui.Control, {\r\n\t\r\n\tinitialize: function ($super, el, ctrlParams) {\r\n\t\t$super(el, ctrlParams);\r\n\t},\r\n\r\n\t_dataset: undefined,\r\n\r\n\tdataset: function(dataset) {\r\n\t\tif(dataset === undefined) {\r\n\t\t\treturn this._dataset;\r\n\t\t}\r\n\r\n\t\tif (jslet.isString(dataset)) {\r\n\t\t\tdataset = jslet.data.dataModule.get(jQuery.trim(dataset));\r\n\t\t}\r\n\t\t\r\n\t\tjslet.Checker.test('DBControl.dataset', dataset).required().isClass(jslet.data.Dataset.className);\r\n\t\tthis._dataset = dataset;\r\n\t},\r\n\r\n\t/**\r\n\t * @protected\r\n\t */\r\n\tsetParams: function ($super, ctrlParams) {\r\n\t\t$super(ctrlParams);\r\n\t\tif(!this._dataset) {\r\n\t\t\tvar dsName = this.getDatasetInParentElement();\r\n\t\t\tthis.dataset(dsName);\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t * Call this method before binding parameters to a HTML element, you can rewrite this in your owner control\r\n\t * @param {String or Object} ctrlParams Parameters of this control, it would be a json string or object, like: '{prop1: value1, prop2: value2}';\r\n\t * \r\n\t */\r\n\tbeforeBind: function ($super) {\r\n\t\t$super();\r\n\t\tthis._dataset.addLinkedControl(this);\r\n\t},\r\n\r\n\tcheckRequiredProperty: function($super) {\r\n\t\tjslet.Checker.test('DBControl.dataset', this._dataset).required();\r\n\t\t$super();\r\n\t},\r\n\t\r\n\t/**\r\n\t * Refresh control when data changed.\r\n\t * There are three type changes: meta changed, data changed, lookup data changed.\r\n\t * \r\n\t * @param {jslet.data.refreshEvent} evt jslet refresh event object;\r\n\t * \r\n\t * @return {Boolean} if refresh successfully, return true, otherwise false.\r\n\t */\r\n\trefreshControl: function (evt) {\r\n\t\tvar Z = this, evtType;\r\n\t\tif(evt) {\r\n\t\t\tevtType = evt.eventType;\r\n\t\t} else {\r\n\t\t\tevtType = jslet.data.RefreshEvent.UPDATEALL;\r\n\t\t}\r\n\t\t// Meta changed \r\n\t\tif (evtType == jslet.data.RefreshEvent.CHANGEMETA) {\r\n\t\t\tvar metaName = evt.metaName;\r\n\t\t\tif(Z._field && Z._field == evt.fieldName) {\r\n\t\t\t\tZ.doMetaChanged(metaName);\r\n\t\t\t} else {\r\n\t\t\t\tif(!Z._field && (metaName == 'visible' || metaName == 'editControl')) {\r\n\t\t\t\t\tZ.doMetaChanged(metaName);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t//Lookup data changed\r\n\t\tif(evtType == jslet.data.RefreshEvent.UPDATELOOKUP && evt.fieldName == Z._field) {\r\n\t\t\tZ.doLookupChanged(evt.isMetaChanged);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t//Value changed\r\n\t\tif (evtType == jslet.data.RefreshEvent.SCROLL || \r\n\t\t\t\tevtType == jslet.data.RefreshEvent.INSERT ||\r\n\t\t\t\tevtType == jslet.data.RefreshEvent.DELETE) {\r\n\t\t\tZ.doValueChanged();\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif((evtType == jslet.data.RefreshEvent.UPDATERECORD ||\r\n\t\t\tevtType == jslet.data.RefreshEvent.UPDATECOLUMN) && \r\n\t\t\tevt.fieldName === undefined || evt && evt.fieldName == Z._field){\r\n\t\t\tZ.doValueChanged();\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif(evtType == jslet.data.RefreshEvent.UPDATEALL) {\r\n\t\t\tZ.doMetaChanged();\r\n\t\t\tZ.doLookupChanged();\r\n\t\t\tZ.doValueChanged();\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn true;\r\n\t}, // end refreshControl\r\n\t\r\n\t/**\r\n\t * \r\n\t */\r\n\tdoMetaChanged: function(metaName){},\r\n\t\r\n\tdoValueChanged: function() {},\r\n\t\r\n\tdoLookupChanged: function() {},\r\n\t\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tgetDatasetInParentElement: function () {\r\n\t\tvar el = this.el, pEl = null;\r\n\t\twhile (true) {\r\n\t\t\tpEl = jslet.ui.getParentElement(el, 1);\r\n\t\t\tif (!pEl) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif (pEl.jslet) {\r\n\t\t\t\treturn pEl.jslet.dataset;\r\n\t\t\t}\r\n\t\t\tel = pEl;\r\n\t\t} //end while\r\n\t\treturn null;\r\n\t},\r\n\r\n\tdestroy: function ($super) {\r\n\t\tthis.removeAllChildControls();\r\n\t\tif (this._dataset) {\r\n\t\t\tthis._dataset.removeLinkedControl(this);\r\n\t\t}\r\n\t\tthis._dataset = null;\r\n\t\t$super();\r\n\t}\r\n});\r\n\r\n/**\r\n * @class\r\n * Base data sensitive control\r\n */\r\njslet.ui.DBFieldControl = jslet.Class.create(jslet.ui.DBControl, {\r\n\tinitialize: function ($super, el, ctrlParams) {\r\n\t\t$super(el, ctrlParams);\r\n\t},\r\n\r\n\t_field: undefined,\r\n\t\r\n\t_valueIndex: undefined,\r\n\t\r\n\t_enableInvalidTip: true,\r\n\t\r\n\t_tableId: null,\r\n\t\r\n\t_tabIndex: null,\r\n\t\r\n\tfield: function(fldName) {\r\n\t\tif(fldName === undefined) {\r\n\t\t\treturn this._field;\r\n\t\t}\r\n\t\t\r\n\t\tfldName = jQuery.trim(fldName);\r\n\t\tjslet.Checker.test('DBControl.field', fldName).isString().required();\r\n\t\tvar k = fldName.lastIndexOf('#');\r\n\t\tif(k > 0) {\r\n\t\t\tthis._fieldMeta = fldName.substring(k+1);\r\n\t\t\tfldName = fldName.substring(0, k);\r\n\t\t}\r\n\t\t\r\n\t\tthis._field = fldName;\r\n\t},\r\n\t\r\n\tfieldMeta: function() {\r\n\t\treturn this._fieldMeta;\r\n\t},\r\n\t\r\n\tvalueIndex: function(valueIndex) {\r\n\t\tif(valueIndex === undefined) {\r\n\t\t\treturn this._valueIndex;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBControl.valueIndex', valueIndex).isNumber();\r\n\t\t\r\n\t\tthis._valueIndex = parseInt(valueIndex);\r\n\t},\r\n\t\r\n\ttabIndex: function(tabIndex) {\r\n\t\tif(tabIndex === undefined) {\r\n\t\t\treturn this._tabIndex;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBControl.tabIndex', tabIndex).isNumber();\r\n\t\tthis._tabIndex = tabIndex;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tsetParams: function ($super, ctrlParams) {\r\n\t\t$super(ctrlParams);\r\n\t\tvar value = ctrlParams.valueIndex;\r\n\t\tif (value !== undefined) {\r\n\t\t\tthis.valueIndex(value);\r\n\t\t}\r\n\t\tvar tbIdx = ctrlParams.tabIndex;\r\n\t\tif(tbIdx !== undefined) {\r\n\t\t\tthis.tabIndex(tbIdx);\r\n\t\t}\r\n\t},\r\n \r\n\tcheckRequiredProperty: function($super) {\r\n\t\t$super();\r\n\t\tjslet.Checker.test('DBControl.field', this._field).required();\r\n\t\tthis.existField(this._field);\r\n\t},\r\n\r\n\tdoMetaChanged: function($super, metaName){\r\n\t\t$super(metaName);\r\n\t\tif(!metaName || metaName == 'tip') {\r\n\t\t\tvar fldObj = this._dataset.getField(this._field);\r\n\t\t\tif(!fldObj) {\r\n\t\t\t\tthrow new Error('Field: ' + this._field + ' NOT exist!');\r\n\t\t\t}\r\n\t\t\tvar tip = fldObj.tip();\r\n\t\t\ttip = tip ? tip: '';\r\n\t\t\tthis.el.title = tip;\r\n\t\t}\r\n\t},\r\n\t\r\n\tsetTabIndex: function() {\r\n\t\tvar Z = this,\r\n\t\t\ttabIdx = Z._tabIndex;\r\n\t\tif(tabIdx !== 0 && !tabIdx) {\r\n\t\t\tvar fldObj = Z._dataset.getField(Z._field);\r\n\t\t\tif(fldObj) {\r\n\t\t\t\ttabIdx = fldObj.tabIndex();\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(tabIdx === 0 || tabIdx) {\r\n\t\t\tZ.el.tabIndex = tabIdx;\r\n\t\t}\r\n\t},\r\n\t\r\n\texistField: function(fldName) {\r\n\t\tvar fldObj = this._dataset.getField(fldName);\r\n\t\treturn fldObj ? true: false;\r\n\t},\r\n\t\r\n\ttableId: function(tableId) {\r\n\t\tif(tableId === undefined) {\r\n\t\t\treturn this._tableId;\r\n\t\t}\r\n\t\tthis._tableId = tableId;\r\n\t},\r\n\t\r\n\tgetValue: function() {\r\n\t\treturn this._dataset.getFieldValue(this._field, this._valueIndex); \r\n\t},\r\n\t\r\n\tgetText: function(isEditing) {\r\n\t\treturn this._dataset.getFieldText(this._field, isEditing, this._valueIndex); \r\n\t},\r\n\t\r\n\tgetFieldError: function() {\r\n\t\treturn this._dataset.getFieldError(this._field, this._valueIndex);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @protected\r\n\t * Render invalid message and change the control to \"invalid\" style.\r\n\t * \r\n\t *  @param {String} errObj error object: {code: xxx, message}, if it's null, clear the 'invalid' style. \r\n\t */\r\n\trenderInvalid: function (errObj) {\r\n\t\tvar Z = this;\r\n\t\tif (!Z._field) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (errObj){\r\n\t\t\tjQuery(Z.el).parent().addClass('has-error');\r\n\t\t\tZ.el.title = errObj.message || '';\r\n\t\t} else {\r\n\t\t\tjQuery(Z.el).parent().removeClass('has-error');\r\n\t\t\tZ.el.title = '';\r\n\t\t}\r\n\t},\r\n \r\n\t/**\r\n\t * @protected\r\n\t * Identify this control can be focused or not.  \r\n\t */\r\n\tcanFocus: function() {\r\n\t\treturn true;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Focus to this control.\r\n\t */\r\n\tfocus: function() {\r\n\t\tvar Z = this;\r\n\t\tif(!Z.canFocus()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar\tfldObj = Z._dataset.getField(Z._field),\r\n\t\t\tflag = !fldObj || fldObj.disabled() || fldObj.readOnly() || !fldObj.visible();\r\n\t\tif(flag) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(Z._tableId) {\r\n\t\t\tjslet('#' + Z._tableId).gotoField(Z._field);\r\n\t\t}\r\n\t\tthis.innerFocus();\r\n\t},\r\n\t\r\n\t/**\r\n\t * @protected.\r\n\t */\r\n\tinnerFocus: function() {\r\n\t\tvar Z = this,\r\n\t\t\tel = Z.el;\r\n\t\tif (el.focus) {\r\n\t\t\ttry {\r\n\t\t\t\tel.focus();\r\n\t\t\t\tif(Z.selectText) {\r\n\t\t\t\t\tZ.selectText();\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t} catch (e) {\r\n\t\t\t\t//Can\\'t focus on this control, maybe it\\'s disabled!\r\n\t\t\t\tconsole.warn(jslet.locale.Dataset.cannotFocusControl);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function ($super) {\r\n\t\t$super();\r\n\t\tthis._field = null;\r\n\t}\r\n\t\r\n});\r\n\r\n/**\r\n* @private\r\n* Convert string parameters to object\r\n* \r\n* @param {String or Object} ctrlParams Control parameters.\r\n* @return {Object}\r\n*/\r\njslet.ui._evalParams = function (ctrlParams) {\r\n\tjslet.Checker.test('evalParams#ctrlParams', ctrlParams).required();\r\n\tif (jslet.isString(ctrlParams)) {\r\n\t\tvar p = jQuery.trim(ctrlParams);\r\n\t\tif (!p.startsWith('{') && p.indexOf(':')>0) {\r\n\t\t\tp = '{' + p +'}';\r\n\t\t}\r\n\t\ttry {\r\n\t\t\t/* jshint ignore:start */\r\n\t\t\tctrlParams = new Function('return ' + p)();\r\n\t\t\t/* jshint ignore:end */\r\n\t\t\tif(ctrlParams['var']) {\r\n\t\t\t\tctrlParams = ctrlParams['var'];\r\n\t\t\t}\r\n\t\t\treturn ctrlParams;\r\n\t\t} catch (e) {\r\n\t\t\tthrow new Error(jslet.formatMessage(jslet.locale.DBControl.invalidJsletProp, [ctrlParams]));\r\n\t\t}\r\n\t}\r\n\treturn ctrlParams;\r\n};\r\n\r\n/**\r\n* Hold all jslet control's configurations\r\n*/\r\njslet.ui.controls = new jslet.SimpleMap();\r\n\r\n/**\r\n* Register jslet control class.\r\n* <pre><code>\r\n* jslet.ui.register('Accordion', jslet.ui.Accordion);\r\n* </code></pre>\r\n* \r\n* @param {String} ctrlName Control name.\r\n* @param {jslet.Class} ctrlType Control Class\r\n*/\r\njslet.ui.register = function (ctrlName, ctrlType) {\r\n\tjslet.ui.controls.set(ctrlName.toLowerCase(), ctrlType);\r\n};\r\n\r\n/**\r\n* Create jslet control according to control configuration, and add it to parent element.\r\n* \r\n* @param {String or Object} jsletparam Jslet Parameter\r\n* @param {Html Element} parent Parent html element which created control will be added to.\r\n* @param {Integer} width Control width, unit: px;\r\n* @param {Integer} height Control height, Unit: px; \r\n* @param {Boolean} hidden Hide control or not;\r\n*  \r\n* @return {jslet control}\r\n*/\r\njslet.ui.createControl = function (jsletparam, parent, width, height, hidden) {\r\n\tvar isAuto = false, \r\n\t\tpnode = parent,\r\n\t\tcontainer = document.createElement('div'),\r\n\t\tctrlParam = jslet.ui._evalParams(jsletparam),\r\n\t\tcontrolType = ctrlParam.type;\r\n\tif (!controlType) {\r\n\t\tcontrolType = jslet.ui.controls.DBTEXT;\r\n\t}\r\n\tvar ctrlClass = jslet.ui.controls.get(controlType.toLowerCase());\r\n\tif (!ctrlClass) {\r\n\t\tthrow new Error('NOT found control type: ' + controlType);\r\n\t}\r\n\tcontainer.innerHTML = ctrlClass.htmlTemplate;\r\n\r\n\tvar el = container.firstChild;\r\n\tcontainer.removeChild(el);\r\n\tif(hidden) {\r\n\t\tel.style.display = 'none';\r\n\t}\t\r\n\tif (parent) {\r\n\t\tparent.appendChild(el);\r\n\t} else {\r\n\t\tdocument.body.appendChild(el);\r\n\t}\r\n\tif (width) {\r\n\t\tif (parseInt(width) == width)\r\n\t\t\twidth = width + 'px';\r\n\t\tel.style.width = width;\r\n\t}\r\n\tif (height) {\r\n\t\tif (parseInt(height) == height)\r\n\t\t\theight = height + 'px';\r\n\t\tel.style.height = height;\r\n\t}\r\n\r\n\treturn new ctrlClass(el, ctrlParam);\r\n};\r\n\r\n/**\r\n * Get jslet class with class name.\r\n * \r\n * @param {String} name Class name.\r\n * @return {jslet.Class}\r\n */\r\njslet.ui.getControlClass = function (name) {\r\n\treturn jslet.ui.controls.get(name.toLowerCase());\r\n};\r\n\r\n/**\r\n* Bind jslet control to an existing html element.\r\n* \r\n* @param {Html Element} el Html element\r\n* @param {String or Object} jsletparam Control parameters\r\n*/\r\njslet.ui.bindControl = function (el, jsletparam) {\r\n\tif (!jsletparam)\r\n\t\tjsletparam = jQuery(el).attr('data-jslet');\r\n\tif(el.jslet) {\r\n\t\tconsole.warn('Control has installed! Don\\'t install it again!');\r\n\t\treturn;\r\n\t}\r\n\tvar ctrlParam = jslet.ui._evalParams(jsletparam);\r\n\tvar controlType = ctrlParam.type;\r\n\tif (!controlType) {\r\n\t\tel.jslet = ctrlParam;\r\n\t\treturn;\r\n\t}\r\n\tvar ctrlClass = jslet.ui.controls.get(controlType.toLowerCase());\r\n\tif (!ctrlClass) {\r\n\t\tthrow new Error('NOT found control type: ' + controlType);\r\n\t}\r\n\tnew ctrlClass(el, ctrlParam);\r\n};\r\n\r\n/**\r\n* Unbind jslet control and clear jslet property.\r\n* \r\n* @param {Html Element} el Html element\r\n*/\r\njslet.ui.unbindControl = function(el) {\r\n\tif (el.jslet && el.jslet.destroy) {\r\n\t\tel.jslet.destroy();\r\n\t}\r\n\tel.jslet = null;\r\n};\r\n\r\n/**\r\n* re-bind jslet control.\r\n* \r\n* @param {Html Element} el Html element\r\n*/\r\njslet.ui.rebindControl = function(el) {\r\n\tjslet.ui.unbindControl(el);\r\n\tjslet.ui.bindControl(el);\r\n};\r\n\r\n/**\r\n* Scan the specified html element children and bind jslet control to these html element with 'data-jslet' attribute.\r\n* \r\n* @param {Html Element} pElement Parent html element which need to be scan, if null, document.body used.\r\n* @param {Function} onJsletReady Call back function after jslet installed.\r\n*/\r\njslet.ui.install = function (pElement, onJsletReady) {\r\n\tif(pElement && (onJsletReady === undefined)) {\r\n\t\t//Match case: jslet.ui.install(onJsletReady);\r\n\t\tif(jQuery.isFunction(pElement)) {\r\n\t\t\tonJsletReady = pElement;\r\n\t\t\tpElement = null;\r\n\t\t}\r\n\t}\r\n\t\r\n\tif(!pElement && jslet.locale.isRtl){\r\n\t\tvar jqBody = jQuery(document.body);\r\n\t\tif(!jqBody.hasClass('jl-rtl')) {\r\n\t\t\tjqBody.addClass('jl-rtl');\r\n\t\t}\r\n\t}\r\n\tvar htmlTags;\r\n\tif (!pElement){\r\n\t\tpElement = document.body;\r\n\t}\r\n\thtmlTags = jQuery(pElement).find('*[data-jslet]');\r\n\r\n\tvar cnt = htmlTags.length, el, id, \r\n\t\texistIds = jslet.existIds;\r\n\tif(!existIds) {\r\n\t\texistIds = {};\r\n\t\tjslet.existIds = existIds;\r\n\t}\r\n\tfor (var i = 0; i < cnt; i++) {\r\n\t\tel = htmlTags[i];\r\n\t\tid = el.id;\r\n\t\tif(id) {\r\n\t\t\tif(existIds[id]) {\r\n\t\t\t\tconsole.warn(jslet.formatMessage(jslet.locale.Control.duplicatedId, [id]));\r\n\t\t\t} else {\r\n\t\t\t\texistIds[id] = 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\tjslet.ui.bindControl(el);\r\n\t}\r\n\tif(onJsletReady){\r\n\t\tonJsletReady();\r\n\t\t//jslet.ui.onReady();\r\n\t}\r\n\tif(jslet.global.afterInstall) {\r\n\t\tjslet.global.afterInstall(pElement);\r\n\t}\r\n};\r\n\r\n///**\r\n// * {Event} Fired after jslet has installed all controls.\r\n// * Pattern: function(){};\r\n// */\r\n//jslet.ui.onReady = null;\r\n\r\n/**\r\n* Scan the specified html element children and unbind jslet control to these html element with 'data-jslet' attribute.\r\n* \r\n* @param {Html Element} pElement Parent html element which need to be scan, if null, document.body used.\r\n*/\r\njslet.ui.uninstall = function (pElement) {\r\n\tvar htmlTags;\r\n\tif (!pElement) {\r\n\t\thtmlTags = jQuery('*[data-jslet]');\r\n\t} else {\r\n\t\thtmlTags = jQuery(pElement).find('*[data-jslet]');\r\n\t}\r\n\tvar el;\r\n\tfor(var i =0, cnt = htmlTags.length; i < cnt; i++){\r\n\t\tel = htmlTags[i];\r\n\t\tif (el.jslet && el.jslet.destroy) {\r\n\t\t\tel.jslet.destroy();\r\n\t\t}\r\n\t\tel.jslet = null;\r\n\t}\r\n\tif(jslet.ui.menuManager) {\r\n\t\tjQuery(document).off('mousedown', jslet.ui.menuManager.hideAll);\r\n\t}\r\n//\tjslet.ui.onReady = null;\r\n};\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n\"use strict\";\r\nif(!jslet.ui) {\r\n\tjslet.ui = {};\r\n}\r\n\r\n/**\r\n* Drag & Drop. A common framework to implement drag & drop. Example:\r\n* <pre><code>\r\n*   //Define a delegate class\r\n*   dndDelegate = {}\r\n*   dndDelegate._doDragStart = function(){}\r\n*   dndDelegate._doDragging = function (oldX, oldY, x, y, deltaX, deltaY) {}\r\n*   dndDelegate._doDragEnd = function (oldX, oldY, x, y, deltaX, deltaY) {}\r\n*   dndDelegate._doDragCancel = function () {}\r\n* \r\n*   //Initialize jslet.ui.DnD\r\n*   //var dnd = new jslet.ui.DnD();\r\n*   //Or use global jslet.ui.DnD instance to bind 'dndDelegate'\r\n*   jslet.ui.dnd.bindControl(dndDelegate);\r\n*\t\r\n*   //After end dragging, you need unbind it\r\n*   jslet.ui.dnd.unbindControl();\r\n* \r\n* </code></pre>\r\n* \r\n*/\r\n\r\njslet.ui.DnD = function () {\r\n\tvar oldX, oldY, x, y, deltaX, deltaY,\r\n\t\tdragDelta = 2, \r\n\t\tdragged = false, \r\n\t\tbindedControl, \r\n\t\tmouseDowned = true,\r\n\t\tself = this;\r\n\r\n\tthis._docMouseDown = function (event) {\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\tmouseDowned = true;\r\n\t\tdeltaX = 0;\r\n\t\tdeltaY = 0;\r\n\t\toldX = event.pageX;\r\n\t\toldY = event.pageY;\r\n\t\tdragged = false;\r\n\r\n\t\tif (bindedControl && bindedControl._doMouseDown) {\r\n\t\t\tbindedControl._doMouseDown(oldX, oldY, x, y, deltaX, deltaY);\r\n\t\t}\r\n\t};\r\n\r\n\tthis._docMouseMove = function (event) {\r\n\t\tif (!mouseDowned) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\t\r\n\t\tx = event.pageX;\r\n\t\ty = event.pageY;\r\n\t\tif (!dragged) {\r\n\t\t\tif (Math.abs(deltaX) > dragDelta || Math.abs(deltaY) > dragDelta) {\r\n\t\t\t\tdragged = true;\r\n\t\t\t\toldX = x;\r\n\t\t\t\toldY = y;\r\n\t\t\t\tif (bindedControl && bindedControl._doDragStart) {\r\n\t\t\t\t\tbindedControl._doDragStart(oldX, oldY);\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tdeltaX = x - oldX;\r\n\t\tdeltaY = y - oldY;\r\n\t\tif (dragged) {\r\n\t\t\tif (bindedControl && bindedControl._doDragging) {\r\n\t\t\t\tbindedControl._doDragging(oldX, oldY, x, y, deltaX, deltaY);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (bindedControl && bindedControl._doMouseMove) {\r\n\t\t\t\tbindedControl._doMouseMove(oldX, oldY, x, y, deltaX, deltaY);\r\n\t\t\t}\r\n\t\t\toldX = x;\r\n\t\t\toldY = y;\r\n\t\t}\r\n\t};\r\n\r\n\tthis._docMouseUp = function (event) {\r\n\t\tmouseDowned = false;\r\n\t\tif (dragged) {\r\n\t\t\tdragged = false;\r\n\t\t\tif (bindedControl && bindedControl._doDragEnd) {\r\n\t\t\t\tbindedControl._doDragEnd(oldX, oldY, x, y, deltaX, deltaY);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (bindedControl && bindedControl._doMouseUp) {\r\n\t\t\t\tbindedControl._doMouseUp(oldX, oldY, x, y, deltaX, deltaY);\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.unbindControl();\r\n\t};\r\n\r\n\tthis._docKeydown = function (event) {\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\tif (event.which == 27) {//Esc key\r\n\t\t\tif (dragged) {\r\n\t\t\t\tdragged = false;\r\n\t\t\t\tif (bindedControl && bindedControl._doDragCancel) {\r\n\t\t\t\t\tbindedControl._doDragCancel();\r\n\t\t\t\t\tself.unbindControl();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tthis._docSelectStart = function (event) {\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\tevent.preventDefault();\r\n\r\n\t\treturn false;\r\n\t};\r\n\r\n\t/**\r\n\t * Bind control \r\n\t * \r\n\t * @param {Object} ctrl The control need drag & drop, there are four method in it: \r\n\t *  ctrl._doDragStart = function(){}\r\n\t *  ctrl._doDragging = function(oldX, oldY, x, y, deltaX, deltaY){}\r\n\t *  ctrl._doDragEnd = function(oldX, oldY, x, y, deltaX, deltaY){}\r\n\t *  ctrl._doDragCancel = function(){}\r\n\t *  ctrl_doDragStart = function{}\r\n\t *  \r\n\t */\r\n\tthis.bindControl = function (ctrl) {\r\n\t\tbindedControl = ctrl;\r\n\t\tvar doc = jQuery(document);\r\n\t\tdoc.on('mousedown', this._docMouseDown);\r\n\t\tdoc.on('mouseup', this._docMouseUp);\r\n\t\tdoc.on('mousemove', this._docMouseMove);\r\n\t\tdoc.on('selectstart', this._docSelectStart);\r\n\t\tdoc.on('keydown', this._docKeydown);\r\n\t};\r\n\r\n\t/**\r\n\t * Unbind the current control\r\n\t */\r\n\tthis.unbindControl = function () {\r\n\t\tvar doc = jQuery(document);\r\n\t\tdoc.off('mousedown', this._docMouseDown);\r\n\t\tdoc.off('mouseup', this._docMouseUp);\r\n\t\tdoc.off('mousemove', this._docMouseMove);\r\n\t\tdoc.off('selectstart', this._docSelectStart);\r\n\t\tdoc.off('keydown', this._docKeydown);\r\n\t\t\r\n\t\tbindedControl = null;\r\n\t};\r\n};\r\n\r\njslet.ui.dnd = new jslet.ui.DnD();\r\n\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n\"use strict\";\r\nif(!jslet.ui) {\r\n\tjslet.ui = {};\r\n}\r\n\r\n/**\r\n * @class EditMask\r\n * Create edit mask class and attach to a html text element.Example:\r\n * <pre><code>\r\n *  var mask = new jslet.ui.EditMask('L00-000');\r\n *  var mask.attach(htmlText);\r\n * </code></pre>\r\n * \r\n * @param {String} mask Mask string, rule:\r\n *  '#': char set: 0-9 and -, not required, \r\n *  '0': char set: 0-9, required,\r\n *  '9': char set: 0-9, not required,\r\n *  'L': char set: A-Z,a-z, required,\r\n *  'l': char set: A-Z,a-z, not required,\r\n *  'A': char set: 0-9,a-z,A-Z, required,\r\n *  'a': char set: 0-9,a-z,A-Z, not required,\r\n *  'C': char set: any char, required\r\n *  'c': char set: any char, not required\r\n *\r\n *@param {Boolean} keepChar Keep the literal character or not\r\n *@param {String} transform Transform character into UpperCase or LowerCase,\r\n *  optional value: upper, lower or null.\r\n */\r\njslet.ui.EditMask = function () {\r\n\tthis._mask = null;\r\n\tthis._keepChar = true;\r\n\tthis._transform = null;\r\n\r\n\tthis._literalChars = null;\r\n\tthis._parsedMask = null;\r\n\tthis._format = null;\r\n\tthis._target = null;\r\n\tthis._buffer = null;\r\n};\r\n\r\njslet.ui.EditMask.prototype = {\r\n\tmaskChars: {\r\n\t\t'#': { regexpr: new RegExp('[0-9\\\\-]'), required: false }, \r\n\t\t'0': { regexpr: new RegExp('[0-9]'), required: true },\r\n\t\t'9': { regexpr: new RegExp('[0-9]'), required: false },\r\n\t\t'L': { regexpr: new RegExp('[A-Za-z]'), required: true },\r\n\t\t'l': { regexpr: new RegExp('[A-Za-z]'), required: false },\r\n\t\t'A': { regexpr: new RegExp('[0-9a-zA-Z]'), required: true },\r\n\t\t'a': { regexpr: new RegExp('[0-9a-zA-Z]'), required: false },\r\n\t\t'C': { regexpr: null, required: true },\r\n\t\t'c': { regexpr: null, required: false }\r\n\t},\r\n\t\r\n\ttransforms: ['upper','lower'],\r\n\r\n\tsetMask: function(mask, keepChar, transform){\r\n\t\tmask = jQuery.trim(mask);\r\n\t\tjslet.Checker.test('EditMask#mask', mask).isString();\r\n\t\tthis._mask = mask;\r\n\t\tthis._keepChar = keepChar ? true: false;\r\n\t\t\r\n\t\tthis._transform = null;\r\n\t\tif(transform){\r\n\t\t\tvar checker = jslet.Checker.test('EditMask#transform', transform).isString();\r\n\t\t\ttransform = jQuery.trim(transform);\r\n\t\t\ttransform = transform.toLowerCase();\r\n\t\t\tchecker.inArray(this.transforms);\r\n\t\t\tthis._transform = transform;\r\n\t\t}\r\n\t\tthis._parseMask();\r\n\t},\r\n\t\r\n\t/**\r\n\t * Attach edit mask to a html text element\r\n\t * \r\n\t * @param {Html Text Element} target Html text element\r\n\t */\r\n\tattach: function (target) {\r\n\t\tjslet.Checker.test('EditMask.attach#target', target).required();\r\n\t\tvar Z = this, jqText = jQuery(target);\r\n\t\tZ._target = target;\r\n\t\tjqText.on('keypress.editmask', function (event) {\r\n\t\t\tif(this.readOnly || !Z._mask) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tvar c = event.which;\r\n\t\t\tif (c === 0) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif (!Z._doKeypress(c)) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t} else {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t});\r\n\t\tjqText.on('keydown.editmask', function (event) {\r\n\t\t\tif(this.readOnly || !Z._mask) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif (!Z._doKeydown(event.which)) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t} else {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tjqText.on('blur.editmask', function (event) {\r\n\t\t\tif(this.readOnly || !Z._mask) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif (!Z._doBur()) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tevent.currentTarget.focus();\r\n\t\t\t} else {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tjqText.on('cut.editmask', function (event) {\r\n\t\t\tif(this.readOnly || !Z._mask) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tZ._doCut(event.originalEvent.clipboardData || window.clipboardData);\r\n\t\t\tevent.preventDefault();\r\n\t\t\treturn false;\r\n\t\t});\r\n\r\n\t\tjqText.on('paste.editmask', function (event) {\r\n\t\t\tif(this.readOnly || !Z._mask) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif (!Z._doPaste(event.originalEvent.clipboardData || window.clipboardData)) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Detach edit mask from a html text element\r\n\t */\r\n\tdetach: function(){\r\n\t\tvar jqText = jQuery(this._target);\r\n\t\tjqText.off('keypress.editmask');\r\n\t\tjqText.off('keydown.editmask');\r\n\t\tjqText.off('blur.editmask');\r\n\t\tjqText.off('cut.editmask');\r\n\t\tjqText.off('paste.editmask');\r\n\t\tthis._target = null; \r\n\t},\r\n\t\r\n\tsetValue: function (value) {\r\n\t\tvalue = jQuery.trim(value);\r\n\t\tjslet.Checker.test('EditMask.setValue#value', value).isString();\r\n\t\tvalue = value ? value : '';\r\n\t\tif(!this._mask) {\r\n\t\t\tthis._target.value = value;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tvar Z = this;\r\n\t\tZ._clearBuffer(0);\r\n\t\tvar prePos = 0, pos, preValuePos = 0, k, i, \r\n\t\t\tch, vch, valuePos = 0, fixedChar, \r\n\t\t\tmaskLen = Z._parsedMask.length;\r\n\t\twhile (true) {\r\n\t\t\tfixedChar = Z._getFixedCharAndPos(prePos);\r\n\t\t\tpos = fixedChar.pos;\r\n\t\t\tch = fixedChar.ch;\r\n\t\t\tif (pos < 0) {\r\n\t\t\t\tpos = prePos;\r\n\t\t\t}\r\n\t\t\tif (ch) {\r\n\t\t\t\tvaluePos = value.indexOf(ch, preValuePos);\r\n\t\t\t\tif (valuePos < 0) {\r\n\t\t\t\t\tvaluePos = value.length;\r\n\t\t\t\t}\r\n\t\t\t\tk = -1;\r\n\t\t\t\tfor (i = valuePos - 1; i >= preValuePos; i--) {\r\n\t\t\t\t\tvch = value.charAt(i);\r\n\t\t\t\t\tZ._buffer[k + pos] = vch;\r\n\t\t\t\t\tk--;\r\n\t\t\t\t}\r\n\t\t\t\tpreValuePos = valuePos + 1;\r\n\t\t\t} else {\r\n\t\t\t\tk = 0;\r\n\t\t\t\tvar c, cnt = Z._buffer.length;\r\n\t\t\t\tfor (i = prePos; i < cnt; i++) {\r\n\t\t\t\t\tc = value.charAt(preValuePos + k);\r\n\t\t\t\t\tif (!c) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tZ._buffer[i] = c;\r\n\t\t\t\t\tk++;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tprePos = pos + 1;\r\n\t\t}\r\n\t\tZ._showValue();\r\n\t},\r\n\t\r\n\tgetValue: function(){\r\n\t\tvar value = this._target.value;\r\n\t\tif(this._keepChar) {\r\n\t\t\treturn value;\r\n\t\t} else {\r\n\t\t\tvar result = [], maskObj;\r\n\t\t\tfor(var i = 0, cnt = value.length; i< cnt; i++){\r\n\t\t\t\tmaskObj = this._parsedMask[i];\r\n\t\t\t\tif(maskObj.isMask) {\r\n\t\t\t\t\tresult.push(value.charAt(i));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result.join('');\r\n\t\t}\r\n\t},\r\n\t\r\n\tvalidateValue: function(){\r\n\t\tvar Z = this, len = Z._parsedMask.length, cfg;\r\n\t\tfor(var i = 0; i< len; i++){\r\n\t\t\tcfg = Z._parsedMask[i];\r\n\t\t\tif(cfg.isMask && Z.maskChars[cfg.ch].required){\r\n\t\t\t\tif(Z._buffer[i] == Z._format[i]) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\t\r\n\t_getFixedCharAndPos: function (begin) {\r\n\t\tvar Z = this;\r\n\t\tif (!Z._literalChars || Z._literalChars.length === 0) {\r\n\t\t\treturn { pos: 0, ch: null };\r\n\t\t}\r\n\t\tif (!begin) {\r\n\t\t\tbegin = 0;\r\n\t\t}\r\n\t\tvar ch, mask;\r\n\t\tfor (var i = begin, cnt = Z._parsedMask.length; i < cnt; i++) {\r\n\t\t\tmask = Z._parsedMask[i];\r\n\t\t\tif (mask.isMask) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tch = mask.ch;\r\n\t\t\tif (Z._literalChars.indexOf(ch) >= 0) {\r\n\t\t\t\treturn { ch: ch, pos: i };\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn { pos: -1, ch: null };\r\n\t},\r\n\r\n\t_parseMask: function () {\r\n\t\tvar Z = this;\r\n\t\tif(!Z._mask) {\r\n\t\t\tZ._parsedMask = null;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tZ._parsedMask = [];\r\n\t\t\r\n\t\tZ._format = [];\r\n\t\tvar c, prevChar = null, isMask;\r\n\r\n\t\tfor (var i = 0, cnt = Z._mask.length; i < cnt; i++) {\r\n\t\t\tc = Z._mask.charAt(i);\r\n\t\t\tif (c == '\\\\') {\r\n\t\t\t\tprevChar = c;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tisMask = false;\r\n\t\t\tif (Z.maskChars[c] === undefined) {\r\n\t\t\t\tif (prevChar) {\r\n\t\t\t\t\tZ._parsedMask.push({ ch: prevChar, isMask: isMask });\r\n\t\t\t\t}\r\n\t\t\t\tZ._parsedMask.push({ ch: c, isMask: isMask });\r\n\t\t\t} else {\r\n\t\t\t\tisMask = prevChar ? false : true;\r\n\t\t\t\tZ._parsedMask.push({ ch: c, isMask: isMask });\r\n\t\t\t}\r\n\t\t\tif(Z._keepChar && !isMask){\r\n\t\t\t\tif(!Z._literalChars) {\r\n\t\t\t\t\tZ._literalChars = [];\r\n\t\t\t\t}\r\n\t\t\t\tvar notFound = true;\r\n\t\t\t\tfor(var k = 0, iteralCnt = Z._literalChars.length; k < iteralCnt; k++){\r\n\t\t\t\t\tif(Z._literalChars[k] == c){\r\n\t\t\t\t\t\tnotFound = false;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(notFound) {\r\n\t\t\t\t\tZ._literalChars.push(c);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tprevChar = null;\r\n\t\t\tZ._format.push(isMask ? '_' : c);\r\n\t\t} //end for\r\n\r\n\t\tZ._buffer = Z._format.slice(0);\r\n\t\tif(Z._target) {\r\n\t\t\tZ._target.value = Z._format.join('');\r\n\t\t}\r\n\t},\r\n\t\r\n\t_validateChar: function (maskChar, inputChar) {\r\n\t\tvar maskCfg = this.maskChars[maskChar];\r\n\t\tvar regExpr = maskCfg.regexpr;\r\n\t\tif (regExpr) {\r\n\t\t\treturn regExpr.test(inputChar);\r\n\t\t} else {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t},\r\n\r\n\t_getValidPos: function (pos, toLeft) {\r\n\t\tvar Z = this, \r\n\t\t\tcnt = Z._parsedMask.length, i;\r\n\t\tif (pos >= cnt) {\r\n\t\t\treturn cnt - 1;\r\n\t\t}\r\n\t\tif (!toLeft) {\r\n\t\t\tfor (i = pos; i < cnt; i++) {\r\n\t\t\t\tif (Z._parsedMask[i].isMask) {\r\n\t\t\t\t\treturn i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (i = pos; i >= 0; i--) {\r\n\t\t\t\tif (Z._parsedMask[i].isMask) {\r\n\t\t\t\t\treturn i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\tfor (i = pos; i >= 0; i--) {\r\n\t\t\t\tif (Z._parsedMask[i].isMask) {\r\n\t\t\t\t\treturn i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (i = pos; i < cnt; i++) {\r\n\t\t\t\tif (Z._parsedMask[i].isMask) {\r\n\t\t\t\t\treturn i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1;\r\n\t},\r\n\r\n\t_clearBuffer: function (begin, end) {\r\n\t\tif(!this._buffer) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!end) {\r\n\t\t\tend = this._buffer.length - 1;\r\n\t\t}\r\n\t\tfor (var i = begin; i <= end; i++) {\r\n\t\t\tthis._buffer[i] = this._format[i];\r\n\t\t}\r\n\t},\r\n\r\n\t_packEmpty: function (begin, end) {\r\n\t\tvar c, k = 0, Z = this, i;\r\n\t\tfor (i = begin; i >= 0; i--) {\r\n\t\t\tc = Z._format[i];\r\n\t\t\tif (Z._literalChars && Z._literalChars.indexOf(c) >= 0) {\r\n\t\t\t\tk = i;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tbegin = k;\r\n\t\tvar str = [];\r\n\t\tfor (i = begin; i < end; i++) {\r\n\t\t\tc = Z._buffer[i];\r\n\t\t\tif (c != Z._format[i]) {\r\n\t\t\t\tstr.push(c);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar len = str.length - 1;\r\n\r\n\t\tfor (i = end - 1; i >= begin; i--) {\r\n\t\t\tif (len >= 0) {\r\n\t\t\t\tZ._buffer[i] = str[len];\r\n\t\t\t\tlen--;\r\n\t\t\t} else {\r\n\t\t\t\tZ._buffer[i] = Z._format[i];\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t_updateBuffer: function (pos, ch) {\r\n\t\tvar begin = pos.begin, end = pos.end, Z = this;\r\n\r\n\t\tbegin = Z._getValidPos(begin);\r\n\t\tif (begin < 0) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tZ._clearBuffer(begin + 1, end);\r\n\t\tif (Z._literalChars && Z._literalChars.indexOf(ch) >= 0) {\r\n\t\t\tfor (var i = begin, cnt = Z._parsedMask.length; i < cnt; i++) {\r\n\t\t\t\tif (Z._parsedMask[i].ch == ch) {\r\n\t\t\t\t\tZ._packEmpty(begin, i);\r\n\t\t\t\t\treturn i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar maskObj = Z._parsedMask[begin];\r\n\t\t\tif (Z._validateChar(maskObj.ch, ch)) {\r\n\t\t\t\tZ._buffer[begin] = ch;\r\n\t\t\t\treturn begin;\r\n\t\t\t} else\t{\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t_moveCursor: function (begin, toLeft) {\r\n\t\tbegin = this._getValidPos(begin, toLeft);\r\n\t\tif (begin >= 0) {\r\n\t\t\tjslet.ui.textutil.setCursorPos(this._target, begin);\r\n\t\t}\r\n\t},\r\n\r\n\t_showValue: function () {\r\n\t\tthis._target.value = this._buffer.join('');\r\n\t},\r\n\r\n\t_doKeypress: function (chCode) {\r\n\t\tif (chCode == 13) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tvar ch = String.fromCharCode(chCode), Z = this;\r\n\t\tif (Z._transform == 'upper') {\r\n\t\t\tch = ch.toUpperCase();\r\n\t\t} else {\r\n\t\t\tif (Z._transform == 'lower') {\r\n\t\t\t\tch = ch.toLowerCase();\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar pos = jslet.ui.textutil.getCursorPos(Z._target);\r\n\t\tvar begin = Z._updateBuffer(pos, ch);\r\n\t\tZ._showValue();\r\n\t\tif (begin >= 0) {\r\n\t\t\tZ._moveCursor(begin + 1);\r\n\t\t} else {\r\n\t\t\tZ._moveCursor(pos.begin);\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t},\r\n\r\n\t_doKeydown: function (chCode) {\r\n\t\tvar Z = this,\r\n\t\t\tpos = jslet.ui.textutil.getCursorPos(Z._target),\r\n\t\t\tbegin = pos.begin,\r\n\t\t\tend = pos.end;\r\n\r\n\t\tif (chCode == 229) {//IME showing\r\n\t\t\tvar flag = (Z._parsedMask.legnth > begin);\r\n\t\t\tif (flag) {\r\n\t\t\t\tvar msk = Z._parsedMask[begin];\r\n\t\t\t\tflag = msk.isMask;\r\n\t\t\t\tif (flag) {\r\n\t\t\t\t\tvar c = msk.ch;\r\n\t\t\t\t\tflag = (c == 'c' || c == 'C');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!flag) {\r\n\t\t\t\twindow.setTimeout(function () {\r\n\t\t\t\t\tZ._showValue();\r\n\t\t\t\t\tZ._moveCursor(begin);\r\n\t\t\t\t}, 50);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (chCode == 13) //enter\r\n\t\t{\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tif (chCode == 8) //backspace\r\n\t\t{\r\n\t\t\tif (begin == end) {\r\n\t\t\t\tbegin = Z._getValidPos(--begin, true);\r\n\t\t\t\tend = begin;\r\n\t\t\t}\r\n\t\t\tZ._clearBuffer(begin, end);\r\n\t\t\tZ._showValue();\r\n\t\t\tZ._moveCursor(begin, true);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (chCode == 27) // Allow to send 'ESC' command\r\n\t\t{\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (chCode == 39) // Move Left\r\n\t\t{\r\n\t\t}\r\n\r\n\t\tif (chCode == 46) // delete the selected text\r\n\t\t{\r\n\t\t\tZ._clearBuffer(begin, end - 1);\r\n\t\t\tZ._showValue();\r\n\t\t\tZ._moveCursor(begin);\r\n\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\r\n\t_doBur: function () {\r\n\t\tvar mask, c, Z = this;\r\n\t\tfor (var i = 0, cnt = Z._parsedMask.length; i < cnt; i++) {\r\n\t\t\tmask = Z._parsedMask[i];\r\n\t\t\tif (!mask.isMask) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tc = mask.ch;\r\n\t\t\tif (Z.maskChars[c].required) {\r\n\t\t\t\tif (Z._buffer[i] == Z._format[i]) {\r\n\t\t\t\t\t//jslet.ui.textutil.setCursorPos(Z._target, i);\r\n\t\t\t\t\t//return false;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\r\n\t_doCut: function (clipboardData) {\r\n\t\tvar Z = this,\r\n\t\t\tdata = jslet.ui.textutil.getSelectedText(Z._target),\r\n\t\t\trange = jslet.ui.textutil.getCursorPos(Z._target),\r\n\t\t\tbegin = range.begin;\r\n\t\tZ._clearBuffer(begin, range.end - 1);\r\n\t\tZ._showValue();\r\n\t\tZ._moveCursor(begin, true);\r\n\t\tclipboardData.setData('Text', data);\r\n\t\treturn false;\r\n\t},\r\n\r\n\t_doPaste: function (clipboardData) {\r\n\t\tvar pasteValue = clipboardData.getData('Text');\r\n\t\tif (!pasteValue) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar pos = jslet.ui.textutil.getCursorPos(this._target), begin = 0, ch;\r\n\t\tpos.end = pos.begin;\r\n\t\tfor (var i = 0; i < pasteValue.length; i++) {\r\n\t\t\tch = pasteValue.charAt(i);\r\n\t\t\tbegin = this._updateBuffer(pos, ch);\r\n\t\t\tpos.begin = i;\r\n\t\t\tpos.end = pos.begin;\r\n\t\t}\r\n\t\tthis._showValue();\r\n\t\tif (begin >= 0) {\r\n\t\t\tthis._moveCursor(begin + 1);\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n};//edit mask\r\n\r\n/**\r\n * Util of \"Text\" control\r\n */\r\njslet.ui.textutil = {\r\n\t/**\r\n\t * Select text from an Input(Text) element \r\n\t * \r\n\t * @param {Html Text Element} txtEl The html text element   \r\n\t * @param {Integer} start Start position.\r\n\t * @param {Integer} end End position.\r\n\t */\r\n\tselectText: function(txtEl, start, end){\r\n\t\tvar v = txtEl.value;\r\n\t\tif (v.length > 0) {\r\n\t\t\tstart = start === undefined ? 0 : start;\r\n\t\t\tend = end === undefined ? v.length : end;\r\n \r\n\t\t\tif (txtEl.setSelectionRange) {\r\n\t\t\t\ttxtEl.setSelectionRange(start, end);\r\n\t\t\t} else if (txtEl.createTextRange) {\r\n\t\t\t\tvar range = txtEl.createTextRange();\r\n\t\t\t\trange.moveStart('character', start);\r\n\t\t\t\trange.moveEnd('character', end - v.length);\r\n\t\t\t\trange.select();\r\n\t\t\t}\r\n\t\t}\t\r\n\t},\r\n\t\r\n\t/**\r\n\t * Get selected text\r\n\t * \r\n\t * @param {Html Text Element} textEl Html Text Element\r\n\t * @return {String}  \r\n\t */\r\n\tgetSelectedText: function (txtEl) {\r\n\t\tif (txtEl.setSelectionRange) {\r\n\t\t\tvar begin = txtEl.selectionStart;\r\n\t\t\tvar end = txtEl.selectionEnd;\r\n\t\t\treturn txtEl.value.substring(begin, end);\r\n\t\t}\r\n\t\tif (document.selection && document.selection.createRange) {\r\n\t\t\treturn document.selection.createRange().text;\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Get cursor postion of html text element\r\n\t * \r\n\t * @param {Html Text Element} txtEl Html Text Element\r\n\t * @return {Integer}\r\n\t */\r\n\tgetCursorPos: function(txtEl){\r\n\t\tvar result = { begin: 0, end: 0 };\r\n\r\n\t\tif (txtEl.setSelectionRange) {\r\n\t\t\tresult.begin = txtEl.selectionStart;\r\n\t\t\tresult.end = txtEl.selectionEnd;\r\n\t\t}\r\n\t\telse if (document.selection && document.selection.createRange) {\r\n\t\t\tvar range = document.selection.createRange();\r\n\t\t\tresult.begin = 0 - range.duplicate().moveStart('character', -100000);\r\n\t\t\tresult.end = result.begin + range.text.length;\r\n\t\t}\r\n\t\treturn result;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Set cursor postion of html text element\r\n\t * \r\n\t * @param {Html Text Element} txtEl Html Text Element\r\n\t * @param {Integer} pos Cusor position\r\n\t */\r\n\tsetCursorPos: function(txtEl, pos){\r\n\t\tif (txtEl.setSelectionRange) {\r\n\t\t\ttxtEl.focus();\r\n\t\t\ttxtEl.setSelectionRange(pos, pos);\r\n\t\t}\r\n\t\telse if (txtEl.createTextRange) {\r\n\t\t\tvar range = txtEl.createTextRange();\r\n\t\t\trange.collapse(true);\r\n\t\t\trange.moveEnd('character', pos);\r\n\t\t\trange.moveStart('character', pos);\r\n\t\t\trange.select();\r\n\t\t}\t\r\n\t}\r\n};\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n\"use strict\";\r\nif(!jslet.ui) {\r\n\tjslet.ui = {};\r\n}\r\n/**\r\n * Control focus manager.\r\n * \r\n * @param containerId {String} container id, if containerid is not specified, container is document.\r\n */\r\njslet.ui.FocusManager = function() {\r\n\tthis._onChangingFocus = null;\r\n\tthis._focusKeyCode = null;\r\n\tthis._containerIds = null;\r\n\tthis._activeDataset = null;\r\n\tthis._activeField = null;\r\n\tthis._activeValueIndex = null;\r\n\t\r\n\tthis._initialize();\r\n};\r\n\r\njslet.ui.FocusManager.prototype = {\r\n\t/**\r\n\t * Get or set onChangingFocus event handler. \r\n\t * \r\n\t * @param onChangingFocus {Function} event handler, pattern:\r\n\t * function doChangingFocus(element, reserve, datasetObj, fieldName, focusingFieldList, valueIndex) {\r\n\t * \t\tconsole.log('Changind focus');\r\n\t * }\r\n\t * element - {HTML element} focusing html element;\r\n\t * reserve - {Boolean} if it's focusing prior element, reserve is true, otherwise false;\r\n\t * datasetObj - {jslet.data.Dataset} current dataset object. If the UI control is not jslet UI control, it's null;\r\n\t * fieldName - {String} current field name. If the UI control is not jslet UI field control, it's null;\r\n\t * focusingFieldList - {String[]} focusing field name list. You can use 'focusingFieldList' and 'fieldName' to check the position of field name.  \r\n\t * valueIndex - {Integer} identify the value index of BETWEEN-style or MULTIPLE-style field.\r\n\t * \r\n\t * focusManager.onChangingFocus(doChangingFocus);\r\n\t * \r\n\t */\r\n\tonChangingFocus: function(onChangingFocus) {\r\n\t\tif(onChangingFocus === undefined) {\r\n\t\t\treturn this._onChangingFocus;\r\n\t\t}\r\n\t\tjslet.Checker.test('FocusManager.onChangingFocus', onChangingFocus).isFunction();\r\n\t\tthis._onChangingFocus = onChangingFocus;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Get or set 'focusKeyCode'\r\n\t * \r\n\t * @param {Integer} focusKeyCode - Key code for changing focus.\r\n\t * \r\n\t */\r\n\tfocusKeyCode: function(focusKeyCode) {\r\n\t\tif(focusKeyCode === undefined) {\r\n\t\t\treturn this._focusKeyCode;\r\n\t\t}\r\n\t\tjslet.Checker.test('FocusManager.focusKeyCode', focusKeyCode).isNumber();\r\n\t\tthis._focusKeyCode = focusKeyCode;\r\n\t},\r\n\t\r\n\tpushContainer: function(containerId) {\r\n\t\tjslet.Checker.test('FocusManager.pushContainer#containerId', containerId).required().isString();\r\n\t\tif(this._containerIds === null) {\r\n\t\t\tthis._containerIds = [];\r\n\t\t}\r\n\t\tthis._containerIds.push(containerId);\r\n\t},\r\n\t\r\n\tpopContainer: function(containerId) {\r\n\t\tjslet.Checker.test('FocusManager.pushContainer#containerId', containerId).required().isString();\r\n\t\tif(this._containerIds[this._containerIds.length - 1] == containerId) {\r\n\t\t\tthis._containerIds.pop();\r\n\t\t}\r\n\t},\r\n\t\r\n\tactiveDataset: function(dsName) {\r\n\t\tif(dsName === undefined) {\r\n\t\t\treturn this._activeDataset;\r\n\t\t}\r\n\t\tjslet.Checker.test('FocusManager.activeDataset', dsName).isString();\r\n\t\tthis._activeDataset = dsName;\r\n\t\treturn this;\r\n\t},\r\n\t\r\n\tactiveField: function(fldName) {\r\n\t\tif(fldName === undefined) {\r\n\t\t\treturn this._activeField;\r\n\t\t}\r\n\t\tjslet.Checker.test('FocusManager.activeField', fldName).isString();\r\n\t\tthis._activeField = fldName;\r\n\t\treturn this;\r\n\t},\r\n\t\r\n\tactiveValueIndex: function(valueIndex) {\r\n\t\tif(valueIndex === undefined) {\r\n\t\t\treturn this._activeValueIndex;\r\n\t\t}\r\n\t\tjslet.Checker.test('FocusManager.activeValueIndex', valueIndex).isNumber();\r\n\t\tthis._activeValueIndex = valueIndex;\r\n\t\treturn this;\r\n\t},\r\n\t\r\n\ttabPrev: function() {\r\n\t\tjQuery.tabPrev(this._getContainer(), true, jQuery.proxy(this._doChangingFocus, this));\r\n\t},\r\n\t\r\n\ttabNext: function() {\r\n\t\tjQuery.tabNext(this._getContainer(), true, jQuery.proxy(this._doChangingFocus, this));\r\n\t},\r\n\t\r\n\t_getContainer: function() {\r\n\t\tvar Z = this,\r\n\t\t\tjqContainer;\r\n\t\tif(Z._containerIds && Z._containerIds.length > 0) {\r\n\t\t\tvar containerId = Z._containerIds[Z._containerIds.length - 1];\r\n\t\t\tjqContainer = jQuery('#' + containerId);\r\n\t\t\tif(jqContainer.length === 0) {\r\n\t\t\t\tthrow new Error('Not found container: ' + containerId);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tjqContainer = jQuery(document);\r\n\t\t}\r\n\t\treturn jqContainer;\r\n\t},\r\n\t\r\n\t_doChangingFocus: function(ele, reverse) {\r\n\t\tvar Z = this,\r\n\t\t\tdsObj = jslet.data.getDataset(Z._activeDataset),\r\n\t\t\tfocusedFlds = dsObj && dsObj.mergedFocusedFields();\r\n\t\tif(Z._onChangingFocus) {\r\n\t\t\tvar cancelFocus = Z._onChangingFocus(ele, reverse, dsObj, Z._activeField, focusedFlds, Z._activeValueIndex);\r\n\t\t\tif(!cancelFocus) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(!Z._activeDataset && !Z._activeField) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif(!dsObj || !dsObj.focusedFields()) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tvar idx = focusedFlds.indexOf(Z._activeField);\r\n\t\tif(idx < 0) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif(!reverse) {\r\n\t\t\tif(idx === focusedFlds.length - 1) {\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\tdsObj.focusEditControl(focusedFlds[idx + 1]);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif(idx === 0) {\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\tdsObj.focusEditControl(focusedFlds[idx - 1]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\t\r\n\t_initialize: function() {\r\n\t\tfunction isTabableElement(ele) {\r\n\t\t\tvar tagName = ele.tagName;\r\n\t\t\tif(tagName == 'TEXTAREA' || tagName == 'A' || tagName == 'BUTTON') {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif(tagName == 'INPUT') {\r\n\t\t\t\tvar typeAttr = ele.type;\r\n\t\t\t\tif(typeAttr == 'button' || typeAttr == 'image' || typeAttr == 'reset' || typeAttr == 'submit' || typeAttr == 'url' || typeAttr == 'file') {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\tvar Z = this;\r\n\t\t\r\n\t\tfunction handleHostKeyDown(event) {\r\n\t\t\tvar focusKeyCode = Z._focusKeyCode || jslet.global.defaultFocusKeyCode || 9;\r\n\t\t\tvar keyCode = event.which;\r\n\t\t\tif(keyCode === focusKeyCode || keyCode === 9) {\r\n\t\t\t\tif(keyCode !== 9 && !isTabableElement(event.target)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif(event.shiftKey){\r\n\t\t\t\t\tZ.tabPrev();\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tZ.tabNext();\r\n\t\t\t\t}\r\n\t\t\t\tevent.preventDefault();\r\n\t       \t\tevent.stopImmediatePropagation();\r\n\t       \t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tjQuery(document).keydown(handleHostKeyDown);\r\n\t}\r\n};\r\n\r\njslet.ui.focusManager = new jslet.ui.FocusManager();\r\n\r\n/*!\r\n * jQuery.tabbable 1.0 - Simple utility for selecting the next / previous ':tabbable' element.\r\n * https://github.com/marklagendijk/jQuery.tabbable\r\n *\r\n * Includes ':tabbable' and ':focusable' selectors from jQuery UI Core\r\n *\r\n * Copyright 2013, Mark Lagendijk\r\n * Released under the MIT license\r\n *\r\n */\r\n\r\n(function($){\r\n\t/**\r\n\t * Focusses the next :focusable element. Elements with tabindex=-1 are focusable, but not tabable.\r\n\t * Does not take into account that the taborder might be different as the :tabbable elements order\r\n\t * (which happens when using tabindexes which are greater than 0).\r\n\t */\r\n\t$.focusNext = function(container, isLoop, onChangingFocus){\r\n\t\tselectNextTabbableOrFocusable(':focusable', container, isLoop, onChangingFocus);\r\n\t};\r\n\r\n\t/**\r\n\t * Focusses the previous :focusable element. Elements with tabindex=-1 are focusable, but not tabable.\r\n\t * Does not take into account that the taborder might be different as the :tabbable elements order\r\n\t * (which happens when using tabindexes which are greater than 0).\r\n\t */\r\n\t$.focusPrev = function(container, isLoop, onChangingFocus){\r\n\t\treturn selectPrevTabbableOrFocusable(':focusable', container, isLoop, onChangingFocus);\r\n\t};\r\n\r\n\t/**\r\n\t * Focusses the next :tabable element.\r\n\t * Does not take into account that the taborder might be different as the :tabbable elements order\r\n\t * (which happens when using tabindexes which are greater than 0).\r\n\t */\r\n\t$.tabNext = function(container, isLoop, onChangingFocus){\r\n\t\treturn selectNextTabbableOrFocusable(':tabbable', container, isLoop, onChangingFocus);\r\n\t};\r\n\r\n\t/**\r\n\t * Focusses the previous :tabbable element\r\n\t * Does not take into account that the taborder might be different as the :tabbable elements order\r\n\t * (which happens when using tabindexes which are greater than 0).\r\n\t */\r\n\t$.tabPrev = function(container, isLoop, onChangingFocus){\r\n\t\treturn selectPrevTabbableOrFocusable(':tabbable', container, isLoop, onChangingFocus);\r\n\t};\r\n\r\n\tfunction selectNextTabbableOrFocusable(selector, container, isLoop, onChangingFocus){\r\n\t\tif(!container) {\r\n\t\t\tcontainer = document;\r\n\t\t}\r\n\t\tvar selectables = jQuery(container).find(selector);\r\n\t\tsortByTabIndex(selectables);\r\n\t\tvar current = $(':focus');\r\n\t\tvar nextIndex = 0;\r\n\t\tvar currEle = null;\r\n\t\tif(current.length === 1){\r\n\t\t\tcurrEle = current[0];\r\n\t\t\tvar currentIndex = selectables.index(current);\r\n\t\t\tif(currentIndex + 1 < selectables.length){\r\n\t\t\t\tnextIndex = currentIndex + 1;\r\n\t\t\t} else {\r\n\t\t\t\tif(isLoop) {\r\n\t\t\t\t\tnextIndex = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar canFocus = true;\r\n\t\tif(onChangingFocus && currEle) {\r\n\t\t\tcanFocus = onChangingFocus(currEle, false);\r\n\t\t}\r\n\t\tif(canFocus) {\r\n\t\t\tvar jqEl = selectables.eq(nextIndex);\r\n\t\t\tjqEl.focus();\r\n\t\t\treturn jqEl[0];\r\n\t\t} else {\r\n\t\t\treturn currEle;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction selectPrevTabbableOrFocusable(selector, container, isLoop, onChangingFocus){\r\n\t\tif(!container) {\r\n\t\t\tcontainer = document;\r\n\t\t}\r\n\t\tvar selectables = jQuery(container).find(selector);\r\n\t\tsortByTabIndex(selectables);\r\n\t\tvar current = $(':focus');\r\n\t\tvar prevIndex = selectables.length - 1;\r\n\t\tvar currEle = null;\r\n\t\tif(current.length === 1){\r\n\t\t\tcurrEle = current[0];\r\n\t\t\tvar currentIndex = selectables.index(current);\r\n\t\t\tif(currentIndex > 0){\r\n\t\t\t\tprevIndex = currentIndex - 1;\r\n\t\t\t} else {\r\n\t\t\t\tif(isLoop) {\r\n\t\t\t\t\tprevIndex = selectables.length - 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar canFocus = true;\r\n\t\tif(onChangingFocus && currEle) {\r\n\t\t\tcanFocus = onChangingFocus(currEle, true);\r\n\t\t}\r\n\t\tif(canFocus) {\r\n\t\t\tvar jqEl = selectables.eq(prevIndex);\r\n\t\t\tjqEl.focus();\r\n\t\t\treturn jqEl[0];\r\n\t\t} else {\r\n\t\t\treturn currEle;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction sortByTabIndex(items) {\r\n\t\tif(!items) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tvar item, item1, k;\r\n\t\tfor(var i = 1, len = items.length; i < len; i++) {\r\n\t\t\titem = items[i];\r\n\t\t\tk = 0;\r\n\t\t\tfor(var j = i - 1; j >= 0; j--) {\r\n\t\t\t\titem1 = items[j];\r\n\t\t\t\tif(item1.tabIndex <= item.tabIndex) {\r\n\t\t\t\t\tk = j + 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} //end for j\r\n\t\t\tif(i !== k) {\r\n\t\t\t\titems.splice(i, 1);\r\n\t\t\t\titems.splice(k, 0, item);\r\n\t\t\t}\r\n\t\t} //end for i\r\n\t}\r\n\t\r\n\t/**\r\n\t * :focusable and :tabbable, both taken from jQuery UI Core\r\n\t */\r\n\t$.extend($.expr[ ':' ], {\r\n\t\tdata: $.expr.createPseudo ?\r\n\t\t\t$.expr.createPseudo(function(dataName){\r\n\t\t\t\treturn function(elem){\r\n\t\t\t\t\treturn !!$.data(elem, dataName);\r\n\t\t\t\t};\r\n\t\t\t}) :\r\n\t\t\t// support: jQuery <1.8\r\n\t\t\tfunction(elem, i, match){\r\n\t\t\t\treturn !!$.data(elem, match[ 3 ]);\r\n\t\t\t},\r\n\r\n\t\tfocusable: function(element){\r\n\t\t\treturn focusable(element, !isNaN($.attr(element, 'tabindex')));\r\n\t\t},\r\n\r\n\t\ttabbable: function(element){\r\n\t\t\tvar tabIndex = $.attr(element, 'tabindex'),\r\n\t\t\t\tisTabIndexNaN = isNaN(tabIndex);\r\n\t\t\treturn ( isTabIndexNaN || tabIndex >= 0 ) && focusable(element, !isTabIndexNaN);\r\n\t\t}\r\n\t});\r\n\r\n\t/**\r\n\t * focussable function, taken from jQuery UI Core\r\n\t * @param element\r\n\t * @returns {*}\r\n\t */\r\n\tfunction focusable(element){\r\n\t\tvar map, mapName, img,\r\n\t\t\tnodeName = element.nodeName.toLowerCase(),\r\n\t\t\tisTabIndexNotNaN = !isNaN($.attr(element, 'tabindex'));\r\n\t\tif('area' === nodeName){\r\n\t\t\tmap = element.parentNode;\r\n\t\t\tmapName = map.name;\r\n\t\t\tif(!element.href || !mapName || map.nodeName.toLowerCase() !== 'map'){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\timg = $('img[usemap=#' + mapName + ']')[0];\r\n\t\t\treturn !!img && visible(img);\r\n\t\t}\r\n\t\treturn ( /input|select|textarea/.test(nodeName) ?\r\n\t\t\t!element.disabled :\r\n\t\t\t'a' === nodeName ?\r\n\t\t\t\telement.href || isTabIndexNotNaN :\r\n\t\t\t\tisTabIndexNotNaN) &&\r\n\t\t\t// the element and all of its ancestors must be visible\r\n\t\t\tvisible(element);\r\n\r\n\t\tfunction visible(element){\r\n\t\t\treturn $.expr.filters.visible(element) && !$(element).parents().addBack().filter(function(){\r\n\t\t\t\treturn $.css(this, 'visibility') === 'hidden';\r\n\t\t\t}).length;\r\n\t\t}\r\n\t}\r\n})(jQuery);\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n* Resize event bus, manage all resize event. Example:\r\n* <pre><code>\r\n*\tvar myCtrlObj = {\r\n*\t\tcheckSizeChanged: function(){\r\n*\t\t\t;\r\n*\t\t}\r\n*\t}\r\n*\t\r\n*\t//Subcribe a message from MessageBus\r\n*\tjslet.messageBus.subcribe(myCtrlObj);\r\n*   \r\n*\t//Unsubcribe a message from MessageBus\r\n*\tjslet.messageBus.unsubcribe(myCtrlObj);\r\n* \r\n*\t//Send a mesasge to MessageBus\r\n*\tjslet.messageBus.sendMessage('MyMessage', {x: 10, y:10});\r\n* \r\n* </code></pre>\r\n* \r\n*/\r\n\"use strict\";\r\njslet.ResizeEventBus = function () {\r\n\t\r\n\tvar handler = null;\r\n\t/**\r\n\t * Send a message.\r\n\t * \r\n\t * @param {Html Element} sender Sender which send resize event.\r\n\t */\r\n\tthis.resize = function (sender) {\r\n\t\tif (handler){\r\n\t\t\twindow.clearTimeout(handler);\r\n\t\t}\r\n\t\thandler = setTimeout(function(){\r\n\t\t\tvar ctrls, ctrl, jsletCtrl;\r\n\t\t\tif (sender) {\r\n\t\t\t\tctrls = jQuery(sender).find(\"*[data-jslet-resizable]\");\r\n\t\t\t} else {\r\n\t\t\t\tctrls = jQuery(\"*[data-jslet-resizable]\");\r\n\t\t\t}\r\n\t\t\tif(jslet.ui._activePopup) {\r\n\t\t\t\tjslet.ui._activePopup.hide();\r\n\t\t\t}\r\n\t\t\tfor(var i = 0, cnt = ctrls.length; i < cnt; i++){\r\n\t\t\t\tctrl = ctrls[i];\r\n\t\t\t\tif (ctrl){\r\n\t\t\t\t\tjsletCtrl = ctrl.jslet;\r\n\t\t\t\t\tif (jsletCtrl && jsletCtrl.checkSizeChanged){\r\n\t\t\t\t\t\tjsletCtrl.checkSizeChanged();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\thandler = null;\r\n\t\t}, 100);\r\n\t};\r\n\r\n\t/**\r\n\t * Subscribe a control to response a resize event.\r\n\t * \r\n\t * @param {Object} ctrlObj control object which need subscribe a message, \r\n\t *\tthere must be a function: checkSizeChanged in ctrlObj.\r\n\t *\tcheckSizeChanged: function(){}\r\n\t */\r\n\tthis.subscribe = function(ctrlObj){\r\n\t\tif (!ctrlObj || !ctrlObj.el) {\r\n\t\t\tthrow new Error(\"ctrlObj required!\");\r\n\t\t}\r\n\t\tjQuery(ctrlObj.el).attr(jslet.ResizeEventBus.RESIZABLE, true);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Unsubscribe a control to response a resize event.\r\n\t * \r\n\t * @param {Object} ctrlObj control object which need subscribe a message.\r\n\t */\r\n\tthis.unsubscribe = function(ctrlObj){\r\n\t\tif (!ctrlObj || !ctrlObj.el) {\r\n\t\t\tthrow new Error(\"ctrlObj required!\");\r\n\t\t}\r\n\t\tjQuery(ctrlObj.el).removeAttr(jslet.ResizeEventBus.RESIZABLE);\r\n\t};\r\n\t\r\n};\r\n\r\njslet.ResizeEventBus.RESIZABLE = \"data-jslet-resizable\";\r\n\r\njslet.resizeEventBus = new jslet.ResizeEventBus();\r\n\r\njQuery(window).on(\"resize\",function(){\r\n\tjslet.resizeEventBus.resize();\r\n});\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n\"use strict\";\r\nif(!jslet.ui) {\r\n\tjslet.ui = {};\r\n}\r\n\r\njslet.ui.htmlclass = {};\r\njslet.ui.GlobalZIndex = 100;\r\n\r\njslet.ui.KeyCode = {\r\n\tBACKSPACE: 8, \r\n\tTAB: 9,\r\n\tENTER: 13,\r\n\tSHIFT: 16,\r\n\tCONTROL: 17,\r\n\tALT: 18,\r\n\r\n\tCAPSLOCK: 20,\r\n\tESCAPE: 27,\r\n\tSPACE: 32,\r\n\tPAGEUP: 33,\r\n\tPAGEDOWN: 34,\r\n\tEND: 35,\r\n\tHOME: 36,\r\n\tLEFT: 37,\r\n\tUP: 38,\r\n\tRIGHT: 39,\r\n\tDOWN: 40,\r\n\t\r\n\tINSERT: 45,\r\n\tDELETE: 46,\r\n\r\n\tF1: 112,\r\n\tF2: 113,\r\n\tF3: 114,\r\n\tF4: 115,\r\n\tF5: 116,\r\n\tF6: 117,\r\n\tF7: 118,\r\n\tF8: 119,\r\n\tF9: 120,\r\n\tF10: 121,\r\n\tF11: 122,\r\n\tF12: 123,\r\n\r\n\tIME: 229\r\n};\r\n\r\nfor(var i = 65; i < 90; i++) {\r\n\tjslet.ui.KeyCode[String.fromCharCode(i)] = i;\r\n}\r\n\r\n/**\r\n* Popup Panel. Example: \r\n* <pre><code>\r\n* var popPnl = new jslet.ui.PopupPanel();\r\n* popPnl.setContent(document.getElementById('id'));\r\n* popPnl.show(10, 10, 100, 100);\r\n* \r\n* popPnl.hide(); //or\r\n* popPnl.destroy();\r\n* </code></pre>\r\n*  \r\n*/\r\njslet.ui.PopupPanel = function () {\r\n\t/**\r\n\t * Event handler when hide popup panel: function(){}\r\n\t */\r\n\tthis.onHidePopup = null;\r\n\r\n\tthis.isShowing = false;\r\n\t/**\r\n\t * Private document click handler\r\n\t */\r\n\tthis.documentClickHandler = function (event) {\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\tvar srcEle = event.target;\r\n\t\tif (jslet.ui.isChild(jslet.ui.PopupPanel.excludedElement,srcEle) ||\r\n\t\t\tjslet.ui.inPopupPanel(srcEle)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (jslet.ui._activePopup) {\r\n\t\t\tjslet.ui._activePopup.hide();\r\n\t\t}\r\n\t};\r\n\r\n\tthis._stopMouseEvent = function(event) {\r\n\t\tevent.stopImmediatePropagation();\r\n\t\tevent.preventDefault();\r\n\t};\r\n\t\r\n\t/**\r\n\t * Private, create popup panel\r\n\t */\r\n\tthis._createPanel = function () {\r\n\t\tif (!jslet.ui._popupPanel) {\r\n\t\t\tvar p = document.createElement('div');\r\n\t\t\tp.style.display = 'none';\r\n\t\t\tp.className = 'jl-popup-panel jl-opaque jl-border-box dropdown-menu';\r\n\t\t\tp.style.position = 'absolute';\r\n\t\t\tp.style.zIndex = 99000;\r\n\t\t\tdocument.body.appendChild(p);\r\n\t\t\t\r\n\t\t\tjQuery(document).on('click', this.documentClickHandler);\r\n//\t\t\tjQuery(p).on('click', this._stopMouseEvent);\r\n//\t\t\tjQuery(p).on('mousedown', this._stopMouseEvent);\r\n//\t\t\tjQuery(p).on('mouseup', this._stopMouseEvent);\r\n\t\t\tjslet.ui._popupPanel = p;\r\n\t\t}\r\n\t};\r\n\t\r\n\t/**\r\n\t * Show popup panel in specified position with specified size.\r\n\t * \r\n\t * @param {Integer} left Left position\r\n\t * @param {Integer} top Top position\r\n\t * @param {Integer} width Popup panel width\r\n\t * @param {Integer} height Popup panel height\r\n\t * \r\n\t */\r\n\tthis.show = function (left, top, width, height, ajustX, ajustY) {\r\n\t\tthis._createPanel();\r\n\t\tleft = parseInt(left);\r\n\t\ttop = parseInt(top);\r\n\t\t\r\n\t\tif (height) {\r\n\t\t\tjslet.ui._popupPanel.style.height = parseInt(height) + 'px';\r\n\t\t}\r\n\t\tif (width) {\r\n\t\t\tjslet.ui._popupPanel.style.width = parseInt(width) + 'px';\r\n\t\t}\r\n\t\tvar jqWin = jQuery(window),\r\n\t\t\twinWidth = jqWin.scrollLeft() + jqWin.width(),\r\n\t\t\twinHeight = jqWin.scrollTop() + jqWin.height(),\r\n\t\t\tpanel = jQuery(jslet.ui._popupPanel),\r\n\t\t\tw = panel.outerWidth(),\r\n\t\t\th = panel.outerHeight();\r\n\t\t/*\r\n\t\tif (left - obody.scrollLeft + w > obody.clientWidth) {\r\n\t\t\tleft -= w;\r\n\t\t}\r\n\t\tif (top - obody.scrollTop + h > obody.clientHeight) {\r\n\t\t\ttop -= (h + ajustY);\r\n\t\t}\r\n\t\t*/\r\n\t\tif (jslet.locale.isRtl) {\r\n\t\t\tleft -= w;\r\n\t\t}\r\n\t\tif(left + w > winWidth) {\r\n\t\t\tleft += winWidth - left - w - 1;\r\n\t\t}\r\n\t\tif(top + h > winHeight) {\r\n\t\t\ttop -= (h + 2 + ajustY);\r\n\t\t}\r\n\t\tif(left < 0) {\r\n\t\t\tleft = 1;\r\n\t\t}\r\n\t\tif(top < 0) {\r\n\t\t\ttop = 1;\r\n\t\t}\r\n\t\t\r\n\t\tif (top) {\r\n\t\t\tjslet.ui._popupPanel.style.top = top + 'px';\r\n\t\t}\r\n\t\tif (left) {\r\n\t\t\tjslet.ui._popupPanel.style.left = left + 'px';\r\n\t\t}\r\n\t\tjslet.ui._popupPanel.style.display = 'block';\r\n\r\n\t\tvar shadow = jslet.ui._popupShadow;\r\n\t\tif(shadow) {\r\n\t\t\tshadow.style.width = w + 'px';\r\n\t\t\tshadow.style.height = h + 'px';\r\n\t\t\tshadow.style.top = top + 2 + 'px';\r\n\t\t\tshadow.style.left = left + 2 + 'px';\r\n\t\t\tshadow.style.display = 'block';\r\n\t\t}\r\n\t\tjslet.ui._activePopup = this;\r\n\t\tthis.isShowing = true;\r\n\t};\r\n\r\n\t/**\r\n\t * Set popup panel content.\r\n\t * \r\n\t * @param {Html Element} content popup panel content\r\n\t * @param {String} content width;\r\n\t * @param {String} cotnent height;\r\n\t */\r\n\tthis.setContent = function (content, width, height) {\r\n\t\tthis._createPanel();\r\n\t\tvar oldContent = jslet.ui._popupPanel.childNodes[0];\r\n\t\tif (oldContent) {\r\n\t\t\tjslet.ui._popupPanel.removeChild(oldContent);\r\n\t\t}\r\n\t\tjslet.ui._popupPanel.appendChild(content);\r\n\t\tcontent.style.border = 'none';\r\n\t\tif(width) {\r\n\t\t\tcontent.style.width = width;\r\n\t\t}\r\n\t\tif(height) {\r\n\t\t\tcontent.style.height = height;\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * Get popup Panel. You can use this method to customize popup panel.\r\n\t * \r\n\t * @return {Html Element}\r\n\t * \r\n\t */\r\n\tthis.getPopupPanel = function () {\r\n\t\tthis._createPanel();\r\n\t\treturn jslet.ui._popupPanel;\r\n\t};\r\n\r\n\t/**\r\n\t * Destroy popup panel completely.\r\n\t */\r\n\tthis.destroy = function () {\r\n\t\tif (!jslet.ui._popupPanel) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.isShowing = false;\r\n\t\tdocument.body.removeChild(jslet.ui._popupPanel);\r\n\t\tif(jslet.ui._popupShadow) {\r\n\t\t\tdocument.body.removeChild(jslet.ui._popupShadow);\r\n\t\t}\r\n\t\tjQuery(this._popupPanel).off();\r\n\t\tjslet.ui._popupPanel = null;\r\n\t\tjslet.ui._popupShadow = null;\r\n\t\tthis.onHidePopup = null;\r\n\t\tjQuery(document).off('click', this.documentClickHandler);\r\n\t};\r\n\r\n\t/**\r\n\t * Hide popup panel, and you can show it again.\r\n\t * \r\n\t */\r\n\tthis.hide = function () {\r\n\t\tif (jslet.ui._popupPanel) {\r\n\t\t\tjslet.ui._popupPanel.style.display = 'none';\r\n\t\t\tif(jslet.ui._popupShadow) {\r\n\t\t\t\tjslet.ui._popupShadow.style.display = 'none';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.onHidePopup) {\r\n\t\t\tthis.onHidePopup();\r\n\t\t}\r\n\t\tthis.isShowing = false;\r\n\t\tdelete jslet.ui._activePopup;\r\n\t};\r\n};\r\n\r\n/**\r\n* Check if a html element is in an active popup or not\r\n* \r\n* @param {Html Element} htmlElement Checking html element\r\n* \r\n* @return {Boolean} True - In popup panel, False - Otherwise\r\n*/\r\njslet.ui.inPopupPanel = function (htmlElement) {\r\n\tif (!htmlElement || htmlElement == document) {\r\n\t\treturn false;\r\n\t}\r\n\tif (jQuery(htmlElement).hasClass('jl-popup-panel')) {\r\n\t\treturn true;\r\n\t} else {\r\n\t\treturn jslet.ui.inPopupPanel(htmlElement.parentNode);\r\n\t}\r\n};\r\n\r\n/**\r\n* Get the specified level parent element. Example:\r\n* <pre><code>\r\n*  //html snippet is: body -> div1 -> div2 ->table\r\n*  jslet.ui.getParentElement(div2); // return div1\r\n*  jslet.ui.getParentElement(div2, 2); //return body \r\n* </code></pre>\r\n* \r\n* @param {Html Element} htmlElement html element as start point\r\n* @param {Integer} level level\r\n* \r\n* @return {Html Element} Parent element, if not found, return null.\r\n*/\r\njslet.ui.getParentElement = function (htmlElement, level) {\r\n\tif (!level) {\r\n\t\tlevel = 1;\r\n\t}\r\n\tvar flag = htmlElement.parentElement ? true : false,\r\n\tresult = htmlElement;\r\n\tfor (var i = 0; i < level; i++) {\r\n\t\tif (flag) {\r\n\t\t\tresult = result.parentElement;\r\n\t\t} else {\r\n\t\t\tresult = result.parentNode;\r\n\t\t}\r\n\t\tif (!result) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\treturn result;\r\n};\r\n\r\n/**\r\n* Find first parent with specified condition. Example:\r\n* <pre><code>\r\n*   //Html snippet: body ->div1 ->div2 -> div3\r\n*\tvar odiv = jslet.ui.findFirstParent(\r\n*\t\todiv3, \r\n*\t\tfunction (node) {return node.class == 'head';},\r\n*\t\tfunction (node) {return node.tagName != 'BODY'}\r\n*   );\r\n* </code></pre>\r\n* \r\n* @param {Html Element} element The start checking html element\r\n* @param {Function} conditionFn Callback function: function(node}{...}, node is html element;\r\n*\t\t\tif conditionFn return true, break finding and return 'node'\r\n* @param {Function} stopConditionFn Callback function: function(node}{...}, node is html element;\r\n*\t\t\tif stopConditionFn return true, break finding and return null\r\n* \r\n* @return {Html Element} Parent element or null\r\n*/\r\njslet.ui.findFirstParent = function (htmlElement, conditionFn, stopConditionFn) {\r\n\tvar p = htmlElement;\r\n\tif (!p) {\r\n\t\treturn null;\r\n\t}\r\n\tif (!conditionFn) {\r\n\t\treturn p.parentNode;\r\n\t}\r\n\tif (conditionFn(p)) {\r\n\t\treturn p;\r\n\t} else {\r\n\t\tif (stopConditionFn && stopConditionFn(p.parentNode)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn jslet.ui.findFirstParent(p.parentNode, conditionFn, stopConditionFn);\r\n\t}\r\n};\r\n\r\n/**\r\n * Find parent element that has 'jslet' property\r\n * \r\n * @param {Html Element} element The start checking html element\r\n * @return {Html Element} Parent element or null\r\n */\r\njslet.ui.findJsletParent = function(element){\r\n\treturn jslet.ui.findFirstParent(element, function(ele){\r\n\t\treturn ele.jslet ? true:false; \r\n\t});\r\n};\r\n\r\n/**\r\n * Check one node is a child of another node or not.\r\n * \r\n * @param {Html Element} parentNode parent node;\r\n * @param {Html Element} testNode, testing node\r\n * @return {Boolean} true - 'testNode' is a child of 'parentNode', false - otherwise.\r\n */\r\njslet.ui.isChild = function(parentNode, testNode) {\r\n\tif(!parentNode || !testNode) {\r\n\t\treturn false;\r\n\t}\r\n\tvar p = testNode;\r\n\twhile(p) {\r\n\t\tif(p == parentNode) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tp = p.parentNode;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n/**\r\n* Text Measurer, measure the display width or height of the given text. Example:\r\n* <pre><code>\r\n*   jslet.ui.textMeasurer.setElement(document.body);\r\n*   try{\r\n\t\tvar width = jslet.ui.textMeasurer.getWidth('HellowWorld');\r\n\t\tvar height = jslet.ui.textMeasurer.getHeight('HellowWorld');\r\n\t}finally{\r\n\t\tjslet.ui.textMeasurer.setElement();\r\n\t}\r\n* </code></pre>\r\n* \r\n*/\r\njslet.ui.TextMeasurer = function () {\r\n\tvar rule,felement = document.body,felementWidth;\r\n\r\n\tvar lastText = null;\r\n\t\r\n\tvar createRule = function () {\r\n\t\tif (!rule) {\r\n\t\t\trule = document.createElement('div');\r\n\t\t\tdocument.body.appendChild(rule);\r\n\t\t\trule.style.position = 'absolute';\r\n\t\t\trule.style.left = '-9999px';\r\n\t\t\trule.style.top = '-9999px';\r\n\t\t\trule.style.display = 'none';\r\n\t\t\trule.style.margin = '0px';\r\n\t\t\trule.style.padding = '0px';\r\n\t\t\trule.style.overflow = 'hidden';\r\n\t\t}\r\n\t\tif (!felement) {\r\n\t\t\tfelement = document.body;\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * Set html element which to be used as rule. \r\n\t * \r\n\t * @param {Html Element} element \r\n\t */\r\n\tthis.setElement = function (element) {\r\n\t\tfelement = element;\r\n\t\tif (!felement) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tcreateRule();\r\n\t\trule.style.fontSize = felement.style.fontSize;\r\n\t\trule.style.fontStyle = felement.style.fontStyle;\r\n\t\trule.style.fontWeight = felement.style.fontWeight;\r\n\t\trule.style.fontFamily = felement.style.fontFamily;\r\n\t\trule.style.lineHeight = felement.style.lineHeight;\r\n\t\trule.style.textTransform = felement.style.textTransform;\r\n\t\trule.style.letterSpacing = felement.style.letterSpacing;\r\n\t};\r\n\r\n\tthis.setElementWidth = function (width) {\r\n\t\tfelementWidth = width;\r\n\t\tif (!felement) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (width) {\r\n\t\t\tfelement.style.width = width;\r\n\t\t} else {\r\n\t\t\tfelement.style.width = '';\r\n\t\t}\r\n\t};\r\n\r\n\tfunction updateText(text){\r\n\t\tif (lastText != text) {\r\n\t\t\trule.innerHTML = text;\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get the display size of specified text\r\n\t * \r\n\t * @param {String} text The text to be measured\r\n\t * \r\n\t * @return {Integer} Display size, unit: px\r\n\t */\r\n\tthis.getSize = function (text) {\r\n\t\tcreateRule();\r\n\t\tupdateText(text);\r\n\t\tvar ruleObj = jQuery(rule);\r\n\t\treturn {width:ruleObj.width(),height:ruleObj.height()};\r\n\t};\r\n\r\n\t/**\r\n\t * Get the display width of specified text\r\n\t * \r\n\t * @param {String} text The text to be measured\r\n\t * \r\n\t * @return {Integer} Display width, unit: px\r\n\t */\r\n\tthis.getWidth = function (text) {\r\n\t\treturn this.getSize(text).width;\r\n\t};\r\n\r\n\t/**\r\n\t * Get the display height of specified text\r\n\t * \r\n\t * @param {String} text The text to be measured\r\n\t * \r\n\t * @return {Integer} Display height, unit: px\r\n\t */\r\n\tthis.getHeight = function (text) {\r\n\t\treturn this.getSize(text).height;\r\n\t};\r\n};\r\n\r\njslet.ui.textMeasurer = new jslet.ui.TextMeasurer();\r\n\r\n/**\r\n * Get css property value. Example:\r\n * <pre><code>\r\n * var width = jslet.ui.getCssValue('fooClass', 'width'); //Return value like '100px' or '200em'\r\n * </code></pre>\r\n * \r\n * @param {String} className Css class name.\r\n * @param {String} styleName style name\r\n * \r\n * @return {String} Css property value.\r\n */\r\njslet.ui.getCssValue = function(className, styleName){\r\n\tvar odiv = document.createElement('div');\r\n\todiv.className = className;\r\n\todiv.style.display = 'none';\r\n\tdocument.body.appendChild(odiv);\r\n\tvar result = jQuery(odiv).css(styleName);\r\n\t\r\n\tdocument.body.removeChild(odiv);\r\n\treturn result;\r\n};\r\n\r\njslet.ui.setEditableStyle = function(formElement, disabled, readOnly, onlySetStyle, required) {\r\n\tif(!onlySetStyle) {\r\n\t\tformElement.disabled = disabled;\r\n\t\tformElement.readOnly = readOnly;\r\n\t}\r\n\tvar jqEl = jQuery(formElement);\r\n\tif(disabled || readOnly) {\r\n\t\tif (!jqEl.hasClass('jl-readonly')) {\r\n\t\t\tjqEl.addClass('jl-readonly');\r\n\t\t\tjqEl.removeClass('jl-ctrl-required');\r\n\t\t}\r\n\t} else {\r\n\t\tjqEl.removeClass('jl-readonly');\r\n\t\tif(required) {\r\n\t\t\tjqEl.addClass('jl-ctrl-required');\r\n\t\t}\r\n\t}\r\n};\r\n\r\n/**\r\n * Get system scroll bar width\r\n * \r\n * @return {Integer} scroll bar width\r\n */\r\njslet.scrollbarSize = function() {\r\n\tvar parent, child, width, height;\r\n\r\n\tif (width === undefined) {\r\n\t\tparent = jQuery('<div style=\"width:50px;height:50px;overflow:auto\"><div/></div>').appendTo('body');\r\n\t\tchild = parent.children();\r\n\t\twidth = child.innerWidth() - child.height(99).innerWidth();\r\n\t\tparent.remove();\r\n\t}\r\n\r\n\treturn width;\r\n};\r\n\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class Accordion. Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"Accordion\",selectedIndex:1,items:[{caption:\"Caption1\"},{caption:\"Caption2\"}]};\r\n * //1. Declaring:\r\n *\t&lt;div data-jslet='jsletParam' style=\"width: 300px; height: 400px;\">\r\n *     &lt;div>content1&lt;/div>\r\n *     &lt;div>content2&lt;/div>\r\n *    &lt;/div>\r\n *  \r\n *  //2. Binding\r\n *    &lt;div id='ctrlId'>\r\n *      &lt;div>content1&lt;/div>\r\n *      &lt;div>content2&lt;/div>\r\n *    &lt;/div>\r\n *    //Js snippet\r\n *    var el = document.getElementById('ctrlId');\r\n *    jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n *    jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.Accordion = jslet.Class.create(jslet.ui.Control, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.el = el;\r\n\t\tZ.allProperties = 'styleClass,selectedIndex,onChanged,items';\r\n\r\n\t\tZ._selectedIndex = 0;\r\n\t\t\r\n\t\tZ._onChanged = null;\r\n\t\t\r\n\t\t/**\r\n\t\t * Array of accordion items,like: [{caption: 'cap1'},{caption: 'cap2'}]\r\n\t\t */\r\n\t\tZ._items = null;\r\n\t\t\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * Selected index.\r\n\t * \r\n\t * @param {Integer or undefined} index selected index.\r\n\t * @return {this or Integer}\r\n\t */\r\n\tselectedIndex: function(index) {\r\n\t\tif(index === undefined) {\r\n\t\t\treturn this._selectedIndex;\r\n\t\t}\r\n\t\tjslet.Checker.test('Accordion.selectedIndex', index).isGTEZero();\r\n\t\tthis._selectedIndex = index;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Fired when user changes accordion panel.\r\n\t * Pattern: \r\n\t *\tfunction(index){}\r\n\t *\t//index: Integer\r\n\t *\r\n\t * @param {Function or undefined} onChanged Accordion panel changed event handler.\r\n\t * @return {this or Function}\r\n\t */\r\n\tonChanged: function(onChanged) {\r\n\t\tif(onChanged === undefined) {\r\n\t\t\treturn this._onChanged;\r\n\t\t}\r\n\t\tjslet.Checker.test('Accordion.onChanged', onChanged).isFunction();\r\n\t\tthis._onChanged = onChanged;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Accordion items.\r\n\t * Pattern:\r\n\t * [{caption:'item1'},...]\r\n\t * \r\n\t * @param {PlanObject[] or undefined} items\r\n\t * @return {this or PlanObject[]} \r\n\t */\r\n\titems: function(items) {\r\n\t\tif(items === undefined) {\r\n\t\t\treturn this._items;\r\n\t\t}\r\n\t\tjslet.Checker.test('Accordion.items', items).isArray();\r\n\t\tvar item;\r\n\t\tfor(var i = 0, len = items.length; i < len; i++) {\r\n\t\t\titem = items[i];\r\n\t\t\tjslet.Checker.test('Accordion.items.caption', item.caption).isString().required();\r\n\t\t}\r\n\t\tthis._items = items;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tthis.renderAll();\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tvar Z = this;\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tif (!jqEl.hasClass('jl-accordion')) {\r\n\t\t\tjqEl.addClass('jl-accordion jl-border-box jl-round5');\r\n\t\t}\r\n\t\tvar panels = jqEl.find('>div'), jqCaption, headHeight = 0, item;\r\n\r\n\t\tvar captionCnt = Z._items ? Z._items.length - 1: -1, caption;\r\n\t\tpanels.before(function(index) {\r\n\t\t\tif (index <= captionCnt) {\r\n\t\t\t\tcaption = Z._items[index].caption;\r\n\t\t\t} else {\r\n\t\t\t\tcaption = 'caption' + index;\r\n\t\t\t}\r\n\t\t\treturn '<button class=\"btn btn-default jl-accordion-head btn-sm\" jsletindex = \"' + index + '\">' + caption + '</button>';\r\n\t\t});\r\n\r\n\t\tvar jqCaptions = jqEl.find('>.jl-accordion-head');\r\n\t\tjqCaptions.click(Z._doCaptionClick);\r\n\t\t\r\n\t\theadHeight = jqCaptions.outerHeight() * panels.length;\r\n\t\tvar contentHeight = jqEl.innerHeight() - headHeight-1;\r\n\t\t\r\n\t\tpanels.wrap('<div class=\"jl-accordion-body\" style=\"height:'+contentHeight+'px;display:none\"></div>');\r\n        Z.setSelectedIndex(Z._selectedIndex, true);\r\n\t},\r\n\t\r\n\t_doCaptionClick: function(event){\r\n\t\tvar jqCaption = jQuery(event.currentTarget),\r\n\t\t\tZ = jslet.ui.findJsletParent(jqCaption[0]).jslet,\r\n\t\t\tk = parseInt(jqCaption.attr('jsletindex'));\r\n\t\tZ.setSelectedIndex(k);\r\n\t},\r\n\t\r\n\t/**\r\n\t * Set selected index\r\n\t * \r\n\t * @param {Integer} index Panel index, start at 0.\r\n\t */\r\n\tsetSelectedIndex: function(index, isRenderAll){\r\n\t\tif (!index) {\r\n\t\t\tindex = 0;\r\n\t\t}\r\n\t\tvar Z = this;\r\n\t\tvar jqBodies = jQuery(Z.el).find('>.jl-accordion-body');\r\n\t\tvar pnlCnt = jqBodies.length - 1;\r\n\t\tif (index > pnlCnt) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (Z._selectedIndex == index && index < pnlCnt){\r\n\t\t\tjQuery(jqBodies[index]).slideUp('fast');\r\n\t\t\tif(!isRenderAll || isRenderAll && index > 0) {\r\n\t\t\t\tindex++;\r\n\t\t\t}\r\n\t\t\tjQuery(jqBodies[index]).slideDown('fast');\r\n\t\t\tZ._selectedIndex = index;\r\n\t\t\tif (Z._onChanged){\r\n\t\t\t\tZ._onChanged.call(this, index);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (Z._selectedIndex >= 0 && Z._selectedIndex != index) {\r\n\t\t\tjQuery(jqBodies[Z._selectedIndex]).slideUp('fast');\r\n\t\t}\r\n\t\tjQuery(jqBodies[index]).slideDown('fast');\r\n\t\tZ._selectedIndex = index;\r\n\t\tif (Z._onChanged){\r\n\t\t\tZ._onChanged.call(this, index);\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tvar jqEl = jQuery(this.el);\r\n\t\tjqEl.find('>.jl-accordion-head').off();\r\n\t\t$super();\r\n\t}\r\n});\r\njslet.ui.register('Accordion', jslet.ui.Accordion);\r\njslet.ui.Accordion.htmlTemplate = '<div></div>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class Calendar. Example:\r\n * <pre><code>\r\n *  var jsletParam = {type:\"Calendar\"};\r\n *  //1. Declaring:\r\n *    &lt;div data-jslet='type:\"Calendar\"' />\r\n *\r\n *  //2. Binding\r\n *    &lt;div id='ctrlId' />\r\n *    //js snippet \r\n *    var el = document.getElementById('ctrlId');\r\n *    jslet.ui.bindControl(el, jsletParam);\r\n *\t\r\n *  //3. Create dynamically\r\n *    jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.Calendar = jslet.Class.create(jslet.ui.Control, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.el = el;\r\n\t\tZ.allProperties = 'styleClass,value,onDateSelected,minDate,maxDate';\r\n\r\n\t\tZ._value = null;\r\n\t\t\r\n\t\tZ._onDateSelected = null;\r\n\t\t\r\n\t\tZ._minDate = null;\r\n\r\n\t\tZ._maxDate = null;\r\n\t\t\r\n\t\tZ._currYear = 0;\r\n\t\tZ._currMonth = 0;\r\n\t\tZ._currDate = 0;\r\n\t\t\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * Calendar value.\r\n\t * \r\n\t * @param {Date or undefined} value calendar value.\r\n\t * @param {Date or undefined}\r\n\t */\r\n\tvalue: function(value) {\r\n\t\tif(value === undefined) {\r\n\t\t\treturn this._value;\r\n\t\t}\r\n\t\tjslet.Checker.test('Calendar.value', value).isDate();\r\n\t\tthis._value = value;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Set or get minimum date of calendar range.\r\n\t * \r\n\t * @param {Date or undefined} minDate minimum date of calendar range \r\n\t * @return {this or Date}\r\n\t */\r\n\tminDate: function(minDate) {\r\n\t\tif(minDate === undefined) {\r\n\t\t\treturn this._minDate;\r\n\t\t}\r\n\t\tjslet.Checker.test('Calendar.minDate', minDate).isDate();\r\n\t\tthis._minDate = minDate;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Set or get maximum date of calendar range.\r\n\t * \r\n\t * @param {Date or undefined} maxDate maximum date of calendar range \r\n\t * @return {this or Date}\r\n\t */\r\n\tmaxDate: function(maxDate) {\r\n\t\tif(maxDate === undefined) {\r\n\t\t\treturn this._maxDate;\r\n\t\t}\r\n\t\tjslet.Checker.test('Calendar.maxDate', maxDate).isDate();\r\n\t\tthis._maxDate = maxDate;\r\n\t},\r\n\t\t\r\n\t/**\r\n\t * Fired when user select a date.\r\n\t * Pattern: \r\n\t *\tfunction(value){}\r\n\t *\t//value: Date\r\n\t *\r\n\t * @param {Function or undefined} onDateSelected Date selected event handler.\r\n\t * @return {this or Function}\r\n\t */\r\n\tonDateSelected: function(onDateSelected) {\r\n\t\tif(onDateSelected === undefined) {\r\n\t\t\treturn this._onDateSelected;\r\n\t\t}\r\n\t\tjslet.Checker.test('Calendar.onDateSelected', onDateSelected).isFunction();\r\n\t\tthis._onDateSelected = onDateSelected;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tthis.renderAll();\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\tif (!jqEl.hasClass('jl-calendar')) {\r\n\t\t\tjqEl.addClass('jl-calendar panel panel-default');\r\n\t\t}\r\n\t\tvar template = ['<div class=\"jl-cal-header\">',\r\n\t\t\t'<a class=\"jl-cal-btn jl-cal-yprev\" title=\"', jslet.locale.Calendar.yearPrev,\r\n\t\t\t'\" href=\"javascript:;\">&lt;&lt;</a><a href=\"javascript:;\" class=\"jl-cal-btn jl-cal-mprev\" title=\"', jslet.locale.Calendar.monthPrev, '\">&lt;',\r\n\t\t\t'</a><a href=\"javascript:;\" class=\"jl-cal-title\"></a><a href=\"javascript:;\" class=\"jl-cal-btn jl-cal-mnext\" title=\"', jslet.locale.Calendar.monthNext, '\">&gt;',\r\n\t\t\t'</a><a href=\"javascript:;\" class=\"jl-cal-btn jl-cal-ynext\" title=\"', jslet.locale.Calendar.yearNext, '\">&gt;&gt;</a>',\r\n\t\t'</div>',\r\n\t\t'<div class=\"jl-cal-body\">',\r\n\t\t\t'<table cellpadding=\"0\" cellspacing=\"0\">',\r\n\t\t\t\t'<thead><tr><th class=\"jl-cal-weekend\">',\r\n\t\t\t\tjslet.locale.Calendar.Sun,\r\n\t\t\t\t\t'</th><th>',\r\n\t\t\t\t\tjslet.locale.Calendar.Mon,\r\n\t\t\t\t\t\t'</th><th>',\r\n\t\t\t\t\tjslet.locale.Calendar.Tue,\r\n\t\t\t\t\t\t'</th><th>',\r\n\t\t\t\t\tjslet.locale.Calendar.Wed,\r\n\t\t\t\t\t\t'</th><th>',\r\n\t\t\t\t\tjslet.locale.Calendar.Thu,\r\n\t\t\t\t\t\t'</th><th>',\r\n\t\t\t\t\tjslet.locale.Calendar.Fri,\r\n\t\t\t\t\t\t'</th><th class=\"jl-cal-weekend\">',\r\n\t\t\t\t\tjslet.locale.Calendar.Sat,\r\n\t\t\t\t\t\t'</th></tr></thead><tbody>',\r\n\t\t\t\t\t\t'<tr><td class=\"jl-cal-weekend\"><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td class=\"jl-cal-weekend\"><a href=\"javascript:;\"></a></td></tr>',\r\n\t\t\t\t\t\t'<tr><td class=\"jl-cal-weekend\"><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td class=\"jl-cal-weekend\"><a href=\"javascript:;\"></a></td></tr>',\r\n\t\t\t\t\t\t'<tr><td class=\"jl-cal-weekend\"><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td class=\"jl-cal-weekend\"><a href=\"javascript:;\"></a></td></tr>',\r\n\t\t\t\t\t\t'<tr><td class=\"jl-cal-weekend\"><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\" class=\"jl-cal-disable\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td class=\"jl-cal-weekend\"><a href=\"javascript:;\"></a></td></tr>',\r\n\t\t\t\t\t\t'<tr><td class=\"jl-cal-weekend\"><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\" class=\"jl-cal-disable\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td class=\"jl-cal-weekend\"><a href=\"javascript:;\"></a></td></tr>',\r\n\t\t\t\t\t\t'<tr><td class=\"jl-cal-weekend\"><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td><a href=\"javascript:;\"></a></td><td class=\"jl-cal-weekend\"><a href=\"javascript:;\"></a></td></tr>',\r\n\t\t\t\t\t\t'</tbody></table></div><div class=\"jl-cal-footer\"><a class=\"jl-cal-today\" href=\"javascript:;\">', jslet.locale.Calendar.today, '</a></div>'];\r\n\r\n\t\tjqEl.html(template.join(''));\r\n\t\tvar jqTable = jqEl.find('.jl-cal-body table');\r\n\t\tZ._currYear = -1;\r\n\t\tjqTable.on('click', Z._doTableClick);\r\n\t\t\r\n\t\tvar dvalue = Z._value && jslet.isDate(Z._value) ? Z._value : new Date();\r\n\t\tthis.setValue(dvalue);\r\n\t\tjqEl.find('.jl-cal-today').click(function (event) {\r\n\t\t\tvar d = new Date();\r\n\t\t\tZ.setValue(new Date(d.getFullYear(), d.getMonth(), d.getDate()));\r\n\t\t\tZ._fireSelectedEvent();\r\n\t\t});\r\n\t\t\r\n\t\tjqEl.find('.jl-cal-yprev').click(function (event) {\r\n\t\t\tZ.incYear(-1);\r\n\t\t});\r\n\t\t\r\n\t\tjqEl.find('.jl-cal-mprev').click(function (event) {\r\n\t\t\tZ.incMonth(-1);\r\n\t\t});\r\n\t\t\r\n\t\tjqEl.find('.jl-cal-ynext').click(function (event) {\r\n\t\t\tZ.incYear(1);\r\n\t\t});\r\n\t\t\r\n\t\tjqEl.find('.jl-cal-mnext').click(function (event) {\r\n\t\t\tZ.incMonth(1);\r\n\t\t});\r\n\t\t\r\n\t\tjqEl.on('keydown', function(event){\r\n\t\t\tvar ctrlKey = event.ctrlKey,\r\n\t\t\t\tkeyCode = event.keyCode;\r\n\t\t\tvar delta = 0;\r\n\t\t\tif(keyCode == jslet.ui.KeyCode.UP) {\r\n\t\t\t\tif(ctrlKey) {\r\n\t\t\t\t\tZ.incYear(-1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tZ.incDate(-7);\r\n\t\t\t\t}\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\treturn;\r\n\t\t\t} \r\n\t\t\tif(keyCode == jslet.ui.KeyCode.DOWN) {\r\n\t\t\t\tif(ctrlKey) {\r\n\t\t\t\t\tZ.incYear(1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tZ.incDate(7);\r\n\t\t\t\t}\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif(keyCode == jslet.ui.KeyCode.LEFT) {\r\n\t\t\t\tif(ctrlKey) {\r\n\t\t\t\t\tZ.incMonth(-1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tZ.incDate(-1);\r\n\t\t\t\t}\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif(keyCode == jslet.ui.KeyCode.RIGHT) {\r\n\t\t\t\tif(ctrlKey) {\r\n\t\t\t\t\tZ.incMonth(1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tZ.incDate(1);\r\n\t\t\t\t}\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\t\r\n\t_getNotNullDate: function() {\r\n\t\tvar value =this._value;\r\n\t\tif(!value) {\r\n\t\t\tvalue = new Date();\r\n\t\t}\r\n\t\treturn value;\r\n\t},\r\n\t\r\n\tincDate: function(deltaDay) {\r\n\t\tvar value = this._getNotNullDate();\r\n\t\tvalue.setDate(value.getDate() + deltaDay);\r\n\t\tthis.setValue(value);\r\n\t},\r\n\t\r\n\tincMonth: function(deltaMonth) {\r\n\t\tvar value = this._getNotNullDate(),\r\n\t\t\toldDate = value.getDate();\r\n\t\tvalue.setMonth(value.getMonth() + deltaMonth);\r\n\t\tif(oldDate >=29) {\r\n\t\t\tvar newDate = value.getDate();\r\n\t\t\tif(oldDate != newDate) {\r\n\t\t\t\tvalue = new Date(value.getFullYear(), value.getMonth(), 1) - 24*3600*1000;\r\n\t\t\t\tvalue = new Date(value);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.setValue(value);\r\n\t},\r\n\t\r\n\tincYear: function(deltaYear) {\r\n\t\tvar value = this._getNotNullDate(),\r\n\t\t\toldDate = value.getDate();\r\n\t\tvalue.setFullYear(value.getFullYear() + deltaYear);\r\n\t\tif(oldDate >=29) {\r\n\t\t\tvar newDate = value.getDate();\r\n\t\t\tif(oldDate != newDate) {\r\n\t\t\t\tvalue = new Date(value.getFullYear(), value.getMonth(), 1) - 24*3600*1000;\r\n\t\t\t\tvalue = new Date(value);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.setValue(value);\r\n\t},\r\n\t\r\n\t_innerSetValue: function(value) {\r\n\t\tvar Z = this,\r\n\t\t\toldValue = Z._getNotNullDate();\r\n\t\tif(value) { //Overwrite Year/Month/Date part, keep time part.\r\n\t\t\toldValue.setFullYear(value.getFullYear(), value.getMonth(), value.getDate());\r\n\t\t}\r\n\t\tZ._value = oldValue;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Set date value of calendar.\r\n\t * \r\n\t * @param {Date} value Calendar date\r\n\t */\r\n\tsetValue: function (value) {\r\n\t\tif (!value) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar Z = this;\r\n\t\tif (Z._minDate && value < Z._minDate) {\r\n\t\t\tvalue = new Date(Z._minDate.getTime());\r\n\t\t}\r\n\t\tif (Z._maxDate && value > Z._maxDate) {\r\n\t\t\tvalue = new Date(Z._maxDate.getTime());\r\n\t\t}\r\n\t\tZ._innerSetValue(value);\r\n\t\tvar y = value.getFullYear(), \r\n\t\t\tm = value.getMonth();\r\n\t\tif (Z._currYear == y && Z._currMonth == m) {\r\n\t\t\tZ._setCurrDateCls();\r\n\t\t} else {\r\n\t\t\tZ._refreshDateCell(y, m);\r\n\t\t}\r\n\t},\r\n\r\n\tfocus: function() {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\tjqEl.find('.jl-cal-current')[0].focus();\r\n\r\n\t},\r\n\t\r\n\t_checkNaviState: function () {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el), flag, btnToday;\r\n\t\tif (Z._minDate) {\r\n\t\t\tvar minY = Z._minDate.getFullYear(),\r\n\t\t\t\tminM = Z._minDate.getMonth(),\r\n\t\t\t\tbtnYearPrev = jqEl.find('.jl-cal-yprev')[0];\r\n\t\t\tflag = (Z._currYear <= minY);\r\n\t\t\tbtnYearPrev.style.visibility = (flag ? 'hidden' : 'visible');\r\n\r\n\t\t\tflag = (Z._currYear == minY && Z._currMonth <= minM);\r\n\t\t\tvar btnMonthPrev = jqEl.find('.jl-cal-mprev')[0];\r\n\t\t\tbtnMonthPrev.style.visibility = (flag ? 'hidden' : 'visible');\r\n\r\n\t\t\tflag = (Z._minDate > new Date());\r\n\t\t\tbtnToday = jqEl.find('.jl-cal-today')[0];\r\n\t\t\tbtnToday.style.visibility = (flag ? 'hidden' : 'visible');\r\n\t\t}\r\n\r\n\t\tif (Z._maxDate) {\r\n\t\t\tvar maxY = Z._maxDate.getFullYear(),\r\n\t\t\t\tmaxM = Z._maxDate.getMonth(),\r\n\t\t\t\tbtnYearNext = jqEl.find('.jl-cal-ynext')[0];\r\n\t\t\tflag = (Z._currYear >= maxY);\r\n\t\t\tbtnYearNext.jslet_disabled = flag;\r\n\t\t\tbtnYearNext.style.visibility = (flag ? 'hidden' : 'visible');\r\n\r\n\t\t\tflag = (Z._currYear == maxY && Z._currMonth >= maxM);\r\n\t\t\tvar btnMonthNext = jqEl.find('.jl-cal-mnext')[0];\r\n\t\t\tbtnMonthNext.jslet_disabled = flag;\r\n\t\t\tbtnMonthNext.style.visibility = (flag ? 'hidden' : 'visible');\r\n\r\n\t\t\tflag = (Z._maxDate < new Date());\r\n\t\t\tbtnToday = jqEl.find('.jl-cal-today')[0];\r\n\t\t\tbtnToday.style.visibility = (flag ? 'hidden' : 'visible');\r\n\t\t}\r\n\t},\r\n\r\n\t_refreshDateCell: function (year, month) {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\tmonthnames = jslet.locale.Calendar.monthNames,\r\n\t\t\tmname = monthnames[month],\r\n\t\t\totitle = jqEl.find('.jl-cal-title')[0];\r\n\t\totitle.innerHTML = mname + ',' + year;\r\n\t\tvar otable = jqEl.find('.jl-cal-body table')[0],\r\n\t\t\trows = otable.tBodies[0].rows,\r\n\t\t\tfirstDay = new Date(year, month, 1),\r\n\t\t\tw1 = firstDay.getDay(),\r\n\t\t\toneDayMs = 86400000, //24 * 60 * 60 * 1000\r\n\t\t\tdate = new Date(firstDay.getTime() - (w1 + 1) * oneDayMs);\r\n\t\tdate = new Date(date.getFullYear(), date.getMonth(), date.getDate());\r\n\r\n\t\tvar rowCnt = rows.length, otr, otd, m, oa;\r\n\t\tfor (var i = 1; i <= rowCnt; i++) {\r\n\t\t\totr = rows[i - 1];\r\n\t\t\tfor (var j = 1, tdCnt = otr.cells.length; j <= tdCnt; j++) {\r\n\t\t\t\totd = otr.cells[j - 1];\r\n\t\t\t\tdate = new Date(date.getTime() + oneDayMs);\r\n\t\t\t\toa = otd.firstChild;\r\n\t\t\t\tif (Z._minDate && date < Z._minDate || Z._maxDate && date > Z._maxDate) {\r\n\t\t\t\t\toa.innerHTML = '';\r\n\t\t\t\t\totd.jslet_date_value = null;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t} else {\r\n\t\t\t\t\toa.innerHTML = date.getDate();\r\n\t\t\t\t\totd.jslet_date_value = date;\r\n\t\t\t\t}\r\n\t\t\t\tm = date.getMonth();\r\n\t\t\t\tif (m != month) {\r\n\t\t\t\t\tjQuery(otd).addClass('jl-cal-disable');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tjQuery(otd).removeClass('jl-cal-disable');\r\n\t\t\t\t}\r\n\t\t\t} //end for j\r\n\t\t} //end for i\r\n\t\tZ._currYear = year;\r\n\t\tZ._currMonth = month;\r\n\t\tZ._setCurrDateCls();\r\n\t\tZ._checkNaviState();\r\n\t},\r\n\t\r\n\t_fireSelectedEvent: function() {\r\n\t\tvar Z = this;\r\n\t\tif (Z._onDateSelected) {\r\n\t\t\tZ._onDateSelected.call(Z, Z._value);\r\n\t\t}\r\n\t},\r\n\t\r\n\t_doTableClick: function (event) {\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\tvar node = event.target,\r\n\t\t\totd = node.parentNode;\r\n\t\t\r\n\t\tif (otd && otd.tagName && otd.tagName.toLowerCase() == 'td') {\r\n\t\t\tif (!otd.jslet_date_value) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar el = jslet.ui.findFirstParent(otd, function (node) { return node.jslet; });\r\n\t\t\tvar Z = el.jslet;\r\n\t\t\tZ._innerSetValue(otd.jslet_date_value);\r\n\t\t\tZ._setCurrDateCls();\r\n\t\t\ttry{\r\n\t\t\t\totd.firstChild.focus();\r\n\t\t\t}catch(e){\r\n\t\t\t}\r\n\t\t\tZ._fireSelectedEvent();\r\n\t\t}\r\n\t},\r\n\r\n\t_setCurrDateCls: function () {\r\n\t\tvar Z = this;\r\n\t\tif (!jslet.isDate(Z._value)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar currM = Z._value.getMonth(),\r\n\t\t\tcurrY = Z._value.getFullYear(),\r\n\t\t\tcurrD = Z._value.getDate(),\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\totable = jqEl.find('.jl-cal-body table')[0],\r\n\t\t\trows = otable.tBodies[0].rows,\r\n\t\t\trowCnt = rows.length, otr, otd, m, d, y, date, jqLink;\r\n\t\tfor (var i = 0; i < rowCnt; i++) {\r\n\t\t\totr = rows[i];\r\n\t\t\tfor (var j = 0, tdCnt = otr.cells.length; j < tdCnt; j++) {\r\n\t\t\t\totd = otr.cells[j];\r\n\t\t\t\tdate = otd.jslet_date_value;\r\n\t\t\t\tif (!date) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tm = date.getMonth();\r\n\t\t\t\ty = date.getFullYear();\r\n\t\t\t\td = date.getDate();\r\n\t\t\t\tjqLink = jQuery(otd.firstChild);\r\n\t\t\t\tif (y == currY && m == currM && d == currD) {\r\n\t\t\t\t\tif (!jqLink.hasClass('jl-cal-current')) {\r\n\t\t\t\t\t\tjqLink.addClass('jl-cal-current');\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\t\totd.firstChild.focus();\r\n\t\t\t\t\t} catch(e){\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tjqLink.removeClass('jl-cal-current');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tvar jqEl = jQuery(this.el);\r\n\t\tjqEl.off();\r\n\t\tjqEl.find('.jl-cal-body table').off();\r\n\t\tjqEl.find('.jl-cal-today').off();\r\n\t\tjqEl.find('.jl-cal-yprev').off();\r\n\t\tjqEl.find('.jl-cal-mprev').off();\r\n\t\tjqEl.find('.jl-cal-mnext').off();\r\n\t\tjqEl.find('.jl-cal-ynext').off();\r\n\t\t$super();\r\n\t}\r\n});\r\njslet.ui.register('Calendar', jslet.ui.Calendar);\r\njslet.ui.Calendar.htmlTemplate = '<div></div>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class FieldSet. Example:\r\n * <pre><code>\r\n *   //1. Declaring:\r\n *      &lt;div data-jslet='type:\"FieldSet\"' />\r\n *\r\n *  //2. Binding\r\n *      &lt;div id='ctrlId' />\r\n *      //Js snippet\r\n *      var jsletParam = {type:\"FieldSet\"};\r\n *      var el = document.getElementById('ctrlId');\r\n *      jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n *      var jsletParam = {type:\"FieldSet\"};\r\n *      jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.FieldSet = jslet.Class.create(jslet.ui.Control, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.el = el;\r\n\t\tZ.allProperties = 'styleClass,caption,collapsed';\r\n\r\n\t\tZ._caption = null; \r\n\t\t\r\n\t\tZ._collapsed = false;\r\n\t\t\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * Set or get caption of fieldset.\r\n\t * \r\n\t * @param {String or undefined} caption caption of fieldset. \r\n\t * @return {this or String}\r\n\t */\r\n\tcaption: function(caption) {\r\n\t\tif(caption === undefined) {\r\n\t\t\treturn this._caption;\r\n\t\t}\r\n\t\tjslet.Checker.test('FieldSet.caption', caption).isString();\r\n\t\tthis._caption = caption;\r\n\t},\r\n\r\n\t/**\r\n\t * Identify fieldset is collapsed or not.\r\n\t * \r\n\t * @param {Boolean or undefined} collapsed true - fieldset is collapsed, false(default) - otherwise. \r\n\t * @return {this or Boolean}\r\n\t */\r\n\tcollapsed: function(collapsed) {\r\n\t\tif(collapsed === undefined) {\r\n\t\t\treturn this._collapsed;\r\n\t\t}\r\n\t\tthis._collapsed = collapsed ? true: false;\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tthis.renderAll();\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tvar Z = this, jqEl = jQuery(Z.el);\r\n\t\tif (!jqEl.hasClass('jl-fieldset')) {\r\n\t\t\tjqEl.addClass('jl-fieldset jl-round5');\r\n\t\t}\r\n\t\t\r\n\t\tvar tmpl = ['<legend class=\"jl-fieldset-legend\">'];\r\n\t\ttmpl.push('<span class=\"jl-fieldset-title\"><i class=\"fa fa-chevron-circle-up jl-fieldset-btn\">');\r\n\t\ttmpl.push('<span>');\r\n\t\ttmpl.push(Z._caption);\r\n\t\ttmpl.push('</span></span></legend><div class=\"jl-fieldset-body\"></div>');\r\n\t\t\r\n\t\tvar nodes = Z.el.childNodes, \r\n\t\t\tchildren = [],\r\n\t\t\ti, cnt;\r\n\t\tcnt = nodes.length;\r\n\t\tfor(i = 0; i < cnt; i++){\r\n\t\t\tchildren.push(nodes[i]);\r\n\t\t}\r\n\r\n\t\tjqEl.html(tmpl.join(''));\r\n\t\tvar obody = jQuery(Z.el).find('.jl-fieldset-body')[0];\r\n\t\tcnt = children.length;\r\n\t\tfor(i = 0; i < cnt; i++){\r\n\t\t\tobody.appendChild(children[i]);\r\n\t\t}\r\n\t\t\r\n\t\tjqEl.find('.jl-fieldset-btn').click(jQuery.proxy(Z._doExpandBtnClick, this));\r\n\t},\r\n\t\r\n\t_doExpandBtnClick: function(){\r\n\t\tvar Z = this, jqEl = jQuery(Z.el);\r\n\t\tvar fsBody = jqEl.find('.jl-fieldset-body');\r\n\t\tif (!Z._collapsed){\r\n\t\t\tfsBody.slideUp();\r\n\t\t\tjqEl.addClass('jl-fieldset-collapse');\r\n\t\t\tjqEl.find('.jl-fieldset-btn').addClass('fa-chevron-circle-down');\r\n\t\t}else{\r\n\t\t\tfsBody.slideDown();\r\n\t\t\tjqEl.removeClass('jl-fieldset-collapse');\r\n\t\t\tjqEl.find('.jl-fieldset-btn').removeClass('fa-chevron-circle-down');\r\n\t\t}\r\n\t\tfsBody[0].focus();\r\n\t\tZ._collapsed = !Z._collapsed;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tvar jqEl = jQuery(this.el);\r\n\t\tjqEl.find('input.jl-fieldset-btn').off();\r\n\t\t$super();\r\n\t}\r\n});\r\n\r\njslet.ui.register('FieldSet', jslet.ui.FieldSet);\r\njslet.ui.FieldSet.htmlTemplate = '<fieldset></fieldset>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n* Menu Manager\r\n*/\r\n\"use strict\";\r\njslet.ui.menuManager = {};\r\n/**\r\n * Global menu id collection, array of string\r\n */\r\njslet.ui.menuManager._menus = [];\r\n\r\n/**\r\n * Register menu id\r\n * \r\n * @param {String} menuid Menu control id\r\n */\r\njslet.ui.menuManager.register = function (menuid) {\r\n\tjslet.ui.menuManager._menus.push(menuid);\r\n};\r\n\r\n/**\r\n * Unregister menu id\r\n * \r\n * @param {String} menuid Menu control id\r\n */\r\njslet.ui.menuManager.unregister = function (menuid) {\r\n\tfor (var i = 0, len = this._menus.length; i < len; i++) {\r\n\t\tjslet.ui.menuManager._menus.splice(i, 1);\r\n\t}\r\n};\r\n\r\n/**\r\n * Hide all menu item.\r\n */\r\njslet.ui.menuManager.hideAll = function (event) {\r\n\tvar id, menu, menus = jslet.ui.menuManager._menus;\r\n\tfor (var i = 0, len = menus.length; i < len; i++) {\r\n\t\tid = menus[i];\r\n\t\tmenu = jslet('#'+id);\r\n\t\tif (menu) {\r\n\t\t\tmenu.hide();\r\n\t\t}\r\n\t}\r\n\tjslet.ui.menuManager.menuBarShown = false;\r\n\tjslet.ui.menuManager._contextObject = null;\r\n};\r\n\r\njQuery(document).on('mousedown', jslet.ui.menuManager.hideAll);\r\n\r\n/**\r\n * @class Calendar. Example:\r\n * <pre><code>\r\n *  var jsletParam = { type: 'MenuBar', onItemClick: globalMenuItemClick, items: [\r\n *\t\t{ name: 'File', items: [\r\n *         { id: 'new', name: 'New Tab', iconClass: 'icon1' }]\r\n *      }]};\r\n *\r\n *  //1. Declaring:\r\n *    &lt;div data-jslet='jsletParam' />\r\n *\r\n *  //2. Binding\r\n *    &lt;div id='ctrlId' />\r\n *    //js snippet:\r\n *    var el = document.getElementById('ctrlId');\r\n *    jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n *    jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\njslet.ui.MenuBar = jslet.Class.create(jslet.ui.Control, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.el = el;\r\n\t\tZ.allProperties = 'styleClass,onItemClick,items';\r\n\r\n\t\tZ._onItemClick = null;\r\n\t\t\r\n\t\tZ._items = null;\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * Get or set menuItem click event handler\r\n\t * Pattern: \r\n\t * function(menuId){}\r\n\t *   //menuId: String\r\n\t * \r\n\t * @param {Function or undefined} onItemClick menuItem click event handler\r\n\t * @param {this or Function}\r\n\t */\r\n\tonItemClick: function(onItemClick) {\r\n\t\tif(onItemClick === undefined) {\r\n\t\t\treturn this._onItemClick;\r\n\t\t}\r\n\t\tjslet.Checker.test('MenuBar.onItemClick', onItemClick).isFunction();\r\n\t\tthis._onItemClick = onItemClick;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Get or set menu items configuration.\r\n\t * \r\n\t * menu item's properties: \r\n\t * id, //{String} Menu id\r\n\t * name, //{String} Menu name \r\n\t * onClick, //{Event} Item click event, \r\n\t *   Pattern: function(event){}\r\n\t *   \r\n\t * disabled, //{Boolean} Menu item is disabled or not\r\n\t * iconClass,  //{String} Icon style class \r\n\t * disabledIconClass, //{String} Icon disabled style class\r\n\t * itemType, //{String} Menu item type, optional value: null, radio, check\r\n\t * checked, //{Boolean} Menu item is checked or not,  only work when itemType equals 'radio' or 'check'\r\n\t * group, //{String} Group name, only work when itemType equals 'radio'\r\n\t * items, //{Array} Sub menu items\r\n\t * \r\n\t * @param {PlanObject[] or undefined} items menu items.\r\n\t * @param {this or PlanObject[]}\r\n\t */\r\n\titems: function(items) {\r\n\t\tif(items === undefined) {\r\n\t\t\treturn this._items;\r\n\t\t}\r\n\t\tjslet.Checker.test('MenuBar.items', items).isArray();\r\n\t\tvar item;\r\n\t\tfor(var i = 0, len = items.length; i < len; i++) {\r\n\t\t\titem = items[i];\r\n\t\t\tjslet.Checker.test('MenuBar.items.name', item.name).isString().required();\r\n\t\t}\r\n\t\tthis._items = items;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tthis.renderAll();\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tvar Z = this;\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tif (!jqEl.hasClass('jl-menubar')) {\r\n\t\t\tjqEl.addClass('jl-menubar jl-unselectable jl-bgcolor jl-round5');\r\n\t\t}\r\n\r\n\t\tZ._createMenuBar();\r\n\t\tjqEl.on('mouseout',function (event) {\r\n\t\t\tif (Z._preHoverItem && !jslet.ui.menuManager.menuBarShown) {\r\n\t\t\t\tjQuery(Z._preHoverItem).removeClass('jl-menubar-item-hover');\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\t_createMenuBar: function () {\r\n\t\tvar Z = this;\r\n\t\tif (Z.isPopup) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfor (var i = 0, cnt = Z._items.length, item; i < cnt; i++) {\r\n\t\t\titem = Z._items[i];\r\n\t\t\tZ._createBarItem(Z.el, item, Z._menubarclick);\r\n\t\t}\r\n\t},\r\n\r\n\t_showSubMenu: function (omi) {\r\n\t\tvar Z = omi.parentNode.jslet,\r\n\t\t\titemCfg = omi.jsletvar;\r\n\t\tif (!itemCfg.items) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!itemCfg.subMenu) {\r\n\t\t\tvar el = document.createElement('div');\r\n\t\t\tdocument.body.appendChild(el);\r\n\t\t\titemCfg.subMenu = new jslet.ui.Menu(el, { onItemClick: Z._onItemClick, items: itemCfg.items });\r\n\t\t}\r\n\t\tvar jqBody = jQuery(document.body),\r\n\t\t\tbodyMTop = parseInt(jqBody.css('margin-top')),\r\n\t\t\tbodyMleft = parseInt(jqBody.css('margin-left')),\r\n\t\t\tjqMi = jQuery(omi), \r\n\t\t\tpos = jqMi.offset(), \r\n\t\t\tposX = pos.left;\r\n\t\tif (jslet.locale.isRtl) {\r\n\t\t\tposX +=  jqMi.width() + 10;\r\n\t\t}\r\n\t\titemCfg.subMenu.show(posX, pos.top + jqMi.height());\r\n\t\tjslet.ui.menuManager.menuBarShown = true;\r\n\t\tZ._activeMenuItem = omi;\r\n\t\t// this.parentNode.parentNode.jslet.ui._createMenuPopup(cfg);\r\n\t},\r\n\r\n\t_createBarItem: function (obar, itemCfg) {\r\n\t\tif (itemCfg.visible !== undefined && !itemCfg.visible) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar omi = document.createElement('div');\r\n\t\tjQuery(omi).addClass('jl-menubar-item');\r\n\t\tomi.jsletvar = itemCfg;\r\n\t\tvar Z = this, jqMi = jQuery(omi);\r\n\t\tjqMi.on('click',function (event) {\r\n\t\t\tvar cfg = this.jsletvar;\r\n\t\t\tif(!cfg.items) {\r\n\t\t\t\tif (cfg.onClick) {\r\n\t\t\t\t\tcfg.onClick.call(Z, cfg.id || cfg.name);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (Z._onItemClick)\r\n\t\t\t\t\t\tZ._onItemClick.call(Z, cfg.id || cfg.name);\r\n\t\t\t\t}\r\n\t\t\t\tjslet.ui.menuManager.hideAll();\r\n\t\t\t} else {\r\n\t\t\t\t//\t\t\t\tif (Z._activeMenuItem != this || jslet.ui.menuManager.menuBarShown)\r\n\t\t\t\tZ._showSubMenu(this);\r\n\t\t\t}\r\n\t\t\tevent.stopPropagation();\r\n\t\t\tevent.preventDefault();\r\n\t\t});\r\n\r\n\t\tjqMi.on('mouseover', function (event) {\r\n\t\t\tif (Z._preHoverItem) {\r\n\t\t\t\tjQuery(Z._preHoverItem).removeClass('jl-menubar-item-hover');\r\n\t\t\t}\r\n\t\t\tZ._preHoverItem = this;\r\n\t\t\tjQuery(this).addClass('jl-menubar-item-hover');\r\n\t\t\tif (jslet.ui.menuManager.menuBarShown) {\r\n\t\t\t\tjslet.ui.menuManager.hideAll();\r\n\t\t\t\tZ._showSubMenu(this);\r\n\t\t\t\tjslet.ui.menuManager._inPopupMenu = true;\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tvar template = [];\r\n\t\ttemplate.push('<a class=\"jl-focusable-item\" href=\"javascript:void(0)\">');\r\n\t\ttemplate.push(itemCfg.name);\r\n\t\ttemplate.push('</a>');\r\n\t\t\r\n\t\tomi.innerHTML = template.join('');\r\n\t\tobar.appendChild(omi);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tvar Z = this;\r\n\t\tZ._activeMenuItem = null;\r\n\t\tZ._preHoverItem = null;\r\n\t\tZ._menubarclick = null;\r\n\t\tZ._onItemClick = null;\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tjqEl.off();\r\n\t\tjqEl.find('.jl-menubar-item').off();\r\n\t\tjqEl.find('.jl-menubar-item').each(function(){\r\n\t\t\tvar omi = this;\r\n\t\t\tif (omi.jsletvar){\r\n\t\t\t\tomi.jsletvar.subMenu = null;\r\n\t\t\t\tomi.jsletvar = null;\r\n\t\t\t}\r\n\t\t});\r\n\t\t$super();\r\n\t}\r\n});\r\njslet.ui.register('MenuBar', jslet.ui.MenuBar);\r\njslet.ui.MenuBar.htmlTemplate = '<div></div>';\r\n\r\n/**\r\n * @class Calendar. Example:\r\n * <pre><code>\r\n *  var jsletParam = { type: 'Menu', onItemClick: globalMenuItemClick, items: [\r\n *     { id: 'back', name: 'Backward', iconClass: 'icon1' },\r\n *     { id: 'go', name: 'Forward', disabled: true },\r\n *     { name: '-' }]};\r\n *\r\n *  //1. Declaring:\r\n *     &lt;div data-jslet='jsletParam' />\r\n *\r\n *  //2. Binding\r\n *     &lt;div id='menu1' />\r\n *     //js snippet:\r\n *     var el = document.getElementById('menu1');\r\n *     jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n *     jslet.ui.createControl(jsletParam, document.body);\r\n * //Use the below code to show context menu\r\n * jslet('#ctrlId').showContextMenu(event);\r\n * //Show menu at the specified position\r\n * jslet('#ctrlId').show(left, top);\r\n * \r\n * </code></pre>\r\n */\r\n/***\r\n* Popup Menu\r\n*/\r\njslet.ui.Menu = jslet.Class.create(jslet.ui.Control, {\r\n\t_onItemClick: undefined,\r\n\t_items:undefined,\r\n\t_invoker: null,\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.el = el;\r\n\t\tZ.allProperties = 'onItemClick,items,invoker'; //'invoker' is used for inner\r\n\t\t//items is an array, menu item's properties: id, name, onClick,disabled,iconClass,disabledIconClass,itemType,checked,group,items\r\n\t\t$super(el, params);\r\n\t\tZ._activeSubMenu = null;\r\n\t},\r\n\r\n\t/**\r\n\t * Get or set menuItem click event handler\r\n\t * Pattern: \r\n\t * function(menuId){}\r\n\t *   //menuId: String\r\n\t * \r\n\t * @param {Function or undefined} onItemClick menuItem click event handler\r\n\t * @param {this or Function}\r\n\t */\r\n\tonItemClick: function(onItemClick) {\r\n\t\tif(onItemClick === undefined) {\r\n\t\t\treturn this._onItemClick;\r\n\t\t}\r\n\t\tjslet.Checker.test('Menu.onItemClick', onItemClick).isFunction();\r\n\t\tthis._onItemClick = onItemClick;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Get or set menu items configuration.\r\n\t * \r\n\t * menu item's properties: \r\n\t * id, //{String} Menu id\r\n\t * name, //{String} Menu name \r\n\t * onClick, //{Event} Item click event, \r\n\t *   Pattern: function(event){}\r\n\t *   \r\n\t * disabled, //{Boolean} Menu item is disabled or not\r\n\t * iconClass,  //{String} Icon style class \r\n\t * disabledIconClass, //{String} Icon disabled style class\r\n\t * itemType, //{String} Menu item type, optional value: null, radio, check\r\n\t * checked, //{Boolean} Menu item is checked or not,  only work when itemType equals 'radio' or 'check'\r\n\t * group, //{String} Group name, only work when itemType equals 'radio'\r\n\t * items, //{Array} Sub menu items\r\n\t * \r\n\t * @param {PlanObject[] or undefined} items menu items.\r\n\t * @param {this or PlanObject[]}\r\n\t */\r\n\titems: function(items) {\r\n\t\tif(items === undefined) {\r\n\t\t\treturn this._items;\r\n\t\t}\r\n\t\tjslet.Checker.test('Menu.items', items).isArray();\r\n\t\tvar item;\r\n\t\tfor(var i = 0, len = items.length; i < len; i++) {\r\n\t\t\titem = items[i];\r\n\t\t\tjslet.Checker.test('Menu.items.name', item.name).isString().required();\r\n\t\t}\r\n\t\tthis._items = items;\r\n\t},\r\n\t\r\n\tinvoker: function(invoker) {\r\n\t\tif(invoker === undefined) {\r\n\t\t\treturn this._invoker;\r\n\t\t}\r\n\t\tthis._invoker = invoker;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tthis.renderAll();\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\tele = Z.el;\r\n\t\tif (!jqEl.hasClass('jl-menu')) {\r\n\t\t\tjqEl.addClass('jl-menu');\r\n\t\t}\r\n\t\tele.style.display = 'none';\r\n\r\n\t\tif (!ele.id) {\r\n\t\t\tele.id = jslet.nextId();\r\n\t\t}\r\n\r\n\t\tjslet.ui.menuManager.register(ele.id);\r\n\t\tZ._createMenuPopup();\r\n\t\tjqEl.on('mousedown',function (event) {\r\n\t\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\t\tevent.stopPropagation();\r\n\t\t\tevent.preventDefault();\r\n\t\t\treturn false;\r\n\t\t});\r\n\r\n\t\tjqEl.on('mouseover', function (event) {\r\n\t\t\tjslet.ui.menuManager._inPopupMenu = true;\r\n\t\t\tif (jslet.ui.menuManager.timerId) {\r\n\t\t\t\twindow.clearTimeout(jslet.ui.menuManager.timerId);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tjqEl.on('mouseout', function (event) {\r\n\t\t\tjslet.ui.menuManager._inPopupMenu = false;\r\n\t\t\tjslet.ui.menuManager.timerId = window.setTimeout(function () {\r\n\t\t\t\tif (!jslet.ui.menuManager._inPopupMenu) {\r\n\t\t\t\t\tjslet.ui.menuManager.hideAll();\r\n\t\t\t\t}\r\n\t\t\t\tjslet.ui.menuManager.timerId = null;\r\n\t\t\t}, 800);\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Show menu at specified position.\r\n\t * \r\n\t * @param {Integer} left Position left\r\n\t * @param {Integer} top Position top\r\n\t */\r\n\tshow: function (left, top) {\r\n\t\tvar Z = this, \r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\twidth = jqEl.outerWidth(),\r\n\t\t\theight = jqEl.outerHeight(),\r\n\t\t\tjqWin = jQuery(window),\r\n\t\t\twinWidth = jqWin.scrollLeft() + jqWin.width(),\r\n\t\t\twinHeight = jqWin.scrollTop() + jqWin.height();\r\n\t\t\t\r\n\t\tleft = left || Z.left || 10;\r\n\t\ttop = top || Z.top || 10;\r\n\t\tif (jslet.locale.isRtl) {\r\n\t\t\tleft -= width;\r\n\t\t}\r\n\t\tif(left + width > winWidth) {\r\n\t\t\tleft += winWidth - left - width - 1;\r\n\t\t}\r\n\t\tif(top + height > winHeight) {\r\n\t\t\ttop += winHeight - top - height - 1;\r\n\t\t}\r\n\t\tif(left < 0) {\r\n\t\t\tleft = 0;\r\n\t\t}\r\n\t\tif(top < 0) {\r\n\t\t\ttop = 0;\r\n\t\t}\r\n\t\tZ.el.style.left = left + 'px';\r\n\t\tZ.el.style.top = parseInt(top) + 'px';\r\n\t\tZ.el.style.display = 'block';\r\n\t\tif (!Z.shadow) {\r\n\t\t\tZ.shadow = document.createElement('div');\r\n\t\t\tjQuery(Z.shadow).addClass('jl-menu-shadow');\r\n\t\t\tZ.shadow.style.width = width + 'px';\r\n\t\t\tZ.shadow.style.height = height + 'px';\r\n\t\t\tdocument.body.appendChild(Z.shadow);\r\n\t\t}\r\n\t\tZ.shadow.style.left = left + 1 + 'px';\r\n\t\tZ.shadow.style.top = top + 1 + 'px';\r\n\t\tZ.shadow.style.display = 'block';\r\n\t},\r\n\r\n\t/**\r\n\t * Hide menu item and all its sub menu item.\r\n\t */\r\n\thide: function () {\r\n\t\tthis.ctxElement = null;\r\n\t\tthis.el.style.display = 'none';\r\n\t\tif (this.shadow) {\r\n\t\t\tthis.shadow.style.display = 'none';\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Show menu on context menu. Example:\r\n\t * <pre><code>\r\n\t *  <div id=\"popmenu\" oncontextmenu=\"popMenu(event);\">\r\n\t *\tfunction popMenu(event) {\r\n\t *\tjslet(\"#popmenu\").showContextMenu(event);\r\n\t *  }\r\n\t * </code></pre>\r\n\t */\r\n\tshowContextMenu: function (event, contextObj) {\r\n\t\tjslet.ui.menuManager.hideAll();\r\n\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\tjslet.ui.menuManager._contextObject = contextObj;\r\n\t\tthis.show(event.pageX, event.pageY);\r\n\t\tevent.preventDefault();\r\n\t},\r\n\r\n\t_createMenuPopup: function () {\r\n\t\tvar panel = this.el,\r\n\t\t\titems = this._items, itemCfg, name, i, cnt;\r\n\t\tcnt = items.length;\r\n\t\tfor (i = 0; i < cnt; i++) {\r\n\t\t\titemCfg = items[i];\r\n\t\t\tif (!itemCfg.name) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tname = itemCfg.name.trim();\r\n\t\t\tif (name != '-') {\r\n\t\t\t\tthis._createMenuItem(panel, itemCfg);\r\n\t\t\t} else {\r\n\t\t\t\tthis._createLine(panel, itemCfg);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar w = jQuery(panel).width() - 2 + 'px',\r\n\t\t\tarrMi = panel.childNodes, node;\r\n\t\tcnt = arrMi.length;\r\n\t\tfor (i = 0; i < cnt; i++) {\r\n\t\t\tnode = arrMi[i];\r\n\t\t\tif (node.nodeType == 1) {\r\n\t\t\t\tnode.style.width = w;\r\n\t\t\t}\r\n\t\t}\r\n\t\tdocument.body.appendChild(panel);\r\n\t},\r\n\r\n\t_ItemClick: function (sender, cfg) {\r\n\t\t//has sub menu items\r\n\t\tif (cfg.items) {\r\n\t\t\tthis._showSubMenu(sender, cfg);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (cfg.disabled) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar contextObj = jslet.ui.menuManager._contextObject || this;\r\n\t\tif (cfg.onClick) {\r\n\t\t\tcfg.onClick.call(contextObj, cfg.id || cfg.name, cfg.checked);\r\n\t\t} else {\r\n\t\t\tif (this._onItemClick) {\r\n\t\t\t\tthis._onItemClick.call(contextObj, cfg.id || cfg.name, cfg.checked);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (cfg.itemType == 'check' || cfg.itemType == 'radio') {\r\n\t\t\tjslet.ui.Menu.setChecked(sender, !cfg.checked);\r\n\t\t}\r\n\t\tjslet.ui.menuManager.hideAll();\r\n\t},\r\n\r\n\t_hideSubMenu: function () {\r\n\t\tvar Z = this;\r\n\t\tif (Z._activeSubMenu) {\r\n\t\t\tZ._activeSubMenu._hideSubMenu();\r\n\t\t\tZ._activeSubMenu.hide();\r\n\t\t\tZ._activeSubMenu.el.style.zIndex = parseInt(jQuery(Z.el).css('zIndex'));\r\n\t\t}\r\n\t},\r\n\r\n\t_showSubMenu: function (sender, cfg, delayTime) {\r\n\t\tvar Z = this;\r\n\t\tvar func = function () {\r\n\t\t\tZ._hideSubMenu();\r\n\t\t\tif (!cfg.subMenu) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar jqPmi = jQuery(sender),\r\n\t\t\t\tpos = jqPmi.offset(), \r\n\t\t\t\tx = pos.left;\r\n\t\t\tif (!jslet.locale.isRtl) {\r\n\t\t\t\tx += jqPmi.width();\r\n\t\t\t}\r\n\r\n\t\t\tcfg.subMenu.show(x - 2, pos.top);\r\n\t\t\tcfg.subMenu.el.style.zIndex = parseInt(jQuery(Z.el).css('zIndex')) + 1;\r\n\t\t\tZ._activeSubMenu = cfg.subMenu;\r\n\t\t};\r\n\t\tif (delayTime) {\r\n\t\t\twindow.setTimeout(func, delayTime);\r\n\t\t} else {\r\n\t\t\tfunc();\r\n\t\t}\r\n\t},\r\n\r\n\t_ItemOver: function (sender, cfg) {\r\n\t\tif (this._activeSubMenu) {\r\n\t\t\tthis._showSubMenu(sender, cfg, 200);\r\n\t\t}\r\n\t},\r\n\r\n\t_createMenuItem: function (container, itemCfg, defaultClickHandler) {\r\n\t\t//id, name, onClick,disabled,iconClass,disabledIconClass,itemType,checked,group,items,subMenuId\r\n\t\tvar isCheckBox = false, \r\n\t\t\tisRadioBox = false,\r\n\t\t\titemType = itemCfg.itemType;\r\n\t\tif (itemType) {\r\n\t\t\tisCheckBox = (itemType == 'check');\r\n\t\t\tisRadioBox = (itemType == 'radio');\r\n\t\t}\r\n\t\tif (isCheckBox) {\r\n\t\t\titemCfg.iconClass = 'jl-menu-check';\r\n\t\t\titemCfg.disabledIconClass = 'jl-menu-check-disabled';\r\n\t\t}\r\n\t\tif (isRadioBox) {\r\n\t\t\titemCfg.iconClass = 'jl-menu-radio';\r\n\t\t\titemCfg.disabledIconClass = 'jl-menu-radio-disabled';\r\n\t\t}\r\n\t\tif (itemCfg.items) {\r\n\t\t\titemCfg.disabled = false;\r\n\t\t}\r\n\t\tvar mi = document.createElement('div'), Z = this, jqMi = jQuery(mi);\r\n\t\tjqMi.addClass('jl-menu-item ' + (itemCfg.disabled ? 'jl-menu-disabled' : 'jl-menu-enabled'));\r\n\r\n\t\tif (!itemCfg.id) {\r\n\t\t\titemCfg.id = jslet.nextId();\r\n\t\t}\r\n\t\tmi.id = itemCfg.id;\r\n\t\tmi.jsletvar = itemCfg;\r\n\t\tjqMi.on('click', function (event) {\r\n\t\t\tZ._ItemClick(this, this.jsletvar);\r\n\t\t\tevent.stopPropagation();\r\n\t\t\tevent.preventDefault();\r\n\t\t});\r\n\r\n\t\tjqMi.on('mouseover', function (event) {\r\n\t\t\tZ._ItemOver(this, this.jsletvar);\r\n\t\t\tif (Z._preHoverItem) {\r\n\t\t\t\tjQuery(Z._preHoverItem).removeClass('jl-menu-item-hover');\r\n\t\t\t}\r\n\t\t\tZ._preHoverItem = this;\r\n\t\t\tif (!this.jsletvar.disabled) {\r\n\t\t\t\tjQuery(this).addClass('jl-menu-item-hover');\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tjqMi.on('mouseout', function (event) {\r\n\t\t\tif (!this.jsletvar.subMenu) {\r\n\t\t\t\tjQuery(this).removeClass('jl-menu-item-hover');\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tvar template = [];\r\n\t\ttemplate.push('<span class=\"jl-menu-icon-placeholder ');\r\n\t\tif ((isCheckBox || isRadioBox) && !itemCfg.checked) {\r\n\t\t\t//Empty \r\n\t\t} else {\r\n\t\t\tif (itemCfg.iconClass) {\r\n\t\t\t\ttemplate.push((!itemCfg.disabled || !itemCfg.disabledIconClass) ? itemCfg.iconClass : itemCfg.disabledIconClass);\r\n\t\t\t}\r\n\t\t}\r\n\t\ttemplate.push('\"></span>');\r\n\r\n\t\tif (itemCfg.items) {\r\n\t\t\ttemplate.push('<div class=\"jl-menu-arrow\"></div>');\r\n\t\t}\r\n\r\n\t\ttemplate.push('<a  href=\"javascript:void(0)\" class=\"jl-focusable-item jl-menu-content ');\r\n\t\ttemplate.push(' jl-menu-content-left jl-menu-content-right');\r\n\t\ttemplate.push('\">');\r\n\t\ttemplate.push(itemCfg.name);\r\n\t\ttemplate.push('</a>');\r\n\t\tmi.innerHTML = template.join('');\r\n\t\tcontainer.appendChild(mi);\r\n\t\tif (itemCfg.items) {\r\n\t\t\tvar el = document.createElement('div');\r\n\t\t\tdocument.body.appendChild(el);\r\n\t\t\titemCfg.subMenu = new jslet.ui.Menu(el, { onItemClick: Z._onItemClick, items: itemCfg.items, invoker: mi });\r\n\t\t}\r\n\t},\r\n\r\n\t_createLine: function (container, itemCfg) {\r\n\t\tvar odiv = document.createElement('div');\r\n\t\tjQuery(odiv).addClass('jl-menu-line');\r\n\t\tcontainer.appendChild(odiv);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tvar Z = this, \r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\tZ._activeSubMenu = null;\r\n\t\tjslet.ui.menuManager.unregister(Z.el.id);\r\n\t\tjqEl.off();\r\n\t\tjqEl.find('.jl-menu-item').each(function(){\r\n\t\t\tthis.onmouseover = null;\r\n\t\t\tthis.onclick = null;\r\n\t\t\tthis.onmouseout = null;\r\n\t\t});\r\n\t\t\r\n\t\t$super();\r\n\t}\r\n});\r\n\r\njslet.ui.register('Menu', jslet.ui.Menu);\r\njslet.ui.Menu.htmlTemplate = '<div></div>';\r\n\r\njslet.ui.Menu.setDisabled = function (menuId, disabled) {\r\n\tvar jqMi;\r\n\tif (Object.isString(menuId)) {\r\n\t\tjqMi = jQuery('#'+menuId);\r\n\t} else {\r\n\t\tjqMi = jQuery(menuId);\r\n\t}\r\n\tvar cfg = jqMi.context.jsletvar;\r\n\tif (cfg.items) {\r\n\t\treturn;\r\n\t}\r\n\tif (disabled) {\r\n\t\tjqMi.removeClass('jl-menu-enabled');\r\n\t\tjqMi.addClass('jl-menu-disabled');\r\n\t} else {\r\n\t\tjqMi.removeClass('jl-menu-disabled');\r\n\t\tjqMi.addClass('jl-menu-enabled');\r\n\t}\r\n\tcfg.disabled = disabled;\r\n};\r\n\r\njslet.ui.Menu.setChecked = function (menuId, checked) {\r\n\tvar jqMi;\r\n\tif (typeof(menuId)==='string') {\r\n\t\tjqMi = jQuery('#' + menuId);\r\n\t} else {\r\n\t\tjqMi = jQuery(menuId);\r\n\t}\r\n\tvar mi = jqMi.context,\r\n\t\tcfg = mi.jsletvar,\r\n\t\titemType = cfg.itemType;\r\n\tif (itemType != 'check' && itemType != 'radio') {\r\n\t\treturn;\r\n\t}\r\n\tif (itemType == 'radio') {\r\n\t\tif (cfg.checked && checked || !checked) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar group = mi.group;\r\n\t\t//uncheck all radio button in the same group\r\n\t\tvar allMi = mi.parentNode.childNodes;\r\n\r\n\t\tfor (var i = 0, node, cfg1, icon, cnt = allMi.length; i < cnt; i++) {\r\n\t\t\tnode = allMi[i];\r\n\t\t\tif (node == mi) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tcfg1 = node.jsletvar;\r\n\t\t\tif (cfg1 && cfg1.itemType == 'radio' && cfg1.group == group) {\r\n\t\t\t\ticon = node.childNodes[0];\r\n\t\t\t\tif (cfg1.disabled) {\r\n\t\t\t\t\tjQuery(icon).removeClass(cfg1.disabledIconClass);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tjQuery(icon).removeClass(cfg1.iconClass);\r\n\t\t\t\t}\r\n\t\t\t\tcfg1.checked = false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tvar jqIcon = jQuery(mi.childNodes[0]);\r\n\r\n\tif (cfg.checked && !checked) {\r\n\t\tif (cfg.disabled) {\r\n\t\t\tjqIcon.removeClass(cfg.disabledIconClass);\r\n\t\t} else {\r\n\t\t\tjqIcon.removeClass(cfg.iconClass);\r\n\t\t}\r\n\t}\r\n\tif (!cfg.checked && checked) {\r\n\t\tif (cfg.disabled) {\r\n\t\t\tjqIcon.addClass(cfg.disabledIconClass);\r\n\t\t}else {\r\n\t\t\tjqIcon.addClass(cfg.iconClass);\r\n\t\t}\r\n\t}\r\n\tcfg.checked = checked;\r\n};\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n* @class Overlay panel. Example:\r\n* <pre><code>\r\n*  var overlay = new jslet.ui.OverlayPanel(Z.el.parentNode);\r\n*  overlay.setZIndex(999);\r\n*  overlay.show();\r\n* </code></pre>\r\n* \r\n* @param {Html Element} container Html Element that OverlayPanel will cover.\r\n* @param {String} color Color String.\r\n*/\r\n\"use strict\";\r\njslet.ui.OverlayPanel = function (container, color) {\r\n\tvar odiv = document.createElement('div');\r\n\tjQuery(odiv).addClass('jl-overlay').on('click', function(event){\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\tvar srcEle = event.target;\r\n\t\tif (jslet.ui.isChild(jslet.ui.PopupPanel.excludedElement,srcEle) ||\r\n\t\t\tjslet.ui.inPopupPanel(srcEle)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (jslet.ui._activePopup) {\r\n\t\t\tjslet.ui._activePopup.hide();\r\n\t\t}\r\n\t\tevent.stopPropagation();\r\n\t\tevent.preventDefault();\r\n\t});\r\n\t\r\n\tif (color) {\r\n\t\todiv.style.backgroundColor = color;\r\n\t}\r\n\tvar left, top, width, height;\r\n\tif (!container) {\r\n\t\tvar jqBody = jQuery(document.body);\r\n\t\tleft = 0;\r\n\t\ttop = 0;\r\n\t\twidth = jqBody.width();\r\n\t\theight = jqBody.height();\r\n\t} else {\r\n\t\twidth = jQuery(container).width();\r\n\t\theight = jQuery(container).height();\r\n\t}\r\n\todiv.style.left = '0px';\r\n\todiv.style.top = '0px';\r\n\todiv.style.bottom = '0px';\r\n\todiv.style.right = '0px';\r\n\tif (!container) {\r\n\t\tdocument.body.appendChild(odiv);\r\n\t} else {\r\n\t\tcontainer.appendChild(odiv);\r\n\t}\r\n\todiv.style.display = 'none';\r\n\r\n\tvar oldResizeHanlder = null;\r\n\tif (!container) {\r\n\t\toldResizeHanlder = window.onresize;\r\n\r\n\t\twindow.onresize = function () {\r\n\t\t\todiv.style.width = document.body.scrollWidth + 'px';\r\n\t\t\todiv.style.height = document.body.scrollHeight + 'px';\r\n\t\t};\r\n\t} else {\r\n\t\toldResizeHanlder = container.onresize;\r\n\t\tcontainer.onresize = function () {\r\n\t\t\tvar width = jQuery(container).width() - 12;\r\n\t\t\tvar height = jQuery(container).height() - 12;\r\n\t\t\todiv.style.width = width + 'px';\r\n\t\t\todiv.style.height = height + 'px';\r\n\t\t};\r\n\t}\r\n\r\n\tthis.overlayPanel = odiv;\r\n\r\n\t/**\r\n\t * Show overlay panel\r\n\t */\r\n\tthis.show = function () {\r\n\t\todiv.style.display = 'block';\r\n\t\treturn odiv;\r\n\t};\r\n\r\n\t/**\r\n\t * Hide overlay panel\r\n\t */\r\n\tthis.hide = function () {\r\n\t\todiv.style.display = 'none';\r\n\t\treturn odiv;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Set Z-index \r\n\t * \r\n\t * @param {Integer} zIndex Z-Index\r\n\t */\r\n\tthis.setZIndex = function(zIndex){\r\n\t\tthis.overlayPanel.style.zIndex = zIndex;\r\n\t};\r\n\r\n\tthis.destroy = function () {\r\n\t\tthis.hide();\r\n\t\tif (!container) {\r\n\t\t\twindow.onresize = oldResizeHanlder;\r\n\t\t\tdocument.body.removeChild(odiv);\r\n\t\t} else {\r\n\t\t\tcontainer.onresize = oldResizeHanlder;\r\n\t\t\tcontainer.removeChild(odiv);\r\n\t\t}\r\n\t\tjQuery(this.overlayPanel).off();\r\n\t};\r\n};\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class Split Panel. Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"SplitPanel\",direction:\"hori\",floatIndex: 1};\r\n * //1. Declaring:\r\n *     &lt;div data-jslet='jsletParam' style=\"width: 300px; height: 400px;\">\r\n *     &lt;div>content1&lt;/div>\r\n *     &lt;div>content2&lt;/div>\r\n *     &lt;/div>\r\n *     \r\n *  //2. Binding\r\n *     &lt;div id='ctrlId'>\r\n *       &lt;div>content1&lt;/div>\r\n *       &lt;div>content2&lt;/div>\r\n *     &lt;/div>\r\n *     //Js snippet\r\n *     var el = document.getElementById('ctrlId');\r\n *     jslet.ui.bindControl(el, jsletParam);\r\n *\t\r\n *  //3. Create dynamically\r\n *     jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.SplitPanel = jslet.Class.create(jslet.ui.Control, {\r\n\tdirections: ['hori', 'vert'],\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.el = el;\r\n\t\tZ.allProperties = 'styleClass,direction,floatIndex,onExpanded,onSize';//{size:100, align:-1/0/1,minSize:10}\r\n\r\n\t\tZ._direction = 'hori';\r\n\r\n\t\tZ._floatIndex = 1;\r\n\t\t\r\n\t\tZ._onExpanded = null;\r\n\t\t\r\n\t\tZ._onSize = null;\r\n\t\t\r\n\t\tZ.panels = null; //Array, panel configuration\r\n\t\tZ.splitter = null;\r\n\t\tZ._oldSize = 0;\r\n\t\tjslet.resizeEventBus.subscribe(Z);\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * Get or set float panel index, only one panel can be a floating panel.\r\n\t * \r\n\t * @param {Integer or undefined} index float panel index.\r\n\t * @return {this or Integer}\r\n\t */\r\n\tfloatIndex: function(index) {\r\n\t\tif(index === undefined) {\r\n\t\t\treturn this._floatIndex;\r\n\t\t}\r\n\t\tjslet.Checker.test('SplitPanel.floatIndex', index).isGTEZero();\r\n\t\tthis._floatIndex = index;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Get or set Split direction, optional value: hori, vert\r\n\t * Default value is 'hori'\r\n\t * \r\n\t * @param {String or undefined} direction optional value: hori, vert.\r\n\t * @return {this or String}\r\n\t */\r\n\tdirection: function(direction) {\r\n\t\tif(direction === undefined) {\r\n\t\t\treturn this._direction;\r\n\t\t}\r\n\t\tdirection = jQuery.trim(direction);\r\n\t\tvar checker = jslet.Checker.test('SplitPanel.direction', direction).required().isString();\r\n\t\tdirection = direction.toLowerCase();\r\n\t\tchecker.inArray(this.directions);\r\n\t\tthis._direction = direction;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Fired when user expand/collapse one panel.\r\n\t *  Pattern: \r\n\t *\tfunction(panelIndex){} \r\n\t *\t//panelIndex: Integer\r\n\t *\r\n\t * @param {Function or undefined} onExpanded expanded event handler.\r\n\t * @return {this or Function}\r\n\t */\r\n\tonExpanded: function(onExpanded) {\r\n\t\tif(onExpanded === undefined) {\r\n\t\t\treturn this._onExpanded;\r\n\t\t}\r\n\t\tjslet.Checker.test('SplitPanel.onExpanded', onExpanded).isFunction();\r\n\t\tthis._onExpanded = onExpanded;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Fired after user change size of one panel.\r\n\t *  Pattern: \r\n\t *\tfunction(panelIndex, newSize){} \r\n\t *\t//panelIndex: Integer\r\n\t *\t//newSize: Integer\r\n\t *\r\n\t * @param {Function or undefined} onExpanded resize event handler.\r\n\t * @return {this or Function}\r\n\t */\r\n\tonSize: function(onSize) {\r\n\t\tif(onSize === undefined) {\r\n\t\t\treturn this._onSize;\r\n\t\t}\r\n\t\tjslet.Checker.test('SplitPanel.onSize', onSize).isFunction();\r\n\t\tthis._onSize = onSize;\r\n\t},\r\n   \r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tthis.renderAll();\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tvar Z = this, jqEl = jQuery(Z.el);\r\n\t\tif (!jqEl.hasClass('jl-splitpanel')) {\r\n\t\t\tjqEl.addClass('jl-splitpanel jl-border-box jl-round5');\r\n\t\t}\r\n\t\tZ.isHori = (Z._direction == 'hori');\r\n\t\t\r\n\t\tZ.width = jqEl.innerWidth();\r\n\t\tZ.height = jqEl.innerHeight();\r\n\t\tZ._oldSize = Z.isHori ? Z.width: Z.height;\r\n\t\t\r\n\t\tvar panelDivs = jqEl.find('>div'),\r\n\t\t\tlastIndex = panelDivs.length - 1;\r\n\t\tif (!Z._floatIndex || Z._floatIndex > lastIndex) {\r\n\t\t\tZ._floatIndex = lastIndex;\r\n\t\t}\r\n\t\tif (Z._floatIndex > lastIndex) {\r\n\t\t\tZ._floatIndex = lastIndex;\r\n\t\t}\r\n\t\tif (!Z.panels) {\r\n\t\t\tZ.panels = [];\r\n\t\t}\r\n\t\tvar containerSize = (Z.isHori ? Z.width : Z.height), sumSize = 0;\r\n\r\n\t\tpanelDivs.each(function(k){\r\n\t\t\tvar jqPanel = jQuery(panelDivs[k]),\r\n\t\t\t\toPanel = Z.panels[k];\r\n\t\t\tif (!oPanel){\r\n\t\t\t\toPanel = {};\r\n\t\t\t\tZ.panels[k] = oPanel;\r\n\t\t\t}\r\n\r\n\t\t\tvar minSize = parseInt(jqPanel.css(Z.isHori ?'min-width': 'min-height'));\r\n\t\t\toPanel.minSize = minSize ? minSize : 5;\r\n\t\t\t\r\n\t\t\tvar maxSize = parseInt(jqPanel.css(Z.isHori ?'max-width': 'max-height'));\r\n\t\t\toPanel.maxSize = maxSize ? maxSize : Infinity;\r\n\t\t\toPanel.expanded = jqPanel.css('display') != 'none';\r\n\t\t\t\r\n\t\t\tvar size = oPanel.size;\r\n\t\t\tif (size === null || size === undefined) {\r\n\t\t\t\tsize = Z.isHori ? jqPanel.outerWidth(): jqPanel.outerHeight();\r\n\t\t\t} else {\r\n\t\t\t\tif (Z.isHori) {\r\n\t\t\t\t\tjqPanel.width(size - 5);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tjqPanel.height(size - 5);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\tif (k != Z._floatIndex){\r\n\t\t\t\tsumSize += size;\r\n\t\t\t\toPanel.size = size;\r\n\t\t\t}\r\n\t\t});\r\n\t\tZ.panels[Z._floatIndex].size = containerSize - sumSize;\r\n\t\t\r\n\t\tZ.splitterTracker = document.createElement('div');\r\n\t\tvar jqTracker = jQuery(Z.splitterTracker);\r\n\t\tjqTracker.addClass('jl-sp-splitter-tracker');\r\n\t\tvar fixedSize = 0,\r\n\t\t\tclsName = Z.isHori ? 'jl-sp-panel-hori': 'jl-sp-panel-vert';\r\n\t\tZ.splitterClsName = Z.isHori ? 'jl-sp-splitter-hori': 'jl-sp-splitter-vert';\r\n\t\tZ.el.appendChild(Z.splitterTracker);\r\n\t\tif (Z.isHori) {\r\n\t\t\tZ.splitterTracker.style.height = '100%';\r\n\t\t} else {\r\n\t\t\tZ.splitterTracker.style.width = '100%';\r\n\t\t}\r\n\t\tvar splitterSize = parseInt(jslet.ui.getCssValue(Z.splitterClsName, Z.isHori? 'width' : 'height'));\r\n\t\tpanelDivs.after(function(k){\r\n\t\t\tvar panel = panelDivs[k],\r\n\t\t\tjqPanel = jQuery(panel),\r\n\t\t\texpanded = Z.panels[k].expanded;\r\n\t\t\t\r\n\t\t\tjqPanel.addClass(clsName);\r\n\r\n\t\t\tif (k == Z._floatIndex) {\r\n\t\t\t\tZ.floatPanel = panel;\r\n\t\t\t} else {\r\n\t\t\t\tif (expanded) {\r\n\t\t\t\t\tfixedSize += splitterSize + Z.panels[k].size;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tjqPanel.css('display', 'none');\r\n\t\t\t\t\tfixedSize += splitterSize;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (k == lastIndex){\r\n\t\t\t\tif (Z.isHori) {\r\n\t\t\t\t\treturn '<div style=\"clear:both;width:0px\"></div>';\r\n\t\t\t\t}\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\tvar id = jslet.nextId(),\r\n\t\t\t\tminBtnCls = Z.isHori ? 'jl-sp-button-left' : 'jl-sp-button-top';\r\n\t\t\t\t\r\n\t\t\tif (Z._floatIndex <= k || !expanded) {\r\n\t\t\t\tminBtnCls += Z.isHori ? ' jl-sp-button-right' : ' jl-sp-button-bottom';\r\n\t\t\t}\r\n\t\t\treturn '<div class=\"'+ Z.splitterClsName + ' jl-unselectable\" id = \"' + id + \r\n\t\t\t'\" jsletindex=\"'+ (k >= Z._floatIndex ? k+1: k)+ '\"><div class=\"jl-sp-button ' + \r\n\t\t\tminBtnCls +'\"' + (expanded ? '': ' jsletcollapsed=\"1\"') +'></div></div>';\r\n\t\t});\r\n\t\tif (Z.isHori) {\r\n\t\t\tjQuery(Z.floatPanel).width(jqEl.innerWidth() - fixedSize - 4);\r\n\t\t} else {\r\n\t\t\tjQuery(Z.floatPanel).height(jqEl.innerHeight() - fixedSize);\r\n\t\t}\r\n\t\tvar splitters = jqEl.find('.'+Z.splitterClsName);\r\n\t\tsplitters.on('mousedown', Z._splitterMouseDown);\r\n\t\tvar splitBtns = splitters.children();\r\n\t\tsplitBtns.on('mousedown', function(event){\r\n\t\t\tvar jqBtn = jQuery(event.target),\r\n\t\t\t\tjqSplitter = jqBtn.parent(),\r\n\t\t\t\tindex = parseInt(jqSplitter.attr('jsletindex'));\r\n\t\t\tZ.expand(index);\r\n\t\t\tevent.stopPropagation();\r\n\t\t});\r\n\t\t\r\n\t\tvar oSplitter;\r\n\t\tfor(var i = 0, cnt = splitters.length; i < cnt; i++){\r\n\t\t\toSplitter = splitters[i];\r\n\t\t\toSplitter._doDragStart = Z._splitterDragStart;\r\n\t\t\toSplitter._doDragging = Z._splitterDragging;\r\n\t\t\toSplitter._doDragEnd = Z._splitterDragEnd;\r\n\t\t\toSplitter._doDragCancel = Z._splitterDragCancel;\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * Get float panel\r\n\t * \r\n\t * @return {Html Element} \r\n\t */\r\n\tfloatPanel: function(){\r\n\t\treturn this.panels[this._floatIndex];\t\r\n\t},\r\n\t\r\n\tchangeSize: function(k, size){\r\n\t\t\r\n\t},\r\n\t\r\n\t/**\r\n\t * Expand or collapse the specified panel\r\n\t * \r\n\t * @param {Integer} index Panel index\r\n\t * @param {Boolean} expanded True for expanded, false otherwise.\r\n\t */\r\n\texpand: function(index, expanded, notChangeSize){\r\n\t\tvar Z = this, jqPanel, jqEl = jQuery(Z.el),\r\n\t\t\tsplitters = jqEl.find('.'+Z.splitterClsName);\r\n\t\tif (index < 0 || index > splitters.length) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar\tjqSplitter = jQuery(splitters[(index >= Z._floatIndex ? index - 1: index)]),\r\n\t\t\tjqBtn = jqSplitter.find(':first-child');\r\n\t\t\t\r\n\t\tif (expanded === undefined) {\r\n\t\t\texpanded  = jqBtn.attr('jsletcollapsed')=='1';\r\n\t\t}\r\n\t\tif (index < Z._floatIndex) {\r\n\t\t\tjqPanel = jqSplitter.prev();\r\n\t\t} else {\r\n\t\t\tjqPanel = jqSplitter.next();\r\n\t\t}\r\n\t\tif (Z.isHori){\r\n\t\t\tif (jqBtn.hasClass('jl-sp-button-right')) {\r\n\t\t\t\tjqBtn.removeClass('jl-sp-button-right');\r\n\t\t\t} else {\r\n\t\t\t\tjqBtn.addClass('jl-sp-button-right');\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (jqBtn.hasClass('jl-sp-button-bottom')) {\r\n\t\t\t\tjqBtn.removeClass('jl-sp-button-bottom');\r\n\t\t\t} else {\r\n\t\t\t\tjqBtn.addClass('jl-sp-button-bottom');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (expanded){\r\n\t\t\tjqPanel.css('display', 'block');\r\n\t\t\tjqBtn.attr('jsletcollapsed', '0');\r\n\t\t}else{\r\n\t\t\tjqPanel.css('display','none');\r\n\t\t\tjqBtn.attr('jsletcollapsed', '1');\r\n\t\t}\r\n\t\tif(notChangeSize) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar jqFp = jQuery(Z.floatPanel);\r\n\t\tif (Z.isHori) {\r\n\t\t\tjqFp.width(jqFp.width()+jqPanel.width()*(expanded ? -1: 1));\r\n\t\t} else {\r\n\t\t\tjqFp.height(jqFp.height()+jqPanel.height()*(expanded ? -1: 1));\r\n\t\t}\r\n\t\tZ.panels[index].expanded = expanded;\r\n\t\tif (Z._onExpanded) {\r\n\t\t\tZ._onExpanded.call(Z, index);\r\n\t\t}\r\n\t\tjslet.resizeEventBus.resize(Z.el);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @private\r\n\t */\r\n\t_splitterMouseDown: function(event){\r\n\t\tvar pos = jQuery(this).position(),\r\n\t\t\tZ = this.parentNode.jslet;\r\n\t\tZ.splitterTracker.style.top = pos.top + 'px';\r\n\t\tZ.splitterTracker.style.left = pos.left + 'px';\r\n\t\tZ.draggingId = this.id;\r\n\t\tvar jqSplitter = jQuery('#'+Z.draggingId),\r\n\t\t\tjqBtn = jqSplitter.find(':first-child');\r\n\t\tif(jqBtn.attr('jsletcollapsed')=='1') { //Collapsed\r\n\t\t\tjqBtn.click();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tjslet.ui.dnd.bindControl(this);\r\n\t},\r\n\t\t\r\n\t/**\r\n\t * @private\r\n\t */\r\n\t_splitterDragStart: function (oldX, oldY, x, y, deltaX, deltaY){\r\n\t\tvar Z = this.parentNode.jslet,\r\n\t\t\tjqTracker = jQuery(Z.splitterTracker),\r\n\t\t\tjqSplitter = jQuery('#'+Z.draggingId),\r\n\t\t\tindex = parseInt(jqSplitter.attr('jsletindex')),\r\n\t\t\tcfg = Z.panels[index],\r\n\t\t\tjqFp = jQuery(Z.floatPanel);\r\n\t\t\r\n\t\tZ.dragRangeMin = cfg.size - cfg.minSize;\r\n\t\tZ.dragRangeMax = cfg.maxSize - cfg.size;\r\n\t\tvar fpMax = (Z.isHori ? jqFp.width() : jqFp.height()) - Z.panels[Z._floatIndex].minSize;\r\n\t\tif (Z.dragRangeMax > fpMax) {\r\n\t\t\tZ.dragRangeMax = fpMax;\r\n\t\t}\r\n\t\tjqTracker.show();\r\n\t},\r\n\t\r\n\t/**\r\n\t * @private\r\n\t */\r\n\t_splitterDragging: function (oldX, oldY, x, y, deltaX, deltaY){\r\n\t\tvar Z = this.parentNode.jslet,\r\n\t\t\tjqTracker = jQuery(Z.splitterTracker),\r\n\t\t\tjqSplitter = jQuery('#'+Z.draggingId),\r\n\t\t\tindex = parseInt(jqSplitter.attr('jsletindex')),\r\n\t\t\tdelta = Math.abs(Z.isHori ? deltaX : deltaY),\r\n\t\t\texpanded;\r\n\t\t\t\r\n\t\tif (Z.isHori) {\r\n\t\t\texpanded = index < Z._floatIndex && deltaX >= 0 || index > Z._floatIndex && deltaX < 0;\r\n\t\t} else {\r\n\t\t\texpanded = index < Z._floatIndex && deltaY >= 0 || index > Z._floatIndex && deltaY < 0;\r\n\t\t}\r\n\t\tif (expanded && delta > Z.dragRangeMax){\r\n\t\t\tZ.endDelta = Z.dragRangeMax;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif (!expanded && delta > Z.dragRangeMin){\r\n\t\t\tZ.endDelta = Z.dragRangeMin;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tZ.endDelta = Math.abs(Z.isHori ? deltaX : deltaY);\r\n\t\tvar pos = jqTracker.offset();\r\n\t\tif (Z.isHori) {\r\n\t\t\tpos.left = x;\r\n\t\t} else {\r\n\t\t\tpos.top = y;\r\n\t\t}\r\n\t\tjqTracker.offset(pos);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @private\r\n\t */\r\n\t_splitterDragEnd: function (oldX, oldY, x, y, deltaX, deltaY){\r\n\t\tvar Z = this.parentNode.jslet,\r\n\t\t\tjqTracker = jQuery(Z.splitterTracker),\r\n\t\t\tjqSplitter = jQuery('#'+Z.draggingId),\r\n\t\t\tindex = parseInt(jqSplitter.attr('jsletindex')),\r\n\t\t\tjqPanel = index < Z._floatIndex ? jqSplitter.prev(): jqSplitter.next(),\r\n\t\t\texpanded,\r\n\t\t\tjqFp = jQuery(Z.floatPanel);\r\n\r\n\t\tif (Z.isHori) {\r\n\t\t\texpanded = index < Z._floatIndex && deltaX >= 0 || index > Z._floatIndex && deltaX < 0;\r\n\t\t} else {\r\n\t\t\texpanded = index < Z._floatIndex && deltaY >= 0 || index > Z._floatIndex && deltaY < 0;\r\n\t\t}\r\n\t\tvar delta = Z.endDelta * (expanded ? 1: -1);\r\n\t\tvar newSize = Z.panels[index].size + delta;\r\n\t\tZ.panels[index].size = newSize;\r\n\t\t\r\n\t\tif (Z.isHori){\r\n\t\t\tjqPanel.width(newSize);\r\n\t\t\tjqFp.width(jqFp.width() - delta);\r\n\t\t}else{\r\n\t\t\tjqPanel.height(newSize);\r\n\t\t\tjqFp.height(jqFp.height() - delta);\r\n\t\t}\r\n\t\tif (Z._onSize) {\r\n\t\t\tZ._onSize.call(Z, index, newSize);\r\n\t\t}\r\n\t\tjslet.resizeEventBus.resize(Z.el);\r\n\t\tjqTracker.hide();\r\n\t},\r\n\t\r\n\t/**\r\n\t * @private\r\n\t */\r\n\t_splitterDragCancel: function (oldX, oldY, x, y, deltaX, deltaY){\r\n\t\tvar Z = this.parentNode.jslet,\r\n\t\t\tjqTracker = jQuery(Z.splitterTracker);\r\n\t\tjqTracker.hide();\r\n\t},\r\n\t\r\n\t/**\r\n\t * Run when container size changed, it's revoked by jslet.resizeeventbus.\r\n\t * \r\n\t */\r\n\tcheckSizeChanged: function(){\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\tcurrSize = Z.isHori ? jqEl.width() : jqEl.height();\r\n\t\tif ( Z._oldSize != currSize){\r\n\t\t\tvar delta = currSize - Z._oldSize;\r\n\t\t\tZ._oldSize = currSize;\r\n\t\t\tvar oFp = Z.panels[Z._floatIndex],\r\n\t\t\t\tjqFp = jQuery(Z.floatPanel),\r\n\t\t\t\tnewSize = delta + (Z.isHori ? jqFp.width(): jqFp.height());\r\n\r\n\t\t\tif (newSize < oFp.minSize) {\r\n\t\t\t\tnewSize = oFp.minSize;\r\n\t\t\t}\r\n\t\t\tif (Z.isHori) {\r\n\t\t\t\tjqFp.width(newSize);\r\n\t\t\t} else {\r\n\t\t\t\tjqFp.height(newSize);\r\n\t\t\t}\r\n\t\t}\r\n\t\tjslet.resizeEventBus.resize(Z.floatPanel);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tvar Z = this,\r\n\t\tjqEl = jQuery(Z.el);\r\n\t\tZ.splitterTracker = null;\r\n\t\tZ.floatPanel = null;\r\n\t\tvar splitters = jqEl.find('.'+Z.splitterClsName);\r\n\t\tsplitters.off('mousedown', Z._splitterMouseDown);\r\n\t\tvar item;\r\n\t\tfor(var i = 0, cnt = splitters.length; i < cnt; i++){\r\n\t\t\titem = splitters[i];\r\n\t\t\tjslet.ui.dnd.unbindControl(item);\r\n\t\t\titem._doDragStart = null;\r\n\t\t\titem._doDragging = null;\r\n\t\t\titem._doDragEnd = null;\r\n\t\t\titem._doDragCancel = null;\r\n\t\t}\r\n\t\tjslet.resizeEventBus.unsubscribe(Z);\r\n\t\t$super();\r\n\t}\r\n});\r\n\r\njslet.ui.register('SplitPanel', jslet.ui.SplitPanel);\r\njslet.ui.SplitPanel.htmlTemplate = '<div></div>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class TabControl. Example:\r\n * <pre><code>\r\n * var jsletParam = {type: \"TabControl\", \r\n *\t\tactiveIndex: 1, \r\n *\t\tonCreateContextMenu: doCreateContextMenu, \r\n *\t\titems: [\r\n *\t\t\t{header: \"one\", userIFrame: true, url: \"http://www.google.com\", iconClass: \"tabIcon\"},\r\n *\t\t\t{header: \"two\", closable: true, divId: \"p2\"},\r\n *\t\t\t{header:\"three\",closable:true,divId:\"p3\"},\r\n *\t\t]};\r\n *  //1. Declaring:\r\n *\t\t&lt;div data-jslet='jsletParam' style=\"width: 300px; height: 400px;\" />\r\n *\r\n *  //2. Binding\r\n *\t\t&lt;div id='ctrlId' />\r\n *\t\t//Js snippet\r\n *\t\tvar el = document.getElementById('ctrlId');\r\n *\t\tjslet.ui.bindControl(el, jsletParam);\r\n *\t\r\n *  //3. Create dynamically\r\n *\t\tjslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\n/**\r\n* Tab Item\r\n*/\r\njslet.ui.TabItem = function () {\r\n\tvar Z = this;\r\n\tZ.id = null; //{String} Element Id\r\n\tZ.index = -1; //{Integer} TabItem index\r\n\tZ.header = null; //{String} Head of tab item\r\n\tZ.closable = false; //{Boolean} Can be closed or not\r\n\tZ.disabled = false; //{Boolean} \r\n\tZ.useIFrame = false; //{Boolean}\r\n\tZ.height = '100%';\r\n\tZ.url = null; //{String} \r\n\tZ.contentId = null; //{String} \r\n\tZ.content = null; //{String} \r\n};\r\n\r\njslet.ui.TabControl = jslet.Class.create(jslet.ui.Control, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.el = el;\r\n\t\tZ.allProperties = 'styleClass,activeIndex,newable,closable,items,onAddTabItem,onActiveIndexChanged,onRemoveTabItem,onCreateContextMenu,onContentLoading,onContentLoaded';\r\n\t\t\r\n\t\tZ._activeIndex = -1;\r\n\t\t\r\n\t\tZ._newable = true;\r\n\t\t\r\n\t\tZ._closable = true;\r\n\t\t\r\n\t\tZ._onActiveIndexChanged = null;\r\n\t\t\r\n\t\tZ._onAddTabItem = null;\r\n\t\t\r\n\t\tZ._onRemoveTabItem = null;\r\n\t\t\r\n\t\tZ._onCreateContextMenu = null;\r\n\t\t\r\n\t\tZ._items = [];\r\n\t\t\r\n\t\tZ._itemsWidth = [];\r\n\t\tZ._containerWidth = 0;\r\n\t\tZ._ready = false;\r\n\t\t\r\n\t\tZ._leftIndex = 0;\r\n\t\tZ._rightIndex = 0;\r\n\t\tZ._maxHeaderWidth = 160;\r\n\t\tZ._tabControlWidth = jQuery(Z.el).width();\r\n\t\tZ._tabControlHeight = jQuery(Z.el).height();\r\n\t\tZ._contextItemIndex = 0;\r\n\t\t\r\n\t\tZ._onContentLoading = null;\r\n\t\tZ._onContentLoaded = null;\r\n\t\tjslet.resizeEventBus.subscribe(this);\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * Get or set active tab item index.\r\n\t * \r\n\t * @param {Integer or undefined} index active tabItem index.\r\n\t * @param {this or Integer}\r\n\t */\r\n\tactiveIndex: function(index) {\r\n\t\tif(index === undefined) {\r\n\t\t\treturn this._activeIndex;\r\n\t\t}\r\n\t\tjslet.Checker.test('TabControl.activeIndex', index).isGTEZero();\r\n\t\tif(this._ready) {\r\n\t\t\tthis._chgActiveIndex(index);\r\n\t\t} else {\r\n\t\t\tthis._activeIndex = index;\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * Get or set active tab item id.\r\n\t * \r\n\t * @param {String or undefined} itemId active tabItem id.\r\n\t * @param {this or String}\r\n\t */\r\n\tactiveItemId: function(itemId) {\r\n\t\tvar Z = this;\r\n\t\tif(itemId === undefined) {\r\n\t\t\tvar itemCfg = Z._items[this._activeIndex];\r\n\t\t\tif(itemCfg) {\r\n\t\t\t\treturn itemCfg.id;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tjslet.Checker.test('TabControl.activeItemId', itemId).isString();\r\n\t\tif(this._ready) {\r\n\t\t\tvar items = Z._items;\r\n\t\t\tfor(var i = 0, len = items.length; i < len; i++) {\r\n\t\t\t\tif(itemId === items[i].id) {\r\n\t\t\t\t\tthis._chgActiveIndex(i);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Get active tab item config.\r\n\t * \r\n\t * @return {jslet.ui.TabItem}\r\n\t */\r\n\tactiveItem: function() {\r\n\t\tvar items = this._items;\r\n\t\tif(items && items.length > 0) {\r\n\t\t\treturn this._items[this._activeIndex || 0];\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify if user can add tab item on fly.\r\n\t * \r\n\t * @param {Boolean or undefined} newable true(default) - user can add tab item on fly, false - otherwise.\r\n\t * @return {this or Boolean} \r\n\t */\r\n\tnewable: function(newable) {\r\n\t\tif(newable === undefined) {\r\n\t\t\treturn this._newable;\r\n\t\t}\r\n\t\tthis._newable = newable? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify if user can close tab item on fly.\r\n\t * \r\n\t * @param {Boolean or undefined} closable true(default) - user can close tab item on fly, false - otherwise.\r\n\t * @return {this or Boolean} \r\n\t */\r\n\tclosable: function(closable) {\r\n\t\tif(closable === undefined) {\r\n\t\t\treturn this._closable;\r\n\t\t}\r\n\t\tthis._closable = closable? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Fired after add a new tab item.\r\n\t * Pattern: \r\n\t *   function(){}\r\n\t *   \r\n\t * @param {Function or undefined} onAddTabItem tab item added event handler.\r\n\t * @return {this or Function} \r\n\t */\r\n\tonAddTabItem: function(onAddTabItem) {\r\n\t\tif(onAddTabItem === undefined) {\r\n\t\t\treturn this._onAddTabItem;\r\n\t\t}\r\n\t\tjslet.Checker.test('TabControl.onAddTabItem', onAddTabItem).isFunction();\r\n\t\tthis._onAddTabItem = onAddTabItem;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Fired when user toggle tab item.\r\n\t * Pattern: \r\n\t *   function(oldIndex, newIndex){}\r\n\t *   //oldIndex: Integer\r\n\t *   //newIndex: Integer\r\n\t *   \r\n\t * @param {Function or undefined} onActiveIndexChanged tab item active event handler.\r\n\t * @return {this or Function} \r\n\t */\r\n\tonActiveIndexChanged: function(onActiveIndexChanged) {\r\n\t\tif(onActiveIndexChanged === undefined) {\r\n\t\t\treturn this._onActiveIndexChanged;\r\n\t\t}\r\n\t\tjslet.Checker.test('TabControl.onActiveIndexChanged', onActiveIndexChanged).isFunction();\r\n\t\tthis._onActiveIndexChanged = onActiveIndexChanged;\r\n\t},\r\n\r\n\t/**\r\n\t * Fired after remove a tab item.\r\n\t * Pattern: \r\n\t *  function(tabItemIndex, active){}\r\n\t *  //tabItemIndex: Integer\r\n\t *  //active: Boolean Identify if the removing item is active\r\n\t *  //return: Boolean, false - cancel removing tab item, true - remove tab item. \r\n\t *   \r\n\t * @param {Function or undefined} onRemoveTabItem tab item removed event handler.\r\n\t * @return {this or Function} \r\n\t */\r\n\tonRemoveTabItem: function(onRemoveTabItem) {\r\n\t\tif(onRemoveTabItem === undefined) {\r\n\t\t\treturn this._onRemoveTabItem;\r\n\t\t}\r\n\t\tjslet.Checker.test('TabControl.onRemoveTabItem', onRemoveTabItem).isFunction();\r\n\t\tthis._onRemoveTabItem = onRemoveTabItem;\r\n\t},\r\n\r\n\t/**\r\n\t * Fired before show context menu\r\n\t * Pattern: \r\n\t *   function(menuItems){}\r\n\t *   //menuItems: Array of MenuItem, @see menu item configuration in jslet.menu.js.\r\n\t *   \r\n\t * @param {Function or undefined} onCreateContextMenu creating context menu event handler.\r\n\t * @return {this or Function} \r\n\t */\r\n\tonCreateContextMenu: function(onCreateContextMenu) {\r\n\t\tif(onCreateContextMenu === undefined) {\r\n\t\t\treturn this._onCreateContextMenu;\r\n\t\t}\r\n\t\tjslet.Checker.test('TabControl.onCreateContextMenu', onCreateContextMenu).isFunction();\r\n\t\tthis._onCreateContextMenu = onCreateContextMenu;\r\n\t},\r\n\t \r\n\t/**\r\n\t * Fired before loading content of tab item;\r\n\t * Pattern: \r\n\t *   function(contentId, itemCfg){}\r\n\t *   //contentId: {String} the content element's id.\r\n\t *   //itemCfg: {Plan Object} tab item config\r\n\t *   \r\n\t * @param {Function or undefined} onContentLoading before loading tab panel content handler.\r\n\t * @return {this or Function} \r\n\t */\r\n\tonContentLoading: function(onContentLoading) {\r\n\t\tif(onContentLoading === undefined) {\r\n\t\t\treturn this._onContentLoading;\r\n\t\t}\r\n\t\tjslet.Checker.test('TabControl.onContentLoading', onContentLoading).isFunction();\r\n\t\tthis._onContentLoading = onContentLoading;\r\n\t},\r\n\t \r\n\t/**\r\n\t * Fired after loading content of tab item;\r\n\t * Pattern: \r\n\t *   function(contentId, itemCfg){}\r\n\t *   //contentId: {String} the content element's id.\r\n\t *   //itemCfg: {Plan Object} tab item config\r\n\t *   \r\n\t * @param {Function or undefined} onContentLoading after loading tab panel content handler.\r\n\t * @return {this or Function} \r\n\t */\r\n\tonContentLoaded: function(onContentLoaded) {\r\n\t\tif(onContentLoaded === undefined) {\r\n\t\t\treturn this._onContentLoaded;\r\n\t\t}\r\n\t\tjslet.Checker.test('TabControl.onContentLoaded', onContentLoaded).isFunction();\r\n\t\tthis._onContentLoaded = onContentLoaded;\r\n\t},\r\n\t \r\n\t/**\r\n\t * Get or set tab item configuration.\r\n\t * \r\n\t * @param {jslet.ui.TabItem[] or undefined} items tab items.\r\n\t * @return {this or jslet.ui.TabItem[]}\r\n\t */\r\n\titems: function(items) {\r\n\t\tif(items === undefined) {\r\n\t\t\treturn this._items;\r\n\t\t}\r\n\t\tjslet.Checker.test('TabControl.items', items).isArray();\r\n\t\tvar item;\r\n\t\tfor(var i = 0, len = items.length; i < len; i++) {\r\n\t\t\titem = items[i];\r\n\t\t\tjslet.Checker.test('TabControl.items.header', item.header).isString().required();\r\n\t\t}\r\n\t\tthis._items = items;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tthis.renderAll();\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tvar Z = this;\r\n\t\tZ._createContextMenu();\r\n\r\n\t\tvar\ttemplate = [\r\n\t\t\t'<div class=\"jl-tab-header jl-unselectable\"><div class=\"jl-tab-container jl-unselectable\"><ul class=\"jl-tab-list\">',\r\n\t\t\tZ._newable ? '<li><a href=\"javascript:;\" class=\"jl-tab-inner\"><span class=\"jl-tab-new\">+</span></a></li>' : '',\r\n\t\t\t'</ul></div><a class=\"jl-tab-left jl-hidden\"><span class=\"jl-nav-btn fa fa-arrow-circle-left\"></span></a><a class=\"jl-tab-right jl-hidden\"><span class=\"jl-nav-btn fa fa-arrow-circle-right\"></span></a></div>',\r\n\t\t\t'<div class=\"jl-tab-panels jl-round5\"></div>'];\r\n\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tif (!jqEl.hasClass('jl-tabcontrol'))\r\n\t\t\tjqEl.addClass('jl-tabcontrol jl-round5');\r\n\t\tjqEl.html(template.join(''));\r\n\t\tif (Z._newable) {\r\n\t\t\tvar oul = jqEl.find('.jl-tab-list')[0];\r\n\t\t\tvar newTab = oul.childNodes[oul.childNodes.length - 1];\r\n\t\t\tZ._newTabItem = newTab;\r\n\t\t\t\r\n\t\t\tnewTab.onclick = function () {\r\n\t\t\t\tvar itemCfg = null;\r\n\t\t\t\tif (Z._onAddTabItem) {\r\n\t\t\t\t\titemCfg = Z._onAddTabItem.call(Z);\r\n\t\t\t\t}\r\n\t\t\t\tif (!itemCfg) {\r\n\t\t\t\t\titemCfg = new jslet.ui.TabItem();\r\n\t\t\t\t\titemCfg.header = jslet.locale.TabControl.newTab;\r\n\t\t\t\t\titemCfg.closable = true;\r\n\t\t\t\t}\r\n\t\t\t\tZ.addTabItem(itemCfg);\r\n\t\t\t\tZ._calcItemsWidth();\r\n\t\t\t\tZ.activeIndex(Z._items.length - 1);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tvar jqNavBtn = jqEl.find('.jl-tab-left');\r\n\t\t\r\n\t\tjqNavBtn.on(\"click\",function (event) {\r\n\t\t\tZ._setVisiTabItems(Z._leftIndex - 1);\r\n\t\t\tevent.stopImmediatePropagation();\r\n\t\t\tevent.preventDefault();\r\n\t\t\treturn false;\r\n\t\t});\r\n\t\tjqNavBtn.on(\"mousedown\",function (event) {\r\n\t\t\tevent.stopImmediatePropagation();\r\n\t\t\tevent.preventDefault();\r\n\t\t\treturn false;\r\n\t\t});\r\n\t\tjqNavBtn = jqEl.find('.jl-tab-right');\r\n\r\n\t\tjqNavBtn.on(\"click\",function (event) {\r\n\t\t\tZ._setVisiTabItems(Z._leftIndex + 1);\r\n\t\t\tevent.stopImmediatePropagation();\r\n\t\t\tevent.preventDefault();\r\n\t\t\treturn false;\r\n\t\t});\r\n\t\tjqNavBtn.on(\"mousedown\",function (event) {\r\n\t\t\tevent.stopImmediatePropagation();\r\n\t\t\tevent.preventDefault();\r\n\t\t\treturn false;\r\n\t\t});\r\n\t\t\r\n\t\tif (Z._items && Z._items.length > 0) {\r\n\t\t\tvar oitem, \r\n\t\t\t\tcnt = Z._items.length;\r\n\t\t\tfor (var i = 0; i < cnt; i++) {\r\n\t\t\t\toitem = Z._items[i];\r\n\t\t\t\tZ._renderTabItem(oitem);\r\n\t\t\t}\r\n\t\t\tZ._activeIndex = 0;\r\n\t\t}\r\n\t\tZ._calcItemsWidth();\r\n\t\tZ._ready = true;\r\n\t\tZ._chgActiveIndex(Z._activeIndex);\r\n\t},\r\n\r\n\taddItem: function (itemCfg) {\r\n\t\tthis._items[this._items.length] = itemCfg;\r\n\t},\r\n\r\n\t/**\r\n\t * Change tab item's header\r\n\t * \r\n\t * @param {Integer} index - tab item index.\r\n\t * @param {String} header - tab item header.\r\n\t */\r\n\ttabHeader: function(index, header) {\r\n\t\tjslet.Checker.test('tabHeader#index', index).isGTEZero();\r\n\t\tjslet.Checker.test('tabHeader#label', header).required().isString();\r\n\t\t\r\n\t\tvar Z = this;\r\n\t\tvar itemCfg = Z._getTabItemCfg(index);\r\n\t\tif(!itemCfg) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\titemCfg.header = header;\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tvar panelContainer = jqEl.find('.jl-tab-list')[0];\r\n\t\tvar nodes = panelContainer.childNodes;\r\n\t\tjQuery(nodes[index]).find('.jl-tab-title').html(header);\r\n\t\tZ._calcItemsWidth();\r\n\t},\r\n\t\r\n\t/**\r\n\t * Disable tab item.\r\n\t * \r\n\t * @param {Integer} index - tab item index.\r\n\t * @param {Boolean} disabled - true - disabled, false - otherwise.\r\n\t */\r\n\ttabDisabled: function(index, disabled) {\r\n\t\tjslet.Checker.test('tabDisabled#index', index).isGTEZero();\r\n\t\tvar Z = this;\r\n\t\tvar itemCfg = Z._getTabItemCfg(index);\r\n\t\tif(!itemCfg) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(index == Z._activeIndex) {\r\n\t\t\tconsole.warn('Cannot set current tab item to disabled.');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\titemCfg.disabled(disabled);\r\n\t\tvar jqEl = jQuery(Z.el),\r\n\t\t\tjqPanels = jqEl.find('.jl-tab-panels'),\r\n\t\t\tpanelContainer = jqPanels[0],\r\n\t\t\tnodes = panelContainer.childNodes,\r\n\t\t\tjqItem = jQuery(nodes[index]);\r\n\t\tif(disabled) {\r\n\t\t\tjqItem.addClass('jl-tab-disabled');\r\n\t\t} else {\r\n\t\t\tjqItem.removeClass('jl-tab-disabled');\r\n\t\t}\r\n\t},\r\n\t\r\n\t_checkTabItemCount: function() {\r\n\t\tvar Z = this,\r\n\t\t\tjqTabPanels = jQuery(Z.el).find('.jl-tab-panels');\r\n\t\tif(!Z._items || Z._items.length === 0) {\r\n\t\t\tif(!jqTabPanels.hasClass('jl-hidden')) {\r\n\t\t\t\tjqTabPanels.addClass('jl-hidden');\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tjqTabPanels.removeClass('jl-hidden');\r\n\r\n\t\t} \r\n\t},\r\n\t\r\n\t/**\r\n\t * Change active tab item.\r\n\t * \r\n\t * @param {Integer} index Tab item index which will be toggled to.\r\n\t */\r\n\t_chgActiveIndex: function (index) {\r\n\t\tvar Z = this;\r\n\t\r\n\t\tvar itemCfg = Z._getTabItemCfg(index);\r\n\t\tif(!itemCfg || itemCfg.disabled) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (Z._onActiveIndexChanged) {\r\n\t\t\tvar canChanged = Z._onActiveIndexChanged.call(Z, Z._activeIndex, index);\r\n\t\t\tif (canChanged !== undefined && !canChanged) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tvar jqEl = jQuery(Z.el),\r\n\t\t\toli, \r\n\t\t\toul = jqEl.find('.jl-tab-list')[0],\r\n\t\t\tnodes = oul.childNodes,\r\n\t\t\tcnt = nodes.length - (Z._newable ? 2 : 1);\r\n\r\n\t\tvar itemContainer = jqEl.find('.jl-tab-panels')[0],\r\n\t\t\titem, \r\n\t\t\titems = itemContainer.childNodes;\r\n\t\tfor (var i = 0; i <= cnt; i++) {\r\n\t\t\toli = jQuery(nodes[i]);\r\n\t\t\titem = items[i];\r\n\t\t\tif (i == index) {\r\n\t\t\t\toli.addClass('jl-tab-active');\r\n\t\t\t\titem.style.display = 'block';\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\toli.removeClass('jl-tab-active');\r\n\t\t\t\titem.style.display = 'none';\r\n\t\t\t}\r\n\t\t}\r\n\t\tZ._activeIndex = index;\r\n\t\tif(index < Z._leftIndex || index >= Z._rightIndex) {\r\n\t\t\tZ._setVisiTabItems(null, Z._activeIndex);\r\n\t\t}\r\n\t},\r\n\t\r\n\t_getTabItemCfg: function(index) {\r\n\t\tvar Z = this;\r\n\t\tif(Z._items.length <= index) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn Z._items[index];\r\n\t},\r\n\t\r\n\t_calcItemsWidth: function() {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl =jQuery(Z.el),\r\n\t\t\tnodes = jqEl.find('.jl-tab-list').children();\r\n\t\tZ._itemsWidth = [];\r\n\t\tZ._totalItemsWidth = 0;\r\n\t\tnodes.each(function(index){\r\n\t\t\tvar w = jQuery(this).outerWidth() + 5;\r\n\t\t\tZ._itemsWidth[index] = w;\r\n\t\t\tZ._totalItemsWidth += w;\r\n\t\t});\r\n\r\n\t\tZ._containerWidth = jqEl.find('.jl-tab-container').innerWidth();\r\n\t\tZ._setNavBtnVisible();\r\n\t},\r\n\t\r\n\t_setVisiTabItems: function(leftIndex, rightIndex) {\r\n\t\tvar Z = this, w, i, len;\r\n\t\tif(!leftIndex && leftIndex !== 0) {\r\n\t\t\tif(!rightIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif(Z._newable) {\r\n\t\t\t\trightIndex++;\r\n\t\t\t}\r\n\t\t\tw = Z._itemsWidth[rightIndex];\r\n\t\t\tZ._leftIndex = rightIndex;\r\n\t\t\tfor(i = rightIndex - 1; i >= 0; i--) {\r\n\t\t\t\tw += Z._itemsWidth[i];\r\n\t\t\t\tif(w > Z._containerWidth) {\r\n\t\t\t\t\tZ._leftIndex = i + 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tZ._leftIndex = i;\r\n\t\t\t}\r\n\t\t\tleftIndex = Z._leftIndex;\r\n\t\t} else {\r\n\t\t\tZ._leftIndex = leftIndex;\r\n\t\t}\r\n\t\tw = 0;\r\n\t\tZ._rightIndex = leftIndex;\r\n\t\tfor(i = leftIndex, len = Z._itemsWidth.length; i < len; i++) {\r\n\t\t\tw += Z._itemsWidth[i];\r\n\t\t\tif(w > Z._containerWidth) {\r\n\t\t\t\tZ._rightIndex = i - 1;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tZ._rightIndex = i;\r\n\t\t}\r\n\t\tvar leftPos = 0;\r\n\t\tfor(i = 0; i < Z._leftIndex; i++) {\r\n\t\t\tleftPos += Z._itemsWidth[i];\r\n\t\t}\r\n\t\tleftPos += 5;\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tjqEl.find('.jl-tab-container').scrollLeft(jslet.locale.isRtl ? 50000 - leftPos: leftPos);\r\n\t\tZ._setNavBtnVisible();\r\n\t},\r\n\t\r\n\t_setNavBtnVisible: function() {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\tjqBtnLeft = jqEl.find('.jl-tab-left'),\r\n\t\t\tisHidden = jqBtnLeft.hasClass('jl-hidden');\r\n\t\tif(Z._leftIndex > 0 && Z._totalItemsWidth > Z._containerWidth) {\r\n\t\t\tif(isHidden) {\r\n\t\t\t\tjqBtnLeft.removeClass('jl-hidden');\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif(!isHidden) {\r\n\t\t\t\tjqBtnLeft.addClass('jl-hidden');\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar jqBtnRight = jqEl.find('.jl-tab-right');\r\n\t\tvar totalCnt = Z._itemsWidth.length;\r\n\t\tisHidden = jqBtnRight.hasClass('jl-hidden');\r\n\t\tif(Z._rightIndex < totalCnt - 1 && Z._totalItemsWidth > Z._containerWidth) {\r\n\t\t\tif(isHidden) {\r\n\t\t\t\tjqBtnRight.removeClass('jl-hidden');\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif(!isHidden) {\r\n\t\t\t\tjqBtnRight.addClass('jl-hidden');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\t_createHeader: function (parent, itemCfg) {\r\n\t\tvar Z = this,\r\n\t\t\tcanClose = Z._closable && itemCfg.closable,\r\n\t\t\ttmpl = ['<a href=\"javascript:;\" class=\"jl-tab-inner' + (canClose? ' jl-tab-close-loc': '') + \r\n\t\t\t        '\" onclick=\"javascript:this.blur();\" title=\"' + itemCfg.header + '\"><span class=\"jl-tab-title '];\r\n\r\n\t\ttmpl.push('\">');\r\n\t\ttmpl.push(itemCfg.header);\r\n\t\ttmpl.push('</span>');\r\n\t\ttmpl.push('<span class=\"fa fa-times close jl-tab-close' + (!canClose || itemCfg.disabled? ' jl-hidden': '') + '\"></span><span style=\"clear:both\"></span>');\r\n\t\ttmpl.push('</a>');\r\n\t\tvar oli = document.createElement('li');\r\n\t\tif(itemCfg.disabled) {\r\n\t\t\tjQuery(oli).addClass('jl-tab-disabled');\r\n\t\t}\r\n\t\toli.innerHTML = tmpl.join('');\r\n\r\n\t\tif (Z._newable) {\r\n\t\t\tvar lastNode = parent.childNodes[parent.childNodes.length - 1];\r\n\t\t\tparent.insertBefore(oli, lastNode);\r\n\t\t} else {\r\n\t\t\tparent.appendChild(oli);\r\n\t\t}\r\n\t\toli.jslet = Z;\r\n\t\tjQuery(oli).on('click', Z._changeTabItem);\r\n\r\n\t\tif (canClose) {\r\n\t\t\tjQuery(oli).find('.jl-tab-close').click(Z._doCloseBtnClick);\r\n\t\t}\r\n\t\tif(Z.contextMenu && !itemCfg.disabled) {\r\n\t\t\toli.oncontextmenu = function (event) {\r\n\t\t\t\tvar k = 0;\r\n\t\t\t\tvar items = jQuery(Z.el).find('.jl-tab-list li').each(function() {\r\n\t\t\t\t\tif(this === event.currentTarget) {\r\n\t\t\t\t\t\tZ._contextItemIndex = k;\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tk++;\r\n\t\t\t\t});\r\n\t\t\t\tZ.contextMenu.showContextMenu(event, Z);\r\n\t\t\t};\r\n\t\t}\r\n\t},\r\n\r\n\t_changeTabItem: function (event) {\r\n\t\tvar nodes = this.parentNode.childNodes,\r\n\t\t\tindex = -1;\r\n\t\tfor (var i = 0; i < nodes.length; i++) {\r\n\t\t\tif (nodes[i] == this) {\r\n\t\t\t\tindex = i;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.jslet._chgActiveIndex(index);\r\n\t},\r\n\r\n\t_doCloseBtnClick: function (event) {\r\n\t\tvar oli = this.parentNode.parentNode,\r\n\t\t\tnodes = oli.parentNode.childNodes,\r\n\t\t\tindex = -1;\r\n\t\tfor (var i = 0; i < nodes.length; i++) {\r\n\t\t\tif (nodes[i] == oli) {\r\n\t\t\t\tindex = i;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\toli.jslet.removeTabItem(index);\r\n\t\tevent.preventDefault();\r\n\t\treturn false;\r\n\t},\r\n\r\n\t_createBody: function (parent, itemCfg) {\r\n\t\tvar Z = this,\r\n\t\t\tjqDiv = jQuery(document.createElement('div'));\r\n\t\tif (!jqDiv.hasClass('jl-tab-panel')) {\r\n\t\t\tjqDiv.addClass('jl-tab-panel');\r\n\t\t}\r\n\t\tvar odiv = jqDiv[0];\r\n\t\tparent.appendChild(odiv);\r\n\t\tvar padding = 4,\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\tjqHead = jqEl.find('.jl-tab-header'),\r\n\t\t\th = itemCfg.height;\r\n\t\th = h ? h: '100%';\r\n\r\n\t\tif (itemCfg.content || itemCfg.contentId) {\r\n\t\t\tvar ocontent = itemCfg.content ? itemCfg.content : jQuery('#'+itemCfg.contentId)[0];\r\n\t\t\tif (ocontent) {\r\n\t\t\t\tvar pNode = ocontent.parentNode;\r\n\t\t\t\tif (pNode && pNode != odiv) {\r\n\t\t\t\t\tpNode.removeChild(ocontent);\r\n\t\t\t\t}\r\n\t\t\t\todiv.appendChild(ocontent);\r\n\t\t\t\tocontent.style.display = 'block';\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar url = itemCfg.url;\r\n\t\tif (url) {\r\n\t\t\turl = url + (url.indexOf('?') >= 0 ? '&': '?') + 'jlTabItemId=' + itemCfg.id;\r\n\t\t\tif (itemCfg.useIFrame || itemCfg.useIFrame === undefined) {\r\n\t\t\t\tvar id = jslet.nextId(); \r\n\t\t\t\tvar s = '<iframe id=\"' + id + '\"scrolling=\"yes\" frameborder=\"0\" allowtransparency=\"true\" src=\"' + \r\n\t\t\t\t\turl + \r\n\t\t\t\t'\" style=\"width: 100%;height:' + h  + ';background-color:transparent\"></iframe>';\r\n\t\t\t\tjqDiv.html(s);\r\n\t\t\t\titemCfg.contentId = id;\r\n\t\t\t\tif(Z._onContentLoading) {\r\n\t\t\t\t\tZ._onContentLoading.call(Z, id, itemCfg);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Add tab item dynamically.\r\n\t * \r\n\t * @param {Object} newItemCfg Tab item configuration\r\n\t * @param {Boolean} noDuplicate Identify if the same \"tabItem.id\" can be added or not, default is true. \r\n\t */\r\n\taddTabItem: function (newItemCfg, noDuplicate) {\r\n\t\tvar Z = this,\r\n\t\t\ttabItems = Z._items,\r\n\t\t\tnewId = newItemCfg.id;\r\n\t\tif(!newId) {\r\n\t\t\tnewId = jslet.nextId();\r\n\t\t\tnewItemCfg.id = newId;\r\n\t\t}\r\n\t\tvar itemCfg;\r\n\t\tif((noDuplicate === undefined || noDuplicate) && newId) {\r\n\t\t\tfor(var i = 0, len = tabItems.length; i < len; i++) {\r\n\t\t\t\titemCfg = tabItems[i];\r\n\t\t\t\tif(newId === itemCfg.id) {\r\n\t\t\t\t\tif(itemCfg.url !== newItemCfg.url) {\r\n\t\t\t\t\t\titemCfg.url = newItemCfg.url;\r\n\t\t\t\t\t\tZ.reloadTabItem(itemCfg);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tZ.activeIndex(i);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\ttabItems.push(newItemCfg);\r\n\t\tZ._renderTabItem(newItemCfg);\r\n\t\tZ._calcItemsWidth();\r\n\t\tZ._chgActiveIndex(tabItems.length - 1);\r\n\t\tZ._checkTabItemCount();\r\n\t},\r\n\r\n\t/**\r\n\t * set the specified tab item to loaded state. It will fire the \"onContentLoaded\" event.\r\n\t * \r\n\t * @param {String} tabItemId - tab item id.\r\n\t */\r\n\tsetContentLoadedState: function(tabItemId) {\r\n\t\tvar Z = this;\r\n\t\tif(!Z._onContentLoaded) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar\ttabItems = Z._items,\r\n\t\t\tcontentId = null,\r\n\t\t\titemCfg;\r\n\t\tfor(var i = 0, len = tabItems.length; i < len; i++) {\r\n\t\t\titemCfg = tabItems[i];\r\n\t\t\tif(tabItemId === itemCfg.id) {\r\n\t\t\t\tcontentId = itemCfg.contentId;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(!contentId) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tZ._onContentLoaded.call(Z, contentId, itemCfg);\r\n\t},\r\n\t\r\n\t/**\r\n\t * Set tab item to changed state or not.\r\n\t * \r\n\t * @param {String} tabItemId - tab item id.\r\n\t * @param {Boolean} changed - changed state.\r\n\t */\r\n\tsetContentChangedState: function(tabItemId, changed) {\r\n\t\tvar Z = this,\r\n\t\t\ttabItems = Z._items,\r\n\t\t\titemCfg,\r\n\t\t\tidx = -1;\r\n\t\tfor(var i = 0, len = tabItems.length; i < len; i++) {\r\n\t\t\titemCfg = tabItems[i];\r\n\t\t\tif(tabItemId === itemCfg.id) {\r\n\t\t\t\tidx = i;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(idx < 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\titemCfg.changed = changed;\r\n\t\tvar header = itemCfg.header,\r\n\t\t\thasChangedFlag = (header.charAt(0) === '*');\r\n\t\tif(changed) {\r\n\t\t\tif(!hasChangedFlag) {\r\n\t\t\t\theader = '*' + header;\r\n\t\t\t\tZ.tabHeader(idx, header);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif(hasChangedFlag) {\r\n\t\t\t\theader = header.substring(1);\r\n\t\t\t\tZ.tabHeader(idx, header);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify which exists changed tab item or not.\r\n\t */\r\n\thasChanged: function() {\r\n\t\tvar Z = this,\r\n\t\t\ttabItems = Z._items,\r\n\t\t\titemCfg,\r\n\t\t\tidx = -1;\r\n\t\tfor(var i = 0, len = tabItems.length; i < len; i++) {\r\n\t\t\titemCfg = tabItems[i];\r\n\t\t\tif(itemCfg.changed) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\t\r\n\t_renderTabItem: function(itemCfg) {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\toul = jqEl.find('.jl-tab-list')[0],\r\n\t\t\tpanelContainer = jqEl.find('.jl-tab-panels')[0];\r\n\t\tif(!itemCfg.id) {\r\n\t\t\titemCfg.id = jslet.nextId();\r\n\t\t}\r\n\t\tZ._createHeader(oul, itemCfg);\r\n\t\tZ._createBody(panelContainer, itemCfg);\r\n\t},\r\n\t\r\n\t/**\r\n\t * Remove tab item with tabItemIndex\r\n\t * \r\n\t * @param {Integer} tabItemIndex Tab item index\r\n\t */\r\n\tremoveTabItem: function (tabItemIndex, isBatch) {\r\n\t\tvar Z = this;\r\n\t\tif (tabItemIndex >= Z._items.length || tabItemIndex < 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar itemCfg = Z._items[tabItemIndex];\r\n\t\tif(itemCfg.changed) {\r\n            jslet.ui.MessageBox.confirm(jslet.locale.TabControl.contentChanged, jslet.locale.MessageBox.confirm, function(button){\r\n\t\t\t\tif(button === 'ok') {\r\n\t\t\t\t\tZ._innerRemoveTabItem(tabItemIndex, isBatch);\r\n\t\t\t\t}\r\n            });\r\n\t\t} else {\r\n\t\t\tZ._innerRemoveTabItem(tabItemIndex, isBatch);\r\n\t\t}\r\n\t},\r\n\r\n\t_innerRemoveTabItem: function (tabItemIndex, isBatch) {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\toul = jqEl.find('.jl-tab-list')[0],\r\n\t\t\tnodes = oul.childNodes,\r\n\t\t\tcnt = nodes.length - (Z._newable ? 2 : 1),\r\n\t\t\toli = jQuery(nodes[tabItemIndex]);\r\n\t\tvar active = oli.hasClass('jl-tab-active');\r\n\t\tif (Z._onRemoveTabItem) {\r\n\t\t\tvar canRemoved = Z._onRemoveTabItem.call(Z, Z._items[tabItemIndex], active);\r\n\t\t\tif (!canRemoved) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\toli.find('.jl-tab-close').hide();\r\n\t\toli.animate({width:'toggle'},200, function() {\r\n\t\t\tvar elItem = oli[0]; \r\n\t\t\telItem.oncontextmenu = null;\r\n\t\t\toul.removeChild(elItem);\r\n\t\t\tZ._items.splice(tabItemIndex, 1);\r\n\t\t\tvar panelContainer = jqEl.find('.jl-tab-panels')[0];\r\n\t\t\tnodes = panelContainer.childNodes;\r\n\t\t\tvar tabPanel = nodes[tabItemIndex];\r\n\t\t\tpanelContainer.removeChild(tabPanel);\r\n\t\t\tif(!isBatch) {\r\n\t\t\t\tZ._calcItemsWidth();\r\n\t\t\t\tZ._checkTabItemCount();\r\n\t\t\t}\r\n\t\t\tif (active) {\r\n\t\t\t\ttabItemIndex = Z._getNextValidIndex(tabItemIndex, tabItemIndex >= cnt);\r\n\t\t\t\tif (tabItemIndex >= 0) {\r\n\t\t\t\t\tZ._chgActiveIndex(tabItemIndex);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tZ._activeIndex = -1;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif(Z._activeIndex > tabItemIndex) {\r\n\t\t\t\t\tZ._activeIndex--;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\t_getNextValidIndex: function(start, isLeft) {\r\n\t\tvar Z = this, i, len;\r\n\t\tif(isLeft) {\r\n\t\t\tfor(i = start - 1; i >= 0; i--) {\r\n\t\t\t\tif(!Z._items[i].disabled) {\r\n\t\t\t\t\treturn i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tfor(i = start, len = Z._items.length; i < len; i++) {\r\n\t\t\t\tif(!Z._items[i].disabled) {\r\n\t\t\t\t\treturn i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Reload the active tab panel.\r\n\t */\r\n\treload: function() {\r\n\t\tvar Z = this,\r\n\t\t\tcurrIdx = Z._contextItemIndex,\r\n\t\t\titemCfg = Z._items[currIdx];\r\n\t\tZ.reloadTabItem(itemCfg);\r\n\t},\r\n\t\r\n\treloadTabItem: function(itemCfg) {\r\n\t\tvar Z = this;\r\n\t\tif(!itemCfg) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar contentId = itemCfg.contentId;\r\n\t\tif(contentId) {\r\n\t\t\tvar jqFrame = jQuery('#' + contentId);\r\n\t\t\tif(Z._onContentLoading) {\r\n\t\t\t\tZ._onContentLoading.call(Z, jqFrame.attr('id'), itemCfg);\r\n\t\t\t}\r\n\t\t\tvar url = itemCfg.url;\r\n\t\t\turl = url + (url.indexOf('?') >= 0 ? '&': '?') + 'jlTabItemId=' + itemCfg.id;\r\n\t\t\tjqFrame.attr('src', url);\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * Close the current active tab item  if this tab item is closable.\r\n\t */\r\n\tclose: function (tabItemIndex) {\r\n\t\tvar Z = this;\r\n\t\tif(tabItemIndex === undefined) {\r\n\t\t\ttabItemIndex = Z._activeIndex;\r\n\t\t}\r\n\t\tvar itemCfg = Z._items[tabItemIndex];\r\n\t\tif (itemCfg && tabItemIndex >= 0 && itemCfg.closable && !itemCfg.disabled) {\r\n\t\t\tZ.removeTabItem(tabItemIndex);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Close all closable tab item except current active tab item.\r\n\t */\r\n\tcloseOther: function () {\r\n\t\tvar Z = this, oitem;\r\n\t\tfor (var i = Z._items.length - 1; i >= 0; i--) {\r\n\t\t\toitem = Z._items[i];\r\n\t\t\tif (oitem.closable && !oitem.disabled) {\r\n\t\t\t\tif (Z._contextItemIndex == i) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tZ.removeTabItem(i, true);\r\n\t\t\t}\r\n\t\t}\r\n\t\tZ._calcItemsWidth();\r\n\t\tZ._checkTabItemCount();\r\n\t},\r\n\t\r\n\t/**\r\n\t * Close all closable tab item.\r\n\t */\r\n\tcloseAll: function() {\r\n\t\tvar Z = this, oitem;\r\n\t\tfor (var i = Z._items.length - 1; i >= 0; i--) {\r\n\t\t\toitem = Z._items[i];\r\n\t\t\tif (oitem.closable && !oitem.disabled) {\r\n\t\t\t\tZ.removeTabItem(i, true);\r\n\t\t\t}\r\n\t\t}\r\n\t\tZ._calcItemsWidth();\r\n\t\tZ._checkTabItemCount();\r\n\t},\r\n\t\r\n\t/**\r\n\t * Run when container size changed, it's revoked by jslet.resizeeventbus.\r\n\t * \r\n\t */\r\n\tcheckSizeChanged: function(){\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\tcurrWidth = jqEl.width(),\r\n\t\t\tcurrHeight = jqEl.height();\r\n\t\tif ( Z._tabControlWidth != currWidth){\r\n\t\t\tZ._tabControlWidth = currWidth;\r\n\t\t\tZ._calcItemsWidth();\r\n\t\t\tZ._setVisiTabItems(Z._leftIndex);\r\n\t\t}\r\n\t},\r\n\t\r\n\t_createContextMenu: function () {\r\n\t\tvar Z = this;\r\n\t\tZ.contextMenu = null;\r\n\t\tif (!jslet.ui.Menu || !Z._closable) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar menuCfg = { type: 'Menu', onItemClick: Z._menuItemClick, items: [\r\n   \t\t\t{ id: 'reload', name: jslet.locale.TabControl.reload},\r\n\t\t\t{ id: 'close', name: jslet.locale.TabControl.close},\r\n\t\t\t{ id: 'closeOther', name: jslet.locale.TabControl.closeOther},\r\n\t\t\t{ id: 'closeAll', name: jslet.locale.TabControl.closeAll}]\r\n\t\t\t};\r\n\t\tif (Z._onCreateContextMenu) {\r\n\t\t\tZ._onCreateContextMenu.call(Z, menuCfg.items);\r\n\t\t}\r\n\r\n\t\tif (menuCfg.items.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tZ.contextMenu = jslet.ui.createControl(menuCfg);\r\n\t},\r\n\r\n\t_menuItemClick: function (menuId, checked) {\r\n\t\tif(menuId === 'reload') {\r\n\t\t\tthis.reload();\r\n\t\t} else if (menuId === 'close') {\r\n\t\t\tthis.close(this._contextItemIndex);\r\n\t\t} else if (menuId === 'closeOther') {\r\n\t\t\tthis.closeOther();\r\n\t\t} else if (menuId === 'closeAll') {\r\n\t\t\tthis.closeAll();\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tvar Z = this;\r\n\t\tif(Z._newTabItem) {\r\n\t\t\tZ._newTabItem.onclick = null;\r\n\t\t\tZ._newTabItem = null;\r\n\t\t}\r\n\t\tvar jqEl = jQuery(Z.el), \r\n\t\t\thead = jqEl.find('.jl-tab-header')[0];\r\n\t\t\r\n\t\tjqEl.find('.jl-tab-left').off();\r\n\t\tjqEl.find('.jl-tab-right').off();\r\n\t\thead.oncontextmenu = null;\r\n\t\tjqEl.find('.jl-tab-close').off();\r\n\t\tvar items = jqEl.find('.jl-tab-list').find('li');\r\n\t\titems.off();\r\n\t\titems.each(function(){\r\n\t\t\tthis.jslet = null;\r\n\t\t});\r\n\t\tjslet.resizeEventBus.unsubscribe(this);\r\n\r\n\t\t$super();\r\n\t}\r\n});\r\n\r\njslet.ui.register('TabControl', jslet.ui.TabControl);\r\njslet.ui.TabControl.htmlTemplate = '<div></div>';\r\n\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n* @class TipPanel. Example:\r\n* <pre><code>\r\n*   var tipPnl = new jslet.ui.TipPanel();\r\n*   tipPnl.show('Hello world', 10, 10);\r\n* </code></pre>\r\n*/\r\n\"use strict\";\r\njslet.ui.TipPanel = function () {\r\n\tthis._hideTimerId = null;\r\n\tthis._showTimerId = null;\r\n\tthis._oldElement = null;\r\n\tvar p = document.createElement('div');\r\n\tjQuery(p).addClass('jl-tip-panel');\r\n\tdocument.body.appendChild(p);\r\n\tthis._tipPanel = p;\r\n\r\n\t/**\r\n\t * Show tips at specified position. Example:\r\n\t * <pre><code>\r\n\t *  tipPnl.show('foo...', event);\r\n\t *  tipPnl.show('foo...', 100, 200);\r\n\t * </code></pre>\r\n\t * \r\n\t * @param {String} tips Tips text\r\n\t * @param {Integer or Event} left Position left, if left is mouse event, then top argument can't be specified\r\n\t * @param {Integer} top Position top\r\n\t */\r\n\tthis.show = function (tips, leftOrEvent, top) {\r\n\t\tvar Z = this;\r\n\t\tvar len = arguments.length;\r\n\t\tvar isSameCtrl = false, left = leftOrEvent;\r\n\t\tif (len == 2) { //this.show(tips)\r\n\t\t\tvar evt = left;\r\n\t\t\tevt = jQuery.event.fix( evt );\r\n\r\n\t\t\ttop = evt.pageY + 16; left = evt.pageX + 2;\r\n\t\t\tvar ele = evt.currentTarget;\r\n\t\t\tisSameCtrl = (ele === Z._oldElement);\r\n\t\t\tZ._oldElement = ele;\r\n\t\t} else {\r\n\t\t\tleft = parseInt(left);\r\n\t\t\ttop = parseInt(top);\r\n\t\t}\r\n\r\n\t\tif (Z._hideTimerId) {\r\n\t\t\twindow.clearTimeout(Z._hideTimerId);\r\n\t\t\tif (isSameCtrl) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._showTimerId = window.setTimeout(function () {\r\n\t\t\tvar p = Z._tipPanel;\r\n\t\t\tp.innerHTML = tips;\r\n\t\t\tp.style.left = left + 'px';\r\n\t\t\tp.style.top = top + 'px';\r\n\t\t\tZ._tipPanel.style.display = 'block';\r\n\t\t\tZ._showTimerId = null;\r\n\t\t}, 300);\r\n\t};\r\n\r\n\t/**\r\n\t * Hide tip panel\r\n\t */\r\n\tthis.hide = function () {\r\n\t\tvar Z = this;\r\n\t\tif (Z._showTimerId) {\r\n\t\t\twindow.clearTimeout(Z._showTimerId);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tZ._hideTimerId = window.setTimeout(function () {\r\n\t\t\tZ._tipPanel.style.display = 'none';\r\n\t\t\tZ._hideTimerId = null;\r\n\t\t\tZ._oldElement = null;\r\n\t\t}, 300);\r\n\t};\r\n};\r\n\r\n/**\r\n * Global tip panel\r\n */\r\njslet.ui.globalTip = new jslet.ui.TipPanel();\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class WaitingBox. Example:\r\n * <pre><code>\r\n *   var wb = new jslet.ui.WaitingBox(document.getElementById(\"test\"), \"Gray\", true);\r\n *\twb.show(\"Please wait a moment...\");\r\n * \r\n * </code></pre>\r\n * @param {Html Element} container The container which waitingbox reside on.\r\n * @param {String} overlayColor Overlay color\r\n * @param {Boolean} tipsAtNewLine Tips is at new line or not. If false, tips and waiting icon is at the same line.\r\n */\r\n\"use strict\";\r\njslet.ui.WaitingBox = function (container, overlayColor, tipsAtNewLine) {\r\n\tvar overlay = new jslet.ui.OverlayPanel(container);\r\n\tvar s = '<div class=\"jl-waitingbox jl-round4\"><b class=\"jl-waitingbox-icon\"></b>';\r\n\t\ts += '<span class=\"jl-waitingbo-text\"></span></div>';\r\n\r\n\tjQuery(overlay.overlayPanel).html(s);\r\n\r\n\t/**\r\n\t * Show wating box\r\n\t * \r\n\t * @param {String} tips Tips\r\n\t */\r\n\tthis.show = function (tips) {\r\n\t\tvar p = overlay.overlayPanel,\r\n\t\t\tbox = p.firstChild,\r\n\t\t\ttipPanel = box.childNodes[1];\r\n\t\ttipPanel.innerHTML = tips ? tips : '';\r\n\t\tvar jqPnl = jQuery(p),\r\n\t\t\tph = jqPnl.height(),\r\n\t\t\tpw = jqPnl.width();\r\n\r\n\t\tsetTimeout(function () {\r\n\t\t\tvar jqBox = jQuery(box);\r\n\t\t\tbox.style.top = Math.round((ph - jqBox.height()) / 2) + 'px';\r\n\t\t\tbox.style.left = Math.round((pw - jqBox.width()) / 2) + 'px';\r\n\t\t}, 10);\r\n\r\n\t\toverlay.show();\r\n\t};\r\n\r\n\t/**\r\n\t * Hide waiting box\r\n\t */\r\n\tthis.hide = function () {\r\n\t\toverlay.hide();\r\n\t};\r\n\r\n\tthis.destroy = function () {\r\n\t\toverlay.overlayPanel.innerHTML = '';\r\n\t\toverlay.destroy();\r\n\t};\r\n};\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class Window, it has the following function: \r\n * 1. Show as modal or modeless;\r\n * 2. User can change window size;\r\n * 3. User can minimize/maximize/restore/close window;\r\n * 4. User can move window;\r\n * \r\n * Example:\r\n * <pre><code>\r\n\tvar oWin = jslet.ui.createControl({ type: \"Window\", iconClass:\"winicon\", caption: \"test window\", minimizable: false, maximizable:false,onActive: doWinActive, onPositionChanged: doPositionChanged });\r\n\toWin.setContent(\"Open modeless window in the Body(with icon)!\");\r\n\toWin.show(350,250);\r\n\t//or oWin.showModel(350, 250);\r\n\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.Window = jslet.Class.create(jslet.ui.Control, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.el = el;\r\n\t\tZ.allProperties = 'styleClass,caption,resizable,minimizable,maximizable,closable,iconClass,onSizeChanged,onClosed,onPositionChanged,onActive,width,height,minWidth,maxWidth,minHeight,maxHeight,isCenter,isSmallHeader,stopEventBubbling,animation';\r\n\r\n\t\tZ._caption = null;\r\n\t\t\r\n\t\tZ._resizable = true;\r\n\t\t\r\n\t\tZ._minimizable = true;\r\n\r\n\t\tZ._maximizable = true;\r\n\t\t\r\n\t\tZ._closable = true;\r\n\t\t\r\n\t\tZ._iconClass = null;\r\n\t\t\r\n\t\tZ._width = 0;\r\n\t\t\r\n\t\tZ._height = 0;\r\n\t\t\r\n\t\tZ._minWidth = 20;\r\n\t\t\r\n\t\tZ._minHeight = 30;\r\n\t\t\r\n\t\tZ._maxWidth = -1;\r\n\r\n\t\tZ._maxHeight = -1;\r\n\r\n\t\tZ._isCenter = false;\r\n \r\n\t\tZ._animation = 'linear';\r\n\t\t\r\n\t\tZ._onSizeChanged = null;\r\n\t\t\r\n\t\tZ._onPositionChanged = null;\r\n\t\t\r\n\t\tZ._onActive = null;\r\n\t\t\r\n\t\tZ._onClosed = null;\r\n\r\n\t\tZ._stopEventBubbling = false;\r\n\t\t\r\n\t\tZ._isModal = false;\r\n\t\t\r\n\t\tZ._state = null; \r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * Get or set window caption.\r\n\t * \r\n\t * @param {String or undefined} window caption.\r\n\t * @return {String or this}\r\n\t */\r\n\tcaption: function(caption) {\r\n\t\tif(caption === undefined) {\r\n\t\t\treturn this._caption;\r\n\t\t}\r\n\t\tjslet.Checker.test('Window.caption', caption).isString();\r\n\t\tthis._caption = caption;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Get or set the icon class of window header.\r\n\t * \r\n\t * @param {String or undefined} iconClass the icon of window header.\r\n\t * @return {String or this}\r\n\t */\r\n\ticonClass: function(iconClass) {\r\n\t\tif(iconClass === undefined) {\r\n\t\t\treturn this._iconClass;\r\n\t\t}\r\n\t\tjslet.Checker.test('Window.iconClass', iconClass).isString();\r\n\t\tthis._iconClass = iconClass;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify whether the window can be resized or not.\r\n\t * \r\n\t * @param {Boolean or undefined} resizable true - window can be resized, false otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\tresizable: function(resizable) {\r\n\t\tif(resizable === undefined) {\r\n\t\t\treturn this._resizable;\r\n\t\t}\r\n\t\tthis._resizable = resizable? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify whether the window can be minimized or not.\r\n\t * \r\n\t * @param {Boolean or undefined} minimizable true - window can be minimized, false - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\tminimizable: function(minimizable) {\r\n\t\tif(minimizable === undefined) {\r\n\t\t\treturn this._minimizable;\r\n\t\t}\r\n\t\tthis._minimizable = minimizable? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify whether the window can be maximized or not.\r\n\t * \r\n\t * @param {Boolean or undefined} maximizable true - window can be maximized, false - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\tmaximizable: function(maximizable) {\r\n\t\tif(maximizable === undefined) {\r\n\t\t\treturn this._maximizable;\r\n\t\t}\r\n\t\tthis._maximizable = maximizable? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify whether the window can be closed or not.\r\n\t * \r\n\t * @param {Boolean or undefined} closable true - window can be closed, false - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\tclosable: function(closable) {\r\n\t\tif(closable === undefined) {\r\n\t\t\treturn this._closable;\r\n\t\t}\r\n\t\tthis._closable = closable? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify whether the window is shown in center of container.\r\n\t * \r\n\t * @param {Boolean or undefined} isCenter true - window is shown in center of container, false - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\tisCenter: function(isCenter) {\r\n\t\tif(isCenter === undefined) {\r\n\t\t\treturn this._isCenter;\r\n\t\t}\r\n\t\tthis._isCenter = isCenter? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Animation effect for showing and hiding.\r\n\t * \r\n\t * @param {String or undefined} animation - Animation effect for showing and hiding, optional value: 'none', 'linear', 'slide', 'fade', default is 'linear'.\r\n\t * @return {String or this}\r\n\t */\r\n\tanimation: function(animation) {\r\n\t\tif(animation === undefined) {\r\n\t\t\treturn this._animation;\r\n\t\t}\r\n\t\tthis._animation = animation;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify whether stopping the event bubble.\r\n\t * \r\n\t * @param {Boolean or undefined} stopEventBubbling true - stop event bubbling, false - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\tstopEventBubbling: function(stopEventBubbling) {\r\n\t\tif(stopEventBubbling === undefined) {\r\n\t\t\treturn this._stopEventBubbling;\r\n\t\t}\r\n\t\tthis._stopEventBubbling = stopEventBubbling? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Get or set window width.\r\n\t * \r\n\t * @param {Integer or undefined} width window width.\r\n\t * @return {Integer or this}\r\n\t */\r\n\twidth: function(width) {\r\n\t\tif(width === undefined) {\r\n\t\t\treturn this._width;\r\n\t\t}\r\n\t\tjslet.Checker.test('Window.width', width).isGTZero();\r\n\t\tthis._width = width;\r\n\t},\r\n\r\n\t/**\r\n\t * Get or set window height.\r\n\t * \r\n\t * @param {Integer or undefined} height window height.\r\n\t * @return {Integer or this}\r\n\t */\r\n\theight: function(height) {\r\n\t\tif(height === undefined) {\r\n\t\t\treturn this._height;\r\n\t\t}\r\n\t\tjslet.Checker.test('Window.height', height).isGTZero();\r\n\t\tthis._height = height;\r\n\t},\r\n\r\n\t/**\r\n\t * Get or set window minimum width.\r\n\t * \r\n\t * @param {Integer or undefined} minWidth window minimum width.\r\n\t * @return {Integer or this}\r\n\t */\r\n\tminWidth: function(minWidth) {\r\n\t\tif(minWidth === undefined) {\r\n\t\t\treturn this._minWidth;\r\n\t\t}\r\n\t\tjslet.Checker.test('Window.minWidth', minWidth).isGTZero();\r\n\t\tif(minWidth < 20) {\r\n\t\t\tminWidth = 20;\r\n\t\t}\r\n\t\tthis._minWidth = minWidth;\r\n\t},\r\n\r\n\t/**\r\n\t * Get or set window minimum height.\r\n\t * \r\n\t * @param {Integer or undefined} minHeight window minimum height.\r\n\t * @return {Integer or this}\r\n\t */\r\n\tminHeight: function(minHeight) {\r\n\t\tif(minHeight === undefined) {\r\n\t\t\treturn this._minHeight;\r\n\t\t}\r\n\t\tjslet.Checker.test('Window.minHeight', minHeight).isGTZero();\r\n\t\tif(minHeight < 30) {\r\n\t\t\tminHeight = 30;\r\n\t\t}\r\n\t\tthis._minHeight = minHeight;\r\n\t},\r\n\r\n\t/**\r\n\t * Get or set window maximum width.\r\n\t * \r\n\t * @param {Integer or undefined} maxWidth window maximum width.\r\n\t * @return {Integer or this}\r\n\t */\r\n\tmaxWidth: function(maxWidth) {\r\n\t\tif(maxWidth === undefined) {\r\n\t\t\treturn this._maxWidth;\r\n\t\t}\r\n\t\tjslet.Checker.test('Window.maxWidth', maxWidth).isNumber();\r\n\t\tthis._maxWidth = maxWidth;\r\n\t},\r\n\r\n\t/**\r\n\t * Get or set window maximum height.\r\n\t * \r\n\t * @param {Integer or undefined} maxHeight window maximum height.\r\n\t * @return {Integer or this}\r\n\t */\r\n\tmaxHeight: function(maxHeight) {\r\n\t\tif(maxHeight === undefined) {\r\n\t\t\treturn this._maxHeight;\r\n\t\t}\r\n\t\tjslet.Checker.test('Window.maxHeight', maxHeight).isNumber();\r\n\t\tthis._maxHeight = maxHeight;\r\n\t},\r\n\r\n\t/**\r\n\t * Set or get window size changed event handler.\r\n\t * Pattern:\r\n\t *   function(width, height){}\r\n\t *   //width: Integer Window width\r\n\t *   //height: Integer Window height\r\n\t * \r\n\t * @param {Function or undefined} onSizeChanged window size changed event handler\r\n\t * @return {Function or this}\r\n\t */\r\n\tonSizeChanged: function(onSizeChanged) {\r\n\t\tif(onSizeChanged === undefined) {\r\n\t\t\treturn this._onSizeChanged;\r\n\t\t}\r\n\t\tjslet.Checker.test('Window.onSizeChanged', onSizeChanged).isFunction();\r\n\t\tthis._onSizeChanged = onSizeChanged;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Set or get window position changed event handler.\r\n\t * Fired when user changes the window's position.\r\n\t * Pattern: \r\n\t *   function(left, top){}\r\n\t *   //left: Integer Window position left\r\n\t *   //top: Integer Window position top \r\n\t * \r\n\t * @param {Function or undefined} onPositionChanged window position changed event handler\r\n\t * @return {Function or this}\r\n\t */\r\n\tonPositionChanged: function(onPositionChanged) {\r\n\t\tif(onPositionChanged === undefined) {\r\n\t\t\treturn this._onPositionChanged;\r\n\t\t}\r\n\t\tjslet.Checker.test('Window.onPositionChanged', onPositionChanged).isFunction();\r\n\t\tthis._onPositionChanged = onPositionChanged;\r\n\t},\r\n\r\n\t/**\r\n\t * Set or get window activated event handler.\r\n\t * Fired when the window is active.\r\n\t *\tfunction(windObj){}\r\n\t *\t//windObj: jslet.ui.Window Window Object\r\n\t * \r\n\t * @param {Function or undefined} onActive window activated event handler\r\n\t * @return {Function or this}\r\n\t */\r\n\tonActive: function(onActive) {\r\n\t\tif(onActive === undefined) {\r\n\t\t\treturn this._onActive;\r\n\t\t}\r\n\t\tjslet.Checker.test('Window.onActive', onActive).isFunction();\r\n\t\tthis._onActive = onActive;\r\n\t},\r\n\t\r\n\t\r\n\t/**\r\n\t * Set or get window closed event handler.\r\n\t * Fired when uses closes window.\r\n\t * Pattern: \r\n\t *\tfunction(windObj){}\r\n\t *\t//windObj: jslet.ui.Window Window Object\r\n\t *\t//return: String If return value equals 'hidden', then hide window instead of closing.\r\n\t * \r\n\t * @param {Function or undefined} onClosed window closed event handler\r\n\t * @return {Function or this}\r\n\t */\r\n\tonClosed: function(onClosed) {\r\n\t\tif(onClosed === undefined) {\r\n\t\t\treturn this._onClosed;\r\n\t\t}\r\n\t\tjslet.Checker.test('Window.onClosed', onClosed).isFunction();\r\n\t\tthis._onClosed = onClosed;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tthis.renderAll();\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tvar Z = this;\r\n\t\tif (!Z._closable) {\r\n\t\t\tZ._minimizable = false;\r\n\t\t\tZ._maximizable = false;\r\n\t\t}\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tif (!jqEl.hasClass('jl-window')) {\r\n\t\t\tjqEl.addClass('panel panel-default jl-window');\r\n\t\t}\r\n\t\tif (Z._width) {\r\n\t\t\tjqEl.width(Z._width);\r\n\t\t}\r\n\t\tif (Z._height) {\r\n\t\t\tjqEl.height(Z._height);\r\n\t\t}\r\n\t\tjqEl.css('display','none');\r\n\t\tvar template = [\r\n\t\t'<div class=\"panel-heading jl-win-header jl-win-header-sm\" style=\"cursor:move\">',\r\n\t\t\tZ._iconClass ? '<span class=\"jl-win-header-icon ' + Z._iconClass + '\"></span>' : '',\r\n\t\t\t'<span class=\"panel-title jl-win-caption\">', Z._caption ? Z._caption : '', '</span>',\r\n\t\t\t'<span class=\"jl-win-tool jl-unselectable\">'];\r\n\t\t\ttemplate.push(Z._closable ? '<button class=\"close jl-win-close\" onfocus=\"this.blur();\">x</button>' : '');\r\n\t\t\ttemplate.push(Z._maximizable ? '<button class=\"close jl-win-max\" onfocus=\"this.blur();\"></button>' : '');\r\n\t\t\ttemplate.push(Z._minimizable ? '<button class=\"close jl-win-min\" onfocus=\"this.blur();\">-</button>' : '');\r\n\t\ttemplate.push('</span></div>');\r\n\t\ttemplate.push('<div class=\"panel-body jl-win-body\"></div>');\r\n\r\n\t\tjqEl.html(template.join(''));\r\n\t\tjqEl.on('mousemove', Z._doWinMouseMove);\r\n\t\tjqEl.on('mousedown', Z._doWinMouseDown);\r\n\t\tjqEl.on('dblclick', function(event){\r\n\t\t\tevent.stopPropagation();\r\n\t\t\tevent.preventDefault();\r\n\t\t});\r\n\r\n\t\tjqEl.on('click', function(event){\r\n\t\t\tif(Z._stopEventBubbling) {\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tif (Z._height) {\r\n\t\t\tZ._changeBodyHeight();\r\n\t\t}\r\n\t\tvar jqHeader = jqEl.find('.jl-win-header'),\r\n\t\t\theader = jqHeader[0];\r\n\t\tvar jqBody = jqEl.find('.jl-win-body');\r\n\t\tjqBody.on('mouseenter',function (event) {\r\n\t\t\twindow.setTimeout(function(){\r\n\t\t\t\tif (jslet.temp_dragging) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tZ.cursor = null;\r\n\t\t\t},300);\r\n\t\t});\r\n\t\tjqBody.on('dblclick',function (event) {\r\n\t\t\tevent.stopPropagation();\r\n\t\t\tevent.preventDefault();\r\n\t\t});\r\n\t\t\r\n\t\tjqHeader.on('mousedown',function (event) {\r\n\t\t\tZ.activate();\r\n\t\t\tif (Z._state == 'max') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tZ.cursor = null;\r\n\t\t\tjslet.ui.dnd.bindControl(this);\r\n\t\t});\r\n\r\n\t\tjqHeader.on('dblclick',function (event) {\r\n\t\t\tevent.stopPropagation();\r\n\t\t\tevent.preventDefault();\r\n\t\t\tif (!Z._maximizable) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (Z._state != 'max') {\r\n\t\t\t\tZ.maximize();\r\n\t\t\t} else {\r\n\t\t\t\tZ.restore();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\theader._doDragStart = function (oldX, oldY, x, y, deltaX, deltaY) {\r\n\t\t\tZ._createTrackerMask(header);\r\n\t\t\tZ.trackerMask.style.cursor = header.style.cursor;\r\n\t\t\tjslet.temp_dragging = true;\r\n\t\t};\r\n\r\n\t\theader._doDragging = function (oldX, oldY, x, y, deltaX, deltaY) {\r\n\t\t\tZ.setPosition(Z.left + deltaX, Z.top + deltaY, true);\r\n\t\t};\r\n\r\n\t\theader._doDragEnd = function (oldX, oldY, x, y, deltaX, deltaY) {\r\n\t\t\tvar left = parseInt(Z.el.style.left);\r\n\t\t\tvar top = parseInt(Z.el.style.top);\r\n\t\t\tZ.setPosition(left, top);\r\n\t\t\tZ._removeTrackerMask();\r\n\t\t\tZ.cursor = null;\r\n\t\t\tjslet.temp_dragging = false;\r\n\t\t};\r\n\r\n\t\theader._doDragCancel = function (oldX, oldY, x, y, deltaX, deltaY) {\r\n\t\t\tZ.setPosition(Z.left, Z.top);\r\n\t\t\tZ._removeTrackerMask();\r\n\t\t\tZ.cursor = null;\r\n\t\t\tjslet.temp_dragging = false;\r\n\t\t};\r\n\r\n\t\tZ.el._doDragStart = function (oldX, oldY, x, y, deltaX, deltaY) {\r\n\t\t\tZ._createTrackerMask(this);\r\n\t\t\tZ._createTracker();\r\n\t\t\tZ.trackerMask.style.cursor = Z.el.style.cursor;\r\n\t\t\tjslet.temp_dragging = true;\r\n\t\t};\r\n\r\n\t\tZ.el._doDragging = function (oldX, oldY, x, y, deltaX, deltaY) {\r\n\t\t\tZ._changeTrackerSize(deltaX, deltaY);\r\n\t\t};\r\n\r\n\t\tZ.el._doDragEnd = function (oldX, oldY, x, y, deltaX, deltaY) {\r\n\t\t\tif (!Z.tracker) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar left = parseInt(Z.tracker.style.left);\r\n\t\t\tvar top = parseInt(Z.tracker.style.top);\r\n\t\t\tvar width = parseInt(Z.tracker.style.width);\r\n\t\t\tvar height = parseInt(Z.tracker.style.height);\r\n\r\n\t\t\tZ.setPosition(left, top);\r\n\t\t\tZ.changeSize(width, height);\r\n\t\t\tZ._removeTrackerMask();\r\n\t\t\tZ._removeTracker();\r\n\t\t\tZ.cursor = null;\r\n\t\t\tjslet.temp_dragging = false;\r\n\t\t};\r\n\r\n\t\tZ.el._doDragCancel = function (oldX, oldY, x, y, deltaX, deltaY) {\r\n\t\t\tZ._removeTrackerMask();\r\n\t\t\tZ._removeTracker();\r\n\t\t\tZ.cursor = null;\r\n\t\t\tjslet.temp_dragging = false;\r\n\t\t};\r\n\r\n\t\tif (Z._closable) {\r\n\t\t\tvar jqClose = jqEl.find('.jl-win-close');\r\n\t\t\tjqClose.click(function (event) {\r\n\t\t\t\tZ.close();\r\n\t\t\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (Z._minimizable) {\r\n\t\t\tvar jqMin = jqEl.find('.jl-win-min');\r\n\t\t\tjqMin.click(function (event) {\r\n\t\t\t\tZ.minimize();\r\n\t\t\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (Z._maximizable) {\r\n\t\t\tvar jqMax = jqEl.find('.jl-win-max'),\r\n\t\t\t\tbtnMax = jqMax[0];\r\n\t\t\tjqMax.click(function (event) {\r\n\t\t\t\tif (Z._state != 'max') {\r\n\t\t\t\t\tbtnMax.innerHTML = '';\r\n\t\t\t\t\tZ.maximize();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tbtnMax.innerHTML = '';\r\n\t\t\t\t\tZ.restore();\r\n\t\t\t\t}\r\n\t\t\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Show window at specified position\r\n\t * \r\n\t * @param {Integer} left - Position left.\r\n\t * @param {Integer} top - Position top.\r\n\t */\r\n\tshow: function (left, top) {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\tif (Z._isCenter) {\r\n\t\t\tvar offsetP = jqEl.offsetParent()[0],\r\n\t\t\t\tjqOffsetP = jQuery(offsetP),\r\n\t\t\t\tpw = jqOffsetP.width(),\r\n\t\t\t\tph = jqOffsetP.height();\r\n\t\t\tleft = offsetP.scrollLeft + Math.round((pw - jqEl.outerWidth()) / 2);\r\n\t\t\ttop = offsetP.scrollTop + Math.round((ph - jqEl.outerHeight()) / 2);\r\n\t\t\tif(left < 0) {\r\n\t\t\t\tleft = 0;\r\n\t\t\t}\r\n\t\t\tif(top < 0) {\r\n\t\t\t\ttop = 0;\r\n\t\t\t} \r\n\t\t}\r\n\r\n\t\tZ.top = top ? top : 0;\r\n\t\tZ.left = left ? left : 0;\r\n\t\tZ.el.style.left = Z.left + 'px';\r\n\t\tZ.el.style.top = Z.top + 'px';\r\n\t\tif(Z._animation == 'slide') {\r\n\t\t\tjqEl.slideDown();\r\n\t\t} else if(Z._animation == 'fade') {\r\n\t\t\tjqEl.fadeIn();\r\n\t\t} else if(Z._animation == 'none') {\r\n\t\t\tjqEl.show();\r\n\t\t} else {\r\n\t\t\tjqEl.show('fast');\r\n\t\t}\r\n\t\tZ.activate();\r\n\t},\r\n\r\n\t/**\r\n\t * Show modal window at specified position\r\n\t * \r\n\t * @param {Integer} left Position left.\r\n\t * @param {Integer} top Position top.\r\n\t * @param {String} animation - Animation effect. optional value: 'slide', 'fade'\r\n\t */\r\n\tshowModal: function (left, top) {\r\n\t\tvar Z = this;\r\n\t\tZ._isModal = true;\r\n\t\tif (!Z.overlay) {\r\n\t\t\tZ.overlay = new jslet.ui.OverlayPanel(Z.el.parentNode);\r\n\t\t}\r\n\t\tjslet.ui.GlobalZIndex += 10;\r\n\t\tvar k = jslet.ui.GlobalZIndex;\r\n\t\tZ.el.style.zIndex = k;\r\n\t\tZ.show(left, top);\r\n\t\tZ.overlay.setZIndex(k - 2);\r\n\t\tZ.overlay.show();\r\n\t},\r\n\r\n\t/**\r\n\t * Hide window\r\n\t * @param {String} animation - Animation effect. optional value: 'slide', 'fade'\r\n\t */\r\n\thide: function () {\r\n\t\tvar Z = this;\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tif(Z._animation == 'slide') {\r\n\t\t\tjqEl.slideUp();\r\n\t\t} else if(Z._animation == 'fade') {\r\n\t\t\tjqEl.fadeOut();\r\n\t\t} else if(Z._animation == 'none') {\r\n\t\t\tjqEl.hide();\r\n\t\t} else {\r\n\t\t\tjqEl.hide('fast');\r\n\t\t}\r\n\t\tif (Z.overlay) {\r\n\t\t\tZ.overlay.hide();\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Close window, this will fire onClosed event.\r\n\t * \r\n\t */\r\n\tclose: function () {\r\n\t\tvar Z = this;\r\n\t\tif(!Z.el) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (Z._onClosed) {\r\n\t\t\tvar action = Z._onClosed.call(Z);\r\n\t\t\tif (action && action.toLowerCase() == 'hidden') {\r\n\t\t\t\tZ.hide();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar pnode = Z.el.parentNode;\r\n\t\tpnode.removeChild(Z.el);\r\n\t\tif (Z.overlay) {\r\n\t\t\tZ.overlay.destroy();\r\n\t\t\tZ.overlay = null;\r\n\t\t}\r\n\t\tjslet.ui.GlobalZIndex -= 10;\r\n\t\tZ.destroy();\r\n\t},\r\n\r\n\t/**\r\n\t * Minimize window\r\n\t */\r\n\tminimize: function () {\r\n\t\tvar Z = this;\r\n\t\tif (Z._state == 'min') {\r\n\t\t\tZ.restore();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (Z._state == 'max') {\r\n\t\t\tZ.restore();\r\n\t\t}\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tZ._tempHeight = jqEl.height();\r\n\t\tZ._tempWidth = jqEl.width();\r\n\t\tZ.changeSize(Z._tempWidth, Z._getHeaerHeight() + 2);\r\n\t\tZ._state = 'min';\r\n\t},\r\n\r\n\t/**\r\n\t * Maximize window\r\n\t */\r\n\tmaximize: function () {\r\n\t\tvar Z = this;\r\n\t\tvar offsetP = jQuery(Z.el).offsetParent();\r\n\t\tvar width = offsetP.innerWidth(); // -12;\r\n\t\tvar height = offsetP.innerHeight(); // -12;\r\n\t\tZ.setPosition(0, 0, true);\r\n\t\tif (Z._state !== 'min') {\r\n\t\t\tvar jqEl = jQuery(Z.el);\r\n\t\t\tZ._tempHeight = jqEl.height();\r\n\t\t\tZ._tempWidth = jqEl.width();\r\n\t\t}\r\n\t\tZ.changeSize(width, height);\r\n\t\tZ._state = 'max';\r\n\t},\r\n\r\n\t/**\r\n\t * Restore window\r\n\t */\r\n\trestore: function () {\r\n\t\tvar Z = this;\r\n\t\tZ.setPosition(Z.left, Z.top, true);\r\n\t\tZ.changeSize(Z._tempWidth, Z._tempHeight);\r\n\t\tZ._state = null;\r\n\t},\r\n\r\n\t/**\r\n\t * Activate window, this will fire the 'OnActive' event\r\n\t */\r\n\tactivate: function () {\r\n\t\tvar Z = this;\r\n\t\tif (!Z.overlay) {\r\n\t\t\tZ.bringToFront();\r\n\t\t}\r\n\t\tif (Z._onActive) {\r\n\t\t\tZ._onActive.call();\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Change window position.\r\n\t * \r\n\t * @param {Integer} left Position left\r\n\t * @param {Integer} top Position top\r\n\t * @param {Boolean} notUpdateLeftTop True - Only change html element position, \r\n\t *\t\tnot change the inner position of Window object, it is usually use for moving action\r\n\t */\r\n\tsetPosition: function (left, top, notUpdateLeftTop) {\r\n\t\tvar Z = this;\r\n\t\tif (!notUpdateLeftTop) {\r\n\t\t\tZ.left = left;\r\n\t\t\tZ.top = top;\r\n\t\t} else {\r\n\t\t\tif (Z._onPositionChanged) {\r\n\t\t\t\tvar result = Z._onPositionChanged.call(Z, left, top);\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\tif (result.left) {\r\n\t\t\t\t\t\tleft = result.left;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (result.top) {\r\n\t\t\t\t\t\ttop = result.top;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tZ.el.style.left = left + 'px';\r\n\t\tZ.el.style.top = top + 'px';\r\n\t},\r\n\r\n\t/**\r\n\t * Change window size.\r\n\t * \r\n\t * @param {Integer} width Window width\r\n\t * @param {Integer} height Window height\r\n\t * @param {Boolean} notUpdateSize True - Only change html element size, \r\n\t *\t\tnot change the inner size of Window object, it is usually use for moving action\r\n\t */\r\n\tchangeSize: function (width, height) {\r\n\t\tvar Z = this;\r\n\t\tif (Z._onSizeChanged) {\r\n\t\t\tZ._onSizeChanged.call(Z, width, height);\r\n\t\t}\r\n\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tjqEl.width(width);\r\n\t\tjqEl.height(height);\r\n\t\tZ._changeBodyHeight();\r\n\t},\r\n\r\n\t_getHeaerHeight: function() {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\tjqHeader = jqEl.find('.jl-win-header');\r\n\t\treturn jqHeader.outerHeight();\r\n\t},\r\n\t\r\n\t_changeBodyHeight: function() {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\tjqBody = jqEl.find('.jl-win-body');\r\n\t\tjqBody.outerHeight(jqEl.innerHeight() - Z._getHeaerHeight());\r\n\t},\r\n\t\r\n\t/**\r\n\t * Get window caption element. You can use it to customize window caption.\r\n\t * \r\n\t * @return {Html Element}\r\n\t */\r\n\tgetCaptionPanel: function () {\r\n\t\treturn jQuery(this.el).find('.jl-win-caption')[0];\r\n\t},\r\n\r\n\t/**\r\n\t * Set window caption\r\n\t * \r\n\t * @param {String} caption Window caption\r\n\t */\r\n\tchangeCaption: function (caption) {\r\n\t\tthis.caption = caption;\r\n\t\tvar captionDiv = jQuery(this.el).find('.jl-win-caption');\r\n\t\tcaptionDiv.html(caption);\r\n\t},\r\n\r\n\t/**\r\n\t * Get window content element. You can use it to customize window content.\r\n\t * \r\n\t * @return {Html Element}\r\n\t */\r\n\tgetContentPanel: function () {\r\n\t\treturn jQuery(this.el).find('.jl-win-body')[0];\r\n\t},\r\n\r\n\t/**\r\n\t * Set window content\r\n\t * \r\n\t * @param {String} html Html text for window content\r\n\t */\r\n\tsetContent: function (html) {\r\n\t\tif (!html){\r\n\t\t\tjslet.showError('Window content cannot be null!');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar bodyDiv = jQuery(this.el).find('.jl-win-body');\r\n\t\tif (html && html.toLowerCase) {\r\n\t\t\tbodyDiv.html(html);\r\n\t\t} else {\r\n\t\t\tbodyDiv.html('');\r\n\t\t\t\r\n\t\t\thtml.parentNode.removeChild(html);\r\n\t\t\tbodyDiv[0].appendChild(html);\r\n\t\t\tif (html.style && html.style.display == 'none') {\r\n\t\t\t\thtml.style.display = 'block';\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Bring window to front\r\n\t */\r\n\tbringToFront: function () {\r\n\t\tvar Z = this;\r\n\t\tvar p = Z.el.parentNode;\r\n\t\tvar node, jqEl = jQuery(Z.el);\r\n\t\tvar maxIndex = 0, jqNode, winIdx;\r\n\t\tfor (var i = 0, cnt = p.childNodes.length; i < cnt; i++) {\r\n\t\t\tnode = p.childNodes[i];\r\n\t\t\tif (node.nodeType != 1 || node == Z.el) {\r\n\t\t\t\tif (!Z._isModal) {\r\n\t\t\t\t\tjqEl.find('.jl-win-header').addClass('jl-window-active');\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tjqNode = jQuery(node);\r\n\t\t\t\r\n\t\t\tif (jqNode.hasClass('jl-window')) {\r\n\t\t\t\twinIdx = parseInt(node.style.zIndex) || 0;\r\n\t\t\t\tif (maxIndex < winIdx) {\r\n\t\t\t\t\tmaxIndex = winIdx;\r\n\t\t\t\t}\r\n\t\t\t\tif (!Z._isModal) {\r\n\t\t\t\t\tjqNode.find('.jl-win-header').removeClass('jl-window-active');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar styleObj = jqEl.getStyleObject();\r\n\t\twinIdx = parseInt(styleObj.zIndex) || 0;\r\n\t\tif (winIdx <= maxIndex) {\r\n\t\t\tZ.setZIndex(maxIndex + 2);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Set window Z-Index\r\n\t * \r\n\t * @param {Integer} zIndex Z-Index\r\n\t */\r\n\tsetZIndex: function (zIndex) {\r\n\t\tthis.el.style.zIndex = zIndex;\r\n\t\tif(this.overlay) {\r\n\t\t\tthis.overlay.setZIndex(zIndex - 2);\r\n\t\t}\r\n\t},\r\n\r\n\t_checkSize: function (width, height) {\r\n\t\tvar Z = this;\r\n\t\tif (width) {\r\n\t\t\tif (width < Z._minWidth || Z._maxWidth > 0 && width > Z._maxWidth) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (height) {\r\n\t\t\tif (height < Z.minHeight || Z._maxHeight > 0 && height > Z._maxHeight) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\r\n\t_changeTrackerSize: function (deltaX, deltaY) {\r\n\t\tvar Z = this;\r\n\t\tif (!Z.tracker || !Z.cursor) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar jqEl = jQuery(Z.el), \r\n\t\t\tw = jqEl.width(), \r\n\t\t\th = jqEl.height(), \r\n\t\t\ttop = null, left = null;\r\n\r\n\t\tif (Z.cursor == 'nw') {\r\n\t\t\tw = w - deltaX;\r\n\t\t\th = h - deltaY;\r\n\t\t\ttop = Z.top + deltaY;\r\n\t\t\tleft = Z.left + deltaX;\r\n\t\t} else if (Z.cursor == 'n') {\r\n\t\t\th = h - deltaY;\r\n\t\t\ttop = Z.top + deltaY;\r\n\t\t} else if (Z.cursor == 'ne') {\r\n\t\t\th = h - deltaY;\r\n\t\t\tw = w + deltaX;\r\n\t\t\ttop = Z.top + deltaY;\r\n\t\t} else if (Z.cursor == 'e') {\r\n\t\t\tw = w + deltaX;\r\n\t\t} else if (Z.cursor == 'se') {\r\n\t\t\tw = w + deltaX;\r\n\t\t\th = h + deltaY;\r\n\t\t} else if (Z.cursor == 's'){\r\n\t\t\th = h + deltaY;\r\n\t\t} else if (Z.cursor == 'sw') {\r\n\t\t\th = h + deltaY;\r\n\t\t\tw = w - deltaX;\r\n\t\t\tleft = Z.left + deltaX;\r\n\t\t} else if (Z.cursor == 'w') {\r\n\t\t\tw = w - deltaX;\r\n\t\t\tleft = Z.left + deltaX;\r\n\t\t}\r\n\r\n\t\tif (!Z._checkSize(w, h)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar jqTracker = jQuery(Z.tracker);\r\n\t\tif (w) {\r\n\t\t\tjqTracker.width(w);\r\n\t\t}\r\n\t\tif (h) {\r\n\t\t\tjqTracker.height(h);\r\n\t\t}\r\n\t\tif (top) {\r\n\t\t\tZ.tracker.style.top = top + 'px';\r\n\t\t}\r\n\t\tif (left) {\r\n\t\t\tZ.tracker.style.left = left + 'px';\r\n\t\t}\r\n\t},\r\n\r\n\t_doWinMouseMove: function (event) {\r\n\t\tif (jslet.temp_dragging) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\t\r\n\t\tvar srcEl = event.target, jqSrcEl = jQuery(srcEl);\r\n\t\t\r\n\t\tif (!jqSrcEl.hasClass('jl-window')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!srcEl.jslet._resizable || srcEl.jslet._state) {\r\n\t\t\tsrcEl.jslet.cursor = null;\r\n\t\t\tsrcEl.style.cursor = 'default';\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar pos = jqSrcEl.offset(),\r\n\t\t\tx = event.pageX - pos.left,\r\n\t\t\ty = event.pageY - pos.top,\r\n\t\t\tw = jqSrcEl.width(),\r\n\t\t\th = jqSrcEl.height();\r\n\t\tvar delta = 8, wdelta = w - delta, hdelta = h - delta, cursor = null;\r\n\t\tif (x <= delta && y <= delta) {\r\n\t\t\tcursor = 'nw';\r\n\t\t} else if (x > delta && x < wdelta && y <= delta) {\r\n\t\t\tcursor = 'n';\r\n\t\t} else if (x >= wdelta && y <= delta) {\r\n\t\t\tcursor = 'ne';\r\n\t\t} else if (x >= wdelta && y > delta && y <= hdelta) {\r\n\t\t\tcursor = 'e';\r\n\t\t} else if (x >= wdelta && y >= hdelta) {\r\n\t\t\tcursor = 'se';\r\n\t\t} else if (x > delta && x < wdelta && y >= hdelta) {\r\n\t\t\tcursor = 's';\r\n\t\t} else if (x <= delta && y >= hdelta) {\r\n\t\t\tcursor = 'sw';\r\n\t\t} else if (x <= delta && y > delta && y < hdelta) {\r\n\t\t\tcursor = 'w';\r\n\t\t}\r\n\t\t\r\n\t\tsrcEl.jslet.cursor = cursor;\r\n\t\tsrcEl.style.cursor = cursor ? cursor + '-resize' : 'default';\r\n\t},\r\n\r\n\t_doWinMouseDown: function (event) {\r\n\t\tvar ojslet = this.jslet;\r\n\t\tojslet.activate();\r\n\t\tif (ojslet.cursor) {\r\n\t\t\tjslet.ui.dnd.bindControl(this);\r\n\t\t}\r\n\t},\r\n\r\n\t_createTrackerMask: function (holder) {\r\n\t\tvar Z = this;\r\n\t\tif (Z.trackerMask) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar jqBody = jQuery(document.body);\r\n\r\n\t\tZ.trackerMask = document.createElement('div');\r\n\t\tjQuery(Z.trackerMask).addClass('jl-win-tracker-mask');\r\n\t\tZ.trackerMask.style.top = '0px';\r\n\t\tZ.trackerMask.style.left = '0px';\r\n\t\tZ.trackerMask.style.zIndex = 99998;\r\n\t\tZ.trackerMask.style.width = jqBody.width() + 'px';\r\n\t\tZ.trackerMask.style.height = jqBody.height() + 'px';\r\n\t\tZ.trackerMask.style.display = 'block';\r\n\t\tZ.trackerMask.onmousedown = function () {\r\n\t\t\tif (holder && holder._doDragCancel) {\r\n\t\t\t\tholder._doDragCancel();\r\n\t\t\t}\r\n\t\t};\r\n\t\tjqBody[0].appendChild(Z.trackerMask);\r\n\t},\r\n\r\n\t_removeTrackerMask: function () {\r\n\t\tvar Z = this;\r\n\t\tif (Z.trackerMask) {\r\n\t\t\tZ.trackerMask.onmousedown = null;\r\n\t\t\tdocument.body.removeChild(Z.trackerMask);\r\n\t\t}\r\n\t\tZ.trackerMask = null;\r\n\t},\r\n\r\n\t_createTracker: function () {\r\n\t\tvar Z = this;\r\n\t\tif (Z.tracker) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar jqEl = jQuery(Z.el), \r\n\t\t\tw = jqEl.width(), \r\n\t\t\th = jqEl.height();\r\n\t\t\r\n\t\tZ.tracker = document.createElement('div');\r\n\t\tvar jqTracker = jQuery(Z.tracker);\r\n\t\tjqTracker.addClass('jl-win-tracker');\r\n\t\tZ.tracker.style.top = Z.top + 'px';\r\n\t\tZ.tracker.style.left = Z.left + 'px';\r\n\t\tZ.tracker.style.zIndex = 99999;\r\n\t\tjqTracker.width(w);\r\n\t\tjqTracker.height(h);\r\n\t\tZ.tracker.style.display = 'block';\r\n\t\tZ.el.parentNode.appendChild(Z.tracker);\r\n\t},\r\n\r\n\t_removeTracker: function () {\r\n\t\tvar Z = this;\r\n\t\tif (Z.tracker) {\r\n\t\t\tZ.el.parentNode.removeChild(Z.tracker);\r\n\t\t}\r\n\t\tZ.tracker = null;\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\tjqEl.find('.jl-win-max').off();\r\n\t\tjqEl.find('.jl-win-min').off();\r\n\t\tjqEl.find('.jl-win-close').off();\r\n\r\n\t\tvar jqHeader = jqEl.find('.jl-win-header'),\r\n\t\t\theader = jqHeader[0];\r\n\t\tjqHeader.off();\r\n\t\tjqEl.find('.jl-win-body').off();\r\n\t\tif (Z.trackerMask) {\r\n\t\t\tZ.trackerMask.onmousedown = null;\r\n\t\t}\r\n\t\tZ.trackerMask = null;\r\n\t\tZ.el._doDragCancel = null;\r\n\t\tZ.el._doDragEnd = null;\r\n\t\tZ.el._doDragging = null;\r\n\t\tZ.el._doDragStart = null;\r\n\t\theader._doDragCancel = null;\r\n\t\theader._doDragEnd = null;\r\n\t\theader._doDragging = null;\r\n\t\theader._doDragStart = null;\r\n\t\t\r\n\t\tif ($super) {\r\n\t\t\t$super();\r\n\t\t}\r\n\t}\r\n});\r\njslet.ui.register('Window', jslet.ui.Window);\r\njslet.ui.Window.htmlTemplate = '<div></div>';\r\n\r\n\r\n/**\r\n* @class MessageBox\r\n*/\r\njslet.ui.MessageBox = function () {\r\n\r\n\t//hasInput-0:none,1-single line input, 2:multiline input\r\n\t/**\r\n\t * Show message box\r\n\t * \r\n\t * @param {String} message Message text\r\n\t * @param {String} caption Caption text\r\n\t * @param {String} iconClass Caption icon class\r\n\t * @param {String[]} buttons Array of button names, like : ['ok','cancel']\r\n\t * @param {Fucntion} callbackFn Callback function when user click one button, \r\n\t *\tPattern: \r\n\t *\tfunction({String}button, {String} value){}\r\n\t *\t//button: String, button name;\r\n\t *\t//value: String, the alue inputed by user;\r\n\t * @param {Integer} hasInput There is input or not, value options: 0 - none, 1 - single line input, 2 - multiline input\r\n\t * @param {String} defaultValue The default value of Input element, if hasInput = 0, this argument is be igored.\r\n\t * @param {Fucntion} validateFn Validate function of input element, if hasInput = 0, this argument is be igored.\r\n\t *   Pattern: \r\n\t *   function(value){}\r\n\t *   //value: String, the value which need to be validated.\r\n\t * \r\n\t */\r\n\tthis.show = function (message, caption, iconClass, buttons, callbackFn, hasInput, defaultValue, validateFn) {\r\n\r\n\t\tvar opt = { type: 'window', caption: caption, isCenter: true, resizable: false, minimizable: false, maximizable: false, stopEventBubbling: true, animation: 'fade'};\r\n\t\tvar owin = jslet.ui.createControl(opt);\r\n\t\tvar iconHtml = '';\r\n\t\tif (iconClass) {\r\n\t\t\ticonHtml = '<div class=\"jl-msg-icon ';\r\n\t\t\tif (iconClass == 'info' || iconClass == 'error' || iconClass == 'question' || iconClass == 'warning') {\r\n\t\t\t\ticonHtml += 'jl-msg-icon-' + iconClass;\r\n\t\t\t} else {\r\n\t\t\t\ticonHtml += iconClass;\r\n\t\t\t}\r\n\t\t\ticonHtml += '\"><i class=\"fa ';\r\n\t\t\tswitch (iconClass) {\r\n\t            case 'info':\r\n\t            \ticonHtml += 'fa-info';\r\n\t                break;\r\n\t            case 'error':\r\n\t            \ticonHtml += 'fa-times';\r\n\t                break;\r\n\t            case 'success':\r\n\t            \ticonHtml += 'fa-check';\r\n\t                break;\r\n\t            case 'warning':\r\n\t            \ticonHtml += 'fa-exclamation';\r\n\t                break;\r\n\t            case 'question':\r\n\t            \ticonHtml += 'fa-question';\r\n\t                break;\r\n\t            default :\r\n\t            \ticonHtml += 'fa-info';\r\n                 \tbreak;\r\n\t        }\r\n\t\t\ticonHtml += '\"></i></div>';\r\n\t\t}\r\n\r\n\t\tvar btnCount = buttons.length;\r\n\t\tvar btnHtml = [], btnName, i;\r\n\t\tif (jslet.locale.isRtl){\r\n\t\t\tfor (i = btnCount - 1; i >=0; i--) {\r\n\t\t\t\tbtnName = buttons[i];\r\n\t\t\t\tbtnHtml.push('<button class=\"jl-msg-button btn btn-default btn-xs\" ');\r\n\t\t\t\tbtnHtml.push(' data-jsletname=\"');\r\n\t\t\t\tbtnHtml.push(btnName);\r\n\t\t\t\tbtnHtml.push('\">');\r\n\t\t\t\tbtnHtml.push(jslet.locale.MessageBox[btnName]);\r\n\t\t\t\tbtnHtml.push('</button>');\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tfor (i = 0; i < btnCount; i++) {\r\n\t\t\t\tbtnName = buttons[i];\r\n\t\t\t\tbtnHtml.push('<button class=\"jl-msg-button btn btn-default btn-xs\" ');\r\n\t\t\t\tbtnHtml.push('\" data-jsletname=\"');\r\n\t\t\t\tbtnHtml.push(btnName);\r\n\t\t\t\tbtnHtml.push('\">');\r\n\t\t\t\tbtnHtml.push(jslet.locale.MessageBox[btnName]);\r\n\t\t\t\tbtnHtml.push('</button>');\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar inputHtml = ['<br />'];\r\n\t\tif (hasInput) {\r\n\t\t\tif (hasInput == 1) {\r\n\t\t\t\tinputHtml.push('<input type=\"text\"');\r\n\t\t\t} else {\r\n\t\t\t\tinputHtml.push('<textarea rows=\"5\"');\r\n\t\t\t}\r\n\t\t\tinputHtml.push(' style=\"width:');\r\n\t\t\tinputHtml.push('98%\"');\r\n\t\t\tif (defaultValue !== null && defaultValue !== undefined) {\r\n\t\t\t\tinputHtml.push(' value=\"');\r\n\t\t\t\tinputHtml.push(defaultValue);\r\n\t\t\t\tinputHtml.push('\"');\r\n\t\t\t}\r\n\t\t\tif (hasInput == 1) {\r\n\t\t\t\tinputHtml.push(' />');\r\n\t\t\t} else {\r\n\t\t\t\tinputHtml.push('></textarea>');\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(message) {\r\n\t\t\tmessage = message.replace('\\n', '<br />');\r\n\t\t}\r\n\t\tvar html = ['<div class=\"jl-msg-container\">', iconHtml, '<div class=\"' + (hasInput? 'jl-msg-message-noicon': 'jl-msg-message') + '\">',\r\n\t\t\t\t\tmessage, inputHtml.join(''), '</div>', '</div>',\r\n\t\t\t\t\t'<div class=\"jl-msg-tool\"><div>', btnHtml.join(''), '</div></div>'\r\n\t\t];\r\n\r\n\t\towin.setContent(html.join(''));\r\n\t\tvar jqEl = jQuery(owin.el);\r\n\t\tvar toolBar = jqEl.find('.jl-msg-tool')[0].firstChild;\r\n\t\tvar inputCtrl = null;\r\n\t\tif (hasInput == 1) {\r\n\t\t\tinputCtrl = jqEl.find('.jl-msg-container input')[0];\r\n\t\t} else {\r\n\t\t\tinputCtrl = jqEl.find('.jl-msg-container textarea')[0];\r\n\t\t}\r\n\t\t\r\n\t\tjQuery(toolBar).on('click', 'button', function(event) {\r\n\t\t\tvar obtn = event.currentTarget;\r\n\t\t\tvar btnName = jQuery(obtn).attr('data-jsletname');\r\n\t\t\tvar value = null;\r\n\t\t\tif (hasInput && btnName == 'ok') {\r\n\t\t\t\tvalue = inputCtrl.value;\r\n\t\t\t\tif (validateFn && !validateFn(value)) {\r\n\t\t\t\t\tinputCtrl.focus();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\towin.close();\r\n\t\t\tif (callbackFn) {\r\n\t\t\t\tcallbackFn(btnName, value);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\towin.onClosed(function () {\r\n\t\t\tif (callbackFn) {\r\n\t\t\t\tcallbackFn(btnName);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\towin.showModal();\r\n\t\towin.setZIndex(99981);\r\n\t\tvar k = btnCount - 1;\r\n\t\tif (jslet.locale.isRtl) {\r\n\t\t\tk = 0;\r\n\t\t}\r\n\t\tvar toolBtn = toolBar.childNodes[k];\r\n\t\tif(toolBtn) {\r\n\t\t\ttoolBtn.focus();\r\n\t\t}\r\n\t\treturn owin;\r\n\t};\r\n};\r\n\r\n/**\r\n * Show alert message. Example:\r\n * <pre><code>\r\n * jslet.ui.MessageBox.alert('Finished!', 'Tips');\r\n * </code></pre>\r\n */\r\njslet.ui.MessageBox.alert = function (message, caption, callbackFn, timeout) {\r\n\tvar omsgBox = new jslet.ui.MessageBox();\r\n\tif (!caption) {\r\n\t\tcaption = jslet.locale.MessageBox.info;\r\n\t}\r\n\tvar owin = omsgBox.show(message, caption, 'info', ['ok'], callbackFn);\r\n\tif(timeout) {\r\n\t\ttimeout = parseInt(timeout);\r\n\t\tif(window.isNaN(timeout)) {\r\n\t\t\twindow.setTimeout(function() {\r\n\t\t\t\towin.close();\r\n\t\t\t}, timeout);\r\n\t\t}\r\n\t}\r\n};\r\n\r\n/**\r\n * Show error message. Example:\r\n * <pre><code>\r\n * jslet.ui.MessageBox.alert('You have made a mistake!', 'Error');\r\n * </code></pre>\r\n */\r\njslet.ui.MessageBox.error = function (message, caption, callbackFn, timeout) {\r\n\tvar omsgBox = new jslet.ui.MessageBox();\r\n\tif (!caption) {\r\n\t\tcaption = jslet.locale.MessageBox.error;\r\n\t}\r\n\tvar owin = omsgBox.show(message, caption, 'error', ['ok'], callbackFn);\r\n\tif(timeout) {\r\n\t\ttimeout = parseInt(timeout);\r\n\t\tif(window.isNam(timeout)) {\r\n\t\t\twindow.setTimeout(function() {\r\n\t\t\t\towin.close();\r\n\t\t\t}, timeout);\r\n\t\t}\r\n\t}\r\n};\r\n\r\n/**\r\n * Show warning message. Example:\r\n * <pre><code>\r\n * jslet.ui.MessageBox.warn('Program will be shut down!', 'Warning');\r\n * </code></pre>\r\n */\r\njslet.ui.MessageBox.warn = function (message, caption, callbackFn) {\r\n\tvar omsgBox = new jslet.ui.MessageBox();\r\n\tif (!caption) {\r\n\t\tcaption = jslet.locale.MessageBox.warn;\r\n\t}\r\n\tomsgBox.show(message, caption, 'warning', ['ok'], callbackFn);\r\n};\r\n\r\n/**\r\n * Show confirm message. Example:\r\n * <pre><code>\r\n * var callbackFn = function(button, value){\r\n * alert('Button: ' + button + ' clicked!');\r\n * }\r\n * jslet.ui.MessageBox.warn('Are you sure?', 'Confirm', callbackFn);//show Ok/Cancel\r\n * jslet.ui.MessageBox.warn('Are you sure?', 'Confirm', callbackFn, true);//show Yes/No/Cancel\r\n * </code></pre>\r\n */\r\njslet.ui.MessageBox.confirm = function(message, caption, callbackFn, isYesNo){\r\n\tvar omsgBox = new jslet.ui.MessageBox();\r\n\tif (!caption) {\r\n\t\tcaption = jslet.locale.MessageBox.confirm;\r\n\t}\r\n\tif (!isYesNo) {\r\n\t\tomsgBox.show(message, caption, 'question',['ok', 'cancel'], callbackFn);\t\r\n\t} else {\r\n\t\tomsgBox.show(message, caption, 'question', ['yes', 'no', 'cancel'], callbackFn);\r\n\t}\r\n};\r\n\r\n/**\r\n * Prompt user to input some value. Example:\r\n * <pre><code>\r\n * var callbackFn = function(button, value){\r\n * alert('Button: ' + button + ' clicked!');\r\n * }\r\n * var validateFn = function(value){\r\n *  if (!value){\r\n *    alert('Please input some thing!');\r\n * return false;\r\n *  }\r\n *  return true;\r\n * }\r\n * jslet.ui.MessageBox.prompt('Input your name: ', 'Prompt', callbackFn, 'Bob', validateFn);\r\n * jslet.ui.MessageBox.warn('Input your comments: ', 'Prompt', callbackFn, null, validateFn, true);\r\n * </code></pre>\r\n */\r\njslet.ui.MessageBox.prompt = function (message, caption, callbackFn, defaultValue, validateFn, isMultiLine) {\r\n\tvar omsgBox = new jslet.ui.MessageBox();\r\n\tif (!caption) {\r\n\t\tcaption = jslet.locale.MessageBox.prompt;\r\n\t}\r\n\tif (!isMultiLine) {\r\n\t\tomsgBox.show(message, caption, null, ['ok', 'cancel'], callbackFn, 1, defaultValue, validateFn);\r\n\t} else {\r\n\t\tomsgBox.show(message, caption, null, ['ok', 'cancel'], callbackFn, 2, defaultValue, validateFn);\r\n\t}\r\n};\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n\"use strict\";\r\njslet.ui.TableCellEditor = function(tableCtrl) { \r\n\tvar _tableCtrl = tableCtrl; \r\n\tvar _editPanel;\r\n\tvar _currField;\r\n\t\r\n\tfunction _create() { \r\n\t\tvar html = '<div class=\"form-group form-group-sm jl-tbl-editpanel\"><table class=\"jl-tbl-edittable\"><tbody><tr class=\"jl-tbl-editrow\">';\r\n\t\tvar columns = _tableCtrl._sysColumns, colCfg,\r\n\t\t\ttblDataset = tableCtrl.dataset(),\r\n\t\t\tdsName = tblDataset.name(),\r\n\t\t\tleft = 1, i, len;\r\n\t\t\t\r\n\t\tfor(i = 0, len = columns.length; i < len; i++) {\r\n\t\t\tcolCfg = columns[i];\r\n\t\t\tleft += colCfg.width + 1;\r\n\t\t}\r\n\t\tcolumns = _tableCtrl.innerColumns;\r\n\t\tvar tableId = tableCtrl.el.id,\r\n\t\t\teditorTabIndex = tableCtrl.editorTabIndex(),\r\n\t\t\tisBool,\r\n\t\t\talignStr = ';text-align: center';\r\n\t\tfor(i = 0, len = columns.length; i < len; i++) {\r\n\t\t\tcolCfg = columns[i];\r\n\t\t\tif(colCfg.field) {\r\n\t\t\t\tisBool = (tblDataset.getField(colCfg.field).dataType() === jslet.data.DataType.BOOLEAN);\r\n\t\t\t\thtml += '<td class=\"jl-edtfld-' + colCfg.field +  '\" style=\"display:none;vertical-align: middle' + (isBool? alignStr: '') + \r\n\t\t\t\t'\"><div data-jslet=\\'type:\"DBPlace\",dataset:\"' + dsName + \r\n\t\t\t\t'\",field:\"' + colCfg.field + \r\n\t\t\t\t'\", tableId: \"' + tableId + \r\n\t\t\t\t'\", expandChildWidth: ' + (isBool? 'false': 'true') + \r\n\t\t\t\t(editorTabIndex? ', tabIndex: ' + editorTabIndex: '') + \r\n\t\t\t\t'\\' class=\"' + colCfg.widthCssName + '\"></div></td>';\r\n\t\t\t}\r\n\t\t}\r\n\t\thtml += '</tr></tbody></table></div>';\r\n\t\tvar jqPanel = jQuery(html);\r\n\t\tjqPanel.appendTo(jQuery(_tableCtrl.el));\r\n\t\tjqPanel.css('left', left + 'px');\r\n\t\tjslet.ui.install(jqPanel[0]);\r\n\t\t_editPanel = jqPanel;\r\n\t\tjqPanel.height(_tableCtrl.rowHeight());\r\n\t\tjqPanel.on('keydown', function(event) {\r\n\t\t\tvar keyCode = event.which;\r\n\t\t\t//prevent to fire dbtable's ctrl+c\r\n\t\t\tif(event.ctrlKey && keyCode === jslet.ui.KeyCode.C) { //ctrl + c\r\n\t       \t\tevent.stopImmediatePropagation();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t_create();\r\n\t\r\n\tthis.showEditor = function(fldName, otd) {\r\n\t\tvar dataset = _tableCtrl.dataset();\r\n\t\tif(!fldName) {\r\n\t\t\t_tableCtrl.dataset().focusEditControl(_currField);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar fldObj = dataset.getField(fldName);\r\n\t\tif(!fldObj || fldObj.disabled() || fldObj.readOnly()) {\r\n\t\t\t_editPanel.hide();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar cellPos = jQuery(otd).offset();\r\n\t\tif(_currField) {\r\n\t\t\t_editPanel.show().find('.jl-edtfld-' + _currField).hide();\r\n\t\t}\r\n\t\tvar jqEditor = _editPanel.find('.jl-edtfld-' + fldName);\r\n\t\t_editPanel.offset(cellPos);\r\n\t\tjqEditor.show();\r\n\t\t_tableCtrl.dataset().focusEditControl(fldName);\r\n\t\t_currField = fldName;\r\n\t};\r\n\t\r\n\tthis.currentField = function() {\r\n\t\treturn _currField;\r\n\t};\r\n\t\r\n\tthis.hideEditor = function() {\r\n\t\t_editPanel.hide();\r\n\t};\r\n\t\r\n\tthis.destroy = function() { \r\n\t\t_tableCtrl = null; \r\n\t};\r\n};\r\n\r\n/**\r\n * Find dialog for DBTable and DBTreeView control\r\n */\r\njslet.ui.FindDialog = function (dbContainer) {\r\n\tvar _dialog;\r\n\tvar _dataset = dbContainer.dataset();\r\n\tvar _containerEl = dbContainer.el;\r\n\tvar _currfield = null;\r\n\tvar _findingField = null;\r\n\tvar _left = -1;\r\n\tvar _top = -1;\r\n\tfunction initialize() {\r\n\t\tvar opt = { type: 'window', caption: jslet.formatMessage(jslet.locale.findDialog.caption, ['']), isCenter: false, resizable: true, minimizable: false, maximizable: false, \r\n\t\t\t\tstopEventBubbling: true, styleClass: 'jl-finddlg'};\r\n\t\t_dialog = jslet.ui.createControl(opt, _containerEl);\r\n\t\t_dialog.onClosed(function(){\r\n\t\t\treturn 'hidden';\r\n\t\t});\r\n\t\t\t\r\n\t\tvar content = '<div class=\"input-group input-group-sm\"><input class=\"form-control jl-finddlg-value\" placeholder=\"' + \r\n\t\tjslet.locale.findDialog.placeholder + '\"/>' + \r\n\t\t'<div class=\"input-group-btn\"><button class=\"btn btn-default jl-finddlg-find\"><i class=\"fa fa-search\" /></button></div></div>';\r\n\t\t\r\n\t\t_dialog.setContent(content);\r\n\t\t_dialog.onPositionChanged(function(left, top) {\r\n\t\t\t_left = (left > 0? left: 0);\r\n\t\t\t_top = (top > 0? top: 0);\r\n\t\t});\r\n\t\tvar dlgEl = _dialog.el;\r\n\r\n\t\tvar jqFindingValue = jQuery(dlgEl).find('.jl-finddlg-value');\r\n\t\tvar isStart = true;\r\n\t\tjqFindingValue.on('keydown', function(event){\r\n\t\t\tif(event.keyCode === jslet.ui.KeyCode.ENTER) {\r\n\t\t\t\tfindData();\r\n\t       \t\tevent.stopImmediatePropagation();\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tisStart = true;\r\n\t\t});\r\n\t\t\r\n\t\tvar jqFind = jQuery(dlgEl).find('.jl-finddlg-find');\r\n\t\tjqFind.on('click', function(event) {\r\n\t\t\tfindData();\r\n\t\t});\r\n\r\n\t\tfunction findData() {\r\n\t\t\tif(_dataset.recordCount() < 2) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar findingValue = jqFindingValue.val(),\r\n\t\t\t\tcurrRecno = 0;\r\n\t\t\tif(!isStart) {\r\n\t\t\t\tcurrRecno = _dataset.recno() + 1;\r\n\t\t\t}\r\n\t\t\tvar found = _dataset.findByField(_findingField, findingValue, currRecno, true, 'any');\r\n\t\t\tisStart = !found;\r\n\t\t\tif(!found) {\r\n\t\t\t\tif(currRecno > 0) { //If not found, find from the first position.\r\n\t\t\t\t\tfindData();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn found;\r\n\t\t}\r\n\t}\r\n\t\r\n\tthis.show = function(left, top) {\r\n\t\tif(_left >= 0) {\r\n\t\t\tleft = _left;\r\n\t\t}\r\n\t\tif(_top >= 0) {\r\n\t\t\ttop = _top;\r\n\t\t}\r\n\t\tleft = left || 0;\r\n\t\ttop = top || 0;\r\n\t\t_dialog.show(left, top);\r\n\t\tthis.focus();\r\n\t};\r\n\t\r\n\tthis.hide = function() {\r\n\t\t_dialog.hide();\r\n\t};\r\n\t\r\n\tthis.findingField = function(findingField) {\r\n\t\tif(findingField === undefined) {\r\n\t\t\treturn _findingField;\r\n\t\t}\r\n\t\tvar oldField = _findingField;\r\n\t\t_findingField = findingField;\r\n\t\tif(_findingField) {\r\n\t\t\tvar fldObj = _dataset.getField(_findingField);\r\n\t\t\tif(fldObj) {\r\n\t\t\t\t_dialog.changeCaption(jslet.formatMessage(jslet.locale.findDialog.caption, [fldObj.label()]));\r\n\t\t\t\tif(oldField != findingField) {\r\n\t\t\t\t\tjQuery(_dialog.el).find('.jl-finddlg-value').val('');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t\r\n\tthis.focus = function() {\r\n\t\tjQuery(_dialog.el).find('.jl-finddlg-value').focus();\r\n\t};\r\n\t\r\n\tthis.destroy = function() {\r\n\t\t_dialog.destroy();\r\n\t};\r\n\t\r\n\tinitialize();\r\n};\r\n\r\n/**\r\n * Filter dialog for DBTable and DBTreeView control\r\n */\r\njslet.ui.FilterDialog = function (dataset, fields) {\r\n\t\r\n};\r\n\r\n/**\r\n * Filter panel for DBTable\r\n */\r\njslet.ui.DBTableFilterPanel = function(tblCtrl) {\r\n\tvar Z = this;\r\n\tZ._width = 300;\r\n\tZ._height = 150;\r\n\tZ.fieldName = null;\r\n\tZ._filterDatasetObj = new jslet.data.FilterDataset(tblCtrl.dataset());\r\n\tZ._filterDataset = Z._filterDatasetObj.filterDataset();\r\n\tZ._filterDataset.getField('lParenthesis').visible(false);\r\n\tZ._filterDataset.getField('rParenthesis').visible(false);\r\n\tZ._filterDataset.getField('logicalOpr').visible(false);\r\n\tZ._filterDataset.getField('valueExprInput').visible(false);\r\n\tZ._dbtable = tblCtrl;\r\n\tZ._jqFilterBtn = null;\r\n\tZ._currFieldName = null;\r\n\tZ._currFilterExpr = null;\r\n};\r\n\r\njslet.ui.DBTableFilterPanel.prototype = {\r\n\t\r\n\tjqFilterBtn: function(jqFilterBtn) {\r\n\t\tthis._jqFilterBtn = jqFilterBtn;\r\n\t},\r\n\t\t\r\n\tchangeField: function(fldName) {\r\n\t\tvar dsFilter = this._filterDataset,\r\n\t\t\tfldObj = dsFilter.getField('field'),\r\n\t\t\tlkDs = fldObj.lookup().dataset();\r\n\t\tdsFilter.cancel();\r\n\t\tlkDs.filter('[name] == \"' + fldName +'\" || like([name],\"'+ fldName + '.%' + '\")');\r\n\t\tlkDs.filtered(true);\r\n\t\tfldObj.visible(lkDs.recordCount() > 1);\r\n\t\tif(!dsFilter.find('[field] == \"' + fldName + '\" || like([field], \"' + fldName + '.%' + '\")')) {\r\n\t\t\tdsFilter.appendRecord();\r\n\t\t\tdsFilter.setFieldValue('field', fldName);\r\n\t\t}\r\n\t\tthis._currFieldName = fldName;\r\n\t},\r\n\t\r\n\tshow: function (left, top, ajustX, ajustY) {\r\n\t\tvar Z = this;\r\n\t\tif (!Z._panel) {\r\n\t\t\tZ._panel = Z._create();\r\n\t\t}\r\n\t\tZ._panel.style.left = left + 'px';\r\n\t\tZ._panel.style.top = top + 'px';\r\n\t\tjQuery(Z._panel).show('fast');\r\n\t\twindow.setTimeout(function(){\r\n\t\t\tZ._filterDataset.focusEditControl('value');\r\n\t\t},5);\r\n\t},\r\n\r\n\thide: function () {\r\n\t\tthis._filterDataset.cancel();\r\n\t\tjQuery(this._panel).hide('fast');\r\n\t},\r\n\t\r\n\tcancelFilter: function() {\r\n\t\tthis._filterDataset.cancel();\r\n\t},\r\n\t\r\n\t_create: function () {\r\n\t\tvar Z = this;\r\n\t\tif (!Z._panel) {\r\n\t\t\tZ._panel = document.createElement('div');\r\n\t\t\tZ._dbtable.el.appendChild(Z._panel);\r\n\t\t}\r\n\t\tjQuery(Z._panel).addClass('panel panel-default jl-filter-panel');\r\n\t\tZ._panel.innerHTML = '<div class=\"\"><div data-jslet=\"type: \\'DBEditPanel\\', dataset: \\'' + Z._filterDataset.name() + \r\n\t\t'\\', columnCount: 1,hasLabel:false \" style=\"width:100%;height:100%\" ></div></div>' +\r\n\t\t'<div><button class=\"btn btn-default btn-sm jl-filter-panel-ok\" tabIndex=\"90990\">' + jslet.locale.FilterPanel.ok +\r\n\t\t'</button><button class=\"btn btn-default btn-sm jl-filter-panel-cancel\" tabIndex=\"90991\">' + jslet.locale.FilterPanel.cancel + \r\n\t\t'</button><button class=\"btn btn-default btn-sm jl-filter-panel-clear\" tabIndex=\"90992\">' + jslet.locale.FilterPanel.clear + \r\n\t\t'</button><button class=\"btn btn-default btn-sm jl-filter-panel-clearall\" tabIndex=\"90993\">' + jslet.locale.FilterPanel.clearAll + \r\n\t\t'</button></div>';\r\n\t\tjslet.ui.install(Z._panel);\r\n\t\tvar jqPanel = jQuery(Z._panel);\r\n\t\tjqPanel.find('.jl-filter-panel-ok').on('click', function(){\r\n\t\t\tvar dsFilter = Z._filterDataset;\r\n\t\t\tdsFilter.confirm();\r\n\t\t\tif(jslet.isEmpty(dsFilter.getFieldValue('value'))) {\r\n\t\t\t\tdsFilter.deleteRecord();\r\n\t\t\t}\r\n\t\t\tvar filter = Z._filterDatasetObj.getFilterExpr();\r\n\t\t\tZ._dbtable.dataset().filter(filter).filtered(true);\r\n\t\t\tZ._currFilterExpr = filter;\r\n\t\t\t\r\n\t\t\tZ.hide();\r\n\t\t\tZ._setFilterBtnStyle();\r\n\t\t});\r\n\t\tjqPanel.find('.jl-filter-panel-cancel').on('click', function(){\r\n\t\t\tZ._filterDataset.cancel();\r\n\t\t\tZ.hide();\r\n\t\t});\r\n\t\tjqPanel.find('.jl-filter-panel-clear').on('click', function(){\r\n\t\t\tZ._filterDataset.deleteRecord();\r\n\t\t\tvar filter = Z._filterDatasetObj.getFilterExpr();\r\n\t\t\tZ._dbtable.dataset().filter(filter).filtered(true);\r\n\t\t\tZ.hide();\r\n\t\t\tZ._currFilterExpr = filter;\r\n\t\t\tZ._setFilterBtnStyle();\r\n\t\t});\r\n\t\tjqPanel.find('.jl-filter-panel-clearall').on('click', function(){\r\n\t\t\tZ._filterDataset.dataList(null);\r\n\t\t\tZ._dbtable.dataset().filter(null).filtered(false);\r\n\t\t\tZ.hide();\r\n\t\t\tZ._clearFilterBtnStyle();\r\n\t\t});\r\n\t\t//prevent to fire the dbtable's keydown event.\r\n\t\tjqPanel.on('keydown', function(event) {\r\n       \t\tevent.stopImmediatePropagation();\r\n\t\t});\r\n\t\treturn Z._panel;\r\n\t},\r\n\r\n\t_clearFilterBtnStyle: function() {\r\n\t\tvar jqPanel = jQuery(this._panel);\r\n\t\tjQuery(this._dbtable.el).find('.jl-tbl-filter-hasfilter').attr('title', '').removeClass('jl-tbl-filter-hasfilter');\r\n\t\tjqPanel.find('.jl-filter-panel-clearall').attr('title', '');\r\n\t\tthis._currFilterExpr = null;\r\n\t},\r\n\t\r\n\tcheckFilterBtnStyle: function() {\r\n\t\tvar Z = this;\r\n\t\tif(!Z._currFilterExpr) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar dsHost = Z._dbtable.dataset(),\r\n\t\t\tdsFilterExpr = dsHost.filter();\r\n\t\tif(dsHost.filtered() && dsFilterExpr == Z._currFilterExpr) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tZ._clearFilterBtnStyle();\r\n\t\tvar dsFilter = Z._filterDataset;\r\n\t\tif(!dsFilterExpr || !dsHost.filtered()) {\r\n\t\t\tdsFilter.dataList(null);\r\n\t\t}\r\n\t\tvar filterText = Z._filterDatasetObj.getFilterExprText();\r\n\t\tjQuery(Z._dbtable.el).find('button.jl-tbl-filter').each(function(){\r\n\t\t\tvar fldName = this.getAttribute('jsletfilterfield');\r\n\t\t\tvar jqFilterBtn = jQuery(this);\r\n\t\t\tif(dsFilter.find('[field] == \"' + fldName + '\" || like([field], \"' + fldName + '.%' + '\")')) {\r\n\t\t\t\tjqFilterBtn.addClass('jl-tbl-filter-hasfilter');\r\n\t\t\t} else {\r\n\t\t\t\tjqFilterBtn.removeClass('jl-tbl-filter-hasfilter');\r\n\t\t\t}\r\n\t\t\tjqFilterBtn.attr('title', filterText || '');\r\n\t\t});\r\n\t\tjQuery(Z._panel).find('.jl-filter-panel-clearall').attr('title', filterText || '');\r\n\t},\r\n\t\r\n\t_setFilterBtnStyle: function() {\r\n\t\tvar Z = this;\r\n\t\tvar filterText = Z._filterDatasetObj.getFilterExprText();\r\n\t\t\r\n\t\tvar dsFilter = Z._filterDataset;\r\n\t\tif(dsFilter.find('[field] == \"' + Z._currFieldName + '\" || like([field], \"' + Z._currFieldName + '.%' + '\")')) {\r\n\t\t\tZ._jqFilterBtn.addClass('jl-tbl-filter-hasfilter');\r\n\t\t} else {\r\n\t\t\tZ._jqFilterBtn.removeClass('jl-tbl-filter-hasfilter');\r\n\t\t}\r\n\t\tZ._jqFilterBtn.attr('title', filterText || '');\r\n\t\tjQuery(Z._dbtable.el).find('.jl-tbl-filter-hasfilter').attr('title', filterText || '');\r\n\t\tjQuery(Z._panel).find('.jl-filter-panel-clearall').attr('title', filterText || '');\r\n\t},\r\n\t\r\n\tdestroy: function(){\r\n\t\tvar Z = this;\r\n\t\tjslet.ui.uninstall(Z._panel);\r\n\t\tZ._panel.innerHTML = '';\r\n\t\tZ._panel = null;\r\n\t\tZ._dbtable = null;\r\n\t\tZ._jqFilterBtn = null;\r\n\t}\r\n};\r\n\r\n/**\r\n * Export dialog;\r\n */\r\njslet.ui.ExportDialog = function(dataset, hasSchemaSection) {\r\n\tthis._dataset = jslet.data.getDataset(dataset);\r\n\tthis._exportDataset = null;\r\n\tthis._hasSchemaSection = (hasSchemaSection === undefined || hasSchemaSection ? true: false);\r\n\t\r\n\tthis._dlgId = null;\r\n\t\r\n\tthis._initialize();\r\n};\r\n\r\njslet.ui.ExportDialog.prototype = {\r\n\t_initialize: function() {\r\n\t\tvar fldCfg = [\r\n\t\t    \t      {name: 'field', type: 'S', length: 100, label: 'Field Name', nullText: 'default'}, \r\n\t\t    \t      {name: 'label', type: 'S', length: 50, label: 'Field Label'},\r\n\t\t    \t      {name: 'parent', type: 'S', length: 100, label: 'Field Name'}, \r\n\t\t    \t    ];\r\n\t\tvar exportLKDs = jslet.data.createDataset('exportLKDs' + jslet.nextId(), fldCfg, \r\n\t\t\t\t{keyField: 'field', codeField: 'field', nameField: 'label', parentField: 'parent', isFireGlobalEvent: false});\r\n\t\texportLKDs.onCheckSelectable(function(){\r\n\t        return !this.hasChildren(); \r\n\t    });\r\n\t\t\r\n\t\tvar expFldCfg = [\r\n    \t      //{name: 'schemaId', type: 'S', length: 30, label: 'Export Schema ID'}, \r\n    \t      {name: 'schema', type: 'S', length: 30, label: 'Export Schema'}, \r\n    \t      {name: 'fields', type: 'S', length: 500, label: 'Export Fields', visible: false, valueStyle: jslet.data.FieldValueStyle.MULTIPLE, lookup: {dataset: exportLKDs}}\r\n    \t    ];\r\n    \tthis._exportDataset = jslet.data.createDataset('exportDs' + jslet.nextId(), expFldCfg, {keyField: 'schema', nameField: 'schema', isFireGlobalEvent: false});\r\n    \tif(this._hasSchemaSection) {\r\n\t    \tvar exportDsClone = this._exportDataset;\r\n\t    \tvar lkObj = new jslet.data.FieldLookup();\r\n\t    \tlkObj.dataset(exportDsClone);\r\n\t    \tthis._exportDataset.getField('schema').lookup(lkObj);\r\n    \t}\r\n\t\tvar opt = { type: 'window', caption: jslet.locale.ExportDialog.caption, isCenter: true, resizable: true, minimizable: false, maximizable: false, animation: 'fade'};\r\n\t\tvar owin = jslet.ui.createControl(opt);\r\n\t\tvar html = ['<div class=\"form-horizontal jl-expdlg-content\" data-jslet=\"dataset: \\'', this._exportDataset.name(),\r\n\t\t            '\\'\"><div class=\"form-group form-group-sm\">',\r\n\t\t            '<div class=\"col-sm-6\"><div data-jslet=\"type:\\'DBComboSelect\\',field:\\'schema\\'\"></div></div>',\r\n\t\t            '<div class=\"col-sm-6\"><button class=\"btn btn-default btn-sm\" id=\"jlbtnSave\">',\r\n\t\t            jslet.locale.ExportDialog.saveSchema,\r\n\t\t            '</button><button class=\"btn btn-default btn-sm\">',\r\n\t\t            jslet.locale.ExportDialog.deleteSchema,\r\n\t\t            '</button></div></div>',\r\n\t\t            \r\n\t\t            '<div class=\"form-group form-group-sm\">',\r\n\t\t            '<div class=\"col-sm-12 jl-expdlg-fields\" data-jslet=\"type:\\'DBList\\',field:\\'fields\\',correlateCheck:true\"></div></div>',\r\n\r\n\t\t            '<div class=\"form-group form-group-sm\"><label class=\"control-label col-sm-3\">',\r\n\t\t            jslet.locale.ExportDialog.fileName,\r\n\t\t            '</label>',\r\n\t\t\t\t\t'<div class=\"col-sm-9\"><input id=\"jltxtExportFile\" class=\"form-control\" type=\"text\"></input></div></div>',\r\n\t\t            '<div class=\"form-group form-group-sm\"><label class=\"control-label col-sm-8\">&nbsp</label>',\r\n\t\t            '<div class=\"col-sm-4\"><button id=\"jlbtnExport\" class=\"btn btn-default btn-sm\">',\r\n\t\t            jslet.locale.ExportDialog.exportData,\r\n\t\t            '</button><button id=\"jlbtnCancel\" class=\"btn btn-default btn-sm\">',\r\n\t\t            jslet.locale.ExportDialog.cancel,\r\n\t\t            '</button></div></div>',\r\n\t\t            '</div>'];\r\n\t\towin.setContent(html.join(''));\r\n\t\towin.onClosed(function () {\r\n\t\t\treturn 'hidden';\r\n\t\t});\r\n\t\tvar Z = this;\r\n\t\tthis._dlgId = owin.el.id;\r\n\t\tvar jqEl = jQuery(owin.el);\r\n\t\tjqEl.find('#jlbtnExport').click(function(event) {\r\n\t\t\tvar jqExpportFile = jqEl.find('#jltxtExportFile');\r\n\t\t\tvar fileName = jqExpportFile.val();\r\n\t\t\tif(!fileName || !fileName.trim()) {\r\n\t\t\t\tjslet.showInfo('FileName required!');\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tvar fields = Z._exportDataset.getFieldValue('fields');\r\n\t\t\t\r\n\t\t\tZ._dataset.exportCsvFile(fileName, {includeFields: fields});\r\n\t\t\towin.close();\r\n\t\t});\r\n\t\tjqEl.find('#jlbtnSave').click(function(event) {\r\n\t\t\tjslet.ui.MessageBox.prompt('Please input exportting shema: ', 'Input Export Schema', function(button, value){\r\n\t\t\t\tif(button === 'ok' && value) {\r\n\t\t\t\t\tvar fields = Z._exportDataset.getFieldValue('fields');\r\n\t\t\t\t\tZ._exportDataset.appendRecord();\r\n\t\t\t\t\tZ._exportDataset.setFieldValue('schema', value);\r\n\t\t\t\t\tZ._exportDataset.setFieldValue('fields', fields);\r\n\t\t\t\t\tZ._exportDataset.confirm();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\t\r\n\t\tjqEl.find('#jlbtnCancel').click(function(event) {\r\n\t\t\towin.close();\r\n\t\t});\r\n\t},\r\n\t\r\n\texportDataset: function(exportDs) {\r\n\t\treturn this._exportDataset;\r\n\t},\r\n\t\r\n\t_refreshFields: function() {\r\n\t\tvar dataList = [{field: '_all_', label: jslet.locale.ExportDialog.all}];\r\n\t\tvar fieldNames = [];\r\n\t\t\r\n\t\tfunction addFields(dataList, fieldNames, fields, parentField, isDetailDs) {\r\n\t\t\tvar fldObj, fldName;\r\n\t\t\tfor(var i = 0, len = fields.length; i < len; i++) {\r\n\t\t\t\tfldObj = fields[i];\r\n\t\t\t\tfldName = fldObj.name();\r\n\t\t\t\tif(parentField && isDetailDs) {\r\n\t\t\t\t\tfldName = parentField + '.' + fldName;\r\n\t\t\t\t}\r\n\t\t\t\tvar detailDs = fldObj.subDataset();\r\n\t\t\t\tif(detailDs) {\r\n\t\t\t\t\tdataList.push({field: fldName, label: fldObj.label(), parent: parentField || '_all_'});\r\n\t\t\t\t\taddFields(dataList, fieldNames, detailDs.getNormalFields(), fldName, true);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif(!fldObj.visible()) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tdataList.push({field: fldName, label: fldObj.label(), parent: parentField || '_all_'});\r\n\t\t\t\tvar fldChildren = fldObj.children();\r\n\t\t\t\tif(fldChildren) {\r\n\t\t\t\t\taddFields(dataList, fieldNames, fldChildren, fldName);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfieldNames.push(fldName);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\taddFields(dataList, fieldNames, this._dataset.getFields());\r\n\t\tvar exportLKDs = this._exportDataset.getField('fields').lookup().dataset();\r\n\t\texportLKDs.dataList(dataList);\r\n\t\tthis._exportDataset.setFieldValue('fields', fieldNames);\r\n\t\texportLKDs.first();\r\n\t},\r\n\r\n\tshow: function() {\r\n\t\tvar Z = this;\r\n\t\tZ._refreshFields();\r\n\t\tvar jqEl = jQuery('#' + this._dlgId);\r\n\t\tvar owin = jqEl[0].jslet;\r\n\t\tvar fileName = Z._dataset.description() + '.csv';\r\n\t\tvar jqExpportFile = jqEl.find('#jltxtExportFile');\r\n\t\tjqExpportFile.val(fileName);\r\n\t\towin.showModal();\r\n\t\towin.setZIndex(999);\r\n\t\treturn owin;\r\n\t}\r\n};\r\n\r\njslet.ui.InputSettingDialog = function() {\r\n\tthis._inputSettingDs = null;\r\n\t\r\n\tthis._hostDataset = null;\r\n\t\r\n\tthis._onClosed = null;\r\n\t\r\n\tthis._onRestoreDefault = null;\r\n\t\r\n\tthis._settings = null;\r\n\tvar Z = this;\r\n\t\r\n\tfunction doProxyFieldChanged(dataRec, proxyFldName, proxyFldObj) {\r\n\t\tvar hostFldObj = jslet.data.getDataset(dataRec.dataset).getField(proxyFldName);\r\n\t\tproxyFldObj.dataType(hostFldObj.dataType());\r\n\t\tproxyFldObj.length(hostFldObj.length());\r\n\t\tproxyFldObj.scale(hostFldObj.scale());\r\n\t\tproxyFldObj.editMask(hostFldObj.editMask());\r\n\r\n\t\tproxyFldObj.displayFormat(hostFldObj.displayFormat());\r\n\t\tproxyFldObj.dateFormat(hostFldObj.dateFormat());\r\n\t\tproxyFldObj.displayControl(hostFldObj.displayControl());\r\n\t\tproxyFldObj.validChars(hostFldObj.validChars());\r\n\t\tif(hostFldObj.lookup()) {\r\n\t\t\tvar hostLkObj = hostFldObj.lookup();\r\n\t\t\tvar lkObj = new jslet.data.FieldLookup();\r\n\t\t\tlkObj.dataset(hostLkObj.dataset());\r\n\t\t\tlkObj.keyField(hostLkObj.keyField());\r\n\t\t\tlkObj.codeField(hostLkObj.codeField());\r\n\t\t\tlkObj.nameField(hostLkObj.nameField());\r\n\t\t\tlkObj.displayFields(hostLkObj.displayFields());\r\n\t\t\tlkObj.parentField(hostLkObj.parentField());\r\n\t\t\tlkObj.onlyLeafLevel(false);\r\n\t\t\tproxyFldObj.lookup(lkObj);\r\n\t\t\tproxyFldObj.editControl('DBComboSelect');\r\n\t\t} else {\r\n\t\t\tproxyFldObj.lookup(null);\r\n\t\t\tvar editorObj = hostFldObj.editControl();\r\n\t\t\tif(jslet.compareValue(editorObj.type,'DBTextArea') === 0) {\r\n\t\t\t\teditorObj = {type: 'DBText'};\r\n\t\t\t}\r\n\t\t\tproxyFldObj.editControl(editorObj);\r\n\t\t}\r\n\t\tproxyFldObj.valueStyle(jslet.data.FieldValueStyle.NORMAL);\r\n\t}\r\n\r\n\tfunction initialize() {\r\n\t\tvar fldCfg = [{name: 'dataset', type: 'S', length: 30, visible: false},\r\n\t\t              {name: 'field', type: 'S', length: 30, displayWidth: 20, visible: false},\r\n\t\t              {name: 'label', type: 'S', label: jslet.locale.InputSettingDialog.labelLabel, length: 50, displayWidth: 20, disabled: true},\r\n\t\t              {name: 'parentField', type: 'S', length: 30, visible: false},\r\n\t\t              {name: 'tabIndex', type: 'N', label: 'tabIndex', length: 3, visible: false},\r\n\t\t              {name: 'defaultValue', type: 'P', label: jslet.locale.InputSettingDialog.labelDefaultValue, length: 200, displayWidth:30, proxyHostFieldName: 'field', proxyFieldChanged: doProxyFieldChanged},\r\n\t\t              {name: 'focused', type: 'B', label: jslet.locale.InputSettingDialog.labelFocused, displayWidth: 6},\r\n\t\t              {name: 'valueFollow', type: 'B', label: jslet.locale.InputSettingDialog.labelValueFollow, displayWidth: 6},\r\n\t\t              {name: 'isDatasetField', type: 'B', label: '', visible: false},\r\n\t\t              ];\r\n\t\t\r\n\t\tZ._inputSettingDs = jslet.data.createDataset('custDs' + jslet.nextId(), fldCfg, \r\n\t\t\t\t{keyField: 'field', nameField: 'label', parentField: 'parentField', logChanges: false, indexFields: 'tabIndex', isFireGlobalEvent: false});\r\n\t\t\r\n\t\tvar custContextFn = function(fldObj, changingFldName){\r\n\t\t\tvar dataset = fldObj.dataset();\r\n\t\t\tfldObj.disabled(dataset.getFieldValue('isDatasetField'));\r\n\t\t};\r\n\t\t\r\n\t\tZ._inputSettingDs.contextRules([{\"condition\": \"true\", \"rules\": [\r\n\t\t     {\"field\": 'defaultValue', \"customized\": custContextFn},\r\n\t\t     {\"field\": 'focused', \"customized\": custContextFn},\r\n\t\t     {\"field\": 'valueFollow', \"customized\": custContextFn}\r\n\t\t]}]);\r\n\t\tZ._inputSettingDs.enableContextRule();\r\n\t\tZ._inputSettingDs.onFieldChanged(function(propName, propValue){\r\n\t\t\tif(Z._isInit) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif(!Z._settings) {\r\n\t\t\t\tZ._settings = {};\r\n\t\t\t}\r\n\t\t\tvar hostDsName = this.getFieldValue('dataset'),\r\n\t\t\t\thostFldName = this.getFieldValue('field'),\r\n\t\t\t\tdsSetting = Z._settings[hostDsName];\r\n\t\t\tif(!dsSetting) {\r\n\t\t\t\tdsSetting = {};\r\n\t\t\t\tZ._settings[hostDsName] = dsSetting;\r\n\t\t\t}\r\n\t\t\tvar fldSetting = dsSetting[hostFldName];\r\n\t\t\tif(!fldSetting) {\r\n\t\t\t\tfldSetting = {};\r\n\t\t\t\tdsSetting[hostFldName] = fldSetting; \r\n\t\t\t}\r\n\t\t\tfldSetting[propName] = propValue;\r\n\t\t});\r\n\t}\r\n\t\r\n\tinitialize.call(this);\r\n};\r\n\r\njslet.ui.InputSettingDialog.prototype = {\r\n\t\t\r\n\thostDataset: function(hostDataset) {\r\n\t\tif(hostDataset === undefined) {\r\n\t\t\treturn this._hostDataset;\r\n\t\t}\r\n\t\tthis._hostDataset = hostDataset;\r\n\t},\r\n\t\r\n\tonClosed: function(onClosedFn) {\r\n\t\tif(onClosedFn === undefined) {\r\n\t\t\treturn this._onClosed;\r\n\t\t}\r\n\t\tthis._onClosed = onClosedFn;\r\n\t},\r\n\t\r\n\tonRestoreDefault: function(onRestoreDefaultFn) {\r\n\t\tif(onRestoreDefaultFn === undefined) {\r\n\t\t\treturn this._onRestoreDefault;\r\n\t\t}\r\n\t\tthis._onRestoreDefault = onRestoreDefaultFn;\r\n\t},\r\n\t\r\n\tshow: function(hostDataset) {\r\n\t\tjslet.Checker.test('InputSettingDialog.show#hostDataset', hostDataset).required();\r\n\t\tvar Z = this;\r\n\t\tZ._hostDataset = hostDataset;\r\n\t\tZ._isInit = true;\r\n\t\tZ._settings = null;\r\n\t\tZ._inputSettingDs.disableControls();\r\n\t\ttry {\r\n\t\t\tZ._initializeFields();\r\n\t\t} finally {\r\n\t\t\tZ._isInit = false;\r\n\t\t\tZ._inputSettingDs.first();\r\n\t\t\tZ._inputSettingDs.enableControls();\r\n\t\t}\r\n\t\tvar creating = false;\r\n\t\tif(!Z._dlgId) {\r\n\t\t\tZ._createDialog();\r\n\t\t\tcreating = true;\r\n\t\t}\r\n\t\tvar tblFields = jQuery('#' + Z._dlgId).find('.jl-isdlg-fields')[0].jslet;\r\n\t\ttblFields.expandAll();\r\n\t\tif(creating) {\r\n\t\t\ttblFields.onRowClick(function() {\r\n\t\t\t\tif(this.dataset().getFieldValue('isDatasetField')) {\r\n\t\t\t\t\tthis.toggle();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar owin = jslet('#' + Z._dlgId);\r\n\t\towin.showModal();\r\n\t\towin.setZIndex(999);\r\n\t},\r\n\t\r\n\t_initializeFields: function(hostDs, isKeepFields, parentField) {\r\n\t\tvar Z = this,\r\n\t\t\tdataset = Z._inputSettingDs,\r\n\t\t\tfldObj;\r\n\t\tif(!hostDs) {\r\n\t\t\thostDs = jslet.data.getDataset(Z._hostDataset);\r\n\t\t}\r\n\t\tvar fields = hostDs.getNormalFields();\r\n\t\tif(!isKeepFields) {\r\n\t\t\tdataset.dataList(null);\r\n\t\t}\r\n\t\tvar isDsFld;\r\n\t\tfor(var i = 0, len = fields.length; i < len; i++) {\r\n\t\t\tfldObj = fields[i];\r\n\t\t\tisDsFld = fldObj.subDataset()? true: false;\r\n\t\t\tif(!isDsFld && !fldObj.visible()) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tdataset.appendRecord();\r\n\t\t\tdataset.setFieldValue('isDatasetField', isDsFld);\r\n\t\t\t\r\n\t\t\tdataset.setFieldValue('dataset', hostDs.name());\r\n\t\t\tdataset.setFieldValue('field', fldObj.name());\r\n\t\t\tdataset.setFieldValue('label', fldObj.label());\r\n\t\t\tdataset.setFieldValue('tabIndex', fldObj.tabIndex());\r\n\t\t\tif(parentField) {\r\n\t\t\t\tdataset.setFieldValue('parentField', parentField);\r\n\t\t\t}\r\n\t\t\tif(!isDsFld) {\r\n\t\t\t\tdataset.setFieldValue('defaultValue', fldObj.defaultValue());\r\n\t\t\t\tdataset.setFieldValue('focused', fldObj.focused());\r\n\t\t\t\tdataset.setFieldValue('valueFollow', fldObj.valueFollow());\r\n\t\t\t}\r\n\t\t\tdataset.confirm();\r\n\t\t\tif(isDsFld) {\r\n\t\t\t\tthis._initializeFields(fldObj.subDataset(), true, fldObj.name());\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\t_createDialog: function() {\r\n\t\tvar opt = { type: 'window', caption: jslet.locale.InputSettingDialog.caption, isCenter: true, resizable: true, minimizable: false, maximizable: false, animation: 'fade', styleClass: 'jl-isdlg'};\r\n\t\tvar owin = jslet.ui.createControl(opt);\r\n\t\tvar html = [\r\n\t\t            '<div class=\"form-group form-group-sm\">',\r\n\t\t            '<div class=\"jl-isdlg-fields\" data-jslet=\"type:\\'DBTable\\',dataset:\\'', this._inputSettingDs.name(), \r\n\t\t            '\\',treeField:\\'label\\',readOnly:false,hasFilterDialog:false\"></div></div>',\r\n\r\n//\t\t            '<div class=\"form-group form-group-sm\">',\r\n//\t\t            '<div class=\"col-sm-3\"><button id=\"jlbtnSave\" class=\"btn btn-default btn-sm\">',\r\n//\t\t            '<button id=\"jlbtnUp\" class=\"btn btn-default btn-sm\">', jslet.locale.InputSettingDialog.save, '</button>',\r\n//\t\t            '<button id=\"jlbtnDown\" class=\"btn btn-default btn-sm\">', jslet.locale.InputSettingDialog.save, '</button>',\r\n//\t\t            '</div>',\r\n//\t\t            '<label class=\"control-label col-sm-6\">&nbsp</label>',\r\n//\t\t            '<div class=\"col-sm-3\"><button id=\"jlbtnSave\" class=\"btn btn-default btn-sm\">',\r\n\t\t            \r\n\t\t            '<div class=\"form-group form-group-sm\"><label class=\"control-label col-sm-9\">&nbsp</label>',\r\n\t\t            '<div class=\"col-sm-3\"><button id=\"jlbtnSave\" class=\"btn btn-default btn-sm\">',\t\t            \r\n\t\t            jslet.locale.InputSettingDialog.save,\r\n\t\t            '</button><button id=\"jlbtnCancel\" class=\"btn btn-default btn-sm\">',\r\n\t\t            jslet.locale.InputSettingDialog.cancel,\r\n\t\t            '</button></div></div>',\r\n\t\t            '</div>'];\r\n\t\towin.setContent(html.join(''));\r\n\t\towin.onClosed(function () {\r\n\t\t\treturn 'hidden';\r\n\t\t});\r\n\t\tthis._dlgId = owin.el.id;\r\n\t\tvar jqEl = jQuery(owin.el), \r\n\t\t\tZ = this;\r\n\t\t\r\n//\t\tjqEl.find('#jlbtnUp').on('click', function(event) {\r\n//\t\t\tvar dataset = Z._inputSettingDs;\r\n//\t\t\tif(dataset.recordCount() === 0) {\r\n//\t\t\t\treturn;\r\n//\t\t\t}\r\n//\t\t\tvar idx = dataset.getFieldValue('tabIndex');\r\n//\t\t\tif(!idx) {\r\n//\t\t\t\tidx = dataset.recno();\r\n//\t\t\t}\r\n//\t\t\tif(idx === 0) {\r\n//\t\t\t\treturn;\r\n//\t\t\t}\r\n//\t\t\tvar context = dataset.startSilenceMove();\r\n//\t\t\ttry {\r\n//\t\t\t\tdataset.setFieldValue('tabIndex', idx - 1);\r\n//\t\t\t\tdataset.prior();\r\n//\t\t\t\tdataset.setFieldValue('tabIndex', idx);\r\n//\t\t\t\tdataset.confirm();\r\n//\t\t\t} finally {\r\n//\t\t\t\tdataset.endSilenceMove(context);\r\n//\t\t\t}\r\n//\t\t\tdataset.indexFields(dataset.indexFields());\r\n//\t\t});\r\n\t\t\r\n\t\tjqEl.find('#jlbtnSave').on('click', function(event) {\r\n\t\t\tif(Z._settings) {\r\n\t\t\t\tvar hostDs, fldObj, fldSetting, propSetting;\r\n\t\t\t\tfor(var dsName in Z._settings) {\r\n\t\t\t\t\thostDs = jslet.data.getDataset(dsName);\r\n\t\t\t\t\tfldSetting = Z._settings[dsName]; \r\n\t\t\t\t\tfor(var fldName in fldSetting) {\r\n\t\t\t\t\t\tfldObj = hostDs.getField(fldName);\r\n\t\t\t\t\t\tpropSetting = fldSetting[fldName];\r\n\t\t\t\t\t\tfor(var propName in propSetting) {\r\n\t\t\t\t\t\t\tfldObj[propName](propSetting[propName]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(Z._onClosed) {\r\n\t\t\t\t\tZ._onClosed(Z._settings);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\towin.close();\r\n\t\t});\r\n\t\tjqEl.find('#jlbtnCancel').on('click', function(event) {\r\n\t\t\towin.close();\r\n\t\t});\r\n\t\t\r\n\t\tjslet.ui.install(owin.el);\r\n\t}\r\n};\r\n\r\njslet.ui.defaultInputSettingDialog = new jslet.ui.InputSettingDialog();\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBChart, show data as a chart. There are five chart type: column, bar, line, area, pie  \r\n * Example:\r\n * <pre><code>\r\n *\t\tvar jsletParam = {type:\"dbchart\", dataset:\"summary\", chartType:\"column\",categoryField:\"month\",valueFields:\"amount\"};\r\n * \r\n * //1. Declaring:\r\n *\t\t&lt;div id=\"chartId\" data-jslet='type:\"dbchart\",chartType:\"column\",categoryField:\"month\",valueFields:\"amount,netProfit\", dataset:\"summary\"' />\r\n *\t\tor\r\n *\t\t&lt;div data-jslet='jsletParam' />\r\n *\r\n *  //2. Binding\r\n *\t\t&lt;div id=\"ctrlId\"  />\r\n *\t\t//Js snippet\r\n *\t\tvar el = document.getElementById('ctrlId');\r\n *\t\tjslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n *\t\tjslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBChart = jslet.Class.create(jslet.ui.DBControl, {\r\n\tchartTypes: ['line', 'bar', 'stackbar', 'pie'],\r\n\tlegendPositions: ['none', 'top', 'bottom', 'left', 'right'],\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,chartType,chartTitle,categoryField,valueFields,legendPos';\r\n\t\tZ.requiredProperties = 'valueFields,categoryField';\r\n\t\t\r\n\t\t/**\r\n\t\t * {String} Chart type. Optional value is: column, bar, line, area, pie\r\n\t\t */\r\n\t\tZ._chartType = \"line\";\r\n\t\t/**\r\n\t\t * {String} Category field, use comma(,) to separate multiple fields.\r\n\t\t */\r\n\t\tZ._categoryFields = null;\r\n\t\t/**\r\n\t\t * {Number} Value field, only one field allowed.\r\n\t\t */\r\n\t\tZ._valueFields = null;\r\n\t\t/**\r\n\t\t * {String} Chart title\r\n\t\t */\r\n\t\tZ._chartTitle = null;\r\n\r\n\t\t/**\r\n\t\t * {String} Legend position, optional value: none, top, bottom, left, right\r\n\t\t */\r\n\t\tZ._legendPos = 'top';\r\n\t\t\r\n\t\tZ._fieldValidated = false;\r\n\t\t\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\tchartType: function(chartType) {\r\n\t\tif(chartType === undefined) {\r\n\t\t\treturn this._chartType;\r\n\t\t}\r\n\t\tchartType = jQuery.trim(chartType);\r\n\t\tvar checker = jslet.Checker.test('DBChart.chartType', chartType).isString().required();\r\n\t\tchecker.testValue(chartType.toLowerCase()).inArray(this.chartTypes);\r\n\t\tthis._chartType = chartType;\r\n\t},\r\n\t\r\n\tcategoryField: function(categoryField) {\r\n\t\tif(categoryField === undefined) {\r\n\t\t\treturn this._categoryField;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBChart.categoryField', categoryField).isString().required();\r\n\t\tcategoryField = jQuery.trim(categoryField);\r\n\t\tthis._categoryField = categoryField;\r\n\t\tthis._fieldValidated = false;\r\n\t},\r\n\t\r\n\tvalueFields: function(valueFields) {\r\n\t\tif(valueFields === undefined) {\r\n\t\t\treturn this._valueFields;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBChart.valueFields', valueFields).isString().required();\r\n\t\tvalueFields = jQuery.trim(valueFields);\r\n\t\tthis._valueFields = valueFields.split(',');\r\n\t\tthis._fieldValidated = false;\r\n\t},\r\n\t\r\n\tchartTitle: function(chartTitle) {\r\n\t\tif(chartTitle === undefined) {\r\n\t\t\treturn this._chartTitle;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBChart.chartTitle', chartTitle).isString();\r\n\t\tthis._chartTitle = chartTitle;\r\n\t},\r\n\t\r\n\tlegendPos: function(legendPos) {\r\n\t\tif(legendPos === undefined) {\r\n\t\t\treturn this._legendPos;\r\n\t\t}\r\n\t\tlegendPos = jQuery.trim(legendPos);\r\n\t\tvar checker = jslet.Checker.test('DBChart.legendPos', legendPos).isString().required();\r\n\t\tchecker.testValue(legendPos.toLowerCase()).inArray(this.legendPositions);\r\n\t\tthis._legendPos = legendPos;\r\n\t},\r\n\t\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn el.tagName.toLowerCase() == 'div';\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tif(!this.el.id) {\r\n\t\t\tthis.el.id = jslet.nextId();\r\n\t\t}\r\n\t\tthis.renderAll();\r\n\t}, // end bind\r\n\r\n\t_validateFields: function() {\r\n\t\tvar Z = this;\r\n\t\tif(Z._fieldValidated) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar dsObj = Z._dataset,\r\n\t\t\tfldName = Z._categoryField;\r\n\t\tif (!dsObj.getField(fldName)) {\r\n\t\t\tthrow new Error(jslet.formatMessage(jslet.locale.Dataset.fieldNotFound, [fldName]));\r\n\t\t}\r\n\t\t\r\n\t\tfor(var i = 0, len = Z._valueFields.length; i < len; i++) {\r\n\t\t\tfldName = Z._valueFields[i];\r\n\t\t\tif(!dsObj.getField(fldName)) {\r\n\t\t\t\tthrow new Error(jslet.formatMessage(jslet.locale.Dataset.fieldNotFound, [fldName]));\r\n\t\t\t}\r\n\t\t}\r\n\t\tZ._fieldValidated = true;\r\n\t},\r\n\t\r\n\t_getLineData: function() {\r\n\t\tvar Z = this,\r\n\t\t\tdsObj = Z._dataset;\r\n\t\tif (dsObj.recordCount() === 0) {\r\n\t\t\treturn {xLabels: [], yValues: []};\r\n\t\t}\r\n\t\tvar oldRecno = dsObj.recnoSilence(),\r\n\t\t\txLabels = [],\r\n\t\t\tyValues = [],\r\n\t\t\tlegendLabels = [];\r\n\r\n\t\ttry {\r\n\t\t\tvar isInit = false, valueFldName,\r\n\t\t\t\tvalueFldCnt = Z._valueFields.length,\r\n\t\t\t\tvalueArr;\r\n\t\t\tfor(var k = 0, recCnt = dsObj.recordCount(); k < recCnt; k++) {\r\n\t\t\t\tdsObj.recnoSilence(k);\r\n\t\t\t\txLabels.push(dsObj.getFieldText(Z._categoryField));\r\n\t\t\t\tfor(var i = 0; i < valueFldCnt; i++) {\r\n\t\t\t\t\tvalueFldName = Z._valueFields[i];\r\n\t\t\t\t\tif(!isInit) {\r\n\t\t\t\t\t\tvalueArr = [];\r\n\t\t\t\t\t\tyValues.push(valueArr);\r\n\t\t\t\t\t\tlegendLabels.push(dsObj.getField(valueFldName).label());\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvalueArr = yValues[i];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvalueArr.push(dsObj.getFieldValue(valueFldName));\r\n\t\t\t\t}\r\n\t\t\t\tisInit = true;\r\n\t\t\t} //End for k\r\n\t\t} finally {\r\n\t\t\tdsObj.recnoSilence(oldRecno);\r\n\t\t}\r\n\t\treturn {xLabels: xLabels, yValues: yValues, legendLabels: legendLabels};\r\n\t},\r\n\r\n\t_getPieData: function() {\r\n\t\tvar Z = this,\r\n\t\t\tdsObj = Z._dataset;\r\n\t\tif (dsObj.recordCount() === 0) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\tvar oldRecno = dsObj.recnoSilence(),\r\n\t\t\tresult = [];\r\n\t\t\t\r\n\t\ttry {\r\n\t\t\tvar valueFldName = Z._valueFields[0],\r\n\t\t\t\tlabel, value;\r\n\t\t\tfor(var k = 0, recCnt = dsObj.recordCount(); k < recCnt; k++) {\r\n\t\t\t\tdsObj.recnoSilence(k);\r\n\t\t\t\tlabel = dsObj.getFieldText(Z._categoryField);\r\n\t\t\t\tvalue = dsObj.getFieldValue(valueFldName);\r\n\t\t\t\tresult.push([label, value]);\r\n\t\t\t}\r\n\t\t} finally {\r\n\t\t\tdsObj.recnoSilence(oldRecno);\r\n\t\t}\r\n\t\treturn result;\r\n\t},\r\n\r\n\t_drawLineChart: function() {\r\n\t\tvar Z = this;\r\n\t\tvar chartData = Z._getLineData();\r\n\t\t\r\n\t\tjQuery.jqplot(Z.el.id, chartData.yValues, \r\n\t\t{ \r\n\t\t\ttitle: Z._chartTitle, \r\n            animate: !jQuery.jqplot.use_excanvas,\r\n\t\t\t// Set default options on all series, turn on smoothing.\r\n\t\t\tseriesDefaults: {\r\n\t\t\t\trendererOptions: {smooth: true},\r\n\t\t\t\tpointLabels: {show: true, formatString: '%d'}\t\t\t\t\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tlegend:{ show:true,\r\n\t\t\t\tlabels: chartData.legendLabels\r\n\t\t\t},\r\n\t\t\t\r\naxes: {\r\n\t\t\t\txaxis: {\r\n\t\t\t\t\trenderer: jQuery.jqplot.CategoryAxisRenderer,\r\n\t\t\t\t\tticks: chartData.xLabels\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\t\t\r\n\t_drawPieChart: function() {\r\n\t\tvar Z = this;\r\n\t\tvar chartData = Z._getPieData();\r\n\t\t\r\n\t\tjQuery.jqplot(Z.el.id, [chartData], {\r\n\t\t\ttitle: Z._chartTitle, \r\n            animate: !jQuery.jqplot.use_excanvas,\r\n\t\t\tseriesDefaults:{\r\n\t\t\t\trenderer: jQuery.jqplot.PieRenderer ,\r\n\t\t\t\tpointLabels: {show: true, formatString: '%d'}\t\t\t\t\r\n\t\t\t},\r\n\t\t\tlegend:{ show:true }\r\n\t\t});\r\n\t},\r\n\t\r\n\t_drawBarChart: function(isStack) {\r\n\t\tvar Z = this;\r\n\t\tvar chartData = Z._getLineData();\r\n\r\n        jQuery.jqplot(Z.el.id, chartData.yValues, {\r\n\t\t\ttitle: Z._chartTitle,\r\n\t\t\tstackSeries: isStack,\r\n            // Only animate if we're not using excanvas (not in IE 7 or IE 8)..\r\n            animate: !jQuery.jqplot.use_excanvas,\r\n            seriesDefaults:{\r\n                renderer:jQuery.jqplot.BarRenderer,\r\n\t\t\t\tpointLabels: {show: true, formatString: '%d'}\t\t\t\t\r\n            },\r\n\r\n\t\t\tlegend:{ show:true,\r\n\t\t\t\tlabels: chartData.legendLabels\r\n\t\t\t},\r\n\t\t\t\r\n            axes: {\r\n                xaxis: {\r\n                    renderer: jQuery.jqplot.CategoryAxisRenderer,\r\n                    ticks: chartData.xLabels\r\n                }\r\n            },\r\n            highlighter: { show: false }\r\n        });\t\r\n\t},\r\n\t\r\n\tdrawChart: function () {\r\n\t\tvar Z = this,\r\n\t\t\tdsObj = Z._dataset;\r\n\t\t\t\r\n\t\tZ.el.innerHTML = '';\r\n\t\tZ._validateFields();\r\n\t\tif(Z._chartType == 'pie') {\r\n\t\t\tZ._drawPieChart();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(Z._chartType == 'line') {\r\n\t\t\tZ._drawLineChart();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(Z._chartType == 'bar') {\r\n\t\t\tZ._drawBarChart(false);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(Z._chartType == 'stackbar') {\r\n\t\t\tZ._drawBarChart(true);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t}, // end draw chart\r\n\r\n\trefreshControl: function (evt) {\r\n\t\tvar evtType = evt.eventType;\r\n\t\tif (evtType == jslet.data.RefreshEvent.UPDATEALL || \r\n\t\t\tevtType == jslet.data.RefreshEvent.UPDATERECORD ||\r\n\t\t\tevtType == jslet.data.RefreshEvent.UPDATECOLUMN || \r\n\t\t\tevtType == jslet.data.RefreshEvent.INSERT || \r\n\t\t\tevtType == jslet.data.RefreshEvent.DELETE) {\r\n\t\t\tthis.drawChart();\r\n\t\t}\r\n\t},\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tthis.refreshControl(jslet.data.RefreshEvent.updateAllEvent(), true);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tthis.swf = null;\r\n\t\t$super();\r\n\t}\r\n});\r\n\r\njslet.ui.register('DBChart', jslet.ui.DBChart);\r\njslet.ui.DBChart.htmlTemplate = '<div></div>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n* DBEditPanel\r\n*/\r\n\"use strict\";\r\njslet.ui.DBEditPanel = jslet.Class.create(jslet.ui.DBControl, {\r\n\t_totalColumns: 12, //Bootstrap column count \r\n\t/**\r\n\t * @override\r\n\t*/\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,columnCount,labelCols,onlySpecifiedFields,fields,hasLabel';\r\n\t\t\r\n\t\t/**\r\n\t\t * {Integer} Column count\r\n\t\t */\r\n\t\tZ._columnCount = 3;\r\n\t\t/**\r\n\t\t * {Integer} The gap between label and editor\r\n\t\t */\r\n\t\tZ._labelCols = 1;\r\n\r\n\t\t/**\r\n\t\t * {Boolean} True - only show specified fields, false otherwise.\r\n\t\t */\r\n\t\tZ._onlySpecifiedFields = false;\r\n\t\t/**\r\n\t\t * Array of edit field configuration, prototype: [{field: \"field1\", colSpan: 2, rowSpan: 1}, ...]\r\n\t\t */\r\n\t\tZ._fields = null;\r\n\t\t\r\n\t\tZ._hasLabel = true;\r\n\t\t\r\n\t\tZ._metaChangedDebounce = jslet.debounce(Z.renderAll, 10);\r\n\r\n\t\t$super(el, params);\r\n\t},\r\n\t\r\n\tcolumnCount: function(columnCount) {\r\n\t\tif(columnCount === undefined) {\r\n\t\t\treturn this._columnCount;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBEditPanel.columnCount', columnCount).isGTZero();\r\n\t\tthis._columnCount = parseInt(columnCount);\r\n\t},\r\n\t\r\n\tlabelCols: function(labelCols) {\r\n\t\tif(labelCols === undefined) {\r\n\t\t\treturn this._labelCols;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBEditPanel.labelCols', labelCols).isNumber().between(1,3);\r\n\t\tthis._labelCols = parseInt(labelCols);\r\n\t},\r\n\t\r\n\tonlySpecifiedFields: function(onlySpecifiedFields) {\r\n\t\tif(onlySpecifiedFields === undefined) {\r\n\t\t\treturn this._onlySpecifiedFields;\r\n\t\t}\r\n\t\tthis._onlySpecifiedFields = onlySpecifiedFields ? true: false;\r\n\t},\r\n\t\r\n\thasLabel: function(hasLabel) {\r\n\t\tif(hasLabel === undefined) {\r\n\t\t\treturn this._hasLabel;\r\n\t\t}\r\n\t\tthis._hasLabel = hasLabel ? true: false;\r\n\t},\r\n\t\r\n\tfields: function(fields) {\r\n\t\tif(fields === undefined) {\r\n\t\t\treturn this._fields;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBEditPanel.fields', fields).isArray();\r\n\t\tvar fldCfg;\r\n\t\tfor(var i = 0, len = fields.length; i < len; i++) {\r\n\t\t\tfldCfg = fields[i];\r\n\t\t\tjslet.Checker.test('DBEditPanel.fields.field', fldCfg.field).isString().required();\r\n\t\t\tjslet.Checker.test('DBEditPanel.fields.labelCols', fldCfg.colSpan).isNumber().between(1,3);\r\n\t\t\tjslet.Checker.test('DBEditPanel.fields.dataCols', fldCfg.colSpan).isNumber().between(1,11);\r\n\t\t\tjslet.Checker.test('DBEditPanel.fields.prefix', fldCfg.prefix).isArray();\r\n\t\t\tjslet.Checker.test('DBEditPanel.fields.suffix', fldCfg.suffix).isArray();\r\n\t\t\tfldCfg.inFirstCol = fldCfg.inFirstCol ? true: false;\r\n\t\t\tfldCfg.showLine = fldCfg.showLine ? true: false;\r\n\t\t\tfldCfg.visible = (fldCfg.visible === undefined || fldCfg.visible) ? true: false;\r\n\t\t}\r\n\t\tthis._fields = fields;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t*/\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn el.tagName.toLowerCase() == 'div';\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tthis.renderAll();\r\n\t},\r\n\t\r\n\t_calcLayout: function () {\r\n\t\tvar Z = this,\r\n\t\t\tallFlds = Z._dataset.getNormalFields(), \r\n\t\t\tfldLayouts, fldObj, i, layoutcnt,\r\n\t\t\tfcnt = allFlds.length;\r\n\t\t\r\n\t\tif (!Z._onlySpecifiedFields) {\r\n\t\t\tfldLayouts = [];\r\n\t\t\tvar fldName, found, editFld, maxFld, visible;\r\n\t\t\tlayoutcnt = Z._fields ? Z._fields.length : 0;\r\n\t\t\tfor (i = 0; i < fcnt; i++) {\r\n\t\t\t\tfldObj = allFlds[i];\r\n\t\t\t\tfldName = fldObj.name();\r\n\t\t\t\tvisible = fldObj.visible();\r\n\t\t\t\tfound = false;\r\n\t\t\t\tfor (var j = 0; j < layoutcnt; j++) {\r\n\t\t\t\t\teditFld = Z._fields[j];\r\n\t\t\t\t\tif (fldName == editFld.field) {\r\n\t\t\t\t\t\tfound = true;\r\n\t\t\t\t\t\tif(editFld.visible === undefined || editFld.visible) {\r\n\t\t\t\t\t\t\tfldLayouts.push(editFld);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (!found) {\r\n\t\t\t\t\tif(!visible) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfldLayouts.push({\r\n\t\t\t\t\t\tfield: fldObj.name()\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t} //end for i\r\n\t\t} else {\r\n\t\t\tfldLayouts = Z._fields;\r\n\t\t}\r\n\r\n\t\tvar dftDataCols = Math.floor((Z._totalColumns - Z._labelCols * Z._columnCount) / Z._columnCount);\r\n\t\tif(dftDataCols <= 0) {\r\n\t\t\tdftDataCols = 1;\r\n\t\t}\r\n\r\n\t\t//calc row, col\r\n\t\tvar layout, r = 0, c = 0, colsInRow = 0, itemCnt;\r\n\t\tfor (i = 0, layoutcnt = fldLayouts.length; i < layoutcnt; i++) {\r\n\t\t\tlayout = fldLayouts[i];\r\n\t\t\tif(!layout.labelCols) {\r\n\t\t\t\tlayout._innerLabelCols = Z._labelCols;\r\n\t\t\t}\r\n\t\t\tif(!layout.dataCols) {\r\n\t\t\t\tlayout._innerDataCols = dftDataCols;\r\n\t\t\t} else {\r\n\t\t\t\tlayout._innerDataCols = layout.dataCols;\t\r\n\t\t\t}\r\n\t\t\titemCnt = layout._innerLabelCols + layout._innerDataCols;\r\n\t\t\tif (layout.inFirstCol || layout.showLine || colsInRow + itemCnt > Z._totalColumns) {\r\n\t\t\t\tr++;\r\n\t\t\t\tcolsInRow = 0;\r\n\t\t\t}\r\n\t\t\tlayout.row = r;\r\n\t\t\tcolsInRow += itemCnt;\r\n\t\t}\r\n\t\treturn fldLayouts;\r\n\t},\r\n\t\r\n\tgetEditField: function (fieldName) {\r\n\t\tvar Z = this;\r\n\t\tif (!Z._fields) {\r\n\t\t\tZ._fields = [];\r\n\t\t}\r\n\t\tvar editFld;\r\n\t\tfor (var i = 0, cnt = Z._fields.length; i < cnt; i++) {\r\n\t\t\teditFld = Z._fields[i];\r\n\t\t\tif (editFld.field == fieldName) {\r\n\t\t\t\treturn editFld;\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar fldObj = Z._dataset.getField(fieldName);\r\n\t\tif (!fldObj) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\teditFld = {\r\n\t\t\tfield: fieldName\r\n\t\t};\r\n\t\tZ._fields.push(editFld);\r\n\t\treturn editFld;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tvar Z = this;\r\n\t\tZ.removeAllChildControls();\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tif (!jqEl.hasClass('jl-editpanel')) {\r\n\t\t\tjqEl.addClass('jl-editpanel form-horizontal');\r\n\t\t}\r\n\t\tjqEl.html('');\r\n\t\tvar allFlds = Z._dataset.getNormalFields(),\r\n\t\t\tfcnt = allFlds.length;\r\n\t\tvar layouts = Z._calcLayout();\r\n\t\t//calc max label width\r\n\t\t\t\r\n\t\tvar layout, dbctrl, editor, r = -1, oLabel, editorCfg, fldName, fldObj, ohr, octrlDiv, opanel, ctrlId, dbCtrl;\r\n\t\tfor (var i = 0, cnt = layouts.length; i < cnt; i++) {\r\n\t\t\tlayout = layouts[i];\r\n\t\t\tif (layout.showLine) {\r\n\t\t\t\tohr = document.createElement('hr');\r\n\t\t\t\tZ.el.appendChild(ohr);\r\n\t\t\t}\r\n\t\t\tif (layout.row != r) {\r\n\t\t\t\topanel = document.createElement('div');\r\n\t\t\t\topanel.className = 'form-group form-group-sm';\r\n\t\t\t\tZ.el.appendChild(opanel);\r\n\t\t\t\tr = layout.row;\r\n\r\n\t\t\t}\r\n\t\t\tfldName = layout.field;\r\n\t\t\tfldObj = Z._dataset.getField(fldName);\r\n\t\t\tif (!fldObj) {\r\n\t\t\t\tthrow new Error(jslet.formatMessage(jslet.locale.Dataset.fieldNotFound, [fldName]));\r\n\t\t\t}\r\n\t\t\teditorCfg = fldObj.editControl();\r\n\t\t\tvar isCheckBox = editorCfg.type.toLowerCase() == 'dbcheckbox';\r\n\t\t\tif(isCheckBox) {\r\n\t\t\t\tif(Z._hasLabel) {\r\n\t\t\t\t\toLabel = document.createElement('div');\r\n\t\t\t\t\topanel.appendChild(oLabel);\r\n\t\t\t\t\toLabel.className = 'col-sm-' + layout._innerLabelCols;\r\n\t\t\t\t}\r\n\t\t\t\toctrlDiv = document.createElement('div');\r\n\t\t\t\topanel.appendChild(octrlDiv);\r\n\t\t\t\toctrlDiv.className = 'col-sm-' + (Z._hasLabel?layout._innerDataCols: 12);\r\n\t\t\t\t\r\n\t\t\t\teditorCfg.dataset = Z._dataset;\r\n\t\t\t\teditorCfg.field = fldName;\r\n\t\t\t\teditor = jslet.ui.createControl(editorCfg, null);\r\n\t\t\t\toctrlDiv.appendChild(editor.el);\r\n\t\t\t\tZ.addChildControl(editor);\r\n\t\t\t\tif(Z._hasLabel) {\r\n\t\t\t\t\toLabel = document.createElement('label');\r\n\t\t\t\t\toctrlDiv.appendChild(oLabel);\r\n\t\t\t\t\tdbCtrl = new jslet.ui.DBLabel(oLabel, {\r\n\t\t\t\t\t\ttype: 'DBLabel',\r\n\t\t\t\t\t\tdataset: Z._dataset,\r\n\t\t\t\t\t\tfield: fldName\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tctrlId = jslet.nextId();\r\n\t\t\t\teditor.el.id = ctrlId;\r\n\t\t\t\tjQuery(oLabel).attr('for', ctrlId);\r\n\t\t\t\tZ.addChildControl(dbCtrl);\r\n\t\t\t} else {\r\n\t\t\t\tif(Z._hasLabel) {\r\n\t\t\t\t\toLabel = document.createElement('label');\r\n\t\t\t\t\topanel.appendChild(oLabel);\r\n\t\t\t\t\toLabel.className = 'col-sm-' + layout._innerLabelCols;\r\n\t\t\t\t\tdbctrl = new jslet.ui.DBLabel(oLabel, {\r\n\t\t\t\t\t\ttype: 'DBLabel',\r\n\t\t\t\t\t\tdataset: Z._dataset,\r\n\t\t\t\t\t\tfield: fldName\r\n\t\t\t\t\t});\r\n\t\t\t\t\tZ.addChildControl(dbCtrl);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\toctrlDiv = document.createElement('div');\r\n\t\t\t\topanel.appendChild(octrlDiv);\r\n\t\t\t\toctrlDiv.className = 'col-sm-' + (Z._hasLabel?layout._innerDataCols: 12);\r\n\t\t\t\t\r\n\t\t\t\tctrlId = Z._renderEditPart(octrlDiv, layout);\r\n\t\t\t\tjQuery(oLabel).attr('for', ctrlId);\r\n\t\t\t\tZ.addChildControl(editor);\r\n\t\t\t}\r\n\t\t}\r\n\t}, // render All\r\n\t\r\n\t_renderEditPart: function(ctrlDiv, layoutCfg) {\r\n\t\tvar Z = this, fldName, i, len,\r\n\t\t\thasPrefix = layoutCfg.prefix && layoutCfg.prefix.length > 0,\r\n\t\t\thasSuffix = layoutCfg.suffix && layoutCfg.suffix.length > 0,\r\n\t\t\totherPartWidth = 0;\r\n\t\t\t\r\n\t\tif(hasPrefix) {\r\n\t\t\totherPartWidth = Z._renderOtherPart(ctrlDiv, layoutCfg.prefix);\r\n\t\t}\r\n\t\tfldName = layoutCfg.field;\r\n\t\tvar editorEl = Z._renderEditor(fldName);\r\n\t\tctrlDiv.appendChild(editorEl);\r\n\t\t\r\n\t\tif(hasSuffix) {\r\n\t\t\totherPartWidth += Z._renderOtherPart(ctrlDiv, layoutCfg.suffix);\r\n\t\t}\r\n\t\tif(otherPartWidth) {\r\n\t\t\tjQuery(editorEl).addClass('jl-ep-part');\r\n\t\t\teditorEl.style.width = jQuery(ctrlDiv).width() - otherPartWidth + 'px';\r\n\t\t}\r\n\t\treturn editorEl.id;\r\n\t},\r\n\t\r\n\t_renderOtherPart: function(ctrlDiv, arrPrefixOrSuffix) {\r\n\t\tvar fixCfg, editorEl, width, partEl, \r\n\t\t\tjqCtrlDiv = jQuery(ctrlDiv), \r\n\t\t\ttotalWidth = 0;\r\n\t\tfor(var i = 0, len = arrPrefixOrSuffix.length; i < len; i++) {\r\n\t\t\tfixCfg = arrPrefixOrSuffix[i];\r\n\t\t\twidth = fixCfg.width;\r\n\t\t\tif(fixCfg.field) {\r\n\t\t\t\tpartEl = this._renderEditor(fixCfg.field);\r\n\t\t\t\tjqCtrlDiv.append(partEl);\r\n\t\t\t} else if(fixCfg.content) {\r\n\t\t\t\tvar id = jslet.nextId();\r\n\t\t\t\tjqCtrlDiv.append('<div id = \"' + id + '\">' + fixCfg.content + '</div>');\r\n\t\t\t\tvar children = jqCtrlDiv.children();\r\n\t\t\t\tpartEl = jQuery('#' + id)[0];\r\n\t\t\t} else {\r\n\t\t\t\tconsole.warn('prefix or suffix: field or content is required!');\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif(!width) {\r\n\t\t\t\tconsole.warn('Width is empty, use 5% instead!');\r\n\t\t\t\twidth = '5%';\r\n\t\t\t}\r\n\t\t\tjQuery(partEl).addClass('jl-ep-part');\r\n\t\t\t\r\n\t\t\tpartEl.style.width = width;\r\n\t\t\ttotalWidth += jQuery(partEl).outerWidth();\r\n\t\t}\r\n\t\treturn totalWidth;\r\n\t},\r\n\t\r\n\t_renderEditor: function(fldName) {\r\n\t\tvar editor = jslet.ui.createControl({type: 'DBPlace', dataset: this._dataset, field: fldName}, null);\r\n\t\teditor.el.id = jslet.nextId();\r\n\t\treturn editor.el;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoMetaChanged: function($super, metaName){\r\n\t\tif(metaName && (metaName == 'visible' || metaName == 'editControl')) {\r\n\t\t\tthis._metaChangedDebounce.call(this);\r\n\t\t}\r\n\t}\r\n});\r\n\r\njslet.ui.register('DBEditPanel', jslet.ui.DBEditPanel);\r\njslet.ui.DBEditPanel.htmlTemplate = '<div></div>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBInspector. \r\n * Display&Edit fields in two columns: Label column and Value column. If in edit mode, this control takes the field editor configuration from dataset field object.\r\n * Example:\r\n * <pre><code>\r\n *  var jsletParam = {type:\"DBInspector\",dataset:\"employee\",columnCount:1,columnWidth:100};\r\n * \r\n * //1. Declaring:\r\n *  &lt;div id='ctrlId' data-jslet='type:\"DBInspector\",dataset:\"employee\",columnCount:1,columnWidth:100' />\r\n *  or\r\n *  &lt;div data-jslet='jsletParam' />\r\n * \r\n *  //2. Binding\r\n *  &lt;div id=\"ctrlId\"  />\r\n *  //Js snippet\r\n *  var el = document.getElementById('ctrlId');\r\n *  jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n *  jslet.ui.createControl(jsletParam, document.body);\r\n *  \r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBInspector = jslet.Class.create(jslet.ui.DBControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,columnCount,fields';\r\n\t\t\r\n\t\tZ._columnCount = 1;\r\n\t\t\r\n\t\tZ._fields = null;\r\n\t\t\r\n\t\tZ._metaChangedDebounce = jslet.debounce(Z.renderAll, 10);\r\n\r\n\t\t$super(el, params);\r\n\t},\r\n\t\r\n\t/**\r\n\t * {Integer} Column count\r\n\t */\r\n\tcolumnCount: function(columnCount) {\r\n\t\tif(columnCount === undefined) {\r\n\t\t\treturn this._columnCount;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBInspector.columnCount', columnCount).isGTZero();\r\n\t\tthis._columnCount = parseInt(columnCount);\r\n\t},\r\n\t\r\n\tfields: function(fields) {\r\n\t\tif(fields === undefined) {\r\n\t\t\treturn this._fields;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBInspector.fields', fields).isArray();\r\n\t\tvar fldCfg;\r\n\t\tfor(var i = 0, len = fields.length; i < len; i++) {\r\n\t\t\tfldCfg = fields[i];\r\n\t\t\tjslet.Checker.test('DBInspector.fields.field', fldCfg.field).isString().required();\r\n\t\t\tfldCfg.visible = fldCfg.visible ? true: false;\r\n\t\t}\r\n\t\tthis._fields = fields;\r\n\t},\r\n\t\r\n\t/**\r\n\t* @override\r\n\t*/\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn el.tagName.toLowerCase() == 'div';\r\n\t},\r\n\t\r\n\t\t/**\r\n\t\t * @override\r\n\t\t */\r\n\tbind: function () {\r\n\t\tvar Z = this;\r\n\t\tvar colCnt = Z._columnCount;\r\n\t\tif (colCnt) {\r\n\t\t\tcolCnt = parseInt(colCnt);\r\n\t\t}\r\n\t\tif (colCnt && colCnt > 0) {\r\n\t\t\tZ._columnCount = colCnt;\r\n\t\t} else {\r\n\t\t\tZ._columnCount = 1;\r\n\t\t}\r\n\t\tZ.renderAll();\r\n\t}, // end bind\r\n\t\r\n\t\t/**\r\n\t\t * @override\r\n\t\t */\r\n\trenderAll: function () {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\tZ.removeAllChildControls();\r\n\t\t\r\n\t\tif (!jqEl.hasClass('jl-inspector'))\r\n\t\t\tjqEl.addClass('jl-inspector jl-round5');\r\n\t\tvar totalWidth = jqEl.width(),\r\n\t\t\tallFlds = Z._dataset.getFields();\r\n\t\tjqEl.html('<table cellpadding=0 cellspacing=0 style=\"margin:0;padding:0;table-layout:fixed;width:100%;height:100%\"><tbody></tbody></table>');\r\n\t\tvar fldObj, i, found, visible, fldName, cfgFld,\r\n\t\t\tfcnt = allFlds.length,\r\n\t\t\tvisibleFlds = [];\r\n\t\tfor (i = 0; i < fcnt; i++) {\r\n\t\t\tfldObj = allFlds[i];\r\n\t\t\tfldName = fldObj.name();\r\n\t\t\tfound = false;\r\n\t\t\tif(Z._fields) {\r\n\t\t\t\tfor(var j = 0, len = Z._fields.length; j < len; j++) {\r\n\t\t\t\t\tcfgFld = Z._fields[j];\r\n\t\t\t\t\tif(fldName == cfgFld.field) {\r\n\t\t\t\t\t\tfound = true;\r\n\t\t\t\t\t\tvisible = cfgFld.visible? true: false;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} \r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(!found) {\r\n\t\t\t\tvisible = fldObj.visible();\r\n\t\t\t}\r\n\t\t\tif (visible) {\r\n\t\t\t\tvisibleFlds.push(fldObj);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfcnt = visibleFlds.length;\r\n\t\tif (fcnt === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar w, c, columnCnt = Math.min(fcnt, Z._columnCount), arrLabelWidth = [];\r\n\t\tfor (i = 0; i < columnCnt; i++) {\r\n\t\t\tarrLabelWidth[i] = 0;\r\n\t\t}\r\n\t\tvar startWidth = jslet.ui.textMeasurer.getWidth('*');\r\n\t\tjslet.ui.textMeasurer.setElement(Z.el);\r\n\t\tfor (i = 0; i < fcnt; i++) {\r\n\t\t\tfldObj = visibleFlds[i];\r\n\t\t\tc = i % columnCnt;\r\n\t\t\tw = Math.round(jslet.ui.textMeasurer.getWidth(fldObj.displayLabel()) + startWidth) + 15;\r\n\t\t\tif (arrLabelWidth[c] < w) {\r\n\t\t\t\tarrLabelWidth[c] = w;\r\n\t\t\t}\r\n\t\t}\r\n\t\tjslet.ui.textMeasurer.setElement();\r\n\t\t\r\n\t\tvar totalLabelWidth = 0;\r\n\t\tfor (i = 0; i < columnCnt; i++) {\r\n\t\t\ttotalLabelWidth += arrLabelWidth[i];\r\n\t\t}\r\n\t\t\r\n\t\tvar editorWidth = Math.round((totalWidth - totalLabelWidth) / columnCnt);\r\n\t\t\r\n\t\tvar otable = Z.el.firstChild,\r\n\t\t\ttHead = otable.createTHead(), otd, otr = tHead.insertRow(-1);\r\n\t\tfor (i = 0; i < columnCnt; i++) {\r\n\t\t\totd = otr.insertCell(-1);\r\n\t\t\totd.style.width = arrLabelWidth[i] + 'px';\r\n\t\t\totd = otr.insertCell(-1);\r\n\t\t}\r\n\t\t\r\n\t\tvar oldRowNo = -1, oldC = -1, rowNo, odiv, oLabel, editor, fldCtrl, dbCtrl;\r\n\t\tZ.preRowIndex = -1;\r\n\t\tfor (i = 0; i < fcnt; i++) {\r\n\t\t\tfldObj = visibleFlds[i];\r\n\t\t\tfldName = fldObj.name();\r\n\t\t\trowNo = Math.floor(i / columnCnt);\r\n\t\t\tc = i % columnCnt;\r\n\t\t\tif (oldRowNo != rowNo) {\r\n\t\t\t\totr = otable.insertRow(-1);\r\n\t\t\t\toldRowNo = rowNo;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\totd = otr.insertCell(-1);\r\n\t\t\totd.noWrap = true;\r\n\t\t\totd.className = jslet.ui.htmlclass.DBINSPECTOR.labelColCls;\r\n\t\t\t\r\n\t\t\toLabel = document.createElement('label');\r\n\t\t\totd.appendChild(oLabel);\r\n\t\t\tdbCtrl = new jslet.ui.DBLabel(oLabel, {\r\n\t\t\t\ttype: 'DBLabel',\r\n\t\t\t\tdataset: Z._dataset,\r\n\t\t\t\tfield: fldName\r\n\t\t\t});\r\n\t\t\tZ.addChildControl(dbCtrl);\r\n\t\t\t\r\n\t\t\totd = otr.insertCell(-1);\r\n\t\t\totd.className = jslet.ui.htmlclass.DBINSPECTOR.editorColCls;\r\n\t\t\totd.noWrap = true;\r\n\t\t\totd.align = 'left';\r\n\t\t\todiv = document.createElement('div');\r\n\t\t\todiv.noWrap = true;\r\n\t\t\totd.appendChild(odiv);\r\n\t\t\tfldCtrl = fldObj.editControl();\r\n\t\t\tfldCtrl.dataset = Z._dataset;\r\n\t\t\tfldCtrl.field = fldName;\r\n\t\t\t\r\n\t\t\teditor = jslet.ui.createControl(fldCtrl, odiv);\r\n\t\t\tif (!editor.isCheckBox) {\r\n\t\t\t\teditor.el.style.width = '100%';//editorWidth - 10 + 'px';\r\n\t\t\t}\r\n\t\t\tZ.addChildControl(editor);\r\n\t\t} // end for\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoMetaChanged: function($super, metaName){\r\n\t\tif(metaName && (metaName == 'visible' || metaName == 'editControl')) {\r\n\t\t\tthis._metaChangedDebounce.call(this);\r\n\t\t}\r\n\t}\r\n});\r\n\r\njslet.ui.htmlclass.DBINSPECTOR = {\r\n\tlabelColCls: 'jl-inspector-label',\r\n\teditorColCls: 'jl-inspector-editor'\r\n};\r\n\r\njslet.ui.register('DBInspector', jslet.ui.DBInspector);\r\njslet.ui.DBInspector.htmlTemplate = '<div></div>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\"use strict\";\r\njslet.ui.htmlclass.TABLECLASS = {\r\n\tcurrentrow: 'jl-tbl-current',\r\n\tscrollBarWidth: 16,\r\n\tselectColWidth: 30,\r\n\thoverrow: 'jl-tbl-row-hover',\r\n};\r\n\r\n/**\r\n * Table column\r\n */\r\njslet.ui.TableColumn = function () {\r\n\tvar Z = this;\r\n\tZ.field = null;   //String, field name\r\n\tZ.colNum = null;  //Integer, column number\r\n\tZ.label = null;   //String, column header label\r\n\tZ.title = null;   //String, column header title\r\n\tZ.displayOrder = null; //Integer, display order\r\n\tZ.width = null;   //Integer, column display width\r\n\tZ.colSpan = null; //Integer, column span\r\n\tZ.disableHeadSort = false; //Boolean, true - user sort this column by click column header\r\n\tZ.mergeSame = false; //Boolean, true - if this column value of adjoined rows is same then merge these rows \r\n\tZ.noRefresh = false; //Boolean, true - do not refresh for customized column\r\n\tZ.visible = true; //Boolean, identify specified column is visible or not \r\n\tZ.cellRender = null; //Function, column cell render for customized column  \r\n};\r\n\r\n/**\r\n * Sub group, use this class to implement complex requirement in one table row, like master-detail style row\r\n */\r\njslet.ui.TableSubgroup = function(){\r\nvar Z = this;\r\n\tZ.hasExpander = true; //Boolean, true - will add a new column automatically, click this column will expand or collapse subgroup panel\r\n\tZ.template = null;//String, html template \r\n\tZ.height = 0; //Integer, subgroup panel height\r\n};\r\n\r\n/**\r\n * Table column header, use this class to implement hierarchical header\r\n */\r\njslet.ui.TableHead = function(){\r\n\tvar Z = this;\r\n\tZ.label = null; //String, Head label\r\n\tZ.title = null; //String, Head title\r\n\tZ.id = null;//String, Head id\r\n\tZ.rowSpan = 0;  //@private\r\n\tZ.colSpan = 0;  //@private\r\n\tZ.disableHeadSort = false; //Boolean, true - user sort this column by click column header\r\n\tZ.subHeads = null; //array of jslet.ui.TableHead\r\n};\r\n\r\njslet.ui.AbstractDBTable = jslet.Class.create(jslet.ui.DBControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\t\r\n\t\tZ.allProperties = 'styleClass,dataset,fixedRows,fixedCols,hasSeqCol,hasSelectCol,reverseSeqCol,seqColHeader,noborder,readOnly,editable,hideHead,disableHeadSort,onlySpecifiedCol,selectBy,rowHeight,onRowClick,onRowDblClick,onSelect,onSelectAll,beforeSelect,beforeSelectAll,afterSelect,afterSelectAll,onCustomSort,onFillRow,onFillCell,treeField,columns,subgroup,aggraded,autoClearSelection,onCellClick,defaultCellRender,hasFindDialog,hasFilterDialog';\r\n\t\t\r\n\t\tZ._fixedRows = 0;\r\n\r\n\t\tZ._fixedCols = 0;\r\n\r\n\t\tZ._hasSeqCol = true;\r\n\t\t\r\n\t\tZ._reverseSeqCol = false;\r\n\t\r\n\t\tZ._seqColHeader = null;\r\n\r\n\t\tZ._hasSelectCol = false;\r\n\t\t\r\n\t\tZ._noborder = false;\r\n\t\t\r\n\t\tZ._editable = false;\r\n\r\n\t\tZ._hideHead = false;\r\n\t\t\r\n\t\tZ._onlySpecifiedCol = false;\r\n\t\t\r\n\t\tZ._disableHeadSort = false;\r\n\t\t\r\n\t\tZ._aggraded = true;\r\n\t\t\r\n\t\tZ._autoClearSelection = true;\r\n\t\t\r\n\t\tZ._selectBy = null;\r\n\r\n\t\tZ._rowHeight = null;\r\n\r\n\t\tZ._headRowHeight = null;\r\n\r\n\t\tZ._treeField = null;\r\n\r\n\t\tZ._columns = null;\r\n\t\t\r\n\t\tZ._onRowClick = null;\r\n\r\n\t\tZ._onRowDblClick = null;\r\n\t\t\r\n\t\tZ._onCellClick = null;\r\n\t\t\r\n\t\tZ._onCustomSort = null; \r\n\t\t\r\n\t\tZ._onSelect = null;\r\n\r\n\t\tZ._onSelectAll = null;\r\n\t\t\r\n\t\tZ._beforeSelect = null;\r\n\t\t\r\n\t\tZ._afterSelect = null;\r\n\t\t\r\n\t\tZ._beforeSelectAll = null;\r\n\t\t\r\n\t\tZ._afterSelectAll = null;\r\n\t\t\r\n\t\tZ._onFillRow = null;\r\n\t\t\r\n\t\tZ._onFillCell = null;\t\t\r\n\r\n\t\tZ._defaultCellRender = null;\r\n\r\n\t\tZ._hasFindDialog = true;\r\n\t\t\r\n\t\tZ._hasFilterDialog = true;\r\n\t\t//@private\r\n\t\tZ._repairHeight = 0;\r\n\t\tZ.contentHeight = 0;\r\n\t\tZ.subgroup = null;//jslet.ui.TableSubgroup\r\n\t\t\r\n\t\tZ._sysColumns = null;//all system column like sequence column, select column, sub-group column\r\n\t\tZ._isHoriOverflow = false;\r\n\t\tZ._oldHeight = null;\r\n\t\t\r\n\t\tZ._currRow = null;\r\n\t\tZ._currColNum = 0;\r\n\t\tZ._editingField = null;\r\n\t\tZ._editorTabIndex = 1;\r\n\t\tZ._rowHeightChanged = false;\r\n\t\t\r\n\t\tZ._cellEditor = null;\r\n\t\t\r\n\t\t$super(el, params);\r\n\t},\r\n\t\r\n\t/**\r\n\t * Get or set Fixed row count.\r\n\t * \r\n\t * @param {Integer or undefined} rows fixed rows.\r\n\t * @return {Integer or this}\r\n\t */\r\n\tfixedRows: function(rows) {\r\n\t\tif(rows === undefined) {\r\n\t\t\treturn this._fixedRows;\r\n\t\t}\r\n\t\t\tjslet.Checker.test('DBTable.fixedRows', rows).isNumber();\r\n\t\tthis._fixedRows = parseInt(rows);\r\n\t},\r\n\t\r\n\t/**\r\n\t * Get or set Fixed column count.\r\n\t * \r\n\t * @param {Integer or undefined} cols fixed cols.\r\n\t * @return {Integer or this}\r\n\t */\r\n\tfixedCols: function(cols) {\r\n\t\tif(cols === undefined) {\r\n\t\t\treturn this._fixedCols;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTable.fixedCols', cols).isNumber();\r\n\t\tthis._fixedCols = parseInt(cols);\r\n\t},\r\n\t\r\n\t/**\r\n\t * Get or set row height of table row.\r\n\t * \r\n\t * @param {Integer or undefined} rowHeight table row height.\r\n\t * @return {Integer or this}\r\n\t */\r\n\trowHeight: function(rowHeight) {\r\n\t\tvar Z = this;\r\n\t\tif(rowHeight === undefined) {\r\n\t\t\tif(Z._rowHeight === null) {\r\n\t\t\t\tvar clsName = Z._editable? 'jl-tbl-editing-row': 'jl-tbl-row';\r\n\t\t\t\tZ._rowHeight = parseInt(jslet.ui.getCssValue(clsName, 'height')) || 25;\r\n\t\t\t}\r\n\t\t\treturn Z._rowHeight;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTable.rowHeight', rowHeight).isGTZero();\r\n\t\tZ._rowHeight = parseInt(rowHeight);\r\n\t\tZ._rowHeightChanged = true;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Get or set row height of table header.\r\n\t * \r\n\t * @param {Integer or undefined} headRowHeight table header row height.\r\n\t * @return {Integer or this}\r\n\t */\r\n\theadRowHeight: function(headRowHeight) {\r\n\t\tif(headRowHeight === undefined) {\r\n\t\t\tif(this._headRowHeight === null) {\r\n\t\t\t\tthis._headRowHeight = parseInt(jslet.ui.getCssValue('jl-tbl-header-row', 'height')) || 25;\r\n\t\t\t}\r\n\t\t\treturn this._headRowHeight;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTable.headRowHeight', headRowHeight).isGTZero();\r\n\t\tthis._headRowHeight = parseInt(headRowHeight);\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify whether there is sequence column in DBTable.\r\n\t * \r\n\t * @param {Boolean or undefined} hasSeqCol true(default) - has sequence column, false - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\thasSeqCol: function(hasSeqCol) {\r\n\t\tif(hasSeqCol === undefined) {\r\n\t\t\treturn this._hasSeqCol;\r\n\t\t}\r\n\t\tthis._hasSeqCol = hasSeqCol ? true: false;\r\n\t},\r\n\r\n\t/**\r\n\t * Identify whether the sequence number is reverse.\r\n\t * \r\n\t * @param {Boolean or undefined} reverseSeqCol true - the sequence number is reverse, false(default) - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\treverseSeqCol: function(reverseSeqCol) {\r\n\t\tif(reverseSeqCol === undefined) {\r\n\t\t\treturn this._reverseSeqCol;\r\n\t\t}\r\n\t\tthis._reverseSeqCol = reverseSeqCol ? true: false;\r\n\t},\r\n\t\t\r\n\t/**\r\n\t * Get or set sequence column header.\r\n\t * \r\n\t * @param {String or undefined} seqColHeader sequence column header.\r\n\t * @return {String or this}\r\n\t */\r\n\tseqColHeader: function(seqColHeader) {\r\n\t\tif(seqColHeader === undefined) {\r\n\t\t\treturn this._seqColHeader;\r\n\t\t}\r\n\t\tthis._seqColHeader = seqColHeader;\r\n\t},\r\n\t\t\r\n\t/**\r\n\t * Identify whether there is \"select\" column in DBTable.\r\n\t * \r\n\t * @param {Boolean or undefined} hasSelectCol true(default) - has \"select\" column, false - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\thasSelectCol: function(hasSelectCol) {\r\n\t\tif(hasSelectCol === undefined) {\r\n\t\t\treturn this._hasSelectCol;\r\n\t\t}\r\n\t\tthis._hasSelectCol = hasSelectCol ? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify the table has border or not.\r\n\t * \r\n\t * @param {Boolean or undefined} noborder true - the table without border, false(default) - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\tnoborder: function(noborder) {\r\n\t\tif(noborder === undefined) {\r\n\t\t\treturn this._noborder;\r\n\t\t}\r\n\t\tthis._noborder = noborder ? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @deprecated\r\n\t * Use onFieldChanged instead.\r\n\t * \r\n\t * Identify the table is read only or not.\r\n\t * \r\n\t * @param {Boolean or undefined} readOnly true(default) - the table is read only, false - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\treadOnly: function(readOnly) {\r\n\t\tvar Z = this;\r\n\t\tif(readOnly === undefined) {\r\n\t\t\treturn !Z._editable;\r\n\t\t}\r\n\t\tZ.editable(!readOnly);\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify the table is editable or not.\r\n\t * \r\n\t * @param {Boolean or undefined} editable true(default) - the table is editable, false - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\teditable: function(editable) {\r\n\t\tvar Z = this;\r\n\t\tif(editable === undefined) {\r\n\t\t\treturn Z._editable;\r\n\t\t}\r\n\t\tZ._editable = editable ? true: false;\r\n\t\tif(Z._editable && !Z._rowHeightChanged) {\r\n\t\t\tZ._rowHeight = null;\r\n\t\t}\r\n\t},\r\n\t\r\n\t\r\n\t/**\r\n\t * Identify the table is hidden or not.\r\n\t * \r\n\t * @param {Boolean or undefined} hideHead true - the table header is hidden, false(default) - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\thideHead: function(hideHead) {\r\n\t\tif(hideHead === undefined) {\r\n\t\t\treturn this._hideHead;\r\n\t\t}\r\n\t\tthis._hideHead = hideHead ? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify the table has aggraded row or not.\r\n\t * \r\n\t * @param {Boolean or undefined} aggraded true - the table has aggraded row, false(default) - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\taggraded: function(aggraded) {\r\n\t\tif(aggraded === undefined) {\r\n\t\t\treturn this._aggraded;\r\n\t\t}\r\n\t\tthis._aggraded = aggraded ? true: false;\r\n\t},\r\n\r\n\t/**\r\n\t * Identify whether automatically clear selection when selecting table cells.\r\n\t * \r\n\t * @param {Boolean or undefined} autoClearSelection true(default) - automatically clear selection, false(default) - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\tautoClearSelection: function(autoClearSelection) {\r\n\t\tif(autoClearSelection === undefined) {\r\n\t\t\treturn this._autoClearSelection;\r\n\t\t}\r\n\t\tthis._autoClearSelection = autoClearSelection ? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify disable table head sorting or not.\r\n\t * \r\n\t * @param {Boolean or undefined} disableHeadSort true - disable table header sorting, false(default) - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\tdisableHeadSort: function(disableHeadSort) {\r\n\t\tif(disableHeadSort === undefined) {\r\n\t\t\treturn this._disableHeadSort;\r\n\t\t}\r\n\t\tthis._disableHeadSort = disableHeadSort ? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify show the specified columns or not.\r\n\t * \r\n\t * @param {Boolean or undefined} onlySpecifiedCol true - only showing the specified columns, false(default) - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\tonlySpecifiedCol: function(onlySpecifiedCol) {\r\n\t\tif(onlySpecifiedCol === undefined) {\r\n\t\t\treturn this._onlySpecifiedCol;\r\n\t\t}\r\n\t\tthis._onlySpecifiedCol = onlySpecifiedCol ? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Specified field names for selecting group records, multiple field names are separated with ','\r\n\t * @see jslet.data.Dataset.select(selected, selectBy).\r\n\t * \r\n\t * <pre><code>\r\n\t * tbl.selectBy('code,gender');\r\n\t * </code></pre>\r\n\t * \r\n\t * @param {String or undefined} selectBy group selecting field names.\r\n\t * @return {String or this}\r\n\t */\r\n\tselectBy: function(selectBy) {\r\n\t\tif(selectBy === undefined) {\r\n\t\t\treturn this._selectBy;\r\n\t\t}\r\n\t\t\tjslet.Checker.test('DBTable.selectBy', selectBy).isString();\r\n\t\tthis._selectBy = selectBy;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Display table as tree style. If this property is set, the dataset must be a tree style dataset, \r\n\t *  means dataset.parentField() and dataset.levelField() can not be empty.\r\n\t * Only one field name allowed.\r\n\t * \r\n\t * <pre><code>\r\n\t * tbl.treeField('code');\r\n\t * </code></pre>\r\n\t * \r\n\t * @param {String or undefined} treeField the field name which will show as tree style.\r\n\t * @return {String or this}\r\n\t */\r\n\ttreeField: function(treeField) {\r\n\t\tif(treeField === undefined) {\r\n\t\t\treturn this._treeField;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTable.treeField', treeField).isString();\r\n\t\tthis._treeField = treeField;\r\n\t},\r\n\r\n\t/**\r\n\t * Default cell render, it must be a child class of @see jslet.ui.CellRender \r\n\t * <pre><code>\r\n\t * \tvar cellRender = jslet.Class.create(jslet.ui.CellRender, {\r\n\t *\t\tcreateHeader: function(cellPanel, colCfg) { },\r\n\t *\t\tcreateCell: function (cellPanel, colCfg) { },\r\n\t *\t\trefreshCell: function (cellPanel, colCfg, recNo) { }\r\n\t * });\r\n\t * </code></pre>  \r\n\t */\r\n\tdefaultCellRender: function(defaultCellRender) {\r\n\t\tif(defaultCellRender === undefined) {\r\n\t\t\treturn this._defaultCellRender;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTable.defaultCellRender', defaultCellRender).isObject();\r\n\t\t\r\n\t\tthis._defaultCellRender = defaultCellRender;\r\n\t},\r\n\t\r\n\tcurrColNum: function(currColNum) {\r\n\t\tvar Z = this;\r\n\t\tif(currColNum === undefined) {\r\n\t\t\treturn Z._currColNum;\r\n\t\t}\r\n\t\tvar oldColNum = Z._currColNum;\r\n\t\tZ._currColNum = currColNum;\r\n\t\tif(oldColNum !== currColNum) {\r\n\t\t\tZ._adjustCurrentCellPos(oldColNum > currColNum);\r\n\t\t}\r\n\t\tZ._showCurrentCell();\r\n\t\tif(Z._findDialog) {\r\n\t\t\tvar colCfg = Z.innerColumns[currColNum];\r\n\t\t\tif(colCfg.field) {\r\n\t\t\t\tZ._findDialog.findingField(colCfg.field);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * Fired when table row clicked.\r\n\t *  Pattern: \r\n\t *\tfunction(event}{}\r\n\t *  \t//event: Js mouse event\r\n\t *  \r\n\t * @param {Function or undefined} onRowClick table row clicked event handler.\r\n\t * @return {this or Function}\r\n\t */\r\n\tonRowClick: function(onRowClick) {\r\n\t\tif(onRowClick === undefined) {\r\n\t\t\treturn this._onRowClick;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTable.onRowClick', onRowClick).isFunction();\r\n\t\tthis._onRowClick = onRowClick;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Fired when table row double clicked.\r\n\t *  Pattern: \r\n\t *\tfunction(event}{}\r\n\t *  \t//event: Js mouse event\r\n\t *  \r\n\t * @param {Function or undefined} onRowDblClick table row double clicked event handler.\r\n\t * @return {this or Function}\r\n\t */\r\n\tonRowDblClick: function(onRowDblClick) {\r\n\t\tif(onRowDblClick === undefined) {\r\n\t\t\treturn this._onRowDblClick;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTable.onRowDblClick', onRowDblClick).isFunction();\r\n\t\tthis._onRowDblClick = onRowDblClick;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Fired when table cell clicked.\r\n\t *  Pattern: \r\n\t *\tfunction(event}{}\r\n\t *  \t//event: Js mouse event\r\n\t *  \r\n\t * @param {Function or undefined} onCellClick table cell clicked event handler.\r\n\t * @return {this or Function}\r\n\t */\r\n\tonCellClick: function(onCellClick) {\r\n\t\tif(onCellClick === undefined) {\r\n\t\t\treturn this._onCellClick;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTable.onCellClick', onCellClick).isFunction();\r\n\t\tthis._onCellClick = onCellClick;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Fired when table row is selected(select column is checked).\r\n\t *  Pattern: \r\n\t *   function(selected}{}\r\n\t *   //selected: Boolean\r\n\t *   //return: true - allow user to select this row, false - otherwise.\r\n\t *  \r\n\t * @param {Function or undefined} onSelect table row selected event handler.\r\n\t * @return {this or Function}\r\n\t */\r\n\tonSelect: function(onSelect) {\r\n\t\tif(onSelect === undefined) {\r\n\t\t\treturn this._onSelect;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTable.onSelect', onSelect).isFunction();\r\n\t\tthis._onSelect = onSelect;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Fired when all table rows are selected.\r\n\t *  Pattern: \r\n\t *   function(dataset, Selected}{}\r\n\t *   //dataset: jslet.data.Dataset\r\n\t *   //Selected: Boolean\r\n\t *   //return: true - allow user to select, false - otherwise.\r\n\t *  \r\n\t * @param {Function or undefined} onSelectAll All table row selected event handler.\r\n\t * @return {this or Function}\r\n\t */\r\n\tonSelectAll: function(onSelectAll) {\r\n\t\tif(onSelectAll === undefined) {\r\n\t\t\treturn this._onSelectAll;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTable.onSelectAll', onSelectAll).isFunction();\r\n\t\tthis._onSelectAll = onSelectAll;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Fired when table row is selecting(select column is checked).\r\n\t *  Pattern: \r\n\t *   function(selected}{}\r\n\t *   //selected: Boolean\r\n\t *   //return: true - allow user to select this row, false - otherwise.\r\n\t *  \r\n\t * @param {Function or undefined} onSelect table row selected event handler.\r\n\t * @return {this or Function}\r\n\t */\r\n\tbeforeSelect: function(beforeSelect) {\r\n\t\tif(beforeSelect === undefined) {\r\n\t\t\treturn this._beforeSelect;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTable.beforeSelect', beforeSelect).isFunction();\r\n\t\tthis._beforeSelect = beforeSelect;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Fired when table row is selected(select column is checked).\r\n\t *  Pattern: \r\n\t *   function(selected}{}\r\n\t *   //selected: Boolean\r\n\t *   //return: true - allow user to select this row, false - otherwise.\r\n\t *  \r\n\t * @param {Function or undefined} onSelect table row selected event handler.\r\n\t * @return {this or Function}\r\n\t */\r\n\tafterSelect: function(afterSelect) {\r\n\t\tif(afterSelect === undefined) {\r\n\t\t\treturn this._afterSelect;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTable.afterSelect', afterSelect).isFunction();\r\n\t\tthis._afterSelect = afterSelect;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Fired when all table rows are selecting(select column is checked).\r\n\t *  Pattern: \r\n\t *   function(selected}{}\r\n\t *   //selected: Boolean\r\n\t *   //return: true - allow user to select this row, false - otherwise.\r\n\t *  \r\n\t * @param {Function or undefined} onSelect table row selected event handler.\r\n\t * @return {this or Function}\r\n\t */\r\n\tbeforeSelectAll: function(beforeSelectAll) {\r\n\t\tif(beforeSelectAll === undefined) {\r\n\t\t\treturn this._beforeSelectAll;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTable.beforeSelectAll', beforeSelectAll).isFunction();\r\n\t\tthis._beforeSelectAll = beforeSelectAll;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Fired when all table rows are selected(select column is checked).\r\n\t *  Pattern: \r\n\t *   function(selected}{}\r\n\t *   //selected: Boolean\r\n\t *   //return: true - allow user to select this row, false - otherwise.\r\n\t *  \r\n\t * @param {Function or undefined} onSelect table row selected event handler.\r\n\t * @return {this or Function}\r\n\t */\r\n\tafterSelectAll: function(afterSelectAll) {\r\n\t\tif(afterSelectAll === undefined) {\r\n\t\t\treturn this._afterSelectAll;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTable.afterSelectAll', afterSelectAll).isFunction();\r\n\t\tthis._afterSelectAll = afterSelectAll;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Fired when user click table header to sort data. You can use it to sort data instead of default, like sending request to server to sort data.  \r\n\t * Pattern: \r\n\t *   function(indexFlds}{}\r\n\t *   //indexFlds: String, format: fieldName desc/asce(default), fieldName,..., desc - descending order, asce - ascending order, like: \"field1 desc,field2,field3\"\r\n\t *   \r\n\t * @param {Function or undefined} onCustomSort Customized sorting event handler.\r\n\t * @return {this or Function}\r\n\t */\r\n\tonCustomSort: function(onCustomSort) {\r\n\t\tif(onCustomSort === undefined) {\r\n\t\t\treturn this._onCustomSort;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTable.onCustomSort', onCustomSort).isFunction();\r\n\t\tthis._onCustomSort = onCustomSort;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Fired when fill row, user can use this to customize each row style like background color, font color\r\n\t * Pattern:\r\n\t *   function(otr, dataset){)\r\n\t *   //otr: Html element: TR\r\n\t *   //dataset: jslet.data.Dataset\r\n\t *   \r\n\t * @param {Function or undefined} onFillRow Table row filled event handler.\r\n\t * @return {this or Function}\r\n\t */\r\n\tonFillRow: function(onFillRow) {\r\n\t\tif(onFillRow === undefined) {\r\n\t\t\treturn this._onFillRow;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTable.onFillRow', onFillRow).isFunction();\r\n\t\tthis._onFillRow = onFillRow;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Fired when fill cell, user can use this to customize each cell style like background color, font color\r\n\t * Pattern:\r\n\t *   function(otd, dataset, fieldName){)\r\n\t *   //otd: Html element: TD\r\n\t *   //dataset: jslet.data.Dataset\r\n\t *   //fieldName: String\r\n\t *   \r\n\t * @param {Function or undefined} onFillCell Table cell filled event handler.\r\n\t * @return {this or Function}\r\n\t */\r\n\tonFillCell: function(onFillCell) {\r\n\t\tif(onFillCell === undefined) {\r\n\t\t\treturn this._onFillCell;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTable.onFillCell', onFillCell).isFunction();\r\n\t\tthis._onFillCell = onFillCell;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify has finding dialog or not.\r\n\t * \r\n\t * @param {Boolean or undefined} hasFindDialog true(default) - show finding dialog when press 'Ctrl + F', false - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\thasFindDialog: function(hasFindDialog) {\r\n\t\tvar Z = this;\r\n\t\tif(hasFindDialog === undefined) {\r\n\t\t\treturn Z._hasFindDialog;\r\n\t\t}\r\n\t\tZ._hasFindDialog = hasFindDialog? true: false;\r\n\t},\r\n\r\n\t/**\r\n\t * Identify has filter dialog or not.\r\n\t * \r\n\t * @param {Boolean or undefined} hasFilterDialog true(default) - show filter dialog when creating table, false - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\thasFilterDialog: function(hasFilterDialog) {\r\n\t\tvar Z = this;\r\n\t\tif(hasFilterDialog === undefined) {\r\n\t\t\treturn Z._hasFilterDialog;\r\n\t\t}\r\n\t\tZ._hasFilterDialog = hasFilterDialog? true: false;\r\n\t},\r\n\r\n\tcellEditor: function() {\r\n\t\tvar Z = this;\r\n\t\tif(!Z._editable) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif(!Z._cellEditor) {\r\n\t\t\tZ._cellEditor = new jslet.ui.TableCellEditor(Z);\r\n\t\t}\r\n\t\treturn Z._cellEditor;\r\n\t},\r\n\r\n\t/**\r\n\t * Table columns configurations, array of jslet.ui.TableColumn.\r\n\t * \r\n\t * @param {jslet.ui.TableColumn[] or undefined} columns Table columns configurations.\r\n\t * @return {jslet.ui.TableColumn[] or undefined}\r\n\t */\r\n\tcolumns: function(columns) {\r\n\t\tif(columns === undefined) {\r\n\t\t\treturn this._columns;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTable.columns', columns).isArray();\r\n\t\tvar colObj;\r\n\t\tfor(var i = 0, len = columns.length; i < len; i++) {\r\n\t\t\tcolObj = columns[i];\r\n\t\t\tjslet.Checker.test('DBTable.Column.field', colObj.field).isString();\r\n\t\t\tjslet.Checker.test('DBTable.Column.label', colObj.label).isString();\r\n\t\t\tjslet.Checker.test('DBTable.Column.colNum', colObj.colNum).isGTEZero();\r\n\t\t\tjslet.Checker.test('DBTable.Column.displayOrder', colObj.displayOrder).isNumber();\r\n\t\t\tjslet.Checker.test('DBTable.Column.width', colObj.width).isGTZero();\r\n\t\t\tjslet.Checker.test('DBTable.Column.colSpan', colObj.colSpan).isGTZero();\r\n\t\t\tcolObj.disableHeadSort = colObj.disableHeadSort ? true: false;\r\n\t\t\tif(!colObj.field) {\r\n\t\t\t\tcolObj.disableHeadSort = true;\r\n\t\t\t}\r\n\t\t\tcolObj.mergeSame = colObj.mergeSame ? true: false;\r\n\t\t\tcolObj.noRefresh = colObj.noRefresh ? true: false;\r\n\t\t\tjslet.Checker.test('DBTable.Column.cellRender', colObj.cellRender).isObject();\r\n\t\t}\r\n\t\tthis._columns = columns;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Goto and show the specified cell by field name.\r\n\t * \r\n\t * @param {String} fldName field name.\r\n\t */\r\n\tgotoField: function(fldName) {\r\n\t\tjslet.Checker.test('DBTable.gotoField#fldName', fldName).required().isString();\r\n\t\tvar colNum = this.getColNumByField(fldName);\r\n\t\tif(colNum >= 0) {\r\n\t\t\tthis.gotoColumn(colNum);\r\n\t\t}\r\n\t},\r\n\t\r\n\tgetColNumByField: function(fldName) {\r\n\t\tvar lastColNum = this.innerColumns.length - 1,\r\n\t\t\tcolCfg;\r\n\t\tfor(var i = 0; i <= lastColNum; i++) {\r\n\t\t\tcolCfg = this.innerColumns[i];\r\n\t\t\tif(colCfg.field == fldName) {\r\n\t\t\t\treturn colCfg.colNum;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1;\r\n\t},\r\n\t\r\n\tgetFieldByColNum: function(colNum) {\r\n\t\tvar lastColNum = this.innerColumns.length - 1,\r\n\t\t\tcolCfg;\r\n\t\tfor(var i = 0; i <= lastColNum; i++) {\r\n\t\t\tcolCfg = this.innerColumns[i];\r\n\t\t\tif(colCfg.colNum == colNum) {\r\n\t\t\t\treturn colCfg.field;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Goto and show the specified cell by field name.\r\n\t * \r\n\t * @param {String} fldName field name.\r\n\t */\r\n\tgotoColumn: function(colNum) {\r\n\t\tjslet.Checker.test('DBTable.gotoColumn#colNum', colNum).required().isGTEZero();\r\n\t\tvar lastColNum = this.innerColumns.length - 1;\r\n\t\tif(colNum > lastColNum) {\r\n\t\t\tcolNum = lastColNum;\r\n\t\t}\r\n\t\tthis.currColNum(colNum);\r\n\t},\r\n\t\r\n\teditorTabIndex: function() {\r\n\t\treturn this._editorTabIndex;\r\n\t},\r\n\t\r\n\t/**\r\n\t* @override\r\n\t*/\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn el.tagName.toLowerCase() == 'div';\r\n\t},\r\n\t\r\n\t_calcTabIndex: function() {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\tif(Z._editable) {\r\n\t\t\tvar masterFldObj = Z._dataset.getMasterFieldObject(),\r\n\t\t\t\ttbIdx = null;\r\n\t\t\tif(masterFldObj) {\r\n\t\t\t\ttbIdx = masterFldObj.tabIndex();\r\n\t\t\t}\r\n\t\t\tif(!tbIdx) {\r\n\t\t\t\ttbIdx = Z.el.tabIndex;\r\n\t\t\t}\r\n\t\t\tZ._editorTabIndex = tbIdx && tbIdx > 0? tbIdx: null;\r\n\t\t}\r\n\t\tZ.el.tabIndex = -1;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tvar Z = this;\r\n\t\tjslet.resizeEventBus.subscribe(Z);\r\n\t\t\r\n\t\tjslet.ui.textMeasurer.setElement(Z.el);\r\n\t\tZ.charHeight = jslet.ui.textMeasurer.getHeight('M')+4;\r\n\t\tjslet.ui.textMeasurer.setElement();\r\n\t\tZ.charWidth = jslet.global.defaultCharWidth || 12;\r\n\t\tZ._widthStyleId = jslet.nextId();\r\n\t\tZ._initializeVm();\r\n\t\tZ._calcTabIndex();\r\n\t\tZ.renderAll();\r\n\t\tvar jqEl = jQuery(Z.el);\r\n        var notFF = ((typeof Z.el.onmousewheel) == 'object'); //firefox or nonFirefox browser\r\n        var wheelEvent = (notFF ? 'mousewheel' : 'DOMMouseScroll');\r\n        jqEl.on(wheelEvent, function (event) {\r\n            var originalEvent = event.originalEvent;\r\n            var num = notFF ? originalEvent.wheelDelta / -120 : originalEvent.detail / 3;\r\n\t\t\tif(Z._editable && Z._dataset.status() != jslet.data.DataSetStatus.BROWSE) {\r\n\t\t\t\tZ._dataset.confirm();\r\n\t\t\t}\r\n\t\t\tvar cellEditor = Z.cellEditor();\r\n\t\t\tif(cellEditor) {\r\n\t\t\t\tcellEditor.hideEditor();\r\n\t\t\t}\r\n            Z.listvm.setVisibleStartRow(Z.listvm.getVisibleStartRow() + num);\r\n       \t\tevent.preventDefault();\r\n        });\r\n\r\n        jqEl.on('mousedown', function(event){\r\n        \tif(event.shiftKey) {\r\n\t       \t\tevent.preventDefault();\r\n\t       \t\tevent.stopImmediatePropagation();\r\n\t       \t\treturn false;\r\n        \t}\r\n        });\r\n        \r\n        jqEl.on('click', 'button.jl-tbl-filter', function(event) {\r\n    \t\tif (!Z._filterPanel) {\r\n    \t\t\tZ._filterPanel = new jslet.ui.DBTableFilterPanel(Z);\r\n    \t\t}\r\n    \t\tvar btnEle = event.currentTarget,\r\n    \t\t\tjqFilterBtn = jQuery(btnEle),\r\n    \t\t\ttblPos = jQuery(Z.el).offset();\r\n    \t\tvar r = jqFilterBtn.offset(), \r\n    \t\t\th = jqFilterBtn.outerHeight(), \r\n    \t\t\tx = r.left - tblPos.left, \r\n    \t\t\ty = r.top + h - tblPos.top;\r\n    \t\tif (jslet.locale.isRtl){\r\n    \t\t\tx = x + jqFilterBtn.outerWidth();\r\n    \t\t}\r\n    \t\tvar fldName = jqFilterBtn[0].getAttribute('jsletfilterfield');\r\n    \t\tZ._filterPanel.changeField(fldName);\r\n    \t\tZ._filterPanel.jqFilterBtn(jqFilterBtn);\r\n    \t\tZ._filterPanel.show(x, y, 0, h);\r\n        \t\r\n       \t\tevent.preventDefault();\r\n       \t\tevent.stopImmediatePropagation();\r\n        });\r\n        \r\n        jqEl.on('click', 'td.jl-tbl-cell', function(event){\r\n        \tvar otd = event.currentTarget;\r\n        \tvar colCfg = otd.jsletColCfg;\r\n        \tif(colCfg) {\r\n        \t\tif(colCfg.isSeqCol) { //If the cell is sequence cell, process row selection.\r\n        \t\t\tZ._processRowSelection(event.ctrlKey, event.shiftKey, event.altKey);\r\n        \t\t} else {\r\n\t        \t\tvar colNum = colCfg.colNum;\r\n\t        \t\tif(colNum !== 0 && !colNum) {\r\n\t        \t\t\treturn;\r\n\t        \t\t}\r\n\t\t\t\t\tZ._doBeforeSelect(event.ctrlKey, event.shiftKey, event.altKey);\r\n\t        \t\tZ.currColNum(colNum);\r\n\t\t\t\t\tZ._processSelection(event.ctrlKey, event.shiftKey, event.altKey);\r\n        \t\t}\r\n            \tZ._doCellClick(colCfg);\r\n            \tvar cellEditor = Z.cellEditor();\r\n            \tif(cellEditor) {\r\n            \t\tif(Z._isCellEditable(colCfg)) {\r\n            \t\t\tvar fldName = colCfg.field;\r\n            \t\t\tcellEditor.showEditor(fldName, otd);\r\n            \t\t\tif(colCfg.isBoolColumn) {\r\n            \t\t\t\twindow.setTimeout(function() {\r\n                \t\t\t\tZ._dataset.setFieldValue(fldName, !Z._dataset.getFieldValue(fldName));\r\n            \t\t\t\t}, 5);\r\n            \t\t\t}\r\n            \t\t} else {\r\n            \t\t\tcellEditor.hideEditor();\r\n            \t\t}\r\n            \t}\r\n        \t}\r\n        \tif(event.shiftKey || event.ctrlKey) {\r\n\t       \t\tevent.preventDefault();\r\n\t       \t\tevent.stopImmediatePropagation();\r\n\t       \t\treturn false;\r\n        \t}\r\n        });\r\n\r\n\t\tjqEl.on('keydown', function (event) {\r\n\t\t\tvar keyCode = event.which,\r\n\t\t\t\tctrlKey = event.ctrlKey,\r\n\t\t\t\tshiftKey = event.shiftKey,\r\n\t\t\t\taltKey = event.altKey;\r\n\t\t\tif(Z._hasFindDialog && ctrlKey && keyCode === jslet.ui.KeyCode.F) { //ctrl + f\r\n\t\t\t\tZ.showFindDialog();\r\n\t\t\t\tevent.preventDefault();\r\n\t       \t\tevent.stopImmediatePropagation();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif(ctrlKey && keyCode === jslet.ui.KeyCode.E) { //ctrl + e\r\n\t\t\t\tZ.gotoNextError();\r\n\t\t\t\tevent.preventDefault();\r\n\t       \t\tevent.stopImmediatePropagation();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif(ctrlKey && keyCode === jslet.ui.KeyCode.C) { //ctrl + c\r\n\t\t\t\tZ.copySelection(false);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif(ctrlKey && keyCode === jslet.ui.KeyCode.A) { //ctrl + a\r\n\t\t\t\tZ.selectAllCells();\r\n\t\t\t\tevent.preventDefault();\r\n\t       \t\tevent.stopImmediatePropagation();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tvar isTabKey = (keyCode === jslet.ui.KeyCode.TAB || keyCode === jslet.global.defaultFocusKeyCode);\r\n\t\t\tif(shiftKey && isTabKey) { //Shift TAB Left\r\n\t\t\t\tif(!Z.tabPrior()) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t} else if(isTabKey) { //TAB Right\r\n\t\t\t\tif(!Z.tabNext()) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t} else if(keyCode === jslet.ui.KeyCode.LEFT) { //Arrow Left\r\n\t\t\t\tZ.movePriorCell(ctrlKey, shiftKey, altKey);\r\n\t\t\t} else if( keyCode === jslet.ui.KeyCode.RIGHT) { //Arrow Right\r\n\t\t\t\tZ.moveNextCell(ctrlKey, shiftKey, altKey);\r\n\t\t\t} else if (keyCode === jslet.ui.KeyCode.UP) {//KEY_UP\r\n\t\t\t\tZ._doBeforeSelect(ctrlKey, shiftKey, altKey);\r\n\t\t\t\tZ.listvm.priorRow();\r\n\t\t\t\tZ._processSelection(ctrlKey, shiftKey, altKey);\r\n\t\t\t} else if (keyCode === jslet.ui.KeyCode.DOWN) {//KEY_DOWN\r\n\t\t\t\tZ._doBeforeSelect(ctrlKey, shiftKey, altKey);\r\n\t\t\t\tZ.listvm.nextRow();\r\n\t\t\t} else if (keyCode === jslet.ui.KeyCode.PAGEUP) {//KEY_PAGEUP\r\n\t\t\t\tZ.listvm.priorPage();\r\n\t\t\t} else if (keyCode === jslet.ui.KeyCode.PAGEDOWN) {//KEY_PAGEDOWN\r\n\t\t\t\tZ.listvm.nextPage();\r\n\t\t\t} else {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tevent.preventDefault();\r\n       \t\tevent.stopImmediatePropagation();\r\n\t\t});\t\t\r\n\t}, // end bind\r\n\t\r\n\tshowFindDialog: function() {\r\n\t\tvar Z = this;\r\n\t\tif(Z._filterPanel) {\r\n\t\t\tZ._filterPanel.hide();\r\n\t\t}\r\n\t\tif(!Z._hasFindDialog) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(!Z._findDialog) {\r\n\t\t\tZ._findDialog = new jslet.ui.FindDialog(Z);\r\n\t\t}\r\n\t\tif(!Z._findDialog.findingField()) {\r\n\t\t\tvar colCfg = Z.innerColumns[Z._currColNum];\r\n\t\t\tif(colCfg.field) {\r\n\t\t\t\tZ._findDialog.findingField(colCfg.field);\r\n\t\t\t} else {\r\n\t\t\t\t//Get first column with field name.\r\n\t\t\t\tfor(var i = Z._currColNum + 1, len = Z.innerColumns.length; i < len; i++) {\r\n\t\t\t\t\tcolCfg = Z.innerColumns[i];\r\n\t\t\t\t\tif(colCfg.field) {\r\n\t\t\t\t\t\tZ._findDialog.findingField(colCfg.field);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(Z._findDialog.findingField()) {\r\n\t\t\tZ._findDialog.show(0, Z.headSectionHt);\r\n\t\t}\t\t\r\n\t},\r\n\t\r\n\tgotoNextError: function() {\r\n\t\tvar Z = this;\r\n\t\tif(!Z._dataset.nextError()) {\r\n\t\t\tZ._dataset.firstError();\r\n\t\t}\r\n\t},\r\n\t\r\n\tcopySelection: function(fitExcel) {\r\n\t\tvar Z = this, \r\n\t\t\tselectedText;\r\n\t\tif(fitExcel) {\r\n\t\t\tselectedText = Z._dataset.selection.getSelectionText('\"', true, '\\t');\r\n\t\t} else {\r\n\t\t\tselectedText = Z._dataset.selection.getSelectionText('', false, '\\t');\r\n\t\t}\r\n\t\tif(!selectedText) {\r\n\t\t\tvar fldName = Z.getFieldByColNum(Z._currColNum);\r\n\t\t\tif(fldName) {\r\n\t\t\t\tselectedText = Z._dataset.getFieldText(fldName);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(selectedText) {\r\n\t\t\tjslet.Clipboard.putText(selectedText);\r\n\t\t\twindow.setTimeout(function(){Z.el.focus();}, 5);\r\n\t\t}\r\n\t},\r\n\t\r\n\tselectAllCells: function() {\r\n\t\tvar Z = this,\r\n\t\t\tfields = [], colCfg, fldName;\r\n\t\tfor(var i = 0, len = Z.innerColumns.length; i < len; i++) {\r\n\t\t\tcolCfg = Z.innerColumns[i];\r\n\t\t\tfldName = colCfg.field;\r\n\t\t\tif(fldName) {\r\n\t\t\t\tfields.push(fldName);\r\n\t\t\t}\r\n\t\t}\r\n\t\tZ._dataset.selection.selectAll(fields, true);\r\n\t\tZ._refreshSelection();\r\n\t},\r\n\t\r\n\ttabPrior: function() {\r\n\t\tvar Z = this,\r\n\t\t\tfldName = Z.getFieldByColNum(Z._currColNum),\r\n\t\t\tlastColNum, num = null, \r\n\t\t\tfocusedFields = Z._dataset.focusedFields(),\r\n\t\t\teditingFields = Z._getEditingFields();\r\n\t\tif(editingFields && editingFields.indexOf(fldName) >= 0) {\r\n\t\t\tvar focusMngr = jslet.ui.focusManager,\r\n\t\t\t\tonChangingFocusFn = focusMngr.onChangingFocus();\r\n\t\t\t\r\n\t\t\tif(focusedFields) {\r\n\t\t\t\tfocusedFields = focusedFields.slice(0);\r\n\t\t\t\tfor(var i = focusedFields.length - 1; i >= 0; i--) {\r\n\t\t\t\t\tif(editingFields.indexOf(focusedFields[i]) < 0) {\r\n\t\t\t\t\t\tfocusedFields.splice(i, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar idx = -1, fields;\r\n\t\t\tif(focusedFields) {\r\n\t\t\t\tfields = focusedFields;\r\n\t\t\t\tidx = fields.indexOf(fldName);\r\n\t\t\t}\r\n\t\t\tif(idx < 0) {\r\n\t\t\t\tfields = editingFields;\r\n\t\t\t\tidx = fields.indexOf(fldName);\r\n\t\t\t}\r\n\t\t\tif(onChangingFocusFn) {\r\n\t\t\t\tvar cancelFocus = onChangingFocusFn(document.activeElement || Z.el, true, Z._dataset, \r\n\t\t\t\t\t\tfocusMngr.activeField(), fields, focusMngr.activeValueIndex());\r\n\t\t\t\tif(!cancelFocus) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(fields && idx >= 0) {\r\n\t\t\t\tif(idx === 0) {\r\n\t\t\t\t\tif(Z._dataset.recno() > 0) {\r\n\t\t\t\t\t\tZ._dataset.prior();\r\n\t\t\t\t\t\tfldName = fields[fields.length - 1];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfldName = fields[idx - 1];\r\n\t\t\t\t}\r\n\t\t\t\tnum = Z.getColNumByField(fldName);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(num === null) {\r\n\t\t\tlastColNum = Z.innerColumns.length - 1;\r\n\t\t\tif(Z._currColNum === 0) {\r\n\t\t\t\tif(Z._dataset.recno() > 0) {\r\n\t\t\t\t\tZ._dataset.prior();\r\n\t\t\t\t\tnum = lastColNum;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tnum = Z._currColNum - 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\tZ.currColNum(num);\r\n\t\treturn true;\r\n\t},\r\n\t\r\n\ttabNext: function() {\r\n\t\tvar Z = this,\r\n\t\t\tfldName = Z.getFieldByColNum(Z._currColNum),\r\n\t\t\tlastColNum, num = null, \r\n\t\t\tfocusedFields = Z._dataset.focusedFields(),\r\n\t\t\teditingFields = Z._getEditingFields();\r\n\t\t\t\r\n\t\tif(editingFields && editingFields.indexOf(fldName) >= 0) {\r\n\t\t\tvar focusMngr = jslet.ui.focusManager,\r\n\t\t\t\tonChangingFocusFn = focusMngr.onChangingFocus();\r\n\t\t\t\r\n\t\t\tif(focusedFields) {\r\n\t\t\t\tfocusedFields = focusedFields.slice(0);\r\n\t\t\t\tfor(var i = focusedFields.length - 1; i >= 0; i--) {\r\n\t\t\t\t\tif(editingFields.indexOf(focusedFields[i]) < 0) {\r\n\t\t\t\t\t\tfocusedFields.splice(i, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar idx = -1, fields;\r\n\t\t\tif(focusedFields) {\r\n\t\t\t\tfields = focusedFields;\r\n\t\t\t\tidx = fields.indexOf(fldName);\r\n\t\t\t}\r\n\t\t\tif(idx < 0) {\r\n\t\t\t\tfields = editingFields;\r\n\t\t\t\tidx = fields.indexOf(fldName);\r\n\t\t\t}\r\n\t\t\tif(onChangingFocusFn) {\r\n\t\t\t\tvar cancelFocus = onChangingFocusFn(document.activeElement || Z.el, false, Z._dataset, \r\n\t\t\t\t\t\tfocusMngr.activeField(), fields, focusMngr.activeValueIndex());\r\n\t\t\t\tif(!cancelFocus) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(fields && idx >= 0) {\r\n\t\t\t\tif(idx === fields.length - 1) {\r\n\t\t\t\t\tif(Z._dataset.recno() < Z._dataset.recordCount() - 1) {\r\n\t\t\t\t\t\tZ._dataset.next();\r\n\t\t\t\t\t\tfldName = fields[0];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfldName = fields[idx + 1];\r\n\t\t\t\t}\r\n\t\t\t\tnum = Z.getColNumByField(fldName);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(num === null) {\r\n\t\t\tlastColNum = Z.innerColumns.length - 1;\r\n\t\t\tif(Z._currColNum < lastColNum) {\r\n\t\t\t\tnum = Z._currColNum + 1;\r\n\t\t\t} else {\r\n\t\t\t\tif(Z._dataset.recno() === Z._dataset.recordCount() - 1) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tZ._dataset.next();\r\n\t\t\t\tnum = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t\tZ.currColNum(num);\r\n\t\treturn true;\r\n\t},\r\n\t\r\n\tmovePriorCell: function(ctrlKey, shiftKey, altKey) {\r\n\t\tvar Z = this,\r\n\t\t\tlastColNum = Z.innerColumns.length - 1,\r\n\t\t\tnum;\r\n\t\t\r\n\t\tif(Z._currColNum === 0) {\r\n\t\t\tif(Z._dataset.recno() > 0) {\r\n\t\t\t\tZ._dataset.prior();\r\n\t\t\t\tnum = lastColNum;\r\n\t\t\t} else {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tnum = Z._currColNum - 1;\r\n\t\t}\r\n\t\tZ._doBeforeSelect(ctrlKey, shiftKey, altKey);\r\n\t\tZ.currColNum(num);\r\n\t\tZ._processSelection(ctrlKey, shiftKey, altKey);\r\n\t},\r\n\t\r\n\tmoveNextCell: function() {\r\n\t\tvar Z = this,\r\n\t\t\tlastColNum = Z.innerColumns.length - 1,\r\n\t\t\tnum;\r\n\t\t\r\n\t\tif(Z._currColNum < lastColNum) {\r\n\t\t\tnum = Z._currColNum + 1;\r\n\t\t} else {\r\n\t\t\tif(Z._dataset.recno() === Z._dataset.recordCount() - 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tZ._dataset.next();\r\n\t\t\tnum = 0;\r\n\t\t}\r\n\t\tZ.currColNum(num);\r\n\t},\r\n\t\r\n\t_getEditingFields: function() {\r\n\t\tvar Z = this; \r\n\t\tif(!Z._editable) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar fldName, fldObj,\r\n\t\t\tdsObj = Z._dataset,\r\n\t\t\tresult = null;\r\n\r\n\t\tfor(var i = 0, len = Z.innerColumns.length; i < len; i++) {\r\n\t\t\tfldName = Z.innerColumns[i].field;\r\n\t\t\tif(!fldName) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tfldObj = dsObj.getField(fldName);\r\n\t\t\tif(!fldObj.disabled() && !fldObj.readOnly()) {\r\n\t\t\t\tif(!result) {\r\n\t\t\t\t\tresult = [];\r\n\t\t\t\t}\r\n\t\t\t\tresult.push(fldName);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t},\r\n\t\r\n\t_initializeVm: function () {\r\n\t\tvar Z = this;\r\n\r\n\t\tZ.listvm = new jslet.ui.ListViewModel(Z._dataset, Z._treeField ? true : false);\r\n\t\t\r\n\t\tZ.listvm.onTopRownoChanged = function (rowno) {\r\n\t\t\tif (rowno < 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tZ._fillData();\r\n\t\t\t\r\n\t\t\tZ._syncScrollBar(rowno);\r\n\t\t\tZ._showCurrentRow();\r\n\t\t};\r\n\t\r\n\t\tZ.listvm.onVisibleCountChanged = function () {\r\n\t\t\tZ.renderAll();\r\n\t\t};\r\n\t\t\r\n\t\tZ.listvm.onCurrentRownoChanged = function (preRowno, rowno) {\r\n\t\t\tif (Z._dataset.recordCount() === 0) {\r\n\t\t\t\tZ._currRow = null;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tZ._dataset.recno(Z.listvm.getCurrentRecno());\r\n\t\t\tif (Z._currRow) {\r\n\t\t\t\tif (Z._currRow.fixed) {\r\n\t\t\t\t\tjQuery(Z._currRow.fixed).removeClass(jslet.ui.htmlclass.TABLECLASS.currentrow);\r\n\t\t\t\t}\r\n\t\t\t\tjQuery(Z._currRow.content).removeClass(jslet.ui.htmlclass.TABLECLASS.currentrow);\r\n\t\t\t}\r\n\t\t\tvar currRow = Z._getTrByRowno(rowno), otr;\r\n\t\t\tif (!currRow) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\totr = currRow.fixed;\r\n\t\t\tif (otr) {\r\n\t\t\t\tjQuery(otr).addClass(jslet.ui.htmlclass.TABLECLASS.currentrow);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\totr = currRow.content;\r\n\t\t\tjQuery(otr).addClass(jslet.ui.htmlclass.TABLECLASS.currentrow);\r\n\t\t\tZ._currRow = currRow;\r\n\t\t\tif(Z._editable) {\r\n\t\t\t\tvar fldName = Z._editingField;\r\n\t\t\t\tif(fldName) {\r\n\t\t\t\t\tvar fldObj = Z._dataset.getField(fldName);\r\n\t\t\t\t\tif(fldObj && !fldObj.disabled() && !fldObj.readOnly()) {\r\n\t\t\t\t\t\tZ._dataset.focusEditControl(fldName);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tvar Z = this;\r\n\t\tZ._innerDestroy();\r\n\t\tZ.el.innerHTML = '';\r\n\t\tZ.listvm.fixedRows = Z._fixedRows;\r\n\t\tZ._calcParams();\r\n\t\tZ.listvm.refreshModel();\r\n\t\tZ._createFrame();\r\n\t\tZ._fillData();\r\n\t\tZ._showCurrentRow();\r\n\t\tZ._oldHeight = jQuery(Z.el).height();\r\n\t\tZ._updateSortFlag(true);\r\n\t}, // end renderAll\r\n\r\n\t_doBeforeSelect: function(hasCtrlKey, hasShiftKey, hasAltKey) {\r\n\t},\r\n\t\r\n\t_getSelectionFields: function(startColNum, endColNum) {\r\n\t\tif(startColNum > endColNum) {\r\n\t\t\tvar tmp = startColNum;\r\n\t\t\tstartColNum = endColNum;\r\n\t\t\tendColNum = tmp;\r\n\t\t}\r\n\t\tvar fields = [], fldName, colCfg, colNum;\r\n\t\tfor(var i = 0, len = this.innerColumns.length; i < len; i++) {\r\n\t\t\tcolCfg = this.innerColumns[i];\r\n\t\t\tcolNum = colCfg.colNum;\r\n\t\t\tif(colNum >= startColNum && colNum <= endColNum) {\r\n\t\t\t\tfldName = colCfg.field;\r\n\t\t\t\tif(fldName) {\r\n\t\t\t\t\tfields.push(fldName);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn fields;\r\n\t},\r\n\t\r\n\t_processSelection: function(hasCtrlKey, hasShiftKey, hasAltKey) {\r\n\t\tvar Z = this,\r\n\t\t\tcurrRecno = Z._dataset.recno(),\r\n\t\t\tfldName;\r\n\t\tif(hasCtrlKey || !Z._autoClearSelection) { //If autoClearSelection = false, click a cell will select it.\r\n\t\t\tfldName = Z.innerColumns[Z._currColNum].field;\r\n\t\t\tif(fldName) {\r\n\t\t\t\tif(Z._dataset.selection.isSelected(currRecno, fldName)) {\r\n\t\t\t\t\tZ._dataset.selection.remove(currRecno, currRecno, [fldName], true);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tZ._dataset.selection.add(currRecno, currRecno, [fldName], true);\r\n\t\t\t\t}\r\n\t\t\t\tZ._refreshSelection();\r\n\t\t\t}\r\n\t\t\tZ._preRecno = currRecno;\r\n\t\t\tZ._preColNum = Z._currColNum;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(hasShiftKey) {\r\n\t\t\tvar fields;\r\n\t\t\tif(Z._preTmpRecno >= 0 && Z._preTmpColNum >= 0) {\r\n\t\t\t\tfields = Z._getSelectionFields(Z._preColNum || 0, Z._preTmpColNum);\r\n\t\t\t\tZ._dataset.selection.remove(Z._preRecno || 0, Z._preTmpRecno, fields, false);\r\n\t\t\t}\r\n\t\t\tfields = Z._getSelectionFields(Z._preColNum || 0, Z._currColNum);\r\n\t\t\tZ._dataset.selection.add(Z._preRecno || 0, currRecno, fields, true);\r\n\t\t\tZ._refreshSelection();\r\n\t\t\tZ._preTmpRecno = currRecno;\r\n\t\t\tZ._preTmpColNum = Z._currColNum;\r\n\t\t} else {\r\n\t\t\tZ._preRecno = currRecno;\r\n\t\t\tZ._preColNum = Z._currColNum;\r\n\t\t\tZ._preTmpRecno = currRecno;\r\n\t\t\tZ._preTmpColNum = Z._currColNum;\r\n\t\t\tif(Z._autoClearSelection) {\r\n\t\t\t\tZ._dataset.selection.removeAll();\r\n\t\t\t\tZ._refreshSelection();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\t_processColumnSelection: function(colCfg, hasCtrlKey, hasShiftKey, hasAltKey) {\r\n\t\tif(!hasCtrlKey && !hasShiftKey) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar Z = this,\r\n\t\t\trecCnt = Z._dataset.recordCount();\r\n\t\tif(recCnt === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar fields, colNum;\r\n\t\tif(hasShiftKey) {\r\n\t\t\tif(Z._preTmpColNum >= 0) {\r\n\t\t\t\tfields = Z._getSelectionFields(Z._preColNum || 0, Z._preTmpColNum);\r\n\t\t\t\tZ._dataset.selection.remove(0, recCnt, fields, true);\r\n\t\t\t}\r\n\t\t\tcolNum = colCfg.colNum + colCfg.colSpan - 1;\r\n\t\t\tfields = Z._getSelectionFields(Z._preColNum || 0, colNum);\r\n\t\t\tZ._dataset.selection.add(0, recCnt, fields, true);\r\n\t\t\tZ._preTmpColNum = colNum;\r\n\t\t} else {\r\n\t\t\tif(!hasCtrlKey && Z._autoClearSelection) {\r\n\t\t\t\tZ._dataset.selection.removeAll();\r\n\t\t\t}\r\n\t\t\tif(colCfg.colSpan > 1) {\r\n\t\t\t\tfields = [];\r\n\t\t\t\tvar startColNum = colCfg.colNum,\r\n\t\t\t\t\tendColNum = colCfg.colNum + colCfg.colSpan, fldName;\r\n\t\t\t\t\r\n\t\t\t\tfor(colNum = startColNum; colNum < endColNum; colNum++) {\r\n\t\t\t\t\tfldName = Z.innerColumns[colNum].field;\r\n\t\t\t\t\tfields.push(fldName);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfields = [colCfg.field];\r\n\t\t\t}\r\n\t\t\tZ._dataset.selection.add(0, recCnt, fields, true);\r\n\t\t\tZ._preColNum = colCfg.colNum;\r\n\t\t}\r\n\t\tZ._refreshSelection();\r\n\t},\r\n\t\r\n\t_processRowSelection: function(hasCtrlKey, hasShiftKey, hasAltKey) {\r\n\t\tif(!hasCtrlKey && !hasShiftKey) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar Z = this,\r\n\t\t\tfields = Z._getSelectionFields(0, Z.innerColumns.length - 1);\r\n\t\tvar currRecno = Z._dataset.recno();\r\n\t\tif(hasShiftKey) {\r\n\t\t\tif(Z._preTmpRecno >= 0) {\r\n\t\t\t\tZ._dataset.selection.remove(Z._preRecno || 0, Z._preTmpRecno, fields, true);\r\n\t\t\t}\r\n\t\t\tZ._dataset.selection.add(Z._preRecno || 0, currRecno, fields, true);\r\n\t\t\tZ._preTmpColNum = currRecno;\r\n\t\t} else {\r\n\t\t\tif(!hasCtrlKey && Z._autoClearSelection) {\r\n\t\t\t\tZ._dataset.selection.removeAll();\r\n\t\t\t}\r\n\t\t\tZ._dataset.selection.add(currRecno, currRecno, fields, true);\r\n\t\t\tZ._preRecno = currRecno;\r\n\t\t}\r\n\t\tZ._refreshSelection();\r\n\t},\r\n\t\r\n\t_prepareColumn: function(){\r\n\t\tvar Z = this, cobj;\r\n\t\tZ._sysColumns = [];\r\n\t\t//prepare system columns\r\n\t\tif (Z._hasSeqCol){\r\n\t\t\tcobj = {label:'&nbsp;',width: Z.seqColWidth, disableHeadSort:true,isSeqCol:true, \r\n\t\t\t\t\tcellRender:jslet.ui.DBTable.sequenceCellRender, widthCssName: Z._widthStyleId + '-s0'};\r\n\t\t\tZ._sysColumns.push(cobj);\r\n\t\t}\r\n\t\tif (Z._hasSelectCol){\r\n\t\t\tcobj = {label:'<input type=\"checkbox\" />', width: Z.selectColWidth, disableHeadSort:true,isSelectCol:true, \r\n\t\t\t\t\tcellRender:jslet.ui.DBTable.selectCellRender, widthCssName: Z._widthStyleId + '-s1'};\r\n\t\t\tZ._sysColumns.push(cobj);\r\n\t\t}\r\n\t\t\r\n\t\tif (Z.subgroup && Z.subgroup.hasExpander){\r\n\t\t\tcobj = {label:'&nbsp;', width: Z.selectColWidth, disableHeadSort:true, isSubgroup: true, \r\n\t\t\t\t\tcellRender:jslet.ui.DBTable.subgroupCellRender, widthCssName: Z._widthStyleId + '-s2'};\r\n\t\t\tZ._sysColumns.push(cobj);\r\n\t\t}\r\n\t\t//prepare data columns\r\n\t\tvar tmpColumns = [], fldObj;\r\n\t\tif (Z._columns) {\r\n\t\t\tfor(var k = 0, colCnt2 = Z._columns.length; k < colCnt2; k++){\r\n\t\t\t\tcobj = Z._columns[k];\r\n\t\t\t\tif (!cobj.field){\r\n\t\t\t\t\tcobj.disableHeadSort = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfldObj = Z._dataset.getField(cobj.field);\r\n\t\t\t\t\tif(!fldObj) {\r\n\t\t\t\t\t\tthrow new Error('Not found Field: ' + cobj.field);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcobj.displayOrder = fldObj.displayOrder();\r\n\t\t\t\t}\r\n\t\t\t\ttmpColumns.push(cobj);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction getColumnObj(fldName) {\r\n\t\t\tif (Z._columns){\r\n\t\t\t\tfor(var m = 0, colCnt1 = Z._columns.length; m < colCnt1; m++){\r\n\t\t\t\t\tcobj = Z._columns[m];\r\n\t\t\t\t\tif (cobj.field && cobj.field == fldName){\r\n\t\t\t\t\t\treturn cobj;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar i, fldcnt, colCnt, fldName;\r\n\t\tif (!Z._onlySpecifiedCol) {\r\n\t\t\tvar fields = Z._dataset.getFields();\r\n\t\t\tfor (i = 0, fldcnt = fields.length; i < fldcnt; i++) {\r\n\t\t\t\tfldObj = fields[i];\r\n\t\t\t\tfldName = fldObj.name();\r\n\t\t\t\tif (fldObj.visible()) {\r\n\t\t\t\t\tcobj = getColumnObj(fldName);\r\n\t\t\t\t\tif(!cobj) {\r\n\t\t\t\t\t\tcobj = new jslet.ui.TableColumn();\r\n\t\t\t\t\t\tcobj.field = fldObj.name();\r\n\t\t\t\t\t\tcobj.displayOrder = fldObj.displayOrder();\r\n\t\t\t\t\t\ttmpColumns.push(cobj);\r\n\t\t\t\t\t}\r\n\t\t\t\t} // end if visible\r\n\t\t\t} // end for\r\n\t\t\tif (Z._columns){\r\n\t\t\t\tfor(i = 0, colCnt = Z._columns.length; i < colCnt; i++){\r\n\t\t\t\t\tcobj = Z._columns[i];\r\n\t\t\t\t\tif (!cobj.field){\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfldObj = Z._dataset.getTopField(cobj.field);\r\n\t\t\t\t\tif (!fldObj) {\r\n\t\t\t\t\t\tthrow new Error(\"Field: \" + cobj.field + \" doesn't exist!\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar children = fldObj.children();\r\n\t\t\t\t\tif (children && children.length > 0){\r\n\t\t\t\t\t\tfldName = fldObj.name();\r\n\t\t\t\t\t\tvar isUnique = true;\r\n\t\t\t\t\t\t// cobj.field is not a child of a groupfield, we need check if the topmost parent field is duplicate or not \r\n\t\t\t\t\t\tif (cobj.field != fldName){\r\n\t\t\t\t\t\t\tfor(var n = 0; n < tmpColumns.length; n++){\r\n\t\t\t\t\t\t\t\tif (tmpColumns[n].field == fldName){\r\n\t\t\t\t\t\t\t\t\tisUnique = false;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} // end for k\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (isUnique){\r\n\t\t\t\t\t\t\tcobj = new jslet.ui.TableColumn();\r\n\t\t\t\t\t\t\tcobj.field = fldName;\r\n\t\t\t\t\t\t\tcobj.displayOrder = fldObj.displayOrder();\r\n\t\t\t\t\t\t\ttmpColumns.push(cobj);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} //end for i\r\n\t\t\t} //end if Z.columns\r\n\t\t}\r\n\t\t\r\n\t\ttmpColumns.sort(function(cobj1, cobj2) {\r\n\t\t\tvar ord1 = cobj1.displayOrder || 0;\r\n\t\t\tvar ord2 = cobj2.displayOrder || 0;\r\n\t\t\treturn ord1 === ord2? 0: (ord1 < ord2? -1: 1);\r\n\t\t});\r\n\t\t\r\n\t\tZ.innerHeads = [];\r\n\t\tZ.innerColumns = [];\r\n\t\tvar ohead, label, \r\n\t\t\tcontext = {lastColNum: 0, depth: 0};\r\n\t\t\r\n\t\tfor(i = 0, colCnt = tmpColumns.length; i < colCnt; i++){\r\n\t\t\tcobj = tmpColumns[i];\r\n\t\t\tfldName = cobj.field;\r\n\t\t\tif (!fldName){\r\n\t\t\t\tohead = new jslet.ui.TableHead();\r\n\t\t\t\tlabel = cobj.label;\r\n\t\t\t\tohead.label = label? label: \"\";\r\n\t\t\t\tohead.level = 0;\r\n\t\t\t\tohead.colNum = context.lastColNum++;\r\n\t\t\t\tcobj.colNum = ohead.colNum;\r\n\t\t\t\tohead.id = jslet.nextId();\r\n\t\t\t\tohead.widthCssName = Z._widthStyleId + '-' + ohead.colNum;\r\n\t\t\t\tcobj.widthCssName = ohead.widthCssName;\r\n\t\t\t\tohead.disableHeadSort = cobj.disableHeadSort;\r\n\r\n\t\t\t\tZ.innerHeads.push(ohead);\r\n\t\t\t\tZ.innerColumns.push(cobj);\r\n\t\t\t\t\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tfldObj = Z._dataset.getField(fldName);\r\n\t\t\tZ._convertField2Head(context, fldObj);\r\n\t\t}\r\n\r\n\t\tZ.maxHeadRows = context.depth + 1;\r\n\t\tZ._calcHeadSpan();\r\n\t\r\n\t\t//check fixedCols property\r\n\t\tvar preColCnt = 0, len,\r\n\t\t\tfixedColNum = Z._fixedCols - Z._sysColumns.length;\r\n\t\tcolCnt = 0;\r\n\t\tfor(i = 1, len = Z.innerHeads.length; i < len; i++){\r\n\t\t\tohead = Z.innerHeads[i];\r\n\t\t\tcolCnt += ohead.colSpan;\r\n\t\t\tif (fixedColNum <= preColCnt || fixedColNum == colCnt) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif (fixedColNum < colCnt && fixedColNum > preColCnt) {\r\n\t\t\t\tZ._fixedCols = preColCnt + Z._sysColumns.length;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tpreColCnt = colCnt;\r\n\t\t}\r\n\t},\r\n\t\r\n\t_calcHeadSpan: function(heads){\r\n\t\tvar Z = this;\r\n\t\tif (!heads) {\r\n\t\t\theads = Z.innerHeads;\r\n\t\t}\r\n\t\tvar ohead, childCnt = 0;\r\n\t\tfor(var i = 0, len = heads.length; i < len; i++ ){\r\n\t\t\tohead = heads[i];\r\n\t\t\tohead.rowSpan = Z.maxHeadRows - ohead.level;\r\n\t\t\tif (ohead.subHeads){\r\n\t\t\t\tohead.colSpan = Z._calcHeadSpan(ohead.subHeads);\r\n\t\t\t\tchildCnt += ohead.colSpan;\r\n\t\t\t} else {\r\n\t\t\t\tohead.colSpan = 1;\r\n\t\t\t\tchildCnt++;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn childCnt;\r\n\t},\r\n\t\r\n\t_convertField2Head: function(context, fldObj, parentHeadObj){\r\n\t\tvar Z = this;\r\n\t\tif (!fldObj.visible()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar level = 0, heads;\r\n\t\tif (!parentHeadObj){\r\n\t\t\theads = Z.innerHeads;\r\n\t\t} else {\r\n\t\t\tlevel = parentHeadObj.level + 1;\r\n\t\t\theads = parentHeadObj.subHeads;\r\n\t\t}\r\n\t\tvar ohead, fldName = fldObj.name();\r\n\t\tohead = new jslet.ui.TableHead();\r\n\t\tohead.label = fldObj.displayLabel();\r\n\t\tohead.field = fldName;\r\n\t\tohead.level = level;\r\n\t\tohead.colNum = context.lastColNum;\r\n\t\tohead.id = jslet.nextId();\r\n\t\theads.push(ohead);\r\n\t\tcontext.depth = Math.max(level, context.depth);\r\n\t\tvar fldChildren = fldObj.children();\r\n\t\tif (fldChildren && fldChildren.length > 0){\r\n\t\t\tohead.subHeads = [];\r\n\t\t\tvar added = false;\r\n\t\t\tfor(var i = 0, cnt = fldChildren.length; i< cnt; i++){\r\n\t\t\t\tZ._convertField2Head(context, fldChildren[i], ohead);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tcontext.lastColNum ++;\r\n\t\t\tvar cobj, found = false;\r\n\t\t\tvar len = Z._columns ? Z._columns.length: 0;\r\n\t\t\tfor(var k = 0; k < len; k++){\r\n\t\t\t\tcobj = Z._columns[k];\r\n\t\t\t\tif (cobj.field == fldName){\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!found){\r\n\t\t\t\tcobj = new jslet.ui.TableColumn();\r\n\t\t\t\tcobj.field = fldName;\r\n\t\t\t}\r\n\t\t\tif (!cobj.label){\r\n\t\t\t\tcobj.label = fldObj.displayLabel();\r\n\t\t\t}\r\n\t\t\tif(fldObj.getType() === jslet.data.DataType.BOOLEAN) {\r\n\t\t\t\tcobj.isBoolColumn = true;\r\n\t\t\t}\r\n\t\t\tcobj.mergeSame = fldObj.mergeSame();\r\n\t\t\tcobj.colNum = ohead.colNum;\r\n\t\t\tif (!cobj.width){\r\n\t\t\t\tvar maxWidth = fldObj ? fldObj.displayWidth() : 0;\r\n\t\t\t\tif (!Z._hideHead && cobj.label) {\r\n\t\t\t\t\tmaxWidth = Math.max(maxWidth, cobj.label.length);\r\n\t\t\t\t}\r\n\t\t\t\tcobj.width = maxWidth ? (maxWidth * Z.charWidth) : 10;\r\n\t\t\t}\r\n\t\t\t//check and set cell render\r\n\t\t\tif (!cobj.cellRender) {\r\n\t\t\t\tif (fldObj.getType() == jslet.data.DataType.BOOLEAN){//data type is boolean\r\n\t\t\t\t\tcobj.cellRender = jslet.ui.DBTable.boolCellRender;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (cobj.field == Z._treeField) {\r\n\t\t\t\t\t\tcobj.cellRender = jslet.ui.DBTable.treeCellRender;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tohead.widthCssName = Z._widthStyleId + '-' + ohead.colNum;\r\n\t\t\tcobj.widthCssName = ohead.widthCssName;\r\n\t\t\t\r\n\t\t\tZ.innerColumns.push(cobj);\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\t\r\n\t_calcParams: function () {\r\n\t\tvar Z = this;\r\n\t\tZ._currColNum = 0;\r\n\t\tZ._preTmpColNum = -1;\r\n\t\tZ._preTmpRecno = -1;\r\n\t\tZ._preRecno = -1;\r\n\t\tZ._preColNum = -1;\r\n\r\n\t\tif (Z._treeField) {//if tree table, then can't sort by clicking column header\r\n\t\t\tZ._disableHeadSort = true;\r\n\t\t}\r\n\t\t// calculate Sequence column width\r\n\t\tif (Z._hasSeqCol) {\r\n\t\t\tZ.seqColWidth = ('' + Z._dataset.recordCount()).length * Z.charWidth + 5;\r\n\t\t\tvar sWidth = jslet.ui.htmlclass.TABLECLASS.selectColWidth;\r\n\t\t\tZ.seqColWidth = Z.seqColWidth > sWidth ? Z.seqColWidth: sWidth;\r\n\t\t} else {\r\n\t\t\tZ.seqColWidth = 0;\r\n\t\t}\r\n\t\t// calculate Select column width\r\n\t\tif (Z._hasSelectCol) {\r\n\t\t\tZ.selectColWidth = jslet.ui.htmlclass.TABLECLASS.selectColWidth;\r\n\t\t} else {\r\n\t\t\tZ.selectColWidth = 0;\r\n\t\t}\r\n\t\t//calculate Fixed row section's height\r\n\t\tif (Z._fixedRows > 0) {\r\n\t\t\tZ.fixedSectionHt = Z._fixedRows * Z.rowHeight();\r\n\t\t} else {\r\n\t\t\tZ.fixedSectionHt = 0;\r\n\t\t}\r\n\t\t//Calculate Foot section's height\r\n\t\tif (Z.aggraded() && Z.dataset().checkAggraded()){\r\n\t\t\tZ.footSectionHt = Z.rowHeight();\r\n\t\t} else {\r\n\t\t\tZ.footSectionHt = 0;\r\n\t\t}\r\n\t\tZ._prepareColumn();\r\n\r\n\t\t// fixed Column count must be less than total columns\r\n\t\tif (Z._fixedCols) {\r\n\t\t\tif (Z._fixedCols > Z.innerColumns.length) {\r\n\t\t\t\tZ._fixedCols = Z.innerColumns.length;\r\n\t\t\t}\r\n\t\t}\r\n\t\tZ.hasFixedCol = Z._sysColumns.length > 0 || Z._fixedCols > 0;\r\n\t\tif (Z.hasFixedCol){\r\n\t\t\tvar w = 0, i, cnt;\r\n\t\t\tfor(i = 0, cnt = Z._sysColumns.length; i < cnt; i++){\r\n\t\t\t\tw += Z._sysColumns[i].width + 1;\r\n\t\t\t}\r\n\t\t\tfor(i = 0, cnt = Z._fixedCols; i < cnt; i++){\r\n\t\t\t\tw += Z.innerColumns[i].width + 1;\r\n\t\t\t}\r\n\t\t\tZ.fixedColWidth = w + 1;\r\n\t\t} else {\r\n\t\t\tZ.fixedColWidth = 0;\r\n\t\t}\r\n\t}, // end _calcParams\r\n\r\n\t_setScrollBarMaxValue: function (maxValue) {\r\n\t\tvar Z = this,\r\n\t\t\tv = maxValue + Z._repairHeight;\r\n\t\tZ.jqVScrollBar.find('div').height(v);\r\n\t\tif(Z.contentSectionHt + Z.footSectionHt >= v) {\r\n\t\t\tZ.jqVScrollBar.parent().addClass('jl-scrollbar-hidden');\t\r\n\t\t} else {\r\n\t\t\tZ.jqVScrollBar.parent().removeClass('jl-scrollbar-hidden');\t\r\n\t\t}\r\n\t},\r\n\r\n\t_changeColWidthCssRule: function(cssName, width){\r\n\t\tvar Z = this,\r\n\t\t\tstyleEle = document.getElementById(Z._widthStyleId),\r\n\t\t\tstyleObj = styleEle.styleSheet || styleEle.sheet,\r\n\t\t\tcssRules = styleObj.cssRules || styleObj.rules,\r\n\t\t\tcssRule = null, found = false;\r\n\t\t\tcssName = '.' + cssName;\r\n\t\tfor(var i = 0, len = cssRules.length; i < len; i++) {\r\n\t\t\tcssRule = cssRules[i];\r\n\t\t\tif(cssRule.selectorText == cssName) {\r\n\t\t\t\tfound = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(found) {\r\n\t\t\tcssRule.style.width = width + 'px';\r\n\t\t}\r\n\t\treturn found;\r\n\t},\r\n\r\n\t_changeColWidth: function (index, deltaW) {\r\n\t\tvar Z = this,\r\n\t\t\tcolObj = Z.innerColumns[index];\r\n\t\tif (colObj.width + deltaW <= 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tcolObj.width += deltaW;\r\n\t\tif(colObj.field) {\r\n\t\t\tZ._dataset.designMode(true);\r\n\t\t\ttry {\r\n\t\t\t\tZ._dataset.getField(colObj.field).displayWidth(Math.round(colObj.width/Z.charWidth));\r\n\t\t\t} finally {\r\n\t\t\t\tZ._dataset.designMode(false);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(Z._changeColWidthCssRule(colObj.widthCssName, colObj.width)) {\r\n\t\t\tZ._changeContentWidth(deltaW);\r\n\t\t}\r\n\t},\r\n\r\n\t_refreshSeqColWidth: function() {\r\n\t\tvar Z = this;\r\n\t\tif (!Z._hasSeqCol) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar oldSeqColWidth = Z.seqColWidth;\r\n\t\tZ.seqColWidth = ('' + Z._dataset.recordCount()).length * Z.charWidth;\r\n\t\tvar sWidth = jslet.ui.htmlclass.TABLECLASS.selectColWidth;\r\n\t\tZ.seqColWidth = Z.seqColWidth > sWidth ? Z.seqColWidth: sWidth;\r\n\t\tif(Z.seqColWidth == oldSeqColWidth) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar colObj;\r\n\t\tfor(var i = 0, len = Z._sysColumns.length; i < len; i++) {\r\n\t\t\tcolObj = Z._sysColumns[i];\r\n\t\t\tif(colObj.isSeqCol) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tcolObj.width = Z.seqColWidth;\r\n\t\tZ._changeColWidthCssRule(colObj.widthCssName, Z.seqColWidth);\r\n\t\tvar deltaW = Z.seqColWidth - oldSeqColWidth;\r\n\t\tZ._changeContentWidth(deltaW, true);\r\n\t},\r\n\r\n\t_changeContentWidth: function (deltaW, isLeft) {\r\n\t\tvar Z = this,\r\n\t\t\ttotalWidth = Z.getTotalWidth(isLeft),\r\n\t\t\ttotalWidthStr = totalWidth + 'px';\r\n\t\tif(!isLeft) {\r\n\t\t\tZ.rightHeadTbl.parentNode.style.width = totalWidthStr;\r\n\t\t\tZ.rightFixedTbl.parentNode.style.width = totalWidthStr;\r\n\t\t\tZ.rightContentTbl.parentNode.style.width = totalWidthStr;\r\n\t\t\tif (Z.footSectionHt) {\r\n\t\t\t\tZ.rightFootTbl.style.width = totalWidthStr;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tZ.fixedColWidth = totalWidth;\r\n\t\t\tZ.leftHeadTbl.parentNode.parentNode.style.width = Z.fixedColWidth + 1 + 'px';\r\n\t\t\tZ.leftHeadTbl.parentNode.style.width = totalWidthStr;\r\n\t\t\tZ.leftFixedTbl.parentNode.style.width = totalWidthStr;\r\n\t\t\tZ.leftContentTbl.parentNode.style.width = totalWidthStr;\r\n\t\t}\r\n\t\tZ._checkHoriOverflow();\r\n\t},\r\n\r\n\t_createFrame: function () {\r\n\t\tvar Z = this;\r\n\t\tZ.el.style.position = 'relative';\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tif (!jqEl.hasClass('jl-table')) {\r\n\t\t\tjqEl.addClass('jl-table jl-border-box jl-round5');\r\n\t\t}\r\n\t\tif(Z._noborder){\r\n\t\t\tjqEl.addClass('jl-tbl-noborder');\r\n\t\t}\r\n\t\t\r\n\t\tfunction generateWidthStyle() {\r\n\t\t\tvar colObj, cssName, i, len,\r\n\t\t\t\tstyleHtml = ['<style type=\"text/css\" id=\"' + Z._widthStyleId + '\">\\n'];\r\n\t\t\tfor(i = 0, len = Z._sysColumns.length; i < len; i++) {\r\n\t\t\t\tcolObj = Z._sysColumns[i];\r\n\t\t\t\tstyleHtml.push('.' + colObj.widthCssName +'{width:' + colObj.width + 'px}\\n');\r\n\t\t\t}\r\n\t\t\tfor(i = 0, len = Z.innerColumns.length; i< len; i++) {\r\n\t\t\t\tcolObj = Z.innerColumns[i];\r\n\t\t\t\tstyleHtml.push('.' + colObj.widthCssName +'{width:' + colObj.width + 'px}\\n');\r\n\t\t\t}\r\n\t\t\tstyleHtml.push('</style>');\r\n\t\t\treturn styleHtml.join('');\r\n\t\t}\r\n\t\t\r\n\t\tvar dbtableframe = [\r\n\t\t\t'<div class=\"jl-tbl-splitter\" style=\"display: none\"></div>',\r\n\t\t\tgenerateWidthStyle(),\r\n\t\t\t'<div class=\"jl-tbl-norecord\">',\r\n\t\t\tjslet.locale.DBTable.norecord,\r\n\t\t\t'</div>',\r\n\t\t\t'<table class=\"jl-tbl-container\"><tr>',\r\n\t\t\t'<td><div class=\"jl-tbl-fixedcol\"><table class=\"jl-tbl-data\"><tbody /></table><table class=\"jl-tbl-data\"><tbody /></table><div class=\"jl-tbl-content-div\"><table class=\"jl-tbl-data\"><tbody /></table></div><table><tbody /></table></div></td>',\r\n\t\t\t'<td><div class=\"jl-tbl-contentcol\"><div><table class=\"jl-tbl-data jl-tbl-content-table\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tbody /></table></div><div><table class=\"jl-tbl-data jl-tbl-content-table\"><tbody /></table></div><div class=\"jl-tbl-content-div\"><table class=\"jl-tbl-data jl-tbl-content-table\"><tbody /></table></div><table class=\"jl-tbl-content-table jl-tbl-footer\"><tbody /></table></div></td>',\r\n\t\t\t'<td class=\"jl-scrollbar-col\"><div class=\"jl-tbl-vscroll-head\"></div><div class=\"jl-tbl-vscroll\"><div /></div></td></tr></table>'];\r\n\t\t\r\n\t\tjqEl.html(dbtableframe.join(''));\r\n\r\n\t\tvar children = jqEl.find('.jl-tbl-fixedcol')[0].childNodes;\r\n\t\tZ.leftHeadTbl = children[0];\r\n\t\tZ.leftFixedTbl = children[1];\r\n\t\tZ.leftContentTbl = children[2].firstChild;\r\n\t\tZ.leftFootTbl = children[3];\r\n\t\t\r\n\t\tchildren = jqEl.find('.jl-tbl-contentcol')[0].childNodes;\r\n\t\tZ.rightHeadTbl = children[0].firstChild;\r\n\t\tZ.rightFixedTbl = children[1].firstChild;\r\n\t\tZ.rightContentTbl = children[2].firstChild;\r\n\t\tZ.rightFootTbl = children[3];\r\n\r\n\t\tZ.height = jqEl.height();\r\n\t\tif (Z._hideHead){\r\n\t\t\tZ.leftHeadTbl.style.display = 'none';\r\n\t\t\tZ.rightHeadTbl.style.display = 'none';\r\n\t\t\tjqEl.find('.jl-tbl-vscroll-head').css('display', 'none');\r\n\t\t}\r\n\t\tif (Z._fixedRows <= 0){\r\n\t\t\tZ.leftFixedTbl.style.display = 'none';\r\n\t\t\tZ.rightFixedTbl.style.display = 'none';\r\n\t\t}\r\n\t\tif (!Z.footSectionHt){\r\n\t\t\tZ.leftFootTbl.style.display = 'none';\r\n\t\t\tZ.rightFootTbl.style.display = 'none';\r\n\t\t}\r\n\t\tZ.leftHeadTbl.parentNode.parentNode.style.width = Z.fixedColWidth + 'px';\r\n\t\t\r\n\t\tvar jqRightHead = jQuery(Z.rightHeadTbl);\r\n\t\tjqRightHead.off();\r\n\t\tvar x = jqRightHead.on('mousedown', Z._doSplitHookDown);\r\n\t\tvar y = jqRightHead.on('mouseup', Z._doSplitHookUp);\r\n\t\t\r\n\t\tjQuery(Z.leftHeadTbl).on('mousedown', '.jl-tbl-header-cell', function(event){\r\n\t\t\tevent = jQuery.event.fix(event || window.event);\r\n\t\t\tvar el = event.target;\r\n\t\t\tif (el.className == 'jl-tbl-splitter-hook') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar colCfg = this.jsletColCfg;\r\n\t\t\tif(colCfg.field) {\r\n\t\t\t\tZ._processColumnSelection(colCfg, event.ctrlKey, event.shiftKey, event.altKey);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tjqRightHead.on('mousedown', '.jl-tbl-header-cell', function(event){\r\n\t\t\tevent = jQuery.event.fix(event || window.event);\r\n\t\t\tvar el = event.target;\r\n\t\t\tif (el.className == 'jl-tbl-splitter-hook') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar colCfg = this.jsletColCfg;\r\n\t\t\tif(colCfg.field) {\r\n\t\t\t\tZ._processColumnSelection(colCfg, event.ctrlKey, event.shiftKey, event.altKey);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tjQuery(Z.leftHeadTbl).on('mouseup', '.jl-focusable-item', function(event){\r\n\t\t\tevent = jQuery.event.fix(event || window.event);\r\n\t\t\tvar el = event.target;\r\n\t\t\tif (Z.isDraggingColumn) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tZ._doHeadClick(this.parentNode.parentNode.parentNode.jsletColCfg, event.ctrlKey);\r\n\t\t\tZ._head_label_cliecked = true;\r\n\t\t\tevent.stopImmediatePropagation();\r\n\t\t\tevent.preventDefault();\r\n\t\t\treturn false;\r\n\t\t});\r\n\t\t\r\n\t\tjqRightHead.on('mouseup', '.jl-focusable-item', function(event){\r\n\t\t\tevent = jQuery.event.fix(event || window.event);\r\n\t\t\tvar el = event.target;\r\n\t\t\tif (Z.isDraggingColumn) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tZ._doHeadClick(this.parentNode.parentNode.parentNode.jsletColCfg, event.ctrlKey);\r\n\t\t\tZ._head_label_cliecked = true;\r\n\t\t\tevent.stopImmediatePropagation();\r\n\t\t\tevent.preventDefault();\r\n\t\t\treturn false;\r\n\t\t});\r\n\t\t\r\n\t\tvar dragTransfer = null;\r\n\t\tjqRightHead.on('dragstart', '.jl-focusable-item', function(event){\r\n\t\t\tif(Z._filterPanel) {\r\n\t\t\t\tZ._filterPanel.hide();\r\n\t\t\t}\r\n\t\t\tvar otd = this.parentNode.parentNode.parentNode,\r\n\t\t\t\tcolCfg = otd.jsletColCfg,\r\n\t\t\t\te = event.originalEvent,\r\n\t\t\t\ttransfer = e.dataTransfer;\r\n\t\t\ttransfer.dropEffect = 'link';\r\n\t\t\ttransfer.effectAllowed = 'link';\r\n\t\t\tdragTransfer = {fieldName: colCfg.field, rowIndex: otd.parentNode.rowIndex, cellIndex: otd.cellIndex};\r\n\t\t\ttransfer.setData('fieldName', colCfg.field); //must has this row otherwise FF does not work.\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tfunction checkDropable(currCell) {\r\n\t\t\tvar colCfg = currCell.jsletColCfg,\r\n\t\t\t\tsrcRowIndex = dragTransfer.rowIndex,\r\n\t\t\t\tsrcCellIndex = dragTransfer.cellIndex,\r\n\t\t\t\tcurrRowIndex = currCell.parentNode.rowIndex,\r\n\t\t\t\tcurrCellIndex = currCell.cellIndex;\r\n\t\t\tvar result = (srcRowIndex == currRowIndex && currCellIndex != srcCellIndex);\r\n\t\t\tif(!result) {\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t\tvar\tsrcFldName = dragTransfer.fieldName,\r\n\t\t\t\tcurrFldName = colCfg.field,\r\n\t\t\t\tsrcPFldObj = Z._dataset.getField(srcFldName).parent(),\r\n\t\t\t\tcurrPFldObj = currFldName && Z._dataset.getField(currFldName).parent();\r\n\t\t\tresult = (srcPFldObj === currPFldObj || (currPFldObj && srcPFldObj.name() == currPFldObj.name()));\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\t\r\n\t\tjqRightHead.on('dragover', '.jl-tbl-header-cell .jl-tbl-header-div', function(event){\r\n\t\t\tif(!dragTransfer) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tvar otd = this.parentNode,\r\n\t\t\t\te = event.originalEvent,\r\n\t\t\t\ttransfer = e.dataTransfer;\r\n\t\t\tif(checkDropable(otd)) { \r\n\t\t\t\tjQuery(event.currentTarget).addClass('jl-tbl-col-over');\r\n\t\t\t\ttransfer.dropEffect = 'link';\r\n\t\t\t} else {\r\n\t\t\t\ttransfer.dropEffect = 'move';\r\n\t\t\t}\r\n\t\t    return false;\r\n\t\t});\r\n\r\n\t\tjqRightHead.on('dragenter', '.jl-tbl-header-cell .jl-tbl-header-div', function(event){\r\n\t\t\tif(!dragTransfer) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tvar otd = this.parentNode,\r\n\t\t\t\te = event.originalEvent,\r\n\t\t\t\ttransfer = e.dataTransfer;\r\n\t\t\tif(checkDropable(otd)) { \r\n\t\t\t\tjQuery(event.currentTarget).addClass('jl-tbl-col-over');\r\n\t\t\t\ttransfer.dropEffect = 'link';\r\n\t\t\t} else {\r\n\t\t\t\ttransfer.dropEffect = 'move';\r\n\t\t\t}\r\n\t\t    return false;\r\n\t\t});\r\n\t\t\r\n\t\tjqRightHead.on('dragleave', '.jl-tbl-header-cell .jl-tbl-header-div', function(event){\r\n\t\t\tif(!dragTransfer) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tjQuery(event.currentTarget).removeClass('jl-tbl-col-over');\r\n\t\t\treturn  false;\r\n\t\t});\r\n\t\t\r\n\t\tjqRightHead.on('drop', '.jl-tbl-header-cell .jl-tbl-header-div', function(event){\r\n\t\t\tif(!dragTransfer) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tjQuery(event.currentTarget).removeClass('jl-tbl-col-over');\r\n\t\t\tvar currCell = this.parentNode,\r\n\t\t\t\te = event.originalEvent,\r\n\t\t\t\ttransfer = e.dataTransfer,\r\n\t\t\t\tcolCfg = currCell.jsletColCfg,\r\n\t\t\t\tsrcRowIndex = dragTransfer.rowIndex,\r\n\t\t\t\tsrcCellIndex = dragTransfer.cellIndex,\r\n\t\t\t\tcurrRowIndex = currCell.parentNode.rowIndex,\r\n\t\t\t\tcurrCellIndex = currCell.cellIndex;\r\n\t\t\t\r\n\t\t\tif(!checkDropable(currCell)) { \r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar destField = this.parentNode.jsletColCfg.field;\r\n\t\t\tif(!destField) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar\tsrcField = dragTransfer.fieldName;\r\n\t\t\tZ._moveColumn(srcRowIndex, srcCellIndex, currCellIndex);\r\n\t    \treturn false;\r\n\t\t});\r\n\t\t\r\n\t\tvar jqLeftFixedTbl = jQuery(Z.leftFixedTbl),\r\n\t\t\tjqRightFixedTbl = jQuery(Z.rightFixedTbl),\r\n\t\t\tjqLeftContentTbl = jQuery(Z.leftContentTbl),\r\n\t\t\tjqRightContentTbl = jQuery(Z.rightContentTbl);\r\n\t\t\r\n\t\tjqLeftFixedTbl.off();\r\n\t\tjqLeftFixedTbl.on('mouseenter', 'tr', function() {\r\n\t\t\tjQuery(this).addClass(jslet.ui.htmlclass.TABLECLASS.hoverrow);\r\n\t\t\tjQuery(jqRightFixedTbl[0].rows[this.rowIndex]).addClass(jslet.ui.htmlclass.TABLECLASS.hoverrow);\r\n\t\t});\r\n\t\tjqLeftFixedTbl.on('mouseleave', 'tr', function() {\r\n\t\t\tjQuery(this).removeClass(jslet.ui.htmlclass.TABLECLASS.hoverrow);\r\n\t\t\tjQuery(jqRightFixedTbl[0].rows[this.rowIndex]).removeClass(jslet.ui.htmlclass.TABLECLASS.hoverrow);\r\n\t\t});\r\n\r\n\t\tjqRightFixedTbl.off();\r\n\t\tjqRightFixedTbl.on('mouseenter', 'tr', function() {\r\n\t\t\tjQuery(this).addClass(jslet.ui.htmlclass.TABLECLASS.hoverrow);\r\n\t\t\tjQuery(jqLeftFixedTbl[0].rows[this.rowIndex]).addClass(jslet.ui.htmlclass.TABLECLASS.hoverrow);\r\n\t\t});\r\n\t\tjqRightFixedTbl.on('mouseleave', 'tr', function() {\r\n\t\t\tjQuery(this).removeClass(jslet.ui.htmlclass.TABLECLASS.hoverrow);\r\n\t\t\tjQuery(jqLeftFixedTbl[0].rows[this.rowIndex]).removeClass(jslet.ui.htmlclass.TABLECLASS.hoverrow);\r\n\t\t});\r\n\t\t\r\n\t\tjqLeftContentTbl.off();\r\n\t\tjqLeftContentTbl.on('mouseenter', 'tr', function() {\r\n\t\t\tjQuery(this).addClass(jslet.ui.htmlclass.TABLECLASS.hoverrow);\r\n\t\t\tjQuery(jqRightContentTbl[0].rows[this.rowIndex]).addClass(jslet.ui.htmlclass.TABLECLASS.hoverrow);\r\n\t\t});\r\n\t\tjqLeftContentTbl.on('mouseleave', 'tr', function(){\r\n\t\t\tjQuery(this).removeClass(jslet.ui.htmlclass.TABLECLASS.hoverrow);\r\n\t\t\tjQuery(jqRightContentTbl[0].rows[this.rowIndex]).removeClass(jslet.ui.htmlclass.TABLECLASS.hoverrow);\r\n\t\t});\r\n\t\t\r\n\t\tjqRightContentTbl.off();\r\n\t\tjqRightContentTbl.on('mouseenter', 'tr', function(){\r\n\t\t\tjQuery(this).addClass(jslet.ui.htmlclass.TABLECLASS.hoverrow);\r\n\t\t\tvar hasLeft = (Z._fixedRows > 0 || Z._sysColumns.length > 0);\r\n\t\t\tif(hasLeft) {\r\n\t\t\t\tjQuery(jqLeftContentTbl[0].rows[this.rowIndex]).addClass(jslet.ui.htmlclass.TABLECLASS.hoverrow);\r\n\t\t\t}\r\n\t\t});\r\n\t\tjqRightContentTbl.on('mouseleave', 'tr', function(){\r\n\t\t\tjQuery(this).removeClass(jslet.ui.htmlclass.TABLECLASS.hoverrow);\r\n\t\t\tvar hasLeft = (Z._fixedRows > 0 || Z._sysColumns.length > 0);\r\n\t\t\tif(hasLeft) {\r\n\t\t\t\tjQuery(jqLeftContentTbl[0].rows[this.rowIndex]).removeClass(jslet.ui.htmlclass.TABLECLASS.hoverrow);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tZ.jqVScrollBar = jqEl.find('.jl-tbl-vscroll');\r\n\t\t//The scrollbar width must be set explicitly, otherwise it doesn't work in IE. \r\n\t\tZ.jqVScrollBar.width(jslet.scrollbarSize()+1);\r\n\t\t\r\n\t\tZ.jqVScrollBar.off().on('scroll', function () {\r\n\t\t\tif (Z._keep_silence_) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif(Z._editable && Z._dataset.status() != jslet.data.DataSetStatus.BROWSE) {\r\n\t\t\t\tZ._dataset.confirm();\r\n\t\t\t}\r\n\t\t\tvar num = Math.round(this.scrollTop / Z.rowHeight());// + Z._fixedRows;\r\n\t\t\tif (num != Z.listvm.getVisibleStartRow()) {\r\n\t\t\t\tZ._keep_silence_ = true;\r\n\t\t\t\ttry {\r\n\t\t\t\t\tZ.listvm.setVisibleStartRow(num);\r\n\t\t\t\t\tZ._showCurrentRow();\r\n\t\t\t\t\tvar cellEditor = Z.cellEditor();\r\n\t\t\t\t\tif(cellEditor) {\r\n\t\t\t\t\t\tcellEditor.hideEditor();\r\n\t\t\t\t\t}\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tZ._keep_silence_ = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\tjqEl.find('.jl-tbl-contentcol').off().on('scroll', function () {\r\n\t\t\tif(Z._isCurrCellInView()) {\r\n\t\t\t\t//Avoid focusing the current control\r\n\t\t\t\tjslet.temp.focusing = true;\r\n\t\t\t\ttry {\r\n\t\t\t\t\tZ._showCurrentCell();\r\n\t\t\t\t\t\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tjslet.temp.focusing = false;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t        \tvar cellEditor = Z.cellEditor();\r\n\t        \tif(cellEditor) {\r\n\t       \t\t\tcellEditor.hideEditor();\r\n\t        \t}\r\n\t\t\t}\r\n\t\t\tif(Z._filterPanel) {\r\n\t\t\t\tZ._filterPanel.hide();\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tvar splitter = jqEl.find('.jl-tbl-splitter')[0];\r\n\t\tsplitter._doDragStart = function(){\r\n\t\t\tthis.style.display = 'block';\r\n\t\t\tif(Z._filterPanel) {\r\n\t\t\t\tZ._filterPanel.hide();\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tsplitter._doDragging = function (oldX, oldY, x, y, deltaX, deltaY) {\r\n\t\t\tvar bodyMleft = parseInt(jQuery(document.body).css('margin-left'));\r\n\r\n\t\t\tvar ojslet = splitter.parentNode.jslet;\r\n\t\t\tvar colObj = ojslet.innerColumns[ojslet.currColId];\r\n\t\t\tif (colObj.width + deltaX <= 40) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tsplitter.style.left = x - jQuery(splitter.parentNode).offset().left - bodyMleft + 'px';\r\n\t\t};\r\n\r\n\t\tsplitter._doDragEnd = function (oldX, oldY, x, y, deltaX,\r\n\t\t\tdeltaY) {\r\n\t\t\tvar Z = splitter.parentNode.jslet;\r\n\t\t\tZ._changeColWidth(Z.currColId, deltaX);\r\n\t\t\tsplitter.style.display = 'none';\r\n\t\t\tsplitter.parentNode.jslet.isDraggingColumn = false;\r\n\t\t\tvar cellEditor = Z.cellEditor();\r\n\t\t\tif(cellEditor) {\r\n\t\t\t\tcellEditor.showEditor();\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tsplitter._doDragCancel = function () {\r\n\t\t\tsplitter.style.display = 'none';\r\n\t\t\tsplitter.parentNode.jslet.isDraggingColumn = false;\r\n\t\t};\r\n\r\n\t\tif (Z.footSectionHt){\r\n\t\t\tZ.leftFootTbl.style.display = '';\r\n\t\t\tZ.rightFootTbl.style.display = '';\r\n\t\t}\r\n\t\tZ._renderHeader();\r\n\t\tif (Z._hideHead) {\r\n\t\t\tZ.headSectionHt = 0;\r\n\t\t} else {\r\n\t\t\tZ.headSectionHt = Z.maxHeadRows * Z.headRowHeight();\r\n\t\t}\r\n\t\tZ._changeContentWidth(0);\r\n\r\n\t\tZ.noRecordDiv = jqEl.find('.jl-tbl-norecord')[0];\r\n\t\tZ.noRecordDiv.style.top = Z.headSectionHt + 'px';\r\n\t\tZ.noRecordDiv.style.left = jqEl.find('.jl-tbl-fixedcol').width() + 5 + 'px';\r\n\t\tjqEl.find('.jl-tbl-vscroll-head').height(Z.headSectionHt + Z.fixedSectionHt);\r\n\t\tZ._renderBody();\r\n\t},\r\n\r\n\t_moveColumn: function(rowIndex, srcCellIndex, destCellIndex) {\r\n\t\tvar Z = this;\r\n\t\t\r\n\t\tfunction moveOneRow(cells, srcStart, srcEnd, destStart, destEnd) {\r\n\t\t\tvar cobj, \r\n\t\t\t\tcolNo = 0, \r\n\t\t\t\tsrcCells = [],\r\n\t\t\t\tdestCells = [], i, len;\r\n\t\t\t\r\n\t\t\tfor(i = 0, len = cells.length; i < len; i++) {\r\n\t\t\t\tcobj = cells[i];\r\n\t\t\t\tif(colNo >= srcStart && colNo <= srcEnd) {\r\n\t\t\t\t\tsrcCells.push(cobj);\r\n\t\t\t\t} else if(colNo >= destStart && colNo <= destEnd) {\r\n\t\t\t\t\tdestCells.push(cobj);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif(colNo > srcEnd && colNo > destEnd) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tcolNo += cobj.colSpan || 1;\r\n\t\t\t}\r\n\t\t\tvar destCell;\r\n\t\t\tif(srcStart > destStart) {\t\r\n\t\t\t\tdestCell = destCells[0];\r\n\t\t\t\tfor(i = 0, len = srcCells.length; i < len; i++) {\r\n\t\t\t\t\tjQuery(srcCells[i]).insertBefore(destCell);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tdestCell = destCells[destCells.length - 1];\r\n\t\t\t\tfor(i = srcCells.length; i >= 0; i--) {\r\n\t\t\t\t\tjQuery(srcCells[i]).insertAfter(destCell);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tfunction moveOneTableColumn(rows, rowIndex, srcStart, srcEnd, destStart, destEnd) {\r\n\t\t\tvar rowCnt = rows.length;\r\n\t\t\tif(rowCnt === 0 || rowCnt === rowIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar colCfg = rows[rowIndex].cells[srcStart].jsletColCfg;\r\n\t\t\tvar rowObj, cellCnt;\r\n\t\t\tfor(var i = rowIndex, len = rows.length; i < len; i++) {\r\n\t\t\t\trowObj = rows[i];\r\n\t\t\t\tmoveOneRow(rowObj.cells, srcStart, srcEnd, destStart, destEnd);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tvar rows = Z.rightHeadTbl.createTHead().rows, cobj,\r\n\t\t\trowObj = rows[rowIndex],\r\n\t\t\tsrcStart = 0,\r\n\t\t\tsrcEnd = 0,\r\n\t\t\tdestStart = 0,\r\n\t\t\tdestEnd = 0, \r\n\t\t\tpreColNo = 0,\r\n\t\t\tcolNo = 0;\r\n\t\t\r\n\t\tfor(var i = 0, len = rowObj.cells.length; i < len; i++) {\r\n\t\t\tcobj = rowObj.cells[i];\r\n\t\t\tpreColNo = colNo; \r\n\t\t\tcolNo += (cobj.colSpan || 1);\r\n\t\t\tif(i === srcCellIndex) {\r\n\t\t\t\tsrcStart = preColNo;\r\n\t\t\t\tsrcEnd = colNo - 1;\r\n\t\t\t}\r\n\t\t\tif(i === destCellIndex) {\r\n\t\t\t\tdestStart = preColNo;\r\n\t\t\t\tdestEnd = colNo - 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar srcCell = rowObj.cells[srcCellIndex],\r\n\t\t\tdestCell = rowObj.cells[destCellIndex];\r\n\t\tvar srcColCfg = srcCell.jsletColCfg,\r\n\t\t\tdestColCfg = destCell.jsletColCfg,\r\n\t\t\tsrcFldName = srcColCfg.field,\r\n\t\t\tdestFldName = destColCfg.field;\r\n\t\tif(srcFldName && destFldName) {\r\n\t\t\tZ._dataset.designMode(true);\r\n\t\t\ttry {\r\n\t\t\t\tZ._dataset.moveField(srcFldName, destFldName);\r\n\t\t\t} finally {\r\n\t\t\t\tZ._dataset.designMode(false);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar currField = Z.getFieldByColNum(Z._currColNum);\r\n\t\tvar dataRows = Z.rightContentTbl.tBodies[0].rows;\r\n\t\tZ._changeColNum(dataRows[0], srcStart, srcEnd, destStart, destEnd);\r\n\t\tvar headRows = Z.rightHeadTbl.createTHead().rows;\r\n\t\tmoveOneTableColumn(headRows, rowIndex, srcStart, srcEnd, destStart, destEnd);\r\n\t\tmoveOneTableColumn(Z.rightFixedTbl.tBodies[0].rows, 0, srcStart, srcEnd, destStart, destEnd);\r\n\t\tmoveOneTableColumn(dataRows, 0, srcStart, srcEnd, destStart, destEnd);\r\n\t\tmoveOneTableColumn(Z.rightFootTbl.tBodies[0].rows, 0, srcStart, srcEnd, destStart, destEnd);\r\n\t\tZ._dataset.selection.removeAll();\r\n\t\tZ._refreshSelection();\r\n    \tZ.gotoField(currField);\r\n\t},\r\n\t\r\n\t_changeColNum: function(rowObj, srcStart, srcEnd, destStart, destEnd) {\r\n\t\tif(!rowObj) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar cobj, \r\n\t\t\tcolNo = 0, \r\n\t\t\tsrcCells = [],\r\n\t\t\tdestCells = [],\r\n\t\t\tcells = rowObj.cells, i, len;\r\n\t\t\r\n\t\tfor(i = 0, len = cells.length; i < len; i++) {\r\n\t\t\tcobj = cells[i];\r\n\t\t\tif(colNo >= srcStart && colNo <= srcEnd) {\r\n\t\t\t\tsrcCells.push(cobj);\r\n\t\t\t} else if(colNo >= destStart && colNo <= destEnd) {\r\n\t\t\t\tdestCells.push(cobj);\r\n\t\t\t} else {\r\n\t\t\t\tif(colNo > srcEnd && colNo > destEnd) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcolNo += cobj.colSpan || 1;\r\n\t\t}\r\n\t\tvar srcCellLen = srcCells.length,\r\n\t\t\tdestCellLen = destCells.length,\r\n\t\t\tfirstDestColNum= destCells[0].jsletColCfg.colNum,\r\n\t\t\tk = 0, colCfg;\r\n\t\tif(srcStart > destStart) {\r\n\t\t\tfor(i = srcStart; i <= srcEnd; i++) {\r\n\t\t\t\tcolCfg = cells[i].jsletColCfg;\r\n\t\t\t\tcolCfg.colNum = firstDestColNum + (k++);\r\n\t\t\t}\r\n\t\t\tfor(i = destStart; i < srcStart; i++) {\r\n\t\t\t\tcolCfg = cells[i].jsletColCfg;\r\n\t\t\t\tcolCfg.colNum = colCfg.colNum + srcCellLen;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar newStart = firstDestColNum - srcCellLen + destCellLen;\r\n\t\t\tfor(i = srcStart; i <= srcEnd; i++) {\r\n\t\t\t\tcolCfg = cells[i].jsletColCfg;\r\n\t\t\t\tcolCfg.colNum = newStart + (k++);\r\n\t\t\t}\r\n\t\t\tfor(i = srcEnd + 1; i <= destEnd; i++) {\r\n\t\t\t\tcolCfg = cells[i].jsletColCfg;\r\n\t\t\t\tcolCfg.colNum = colCfg.colNum - srcCellLen;\r\n\t\t\t}\r\n\t\t}\t\t\r\n\t},\r\n\t\r\n\t_calcAndSetContentHeight: function(){\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el);\r\n\r\n\t\tZ.contentSectionHt = Z.height - Z.headSectionHt - Z.fixedSectionHt - Z.footSectionHt;\r\n\t\tif (Z._isHoriOverflow){\r\n\t\t\tZ.contentSectionHt -= jslet.ui.htmlclass.TABLECLASS.scrollBarWidth;\r\n\t\t}\r\n\t\tvar rh = Z.rowHeight();\r\n\t\tZ.listvm.setVisibleCount(Math.floor((Z.contentSectionHt) / rh), true);\r\n\t\tZ._repairHeight = Z.contentSectionHt - Z.listvm.getVisibleCount() * rh;\r\n\t\t\r\n\t\tjqEl.find('.jl-tbl-contentcol').height(Z.height);\r\n\t\tjqEl.find('.jl-tbl-content-div').height(Z.contentSectionHt);\r\n\r\n\t\tZ.jqVScrollBar.height(Z.contentSectionHt + Z.footSectionHt);\r\n\t\tZ._setScrollBarMaxValue(Z.listvm.getNeedShowRowCount() * rh);\r\n\t},\r\n\t\r\n\t_checkHoriOverflow: function(){\r\n\t\tvar Z = this,\r\n\t\t\tcontentWidth = Z.getTotalWidth();\r\n\r\n\t\tif(Z._hideHead) {\r\n\t\t\tZ._isHoriOverflow = contentWidth > jQuery(Z.rightContentTbl.parentNode.parentNode).innerWidth();\r\n\t\t} else {\r\n\t\t\tZ._isHoriOverflow = contentWidth > Z.rightHeadTbl.parentNode.parentNode.clientWidth;\r\n\t\t}\r\n\t\tZ._calcAndSetContentHeight();\r\n\t},\r\n\t\r\n\t_refreshHeadCell: function(fldName) {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el), oth = null, cobj;\r\n\t\tjqEl.find('.jl-tbl-header-cell').each(function(index, value){\r\n\t\t\tcobj = this.jsletColCfg;\r\n\t\t\tif(cobj && cobj.field == fldName) {\r\n\t\t\t\toth = this;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif(!oth) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar fldObj = Z._dataset.getField(cobj.field);\r\n\t\tcobj.label = fldObj.displayLabel();\r\n\t\tvar ochild = oth.childNodes[0];\r\n\t\tvar cellRender = cobj.cellRender || Z._defaultCellRender;\r\n\t\tif (cellRender && cellRender.createHeader) {\r\n\t\t\tochild.html('');\r\n\t\t\tcellRender.createHeader.call(Z, ochild, cobj);\r\n\t\t} else {\r\n\t\t\tvar sh = cobj.label || '&nbsp;';\r\n\t\t\tif(cobj.field && Z._isCellEditable(cobj)) {\r\n\t\t\t\tif(fldObj && fldObj.required()) {\r\n\t\t\t\t\tsh = '<span class=\"jl-lbl-required\">*</span>' + sh;\r\n\t\t\t\t}\r\n\t\t\t} \r\n\t\t\tjQuery(oth).find('.jl-focusable-item').html(sh);\r\n\t\t}\r\n\t},\r\n\t\r\n\t_createHeadCell: function (otr, cobj) {\r\n\t\tvar Z = this,\r\n\t\t\trowSpan = 0, colSpan = 0;\r\n\t\t\r\n\t\tif (!cobj.subHeads) {\r\n\t\t\trowSpan = Z.maxHeadRows - (cobj.level ? cobj.level: 0);\r\n\t\t} else {\r\n\t\t\tcolSpan = cobj.colSpan;\r\n\t\t}\r\n\t\tvar oth = document.createElement('th');\r\n\t\toth.className = 'jl-tbl-header-cell jl-unselectable';\r\n\t\toth.noWrap = true;\r\n\t\toth.jsletColCfg = cobj;\r\n\t\tif (rowSpan && rowSpan > 1) {\r\n\t\t\toth.rowSpan = rowSpan;\r\n\t\t}\r\n\t\tif (colSpan && colSpan > 1) {\r\n\t\t\toth.colSpan = colSpan;\r\n\t\t}\r\n\t\toth.innerHTML = '<div style=\"position: relative\" unselectable=\"on\" class=\"jl-unselectable jl-tbl-header-div jl-border-box ' + \r\n\t\t\t(cobj.widthCssName || '') +'\">';\r\n\t\tvar ochild = oth.childNodes[0];\r\n\t\tvar cellRender = cobj.cellRender || Z._defaultCellRender;\r\n\t\tif (cellRender && cellRender.createHeader) {\r\n\t\t\tcellRender.createHeader.call(Z, ochild, cobj);\r\n\t\t} else {\r\n\t\t\tvar sh = cobj.label || '&nbsp;';\r\n\t\t\tif(cobj.field) {\r\n\t\t\t\tvar fldObj = Z._dataset.getField(cobj.field);\r\n\t\t\t\tif(fldObj && fldObj.required()) {\r\n\t\t\t\t\tsh = '<span class=\"jl-lbl-required\">*</span>' + sh;\r\n\t\t\t\t}\r\n\t\t\t} \r\n\t\t\tochild.innerHTML = [\r\n\t\t\t    Z._hasFilterDialog && cobj.field && !cobj.subHeads? '<button class=\"jl-tbl-filter\" jsletfilterfield=\"' + cobj.field + \r\n\t\t\t    \t\t'\"><i class=\"fa fa-filter\"></i></button>': '',\r\n\t\t\t    '<span id=\"',\r\n\t\t\t\tcobj.id, \r\n\t\t\t\t'\" unselectable=\"on\" style=\"width:100%;padding:0px 2px\">',\r\n\t\t\t\t((!Z._disableHeadSort && !cobj.disableHeadSort) ? '<span class=\"jl-focusable-item\" draggable=\"true\">' + sh +'</span>': sh),\r\n\t\t\t\t'</span><span unselectable=\"on\" class=\"jl-tbl-sorter\" title=\"',\r\n\t\t\t\tjslet.locale.DBTable.sorttitle,\r\n\t\t\t\t'\">&nbsp;</span><div  unselectable=\"on\" class=\"jl-tbl-splitter-hook\" colid=\"',\r\n\t\t\t\tcobj.colNum,\r\n\t\t\t\t'\">&nbsp;</div>'].join('');\r\n\t\t}\r\n\t\totr.appendChild(oth);\t\r\n\t}, // end _createHeadCell\r\n\r\n\t_renderHeader: function () {\r\n\t\tvar Z = this;\r\n\t\tif (Z._hideHead) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar otr, otrLeft = null, cobj, otrRight, otd, oth, i, cnt,\r\n\t\t\tleftHeadObj = Z.leftHeadTbl.createTHead(),\r\n\t\t\trightHeadObj = Z.rightHeadTbl.createTHead();\r\n\t\tfor(i = 0; i < Z.maxHeadRows; i++){\r\n\t\t\tleftHeadObj.insertRow(-1);\r\n\t\t\trightHeadObj.insertRow(-1);\r\n\t\t}\r\n\t\totr = leftHeadObj.rows[0];\r\n\t\tfor(i = 0, cnt = Z._sysColumns.length; i < cnt; i++){\r\n\t\t\tcobj = Z._sysColumns[i];\r\n\t\t\tcobj.rowSpan = Z.maxHeadRows;\r\n\t\t\tZ._createHeadCell(otr, cobj);\r\n\t\t}\r\n\t\tfunction travHead(arrHeadCfg){\r\n\t\t\tvar cobj, otr;\r\n\t\t\tfor(var m = 0, ccnt = arrHeadCfg.length; m < ccnt; m++){\r\n\t\t\t\tcobj = arrHeadCfg[m];\r\n\t\t\t\tif (cobj.colNum < Z._fixedCols) {\r\n\t\t\t\t\totr = leftHeadObj.rows[cobj.level];\r\n\t\t\t\t} else {\r\n\t\t\t\t\totr = rightHeadObj.rows[cobj.level];\r\n\t\t\t\t}\r\n\t\t\t\tZ._createHeadCell(otr, cobj);\r\n\t\t\t\tif (cobj.subHeads) {\r\n\t\t\t\t\ttravHead(cobj.subHeads);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\ttravHead(Z.innerHeads);\r\n\t\tvar jqTr1, jqTr2, h= Z.headRowHeight();\r\n\t\tfor(i = 0; i <= Z.maxHeadRows; i++){\r\n\t\t\tjqTr1 = jQuery(leftHeadObj.rows[i]);\r\n\t\t\tjqTr2 = jQuery(rightHeadObj.rows[i]);\r\n\t\t\tjqTr1.height(h);\r\n\t\t\tjqTr2.height(h);\r\n\t\t}\r\n\t\tZ.sortedCell = null;\r\n\t\tZ.indexField = null;\r\n\t}, // end renderHead\r\n\r\n\tgetTotalWidth: function(isLeft){\r\n\t\tvar Z= this,\r\n\t\t\ttotalWidth = 0, i, cnt;\r\n\t\tif(!isLeft) {\r\n\t\t\tfor(i = Z._fixedCols, cnt = Z.innerColumns.length; i < cnt; i++){\r\n\t\t\t\ttotalWidth += Z.innerColumns[i].width;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tfor(i = 0, cnt = Z._sysColumns.length; i < cnt; i++){\r\n\t\t\t\ttotalWidth += Z._sysColumns[i].width;\r\n\t\t\t}\r\n\t\t\tfor(i = 0, cnt = Z._fixedCols; i < cnt; i++){\r\n\t\t\t\ttotalWidth += Z.innerColumns[i].width;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn totalWidth;\r\n\t},\r\n\t\r\n\t_doSplitHookDown: function (event) {\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\tvar ohook = event.target;\r\n\t\tif (ohook.className != 'jl-tbl-splitter-hook') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar tblContainer = jslet.ui.findFirstParent(ohook, function (el) {\r\n\t\t\treturn el.tagName.toLowerCase() == 'div' && el.jslet && el.jslet._dataset;\r\n\t\t});\r\n\t\tvar jqTblContainer = jQuery(tblContainer),\r\n\t\t\tjqBody = jQuery(document.body), \r\n\t\t\tbodyMTop = parseInt(jqBody.css('margin-top')),\r\n\t\t\tbodyMleft = parseInt(jqBody.css('margin-left')),\r\n\t\t\ty = jqTblContainer.position().top - bodyMTop,\r\n\t\t\tjqHook = jQuery(ohook),\r\n\t\t\th = jqTblContainer.height() - 20,\r\n\t\t\tcurrLeft = jqHook.offset().left - jqTblContainer.offset().left - bodyMleft,\r\n\t\t\tsplitDiv = jqTblContainer.find('.jl-tbl-splitter')[0];\r\n\t\tsplitDiv.style.left = currLeft + 'px';\r\n\t\tsplitDiv.style.top = '1px';\r\n\t\tsplitDiv.style.height = h + 'px';\r\n\t\tjslet.ui.dnd.bindControl(splitDiv);\r\n\t\ttblContainer.jslet.currColId = parseInt(jqHook.attr('colid'));\r\n\t\ttblContainer.jslet.isDraggingColumn = true;\r\n\t},\r\n\r\n\t_doSplitHookUp: function (event) {\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\tvar ohook = event.target.lastChild;\r\n\t\tif (!ohook || ohook.className != 'jl-tbl-splitter-hook') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar tblContainer = jslet.ui.findFirstParent(ohook, function (el) {\r\n\t\t\treturn el.tagName.toLowerCase() == 'div' && el.jslet && el.jslet._dataset;\r\n\t\t});\r\n\r\n\t\tvar jqTblContainer = jQuery(tblContainer),\r\n\t\t\tjqBody = jQuery(document.body); \r\n\t\tjqBody.css('cursor','auto');\r\n\r\n\t\tvar splitDiv = jqTblContainer.find('.jl-tbl-splitter')[0];\r\n\t\tif (splitDiv.style.display != 'none') {\r\n\t\t\tsplitDiv.style.display = 'none';\r\n\t\t}\r\n\t\ttblContainer.jslet.isDraggingColumn = false;\r\n\t},\r\n\r\n\t_getColumnByField: function (fieldName) {\r\n\t\tvar Z = this;\r\n\t\tif (!Z.innerColumns) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar cobj;\r\n\t\tfor (var i = 0, cnt = Z.innerColumns.length; i < cnt; i++) {\r\n\t\t\tcobj = Z.innerColumns[i];\r\n\t\t\tif (cobj.field == fieldName) {\r\n\t\t\t\treturn cobj;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\r\n\t_doHeadClick: function (colCfg, ctrlKeyPressed) {\r\n\t\tvar Z = this;\r\n\t\tif (Z._disableHeadSort || colCfg.disableHeadSort || Z.isDraggingColumn) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tZ._doSort(colCfg.field, ctrlKeyPressed);\r\n\t}, // end _doHeadClick\r\n\r\n\t_doSort: function (sortField, isMultiSort) {\r\n\t\tvar Z = this;\r\n\t\tZ._dataset.confirm();\r\n\t\tZ._dataset.disableControls();\r\n\t\ttry {\r\n\t\t\tif (!Z._onCustomSort) {\r\n\t\t\t\tZ._dataset.toggleIndexField(sortField, !isMultiSort);\r\n\t\t\t} else {\r\n\t\t\t\tZ._onCustomSort.call(Z, sortField);\r\n\t\t\t}\r\n\t\t\tZ.listvm.refreshModel();\r\n\t\t} finally {\r\n\t\t\tZ._dataset.enableControls();\r\n\t\t}\r\n\t},\r\n\r\n\t_updateSortFlag: function () {\r\n\t\tvar Z = this;\r\n\t\tif (Z._hideHead) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar sortFields = Z._dataset.mergedIndexFields();\r\n\t\t\r\n\t\tvar leftHeadObj = Z.leftHeadTbl.createTHead(),\r\n\t\t\trightHeadObj = Z.rightHeadTbl.createTHead(),\r\n\t\t\tleftHeadCells, rightHeadCells,\r\n\t\t\tallHeadCells = [], oth, i, cnt, r,\r\n\t\t\trowCnt = leftHeadObj.rows.length;\r\n\t\tfor(r = 0; r < rowCnt; r++) {\r\n\t\t\tleftHeadCells = leftHeadObj.rows[r].cells;\r\n\t\t\tfor (i = 0, cnt = leftHeadCells.length; i < cnt; i++){\r\n\t\t\t\toth = leftHeadCells[i];\r\n\t\t\t\tif (oth.jsletColCfg) {\r\n\t\t\t\t\tallHeadCells[allHeadCells.length] = oth;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(r = 0; r < rowCnt; r++) {\r\n\t\t\trightHeadCells =  rightHeadObj.rows[r].cells;\r\n\t\t\tfor (i = 0, cnt = rightHeadCells.length; i < cnt; i++){\r\n\t\t\t\toth = rightHeadCells[i];\r\n\t\t\t\tif (oth.jsletColCfg) {\r\n\t\t\t\t\tallHeadCells[allHeadCells.length] = oth;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar len = sortFields.length, sortDiv, \r\n\t\t\tcellCnt = allHeadCells.length;\r\n\t\tfor (i = 0; i < cellCnt; i++) {\r\n\t\t\toth = allHeadCells[i];\r\n\t\t\tsortDiv = jQuery(oth).find('.jl-tbl-sorter')[0];\r\n\t\t\tif (sortDiv) {\r\n\t\t\t\tsortDiv.innerHTML = '&nbsp;';\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar fldName, sortFlag, sortObj, \r\n\t\t\tk = 1;\r\n\t\tfor (i = 0; i < len; i++) {\r\n\t\t\tsortObj = sortFields[i];\r\n\t\t\tfor (var j = 0; j < cellCnt; j++) {\r\n\t\t\t\toth = allHeadCells[j];\r\n\t\t\t\tfldName = oth.jsletColCfg.field;\r\n\t\t\t\tif (!fldName) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tsortDiv = jQuery(oth).find('.jl-tbl-sorter')[0];\r\n\t\t\t\tsortFlag = '&nbsp;';\r\n\t\t\t\tif (fldName == sortObj.fieldName) {\r\n\t\t\t\t\tsortFlag = sortObj.order === 1 ? '<i class=\"fa fa-arrow-up\"></i>' : '<i class=\"fa fa-arrow-down\"></i>';\r\n\t\t\t\t\tif (len > 1) {\r\n\t\t\t\t\t\tsortFlag += k++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tsortDiv.innerHTML = sortFlag;\r\n\t\t\tif (!oth) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t_doSelectBoxClick: function (event) {\r\n\t\tvar ocheck = null;\r\n\t\tif (event){\r\n\t\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\t\tocheck = event.target;\r\n\t\t} else {\r\n\t\t\tocheck = this;\r\n\t\t}\r\n\t\tvar otr = jslet.ui.getParentElement(ocheck, 2);\r\n\t\ttry {\r\n\t\t\tjQuery(otr).click();// tr click\r\n\t\t} finally {\r\n\t\t\tvar otable = jslet.ui.findFirstParent(otr, function (node) {\r\n\t\t\t\treturn node.jslet? true: false;\r\n\t\t\t});\r\n\t\t\tvar oJslet = otable.jslet;\r\n\r\n\t\t\tif (oJslet._onSelect) {\r\n\t\t\t\tvar flag = oJslet._onSelect.call(oJslet, ocheck.checked);\r\n\t\t\t\tif (flag !== undefined && !flag) {\r\n\t\t\t\t\tocheck.checked = !ocheck.checked;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(oJslet._beforeSelect) {\r\n\t\t\t\toJslet._beforeSelect.call(oJslet);\r\n\t\t\t}\r\n\t\t\toJslet._dataset.select(ocheck.checked ? 1 : 0, oJslet._selectBy);\r\n\t\t\tif(oJslet._afterSelect) {\r\n\t\t\t\toJslet._afterSelect.call(oJslet);\r\n\t\t\t}\r\n\t\t}\r\n\t}, // end _doSelectBoxClick\r\n\r\n\t_doCellClick: function (colCfg) {\r\n\t\tvar Z = this;\r\n\t\tif (Z._onCellClick) {\r\n\t\t\tZ._onCellClick.call(Z, colCfg);\r\n\t\t}\r\n\t},\r\n\t\r\n\t_doRowDblClick: function (event) {\r\n\t\tvar otable = jslet.ui.findFirstParent(this, function (node) {\r\n\t\t\treturn node.jslet? true: false;\r\n\t\t});\r\n\r\n\t\tvar Z = otable.jslet;\r\n\t\tif (Z._onRowDblClick) {\r\n\t\t\tZ._onRowDblClick.call(Z, event);\r\n\t\t}\r\n\t},\r\n\r\n\t_doRowClick: function (event) {\r\n\t\tvar otable = jslet.ui.findFirstParent(this, function (node) {\r\n\t\t\treturn node.jslet ? true: false;\r\n\t\t});\r\n\r\n\t\tvar Z = otable.jslet;\r\n\t\tvar dataset = Z.dataset();\r\n\t\tif(this.jsletrecno !== dataset.recno()) {\r\n\t\t\tif(dataset.status()) {\r\n\t\t\t\tdataset.confirm();\r\n\t\t\t}\r\n\t\r\n\t\t\tvar rowno = Z.listvm.recnoToRowno(this.jsletrecno);\r\n\t\t\tZ.listvm.setCurrentRowno(rowno);\r\n\t\t\tZ._dataset.recno(Z.listvm.getCurrentRecno());\r\n\t\t}\r\n\t\tif (Z._onRowClick) {\r\n\t\t\tZ._onRowClick.call(Z, event);\r\n\t\t}\r\n\t},\r\n\r\n\t_renderCell: function (otr, colCfg, isFirstCol) {\r\n\t\tvar Z = this;\r\n\t\tvar otd = document.createElement('td');\r\n\t\totd.noWrap = true;\r\n\t\totd.jsletColCfg = colCfg;\r\n\t\tjQuery(otd).addClass('jl-tbl-cell');\r\n\t\totd.innerHTML = '<div class=\"jl-tbl-cell-div ' + (colCfg.widthCssName || '') + '\"></div>';\r\n\t\tvar ochild = otd.firstChild;\r\n\t\tvar cellRender = colCfg.cellRender || Z._defaultCellRender;\r\n\t\tif (cellRender && cellRender.createCell) {\r\n\t\t\tcellRender.createCell.call(Z, ochild, colCfg);\r\n\t\t} else if (!Z._isCellEditable(colCfg)) {\r\n\t\t\t\tjslet.ui.DBTable.defaultCellRender.createCell.call(Z, ochild, colCfg);\r\n\t\t\t\tcolCfg.editable = false;\r\n\t\t} else {\r\n\t\t\tjslet.ui.DBTable.defaultCellRender.createCell.call(Z, ochild, colCfg);\r\n\t\t\tcolCfg.editable = true;\r\n\t\t}\r\n\t\totr.appendChild(otd);\r\n\t},\r\n\r\n\t_renderRow: function (sectionNum, onlyRefreshContent) {\r\n\t\tvar Z = this;\r\n\t\tvar rowCnt = 0, leftBody = null, rightBody,\r\n\t\t\thasLeft = Z._fixedCols > 0 || Z._sysColumns.length > 0;\r\n\t\tswitch (sectionNum) {\r\n\t\t\tcase 1:\r\n\t\t\t\t{//fixed data\r\n\t\t\t\t\trowCnt = Z._fixedRows;\r\n\t\t\t\t\tif (hasLeft) {\r\n\t\t\t\t\t\tleftBody = Z.leftFixedTbl.tBodies[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\trightBody = Z.rightFixedTbl.tBodies[0];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\tcase 2:\r\n\t\t\t\t{//data content\r\n\t\t\t\t\trowCnt = Z.listvm.getVisibleCount();\r\n\t\t\t\t\tif (hasLeft) {\r\n\t\t\t\t\t\tleftBody = Z.leftContentTbl.tBodies[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\trightBody = Z.rightContentTbl.tBodies[0];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t}\r\n\t\tvar otr, oth, colCfg, isfirstCol, \r\n\t\t\tstartRow = 0, j,\r\n\t\t\tfldCnt = Z.innerColumns.length;\r\n\t\tif (onlyRefreshContent){\r\n\t\t\tstartRow = rightBody.rows.length;\r\n\t\t}\r\n\t\tvar rh = Z.rowHeight();\r\n\t\t// create date content table row\r\n\t\tfor (var i = startRow; i < rowCnt; i++) {\r\n\t\t\tif (hasLeft) {\r\n\t\t\t\totr = leftBody.insertRow(-1);\r\n\t\t\t\totr.style.height = rh + 'px';\r\n\r\n\t\t\t\totr.ondblclick = Z._doRowDblClick;\r\n\t\t\t\totr.onclick = Z._doRowClick;\r\n\t\t\t\tvar sysColLen = Z._sysColumns.length;\r\n\t\t\t\tfor(j = 0; j < sysColLen; j++){\r\n\t\t\t\t\tcolCfg = Z._sysColumns[j];\r\n\t\t\t\t\tZ._renderCell(otr, colCfg, j === 0);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tisfirstCol = sysColLen === 0;\r\n\t\t\t\tfor(j = 0; j < Z._fixedCols; j++) {\r\n\t\t\t\t\tcolCfg = Z.innerColumns[j];\r\n\t\t\t\t\tZ._renderCell(otr, colCfg, isfirstCol && j === 0);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tisfirstCol = !hasLeft;\r\n\t\t\totr = rightBody.insertRow(-1);\r\n\t\t\totr.style.height = rh + 'px';\r\n\t\t\totr.ondblclick = Z._doRowDblClick;\r\n\t\t\totr.onclick = Z._doRowClick;\r\n\t\t\tfor (j = Z._fixedCols; j < fldCnt; j++) {\r\n\t\t\t\tcolCfg = Z.innerColumns[j];\r\n\t\t\t\tZ._renderCell(otr, colCfg, j == Z._fixedCols);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t_renderBody: function (onlyRefreshContent) {\r\n\t\tvar Z = this;\r\n\t\tif (onlyRefreshContent){\r\n\t\t\tZ._renderRow(2, true);\r\n\t\t} else {\r\n\t\t\tZ._renderRow(1);\r\n\t\t\tZ._renderRow(2);\r\n\t\t\tZ._renderTotalSection();\r\n\t\t}\r\n\t}, // end _renderBody\r\n\r\n\t_renderTotalSection: function() {\r\n\t\tvar Z = this;\r\n\t\tif (!Z.footSectionHt) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar hasLeft = Z._fixedCols > 0 || Z._sysColumns.length > 0,\r\n\t\t\tleftBody,\r\n\t\t\trightBody,\r\n\t\t\totr, colCfg, j, len;\r\n\t\tif (hasLeft) {\r\n\t\t\tleftBody = Z.leftFootTbl.tBodies[0];\r\n\t\t}\r\n\t\trightBody = Z.rightFootTbl.tBodies[0];\r\n\t\t\r\n\t\tfunction createCell(colCfg) {\r\n\t\t\tvar otd = document.createElement('td');\r\n\t\t\totd.noWrap = true;\r\n\t\t\totd.innerHTML = '<div class=\"jl-tbl-footer-div ' + (colCfg.widthCssName || '') + '\"></div>';\r\n\t\t\totd.jsletColCfg = colCfg;\r\n\t\t\treturn otd;\r\n\t\t}\r\n\t\t\r\n\t\tif (hasLeft) {\r\n\t\t\totr = leftBody.insertRow(-1);\r\n\t\t\totr.style.height = Z.rowHeight() + 'px';\r\n\r\n\t\t\tfor(j = 0, len = Z._sysColumns.length; j < len; j++) {\r\n\t\t\t\tcolCfg = Z._sysColumns[j];\r\n\t\t\t\totr.appendChild(createCell(colCfg));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor(j = 0; j < Z._fixedCols; j++) {\r\n\t\t\t\tcolCfg = Z.innerColumns[j];\r\n\t\t\t\totr.appendChild(createCell(colCfg));\r\n\t\t\t}\r\n\t\t}\r\n\t\totr = rightBody.insertRow(-1);\r\n\t\totr.style.height = Z.rowHeight() + 'px';\r\n\t\tfor (j = Z._fixedCols, len = Z.innerColumns.length; j < len; j++) {\r\n\t\t\tcolCfg = Z.innerColumns[j];\r\n\t\t\totr.appendChild(createCell(colCfg));\r\n\t\t}\r\n\t\t\r\n\t},\r\n\t\r\n\t_fillTotalSection: function () {\r\n\t\tvar Z = this,\r\n\t\t\taggradeValues = Z._dataset.aggradedValues();\r\n\t\tif (!Z.footSectionHt || !aggradeValues) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar sysColCnt = Z._sysColumns.length,\r\n\t\t\thasLeft = Z._fixedCols > 0 || sysColCnt > 0,\r\n\t\t\totrLeft, otrRight;\r\n\t\tif (hasLeft) {\r\n\t\t\totrLeft = Z.leftFootTbl.tBodies[0].rows[0];\r\n\t\t}\r\n\t\totrRight = Z.rightFootTbl.tBodies[0].rows[0];\r\n\r\n\t\tvar otd, k = 0, fldObj, cobj, fldName, totalValue;\r\n\t\tvar aggradeValueObj,\r\n\t\t\tlabelDisplayed = false,\r\n\t\t\tcanShowLabel = true;\r\n\t\tif(sysColCnt > 0) {\r\n\t\t\totd = otrLeft.cells[sysColCnt - 1];\r\n\t\t\totd.innerHTML = jslet.locale.DBTable.totalLabel;\r\n\t\t\tcanShowLabel = false;\r\n\t\t}\r\n\t\tvar colNum;\r\n\t\tfor (var i = 0, len = Z.innerColumns.length; i < len; i++) {\r\n\t\t\tcobj = Z.innerColumns[i];\r\n\t\t\tcolNum = cobj.colNum;\r\n\t\t\tif (colNum < Z._fixedCols) {\r\n\t\t\t\totd = otrLeft.cells[colNum + sysColCnt];\r\n\t\t\t} else {\r\n\t\t\t\totd = otrRight.cells[colNum - Z._fixedCols];\r\n\t\t\t}\r\n\t\t\totd.style.textAlign = 'right';\r\n\r\n\t\t\tfldName = cobj.field;\r\n\t\t\taggradeValueObj = aggradeValues[fldName];\r\n\t\t\tif (!aggradeValueObj) {\r\n\t\t\t\tif(canShowLabel) {\r\n\t\t\t\t\tvar content;\r\n\t\t\t\t\tif(labelDisplayed) {\r\n\t\t\t\t\t\tcontent = '&nbsp;';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcontent = jslet.locale.DBTable.totalLabel;\r\n\t\t\t\t\t\tlabelDisplayed = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\totd.firstChild.innerHTML = content;\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tcanShowLabel = false;\r\n\t\t\tfldObj = Z._dataset.getField(fldName);\r\n\t\t\tif(fldObj.getType() === jslet.data.DataType.NUMBER) {\r\n\t\t\t\ttotalValue = aggradeValueObj.sum;\r\n\t\t\t} else {\r\n\t\t\t\ttotalValue = aggradeValueObj.count;\r\n\t\t\t}\r\n\t\t\tvar dispFmt = fldObj.displayFormat();\r\n\t\t\tvar displayValue = totalValue;\r\n\t\t\tif(dispFmt && fldObj.getType() === jslet.data.DataType.NUMBER) {\r\n\t\t\t\tdisplayValue = totalValue? jslet.formatNumber(totalValue, dispFmt) : '';\r\n\t\t\t}\r\n\t\t\totd.firstChild.innerHTML = displayValue;\r\n\t\t\totd.firstChild.title = displayValue;\r\n\t\t}\r\n\t},\r\n\t\r\n\t_fillData: function () {\r\n\t\tvar Z = this;\r\n\t\tvar preRecno = Z._dataset.recno(),\r\n\t\t\tallCnt = Z.listvm.getNeedShowRowCount(),\r\n\t\t\th = allCnt * Z.rowHeight() + Z.footSectionHt;\r\n\t\tZ._setScrollBarMaxValue(h);\r\n\t\tvar noRecord = Z.dataset().recordCount() === 0;\r\n\t\tZ.noRecordDiv.style.display = (noRecord ?'block':'none');\r\n\t\tvar oldRecno = Z._dataset.recnoSilence();\r\n\t\ttry {\r\n\t\t\tZ._fillRow(true);\r\n\t\t\tZ._fillRow(false);\r\n\t\t\tif (Z.footSectionHt) {\r\n\t\t\t\tZ._fillTotalSection();\r\n\t\t\t}\r\n\t\t} finally {\r\n\t\t\tZ._dataset.recnoSilence(oldRecno);\r\n\t\t}\r\n\t\tZ._refreshSeqColWidth();\r\n\t\tif(Z._cellEditor && noRecord) {\r\n\t\t\tZ._cellEditor.hideEditor();\r\n\t\t}\r\n\t},\r\n\r\n\t_fillRow: function (isFixed) {\r\n\t\tvar Z = this,\r\n\t\t\trowCnt = 0, start = 0, leftBody = null, rightBody,\r\n\t\t\thasLeft = Z._fixedCols > 0 || Z._sysColumns.length > 0;\r\n\t\t\t\r\n\t\tif (isFixed) {\r\n\t\t\trowCnt = Z._fixedRows;\r\n\t\t\tstart = -1 * Z._fixedRows;\r\n\t\t\tif (rowCnt === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (hasLeft) {\r\n\t\t\t\tleftBody = Z.leftFixedTbl.tBodies[0];\r\n\t\t\t}\r\n\t\t\trightBody = Z.rightFixedTbl.tBodies[0];\r\n\t\t} else {\r\n\t\t\trowCnt = Z.listvm.getVisibleCount();\r\n\t\t\tstart = Z.listvm.getVisibleStartRow();\r\n\t\t\tif (hasLeft) {\r\n\t\t\t\tleftBody = Z.leftContentTbl.tBodies[0];\r\n\t\t\t}\r\n\t\t\trightBody = Z.rightContentTbl.tBodies[0];\r\n\t\t}\r\n\t\t\r\n\t\tvar otr, colCfg, isfirstCol, recNo = -1, cells, clen, otd, j, \r\n\t\t\tfldCnt = Z.innerColumns.length,\r\n\t\t\tallCnt = Z.listvm.getNeedShowRowCount() - Z.listvm.getVisibleStartRow(),\r\n\t\t\tfixedRows = hasLeft ? leftBody.rows : null,\r\n\t\t\tcontentRows = rightBody.rows,\r\n\t\t\tsameValueNodes = {},\r\n\t\t\tisFirst = true,\r\n\t\t\tactualCnt = Math.min(contentRows.length, rowCnt);\r\n\r\n\t\tfor (var i = 0; i < actualCnt ; i++) {\r\n\t\t\tif (i + (isFixed? start: 0) >= allCnt) {\r\n\t\t\t\tif (hasLeft) {\r\n\t\t\t\t\totr = fixedRows[i];\r\n\t\t\t\t\totr.style.display = 'none';\r\n\t\t\t\t}\r\n\t\t\t\totr = contentRows[i];\r\n\t\t\t\totr.style.display = 'none';\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tZ.listvm.setCurrentRowno(i + start, true);\r\n\t\t\trecNo = Z.listvm.getCurrentRecno();\r\n\t\t\tZ._dataset.recnoSilence(recNo);\r\n\t\t\tif (hasLeft) {\r\n\t\t\t\totr = fixedRows[i];\r\n\t\t\t\totr.jsletrecno = recNo;\r\n\t\t\t\totr.style.display = '';\r\n\t\t\t\tif (Z._onFillRow) {\r\n\t\t\t\t\tZ._onFillRow.call(Z, otr, Z._dataset);\r\n\t\t\t\t}\r\n\t\t\t\tcells = otr.childNodes;\r\n\t\t\t\tclen = cells.length;\r\n\t\t\t\tfor (j = 0; j < clen; j++) {\r\n\t\t\t\t\totd = cells[j];\r\n\t\t\t\t\tZ._fillCell(recNo, otd, sameValueNodes, isFirst);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\totr = contentRows[i];\r\n\t\t\totr.jsletrecno = recNo;\r\n\t\t\totr.style.display = '';\r\n\t\t\tif (Z._onFillRow) {\r\n\t\t\t\tZ._onFillRow.call(Z, otr, Z._dataset);\r\n\t\t\t}\r\n\t\t\t// fill content table\r\n\t\t\totr = contentRows[i];\r\n\t\t\tcells = otr.childNodes;\r\n\t\t\tclen = cells.length;\r\n\t\t\tfor (j = 0; j < clen; j++) {\r\n\t\t\t\totd = cells[j];\r\n\t\t\t\tZ._fillCell(recNo, otd, sameValueNodes, isFirst);\r\n\t\t\t} //end for data content field\r\n\t\t\tisFirst = 0;\r\n\t\t} //end for records\r\n\t},\r\n\r\n\t_fillCell: function (recNo, otd, sameValueNodes, isFirst) {\r\n\t\tvar Z = this,\r\n\t\tcolCfg = otd.jsletColCfg;\r\n\t\tif (!colCfg)\r\n\t\t\treturn;\r\n\t\tvar fldName = colCfg.field,\r\n\t\t\tcellPanel = otd.firstChild;\r\n\t\t\r\n\t\tif (Z._onFillCell) {\r\n\t\t\tZ._onFillCell.call(Z, cellPanel, Z._dataset, fldName);\r\n\t\t}\r\n\t\tif (fldName && colCfg.mergeSame && sameValueNodes) {\r\n\t\t\tif (isFirst || !Z._dataset.isSameAsPrevious(fldName)) {\r\n\t\t\t\tsameValueNodes[fldName] = { cell: otd, count: 1 };\r\n\t\t\t\tjQuery(otd).attr('rowspan', 1);\r\n\t\t\t\totd.style.display = '';\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tvar sameNode = sameValueNodes[fldName];\r\n\t\t\t\tsameNode.count++;\r\n\t\t\t\totd.style.display = 'none';\r\n\t\t\t\tjQuery(sameNode.cell).attr('rowspan', sameNode.count);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar cellRender = colCfg.cellRender || Z._defaultCellRender;\r\n\t\tif (cellRender && cellRender.refreshCell) {\r\n\t\t\tcellRender.refreshCell.call(Z, cellPanel, colCfg, recNo);\r\n\t\t} else {\r\n\t\t\tjslet.ui.DBTable.defaultCellRender.refreshCell.call(Z, cellPanel, colCfg, recNo);\r\n\t\t}\r\n\t\tif(fldName) {\r\n\t\t\tvar errObj = Z._dataset.getFieldErrorByRecno(recNo, fldName);\r\n\t\t\tvar jqTd = jQuery(otd);\r\n\t\t\tvar title = cellPanel.title;\r\n\t\t\tif(errObj && errObj.message) {\r\n\t\t\t\tif(!jqTd.hasClass('has-error')) {\r\n\t\t\t\t\tjqTd.addClass('has-error');\r\n\t\t\t\t}\r\n\t\t\t\tcellPanel.title = errObj.message;\r\n\t\t\t} else {\r\n\t\t\t\tif(jqTd.hasClass('has-error')) {\r\n\t\t\t\t\tjqTd.removeClass('has-error');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\trefreshCurrentRow: function () {\r\n\t\tvar Z = this,\r\n\t\t\thasLeft = Z._fixedCols > 0 || Z._hasSeqCol || Z._hasSelectCol,\r\n\t\t\tfixedBody = null, contentBody, idx,\r\n\t\t\trecno = Z._dataset.recno();\r\n\r\n\t\tif (recno < Z._fixedRows) {\r\n\t\t\tif (hasLeft) {\r\n\t\t\t\tfixedBody = Z.leftFixedTbl.tBodies[0];\r\n\t\t\t}\r\n\t\t\tcontentBody = Z.rightFixedTbl.tBodies[0];\r\n\t\t\tidx = recno;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (hasLeft) {\r\n\t\t\t\tfixedBody = Z.leftContentTbl.tBodies[0];\r\n\t\t\t}\r\n\t\t\tcontentBody = Z.rightContentTbl.tBodies[0];\r\n\t\t\tidx = Z.listvm.recnoToRowno(Z._dataset.recno()) - Z.listvm.getVisibleStartRow();\r\n\t\t}\r\n\r\n\t\tvar otr, cells, otd, recNo, colCfg, j, clen;\r\n\r\n\t\tif (hasLeft) {\r\n\t\t\totr = fixedBody.rows[idx];\r\n\t\t\tif (!otr) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcells = otr.childNodes;\r\n\t\t\trecNo = otr.jsletrecno;\r\n\t\t\tif (Z._onFillRow) {\r\n\t\t\t\tZ._onFillRow.call(Z, otr, Z._dataset);\r\n\t\t\t}\r\n\t\t\tvar ocheck;\r\n\t\t\tfor (j = 0, clen = cells.length; j < clen; j++) {\r\n\t\t\t\totd = cells[j];\r\n\t\t\t\tcolCfg = otd.jsletColCfg;\r\n\t\t\t\tif (colCfg && colCfg.isSeqCol) {\r\n\t\t\t\t\tcolCfg.cellRender.refreshCell.call(Z, otd.firstChild, colCfg);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (colCfg && colCfg.isSelectCol) {\r\n\t\t\t\t\tocheck = otd.firstChild;\r\n\t\t\t\t\tocheck.checked = Z._dataset.selected();\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tZ._fillCell(recNo, otd);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\totr = contentBody.rows[idx];\r\n\t\tif (!otr) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\trecNo = otr.jsletrecno;\r\n\t\tif (Z._onFillRow) {\r\n\t\t\tZ._onFillRow.call(Z, otr, Z._dataset);\r\n\t\t}\r\n\t\t// fill content table\r\n\t\tcells = otr.childNodes;\r\n\t\tfor (j = 0, clen = cells.length; j < clen; j++) {\r\n\t\t\totd = cells[j];\r\n\t\t\tZ._fillCell(recNo, otd);\r\n\t\t}\r\n\t},\r\n\r\n\t_getLeftRowByRecno: function (recno) {\r\n\t\tvar Z = this;\r\n\t\tif (recno < Z._fixedRows) {\r\n\t\t\treturn Z.leftFixedTbl.tBodies[0].rows[recno];\r\n\t\t}\r\n\t\tvar rows = Z.leftContentTbl.tBodies[0].rows, row;\r\n\t\tfor (var i = 0, cnt = rows.length; i < cnt; i++) {\r\n\t\t\trow = rows[i];\r\n\t\t\tif (row.jsletrecno == recno) {\r\n\t\t\t\treturn row;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}, // end _getLeftRowByRecno\r\n\r\n\t_showCurrentRow: function (checkVisible) {//Check if current row is in visible area\r\n\t\tvar Z = this,\r\n\t\t\trowno = Z.listvm.recnoToRowno(Z._dataset.recno());\r\n\t\tZ.listvm.setCurrentRowno(rowno, false, checkVisible);\r\n\t\tZ._showCurrentCell();\r\n\t},\r\n\r\n\t_getTrByRowno: function (rowno) {\r\n\t\tvar Z = this, \r\n\t\t\thasLeft = Z._fixedCols > 0 || Z._sysColumns.length > 0,\r\n\t\t\tidx, otr, k, rows, row, fixedRow;\r\n\r\n\t\tif (rowno < 0) {//fixed rows\r\n\t\t\trows = Z.rightFixedTbl.tBodies[0].rows;\r\n\t\t\tk = Z._fixedRows + rowno;\r\n\t\t\trow = rows[k];\r\n\t\t\tfixedRow = (hasLeft ? Z.leftFixedTbl.tBodies[0].rows[k] : null);\r\n\t\t\treturn { fixed: fixedRow, content: row };\r\n\t\t}\r\n\t\t//data content\r\n\t\trows = Z.rightContentTbl.tBodies[0].rows;\r\n\t\tk = rowno - Z.listvm.getVisibleStartRow();\r\n\t\tif (k >= 0) {\r\n\t\t\trow = rows[k];\r\n\t\t\tif (!row) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tfixedRow = hasLeft ? Z.leftContentTbl.tBodies[0].rows[k] : null;\r\n\t\t\treturn { fixed: fixedRow, content: row };\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\r\n\t_getCurrCellEl: function() {\r\n\t\tvar Z = this;\r\n\t\tif(!Z._currRow) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar contentRow = Z._currRow.content,\r\n\t\t\tcells = contentRow.cells, \r\n\t\t\tcellEl, colCfg;\r\n\t\tfor(var i = 0, len = cells.length; i < len; i++) {\r\n\t\t\tcellEl = cells[i];\r\n\t\t\tcolCfg = cellEl.jsletColCfg;\r\n\t\t\tif(colCfg && colCfg.colNum === Z._currColNum) {\r\n\t\t\t\treturn cellEl;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\t\r\n\t_adjustCurrentCellPos: function(isLeft) {\r\n\t\tvar Z = this;\r\n\t\tif(!Z._currRow) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar jqEl = jQuery(Z.el),\r\n\t\t\tjqContentPanel = jqEl.find('.jl-tbl-contentcol'),\r\n\t\t\tcontentPanel = jqContentPanel[0],\r\n\t\t\toldScrLeft = contentPanel.scrollLeft;\r\n\t\tif(Z._currColNum < Z._fixedCols) { //If current cell is in fixed content area\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar currTd = Z._getCurrCellEl(),\r\n\t\t\tcurrTdLeft = currTd.offsetLeft,\r\n\t\t\tcurrTdWidth = currTd.offsetWidth,\r\n\t\t\tcontainerWidth = contentPanel.clientWidth,\r\n\t\t\tcontainerLeft = contentPanel.scrollLeft;\r\n\t\tif(currTdLeft < containerLeft) {\r\n\t\t\tcontentPanel.scrollLeft = currTdLeft;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(currTdLeft + currTdWidth > containerLeft + containerWidth) {\r\n\t\t\tcontentPanel.scrollLeft = currTdLeft + currTdWidth - containerWidth;\r\n\t\t}\r\n\t},\r\n\r\n\t_isCurrCellInView: function() {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\tjqContentPanel = jqEl.find('.jl-tbl-contentcol'),\r\n\t\t\tcontentPanel = jqContentPanel[0],\r\n\t\t\tborderW = (Z._noborder ? 0: 2),\r\n\t\t\toldScrLeft = contentPanel.scrollLeft,\r\n\t\t\tcurrColLeft = 0, i, len;\r\n\t\tif(Z._currColNum < Z._fixedCols) { //If current cell is in fixed content area\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tfor(i = Z._fixedCols, len = Z.innerColumns.length; i < Z._currColNum; i++) {\r\n\t\t\tcurrColLeft += (Z.innerColumns[i].width + borderW); //\"2\" is the cell border's width(left+right)\r\n\t\t}\r\n\t\tif(currColLeft < oldScrLeft) {\r\n\t\t\treturn false; \r\n\t\t}\r\n\t\tvar containerWidth = jqContentPanel.innerWidth(),\r\n\t\t\tcontentWidth = jqContentPanel.find('.jl-tbl-content-div').width(),\r\n\t\t\tscrWidth = 0;\r\n\t\tfor(i = Z.innerColumns.length - 1; i > Z._currColNum; i--) {\r\n\t\t\tscrWidth += (Z.innerColumns[i].width + borderW); //\"2\" is the cell border's width(left+right)\r\n\t\t}\r\n\t\tcurrColLeft = contentWidth - scrWidth - containerWidth;\r\n\t\tcurrColLeft = (currColLeft >= 0? currColLeft: 0);\r\n\t\tif(currColLeft > oldScrLeft) {\r\n\t\t\treturn false; \r\n\t\t}\r\n\t\t\r\n\t\treturn true;\r\n\t},\r\n\t\r\n\t_showCurrentCell: function() {\r\n\t\tvar Z = this,\r\n\t\t\trowObj = Z._currRow;\r\n\t\tif(!rowObj) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar otr;\r\n\t\tif(Z._currColNum >= Z._fixedCols) {\r\n\t\t\totr = rowObj.content;\r\n\t\t} else {\r\n\t\t\totr = rowObj.fixed;\r\n\t\t}\r\n\t\tvar recno = otr.jsletrecno;\r\n    \tvar cellEditor = Z.cellEditor();\r\n\t\tif(recno !== Z._dataset.recno()) {\r\n    \t\tif(Z.prevCell) {\r\n    \t\t\tZ.prevCell.removeClass('jl-tbl-curr-cell');\r\n    \t\t}\r\n        \tif(cellEditor) {\r\n       \t\t\tcellEditor.hideEditor();\r\n        \t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar ocells = otr.cells, otd, colCfg, found = false;\r\n\t\tfor(var i = 0, len = ocells.length; i < len; i++) {\r\n\t\t\totd = ocells[i];\r\n        \tcolCfg = otd.jsletColCfg;\r\n        \tif(colCfg && colCfg.colNum == Z._currColNum) {\r\n        \t\tif(Z.prevCell) {\r\n        \t\t\tZ.prevCell.removeClass('jl-tbl-curr-cell');\r\n        \t\t}\r\n        \t\tvar jqCell = jQuery(otd);\r\n        \t\tjqCell.addClass('jl-tbl-curr-cell');\r\n        \t\tZ.prevCell = jqCell;\r\n        \t\tfound = true;\r\n        \t\tbreak;\r\n        \t}\r\n\t\t}\r\n    \tif(cellEditor && found) {\r\n    \t\tif(Z._isCurrCellInView()) {\r\n    \t\t\tcellEditor.showEditor(colCfg.field, otd);\r\n    \t\t} else {\r\n    \t\t\tcellEditor.hideEditor();\r\n    \t\t}\r\n    \t}\r\n\t},\r\n\t\r\n\t_showSelected: function(otd, fldName, recno) {\r\n\t\tvar Z = this,\r\n\t\t\tjqCell = jQuery(otd);\r\n\t\tif(recno === undefined) {\r\n\t\t\trecno = Z._dataset.recno();\r\n\t\t}\r\n\t\tvar isSelected = Z._dataset.selection.isSelected(recno, fldName);\r\n\t\tif(isSelected) {\r\n\t\t\tjqCell.addClass('jl-tbl-selected');\r\n\t\t} else {\r\n\t\t\tjqCell.removeClass('jl-tbl-selected');\r\n\t\t}\r\n\t},\r\n\t\r\n\t_refreshSelection: function() {\r\n\t\tvar Z = this;\r\n\t\tjQuery(Z.el).find('td.jl-tbl-cell').each(function(k, otd){\r\n        \tvar colCfg = otd.jsletColCfg;\r\n        \tvar recno = parseInt(otd.parentNode.jsletrecno);\r\n        \tif((recno || recno === 0) && colCfg) {\r\n        \t\tvar fldName = colCfg.field;\r\n        \t\tif(fldName) {\r\n        \t\t\tZ._showSelected(otd, fldName, recno);\r\n        \t\t}\r\n        \t}\r\n\t\t});\r\n\t},\r\n\t\r\n\t_syncScrollBar: function (rowno) {\r\n\t\tvar Z = this;\r\n\t\tif (Z._keep_silence_) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar\tsw = rowno * Z.rowHeight();\r\n\t\tZ._keep_silence_ = true;\r\n\t\ttry {\r\n\t\t\tvar scrBar = Z.jqVScrollBar[0];\r\n\t\t\twindow.setTimeout(function() {\r\n\t\t\t\tscrBar.scrollTop = sw;\r\n\t\t\t}, 10);\r\n\t\t} finally {\r\n\t\t\tZ._keep_silence_ = false;\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Toggle(expand/collapse) the current record expanded status, enabled for tree style table.\r\n\t */\r\n\ttoggle: function() {\r\n\t\tvar Z = this;\r\n\t\tif(Z._dataset.recordCount() === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar expanded = Z._dataset.expandedByRecno(Z._dataset.recno());\r\n\t\tif (expanded) {\r\n\t\t\tZ.listvm.collapse(function(){\r\n\t\t\t\tZ._fillData();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tZ.listvm.expand(function(){\r\n\t\t\t\tZ._fillData();\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * Expand the current record, enabled for tree style table.\r\n\t */\r\n\texpand: function() {\r\n\t\tvar Z = this;\r\n\t\tif(Z._dataset.recordCount() === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar expanded = Z._dataset.expandedByRecno(Z._dataset.recno());\r\n\t\tif (!expanded) {\r\n\t\t\tZ.listvm.expand(function(){\r\n\t\t\t\tZ._fillData();\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * Collapse the current record, enabled for tree style table.\r\n\t */\r\n\tcollapse: function() {\r\n\t\tvar Z = this;\r\n\t\tif(Z._dataset.recordCount() === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar expanded = Z._dataset.expandedByRecno(Z._dataset.recno());\r\n\t\tif (expanded) {\r\n\t\t\tZ.listvm.collapse(function(){\r\n\t\t\t\tZ._fillData();\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * Expand all records, enabled for tree style table.\r\n\t */\r\n\texpandAll: function () {\r\n\t\tvar Z = this;\r\n\t\tZ.listvm.expandAll(function () {\r\n\t\t\tZ._fillData(); \r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Collapse all records, enabled for tree style table.\r\n\t */\r\n\tcollapseAll: function () {\r\n\t\tvar Z = this;\r\n\t\tZ.listvm.collapseAll(function () {\r\n\t\t\tZ._fillData(); \r\n\t\t});\r\n\t},\r\n\r\n\t_doMetaChanged: function(metaName, fldName) {\r\n\t\tvar Z = this;\r\n\t\tif(!fldName) {\r\n\t\t\tZ.renderAll();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(metaName == 'label' && !Z._hideHead) {\r\n\t\t\tZ._refreshHeadCell(fldName);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif(metaName == 'required' && Z._editable && !Z._hideHead) {\r\n\t\t\tZ._refreshHeadCell(fldName);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif(metaName == 'visible') {\r\n\t\t\t\r\n\t\t}\r\n\t\tif(Z._editable && (metaName == 'readOnly' || metaName == 'disabled')) {\r\n\t\t\tvar cellEditor = Z.cellEditor();\r\n\t\t\tif(cellEditor) {\r\n\t\t\t\tvar currFld = cellEditor.currentField();\r\n\t\t\t\tif(currFld == fldName) {\r\n\t\t\t\t\tcellEditor.showEditor(fldName);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\trefreshControl: function (evt) {\r\n\t\tvar Z = this, i, cnt, otr, otd, checked, ocheckbox, col, recno,\r\n\t\t\tevtType = evt.eventType;\r\n\t\tif (evtType == jslet.data.RefreshEvent.CHANGEMETA) {\r\n\t\t\tZ._doMetaChanged(evt.metaName, evt.fieldName);\r\n\t\t} else if (evtType == jslet.data.RefreshEvent.AGGRADED) {\r\n\t\t\tZ._fillTotalSection();\t\t\t\r\n\t\t} else if (evtType == jslet.data.RefreshEvent.BEFORESCROLL) {\r\n\t\t\t\r\n\t\t} else if (evtType == jslet.data.RefreshEvent.SCROLL) {\r\n\t\t\tif (Z._dataset.recordCount() === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tZ._showCurrentRow(true);\r\n\t\t} else if (evtType == jslet.data.RefreshEvent.UPDATEALL) {\r\n\t\t\tif(!Z.listvm) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tZ.listvm.refreshModel();\r\n\t\t\tZ._updateSortFlag(true);\r\n\t\t\tif(Z._dataset.recordCount() === 0) {\r\n\t\t\t\tZ._currRow = null;\r\n\t\t\t}\r\n\t\t\tZ._fillData();\r\n\t\t\tZ._showCurrentRow(true);\r\n\t\t\tif(Z._filterPanel) {\r\n\t\t\t\tZ._filterPanel.checkFilterBtnStyle();\r\n\t\t\t}\r\n\t\t\t//Clear \"Select all\" checkbox\r\n\t\t\tif(Z._hasSelectCol) {\r\n\t\t\t\tjQuery(Z.el).find('.jl-tbl-select-all')[0].checked = false;\r\n\t\t\t}\r\n\t\t} else if (evtType == jslet.data.RefreshEvent.UPDATERECORD) {\r\n\t\t\tZ.refreshCurrentRow();\r\n\t\t} else if (evtType == jslet.data.RefreshEvent.UPDATECOLUMN || evtType == jslet.data.RefreshEvent.UPDATELOOKUP) {\r\n\t\t\tZ._fillData();\r\n\t\t} else if (evtType == jslet.data.RefreshEvent.INSERT) {\r\n\t\t\tZ.listvm.refreshModel();\r\n\t\t\trecno = Z._dataset.recno();\r\n\t\t\tvar\tpreRecno = evt.preRecno;\r\n\r\n\t\t\tZ._fillData();\r\n\t\t\tZ._keep_silence_ = true;\r\n\t\t\ttry {\r\n\t\t\t\tZ.refreshControl(jslet.data.RefreshEvent.scrollEvent(recno, preRecno));\r\n\t\t\t} finally {\r\n\t\t\t\tZ._keep_silence_ = false;\r\n\t\t\t}\r\n\t\t} else if (evtType == jslet.data.RefreshEvent.DELETE) {\r\n\t\t\tZ.listvm.refreshModel();\r\n\t\t\tZ._fillData();\r\n\t\t\tif(Z._dataset.recordCount() === 0) {\r\n\t\t\t\tZ._currRow = null;\r\n\t\t\t}\r\n\t\t} else if (evtType == jslet.data.RefreshEvent.SELECTRECORD) {\r\n\t\t\tif (!Z._hasSelectCol) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcol = 0;\r\n\t\t\tif (Z._hasSeqCol) {\r\n\t\t\t\tcol++;\r\n\t\t\t}\r\n\t\t\trecno = evt.recno;\r\n\t\t\tfor(i = 0, cnt = recno.length; i < cnt; i++){\r\n\t\t\t\totr = Z._getLeftRowByRecno(recno[i]);\r\n\t\t\t\tif (!otr) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\totd = otr.cells[col];\r\n\t\t\t\tchecked = evt.selected ? true : false;\r\n\t\t\t\tocheckbox = jQuery(otd).find('[type=checkbox]')[0];\r\n\t\t\t\tocheckbox.checked = checked;\r\n\t\t\t\tocheckbox.defaultChecked = checked;\r\n\t\t\t}\r\n\t\t} else if (evtType == jslet.data.RefreshEvent.SELECTALL) {\r\n\t\t\tif (!Z._hasSelectCol) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcol = 0;\r\n\t\t\tif (Z._hasSeqCol) {\r\n\t\t\t\tcol++;\r\n\t\t\t}\r\n\t\t\tvar leftFixedBody = Z.leftFixedTbl.tBodies[0],\r\n\t\t\t\tleftContentBody = Z.leftContentTbl.tBodies[0],\r\n\t\t\t\trec,\r\n\t\t\t\toldRecno = Z._dataset.recno();\r\n\r\n\t\t\ttry {\r\n\t\t\t\tfor (i = 0, cnt = leftFixedBody.rows.length; i < cnt; i++) {\r\n\t\t\t\t\totr = leftFixedBody.rows[i];\r\n\t\t\t\t\tif (otr.style.display == 'none') {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tZ._dataset.recnoSilence(otr.jsletrecno);\r\n\t\t\t\t\tchecked = Z._dataset.selected() ? true : false;\r\n\t\t\t\t\totd = otr.cells[col];\r\n\t\t\t\t\tocheckbox = jQuery(otd).find('[type=checkbox]')[0];\r\n\t\t\t\t\tocheckbox.checked = checked;\r\n\t\t\t\t\tocheckbox.defaultChecked = checked;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (i = 0, cnt = leftContentBody.rows.length; i < cnt; i++) {\r\n\t\t\t\t\totr = leftContentBody.rows[i];\r\n\t\t\t\t\tif (otr.style.display == 'none') {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tZ._dataset.recnoSilence(otr.jsletrecno);\r\n\t\t\t\t\tchecked = Z._dataset.selected() ? true : false;\r\n\t\t\t\t\totd = otr.cells[col];\r\n\t\t\t\t\tocheckbox = jQuery(otd).find('[type=checkbox]')[0];\r\n\t\t\t\t\tocheckbox.checked = checked;\r\n\t\t\t\t\tocheckbox.defaultChecked = checked;\r\n\t\t\t\t}\r\n\t\t\t} finally {\r\n\t\t\t\tZ._dataset.recnoSilence(oldRecno);\r\n\t\t\t}\r\n\t\t} //end event selectall\r\n\t}, // refreshControl\r\n\r\n\t_isCellEditable: function(colCfg){\r\n\t\tvar Z = this;\r\n\t\tif (!Z._editable) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar fldName = colCfg.field;\r\n\t\tif (!fldName) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar fldObj = Z._dataset.getField(fldName),\r\n\t\t\tisEditable = !fldObj.fieldDisabled() && !fldObj.fieldReadOnly() ? 1 : 0;\r\n\t\treturn isEditable;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Run when container size changed, it's revoked by jslet.resizeeventbus.\r\n\t * \r\n\t */\r\n\tcheckSizeChanged: function(){\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\tnewHeight = jqEl.height();\r\n\t\tif (newHeight == Z._oldHeight) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tZ.height = newHeight;\r\n\t\tZ.renderAll();\r\n\t},\r\n\t\r\n\t_innerDestroy: function() {\r\n\t\tvar Z = this, \r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\tZ._currRow = null;\r\n\t\tZ.listvm.reset();\r\n\t\tZ.leftHeadTbl = null;\r\n\t\tZ.rightHeadTbl = null;\r\n\t\tjQuery(Z.rightHeadTbl).off();\r\n\r\n\t\tZ.leftFixedTbl = null;\r\n\t\tZ.rightFixedTbl = null;\r\n\r\n\t\tZ.leftContentTbl = null;\r\n\t\tZ.rightContentTbl = null;\r\n\r\n\t\tZ.leftFootTbl = null;\r\n\t\tZ.rightFootTbl = null;\r\n\t\t\r\n\t\tZ.noRecordDiv = null;\r\n\t\tif(Z.jqVScrollBar) {\r\n\t\t\tZ.jqVScrollBar.off();\r\n\t\t}\r\n\t\tZ.jqVScrollBar = null;\r\n\t\t\r\n\t\tvar splitter = jqEl.find('.jl-tbl-splitter')[0];\r\n\t\tif(splitter) {\r\n\t\t\tsplitter._doDragging = null;\r\n\t\t\tsplitter._doDragEnd = null;\r\n\t\t\tsplitter._doDragCancel = null;\r\n\t\t}\r\n\t\tZ.parsedHeads = null;\r\n\t\tZ.prevCell = null;\r\n\t\tjqEl.find('tr').each(function(){\r\n\t\t\tthis.ondblclick = null;\r\n\t\t\tthis.onclick = null;\r\n\t\t});\r\n\t\t\r\n\t\tjqEl.find('.jl-tbl-select-check').off();\r\n\t\tif(Z._filterPanel) {\r\n\t\t\tZ._filterPanel.destroy();\r\n\t\t\tZ._filterPanel = null;\r\n\t\t}\r\n\t\t\r\n\t\tif(Z._findDialog) {\r\n\t\t\tZ._findDialog.destroy();\r\n\t\t\tZ._findDialog = null;\r\n\t\t}\r\n\t\t\r\n\t\tif(Z._cellEditor) {\r\n\t\t\tZ._cellEditor.destroy();\r\n\t\t\tZ._cellEditor = null;\r\n\t\t}\t\t\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tvar Z = this, \r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\tjslet.resizeEventBus.unsubscribe(Z);\r\n\t\tjqEl.off();\r\n\t\tZ._innerDestroy();\r\n\t\tZ.listvm.destroy();\r\n\t\tZ.listvm = null;\r\n\t\t$super();\r\n\t} \r\n});\r\n\r\njslet.ui.DBTable = jslet.Class.create(jslet.ui.AbstractDBTable, {});\r\n\r\n\r\njslet.ui.register('DBTable', jslet.ui.DBTable);\r\njslet.ui.DBTable.htmlTemplate = '<div></div>';\r\n\r\njslet.ui.CellRender = jslet.Class.create({\r\n\tcreateHeader: function(cellPanel, colCfg) {\r\n\t\t\r\n\t},\r\n\t\r\n\tcreateCell: function (cellPanel, colCfg) {\r\n\t\r\n\t},\r\n\t\r\n\trefreshCell: function (cellPanel, colCfg, recNo) {\r\n\t\r\n\t}\r\n});\r\n\r\njslet.ui.DefaultCellRender =  jslet.Class.create(jslet.ui.CellRender, {\r\n\tcreateCell: function (cellPanel, colCfg) {\r\n\t\tvar Z = this,\r\n\t\t\tfldName = colCfg.field,\r\n\t\t\tfldObj = Z._dataset.getField(fldName);\r\n\t\tcellPanel.parentNode.style.textAlign = fldObj.alignment();\r\n\t},\r\n\t\t\t\t\t\t\t\t\r\n\trefreshCell: function (cellPanel, colCfg, recNo) {\r\n\t\tif (!colCfg || colCfg.noRefresh) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar Z = this,\r\n\t\t\tfldName = colCfg.field;\r\n\t\tif (!fldName) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tvar fldObj = Z._dataset.getField(fldName), text;\r\n\t\ttry {\r\n\t\t\ttext = Z._dataset.getFieldTextByRecno(recNo, fldName);\r\n\t\t} catch (e) {\r\n\t\t\ttext = 'error: ' + e.message;\r\n\t\t\tconsole.error(e);\r\n\t\t}\r\n\t\t\r\n\t\tif (fldObj.urlExpr()) {\r\n\t\t\tvar url = '<a href=' + fldObj.calcUrl(),\r\n\t\t\t\ttarget = fldObj.urlTarget();\r\n\t\t\tif (target) {\r\n\t\t\t\turl += ' target=' + target;\r\n\t\t\t}\r\n\t\t\turl += '>' + text + '</a>';\r\n\t\t\ttext = url;\r\n\t\t}\r\n\t\tif(text === '' || text === null || text === undefined) {\r\n\t\t\ttext = '&nbsp;';\r\n\t\t}\r\n\t\tvar jqCellPanel = jQuery(cellPanel); \r\n\t\tjqCellPanel.html(text);\r\n\t\tcellPanel.title = jqCellPanel.text();\r\n\t\tZ._showSelected(cellPanel.parentNode, fldName, recNo);\r\n\t} \r\n});\r\n\r\njslet.ui.SequenceCellRender = jslet.Class.create(jslet.ui.CellRender, {\r\n\tcreateHeader: function(cellPanel, colCfg) {\r\n\t\tcellPanel.innerHTML = this._seqColHeader || '&nbsp;';\r\n\t},\r\n\t\r\n\tcreateCell: function (cellPanel, colCfg) {\r\n\t\tjQuery(cellPanel.parentNode).addClass('jl-tbl-sequence');\r\n\t},\r\n\t\r\n\trefreshCell: function (cellPanel, colCfg) {\r\n\t\tif (!colCfg || colCfg.noRefresh) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar jqDiv = jQuery(cellPanel), \r\n\t\t\ttext,\r\n\t\t\trecno = this.listvm.getCurrentRecno();\r\n\t\tif(this._reverseSeqCol) {\r\n\t\t\ttext = this._dataset.recordCount() - recno;\r\n\t\t} else {\r\n\t\t\ttext = recno + 1;\r\n\t\t}\r\n\t\tvar title;\r\n\t\tif(this._dataset.existRecordError(recno)) {\r\n\t\t\tjqDiv.parent().addClass('has-error');\r\n\t\t\ttitle = this._dataset.getRecordErrorInfo(recno);\r\n\t\t} else {\r\n\t\t\tjqDiv.parent().removeClass('has-error');\r\n\t\t\ttitle = text;\r\n\t\t}\r\n\t\t\r\n\t\tcellPanel.title = title;\r\n\t\tjqDiv.html(text);\r\n\t}\r\n});\r\n\r\njslet.ui.SelectCellRender = jslet.Class.create(jslet.ui.CellRender, {\r\n\tcreateHeader: function(cellPanel, colCfg) {\r\n\t\tcellPanel.style.textAlign = 'center';\r\n\t\tvar ocheckbox = document.createElement('input');\r\n\t\tocheckbox.type = 'checkbox';\r\n\t\tvar Z = this;\r\n\t\tjQuery(ocheckbox).addClass('jl-tbl-select-check jl-tbl-select-all').on('click', function (event) {\r\n\t\t\tif(Z._beforeSelectAll) {\r\n\t\t\t\tZ._beforeSelectAll.call(Z);\r\n\t\t\t}\r\n\t\t\tZ._dataset.selectAll(this.checked ? 1 : 0, Z._onSelectAll);\r\n\t\t\tif(Z._afterSelectAll) {\r\n\t\t\t\tZ._afterSelectAll.call(Z);\r\n\t\t\t}\r\n\t\t});\r\n\t\tcellPanel.appendChild(ocheckbox);\r\n\t},\r\n\t\r\n   createCell: function (cellPanel, colCfg) {\r\n\t    cellPanel.style.textAlign = 'center';\r\n\t\tvar Z = this, \r\n\t\tocheck = document.createElement('input'),\r\n\t\tjqCheck = jQuery(ocheck);\r\n\t\tjqCheck.attr('type', 'checkbox').addClass('jl-tbl-select-check');\r\n\t\tjqCheck.click(Z._doSelectBoxClick);\r\n\t\tcellPanel.appendChild(ocheck);\r\n\t},\r\n\r\n\trefreshCell: function (cellPanel, colCfg, recNo) {\r\n\t\tif (!colCfg || colCfg.noRefresh) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar Z = this,\r\n\t\t\tocheck = cellPanel.firstChild;\r\n\t\tif(Z._dataset.checkSelectable(recNo)) {\r\n\t\t\tocheck.checked = Z._dataset.selectedByRecno(recNo);\r\n\t\t\tocheck.style.display = '';\r\n\t\t} else {\r\n\t\t\tocheck.style.display = 'none';\r\n\t\t}\r\n\t}\r\n});\r\n\r\njslet.ui.SubgroupCellRender = jslet.Class.create(jslet.ui.CellRender, {\r\n\tcreateCell: function(otd, colCfg){\r\n\t\t//TODO\r\n\t}\r\n});\r\n\r\njslet.ui.BoolCellRender = jslet.Class.create(jslet.ui.DefaultCellRender, {\r\n\trefreshCell: function (cellPanel, colCfg, recNo) {\r\n\t\tif (!colCfg || colCfg.noRefresh) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tcellPanel.style.textAlign = 'center';\r\n\t\tvar jqDiv = jQuery(cellPanel);\r\n\t\tjqDiv.html('&nbsp;');\r\n\t\tvar Z = this,\r\n\t\t\tfldName = colCfg.field, \r\n\t\t\tfldObj = Z._dataset.getField(fldName);\r\n\t\tif (Z._dataset.getFieldValueByRecno(recNo, fldName)) {\r\n\t\t\tjqDiv.addClass('jl-tbl-checked');\r\n\t\t\tjqDiv.removeClass('jl-tbl-unchecked');\r\n\t\t}\r\n\t\telse {\r\n\t\t\tjqDiv.removeClass('jl-tbl-checked');\r\n\t\t\tjqDiv.addClass('jl-tbl-unchecked');\r\n\t\t}\r\n\t\tZ._showSelected(cellPanel.parentNode, fldName, recNo);\r\n\t}\r\n});\r\n\t\t\r\njslet.ui.TreeCellRender = jslet.Class.create(jslet.ui.CellRender, {\r\n\tinitialize: function () {\r\n\t},\r\n\t\t\r\n\tcreateCell: function (cellPanel, colCfg, recNo) {\r\n\t\tvar Z = this;\r\n\r\n\t\tvar odiv = document.createElement('div'),\r\n\t\t\tjqDiv = jQuery(odiv);\r\n\t\todiv.style.height = Z.rowHeight() - 2 + 'px';\r\n\t\tjqDiv.html('<span class=\"jl-tbltree-indent\"></span><span class=\"jl-tbltree-node\"></span><span class=\"jl-tbltree-icon\"></span><span class=\"jl-tbltree-text\"></span>');\r\n\t\t\r\n\t\tvar obtn = odiv.childNodes[1];\r\n\t\tobtn.onclick = function (event) {\r\n\t\t\tvar otr = jslet.ui.findFirstParent(this,\r\n\t\t\tfunction(node){\r\n\t\t\t\treturn node.tagName && node.tagName.toLowerCase() == 'tr';\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tevent.stopImmediatePropagation();\r\n\t\t\tevent.preventDefault();\r\n\t\t\tZ._dataset.recno(otr.jsletrecno);\r\n\t\t\tif(Z._dataset.aborted()) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (this.expanded) {\r\n\t\t\t\tZ.listvm.collapse(function(){\r\n\t\t\t\t\tZ._fillData();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tZ.listvm.expand(function(){\r\n\t\t\t\t\tZ._fillData();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t};\r\n\t\t\r\n\t\tobtn.onmouseover = function (event) {\r\n\t\t\tvar jqBtn = jQuery(this);\r\n\t\t\tif (jqBtn.hasClass('jl-tbltree-collapse')) {\r\n\t\t\t\tjqBtn.addClass('jl-tbltree-collapse-hover');\r\n\t\t\t} else {\r\n\t\t\t\tjqBtn.addClass('jl-tbltree-expand-hover');\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tobtn.onmouseout = function (event) {\r\n\t\t\tvar jqBtn = jQuery(this);\r\n\t\t\tjqBtn.removeClass('jl-tbltree-collapse-hover');\r\n\t\t\tjqBtn.removeClass('jl-tbltree-expand-hover');\r\n\t\t};\r\n\t\t\r\n\t\tcellPanel.appendChild(odiv);\r\n\t},\r\n\t\r\n\trefreshCell: function (cellPanel, colCfg, recNo) {\r\n\t\tif (!colCfg || colCfg.noRefresh) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar odiv = cellPanel.firstChild,\r\n\t\t\tarrSpan = odiv.childNodes,\r\n\t\t\tZ = this,\r\n\t\t\tlevel = Z.listvm.getLevel(recNo);\r\n\t\t\r\n\t\tif (!jslet.ui.TreeCellRender.iconWidth) {\r\n\t\t\tjslet.ui.TreeCellRender.iconWidth = parseInt(jslet.ui.getCssValue('jl-tbltree-indent', 'width'));\r\n\t\t}\r\n\t\tvar hasChildren = Z.listvm.hasChildren(recNo),\r\n\t\t\tindentWidth = (!hasChildren ? level + 1 : level) * jslet.ui.TreeCellRender.iconWidth,\r\n\t\t\toindent = arrSpan[0];\r\n\t\toindent.style.width = indentWidth + 'px';\r\n\t\tvar expBtn = arrSpan[1]; //expand button\r\n\t\texpBtn.style.display = hasChildren ? 'inline-block' : 'none';\r\n\t\tif (hasChildren) {\r\n\t\t\texpBtn.expanded = Z._dataset.expandedByRecno(recNo);\r\n\t\t\tvar jqExpBtn = jQuery(expBtn);\r\n\t\t\tjqExpBtn.removeClass('jl-tbltree-expand');\r\n\t\t\tjqExpBtn.removeClass('jl-tbltree-collapse');\r\n\t\t\tjqExpBtn.addClass((expBtn.expanded ? 'jl-tbltree-expand' : 'jl-tbltree-collapse'));\r\n\t\t}\r\n\t\tif (colCfg.getIconClass) {\r\n\t\t\tvar iconCls = colCfg.getIconClass(level, hasChildren);\r\n\t\t\tif (iconCls) {\r\n\t\t\t\tvar jqIcon = jQuery(arrSpan[2]);\r\n\t\t\t\tjqIcon.addClass('jl-tbltree-icon ' + iconCls);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tvar otext = arrSpan[3];\r\n\t\t\r\n\t\tvar fldName = colCfg.field, fldObj = Z._dataset.getField(fldName), text;\r\n\t\ttry {\r\n\t\t\ttext = Z._dataset.getFieldTextByRecno(recNo, fldName);\r\n\t\t} catch (e) {\r\n\t\t\ttext = 'error: ' + e.message;\r\n\t\t}\r\n\t\tcellPanel.title = text;\r\n\t\tif (fldObj.urlExpr()) {\r\n\t\t\tvar url = '<a href=' + fldObj.calcUrl();\r\n\t\t\tvar target = fldObj.urlTarget();\r\n\t\t\tif (target) {\r\n\t\t\t\turl += ' target=' + target;\r\n\t\t\t}\r\n\t\t\turl += '>' + text + '</a>';\r\n\t\t\ttext = url;\r\n\t\t}\r\n\t\totext.innerHTML = text;\r\n\t\tZ._showSelected(cellPanel.parentNode, fldName, recNo);\r\n\t}\r\n});\r\n\r\njslet.ui.DBTable.defaultCellRender = new jslet.ui.DefaultCellRender();\r\n\r\njslet.ui.DBTable.treeCellRender = new jslet.ui.TreeCellRender();\r\njslet.ui.DBTable.boolCellRender = new jslet.ui.BoolCellRender();\r\njslet.ui.DBTable.sequenceCellRender = new jslet.ui.SequenceCellRender();\r\njslet.ui.DBTable.selectCellRender = new jslet.ui.SelectCellRender();\r\njslet.ui.DBTable.subgroupCellRender = new jslet.ui.SubgroupCellRender();\r\n\r\n/**\r\n* Splitter: used in jslet.ui.DBTable\r\n*/\r\njslet.ui.Splitter = function () {\r\n\tif (!jslet.ui._splitDiv) {\r\n\t\tvar odiv = document.createElement('div');\r\n\t\todiv.className = 'jl-split-column';\r\n\t\todiv.style.display = 'none';\r\n\t\tjslet.ui._splitDiv = odiv;\r\n\t\tdocument.body.appendChild(odiv);\r\n\t\todiv = null;\r\n\t}\r\n\t\r\n\tthis.isDragging = false;\r\n\t\r\n\tthis.attach = function (el, left, top, height) {\r\n\t\tif (!height) {\r\n\t\t\theight = jQuery(el).height();\r\n\t\t}\r\n\t\tvar odiv = jslet.ui._splitDiv;\r\n\t\todiv.style.height = height + 'px';\r\n\t\todiv.style.left = left + 'px';\r\n\t\todiv.style.top = top + 'px';\r\n\t\todiv.style.display = 'block';\r\n\t\tjslet.ui.dnd.bindControl(this);\r\n\t\tthis.isDragging = false;\r\n\t};\r\n\t\r\n\tthis.unattach = function () {\r\n\t\tjslet.ui._splitDiv.style.display = 'none';\r\n\t\tthis.onSplitEnd = null;\r\n\t\tthis.onSplitCancel = null;\r\n\t};\r\n\t\r\n\tthis.onSplitEnd = null;\r\n\tthis.onSplitCancel = null;\r\n\t\r\n\tthis._doDragEnd = function (oldX, oldY, x, y, deltaX, deltaY) {\r\n\t\tjslet.ui.dnd.unbindControl();\r\n\t\tif (this.onSplitEnd) {\r\n\t\t\tthis.onSplitEnd(x - oldX);\r\n\t\t}\r\n\t\tthis.unattach();\r\n\t\tthis.isDragging = false;\r\n\t};\r\n\t\r\n\tthis._doDragging = function (oldX, oldY, x, y, deltaX, deltaY) {\r\n\t\tthis.isDragging = true;\r\n\t\tjslet.ui._splitDiv.style.left = x + 'px';\r\n\t};\r\n\t\r\n\tthis._doDragCancel = function () {\r\n\t\tjslet.ui.dnd.unbindControl();\r\n\t\tif (this.onSplitCancel) {\r\n\t\t\tthis.onSplitCancel();\r\n\t\t}\r\n\t\tthis.unattach();\r\n\t\tthis.isDragging = false;\r\n\t};\r\n};\r\n\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBTreeView. \r\n * Functions:\r\n * 1. Perfect performance, you can load unlimited data;\r\n * 2. Checkbox on tree node;\r\n * 3. Relative check, when you check one tree node, its children and its parent will check too;\r\n * 4. Many events for you to customize tree control;\r\n * 5. Context menu supported and you can customize your context menu;\r\n * 6. Icon supported on each tree node.\r\n * \r\n * Example:\r\n * <pre><code>\r\n *\tvar jsletParam = { type: \"DBTreeView\", \r\n *\tdataset: \"dsAgency\", \r\n *\tdisplayFields: \"[code]+'-'+[name]\",\r\n *  keyField: \"id\", \r\n *\tparentField: \"parentid\",\r\n *  hasCheckBox: true, \r\n *\ticonClassField: \"iconcls\", \r\n *\tonCreateContextMenu: doCreateContextMenu, \r\n *\tcorrelateCheck: true\r\n * };\r\n * //1. Declaring:\r\n *  &lt;div id=\"ctrlId\" data-jslet=\"jsletParam\">\r\n *  or\r\n *  &lt;div data-jslet='jsletParam' />\r\n *  \r\n *  //2. Binding\r\n *  &lt;div id=\"ctrlId\"  />\r\n *  //Js snippet\r\n *\tvar el = document.getElementById('ctrlId');\r\n *  jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n *  jslet.ui.createControl(jsletParam, document.body);\r\n *\t\t\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBTreeView = jslet.Class.create(jslet.ui.DBControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,displayFields,hasCheckBox,correlateCheck,onlyCheckChildren,readOnly,expandLevel,codeField,codeFormat,onItemClick,onItemDblClick,beforeCheckBoxClick,afterCheckBoxClick,iconClassField,onGetIconClass,onRenderItem,onCreateContextMenu';\r\n\t\tZ.requiredProperties = 'displayFields';\r\n\t\t\r\n\t\tZ._displayFields = null;\r\n\r\n\t\tZ._hasCheckBox = false;\r\n\r\n\t\tZ._readOnly = false;\r\n\t\t\r\n\t\tZ._correlateCheck = false;\r\n\t\t\r\n\t\tZ._onlyCheckChildren = false;\r\n\t\t\r\n\t\tZ._iconClassField = null;\r\n\t\t\r\n\t\tZ._expandLevel = -1;\r\n\t\t\r\n\t\tZ._onItemClick = null;\r\n\t\t\r\n\t\tZ._onItemDblClick = null;\r\n\r\n\t\tZ._beforeCheckBoxClick = null;\r\n\t\t\r\n\t\tZ._afterCheckBoxClick = null;\r\n\r\n\t\tZ._onGetIconClass = null;\r\n\t\t\r\n\t\tZ._onRenderItem = null;\r\n\t\t\r\n\t\tZ._onCreateContextMenu = null;\r\n\t\t\r\n\t\tZ.iconWidth = null;\r\n\t\t\r\n\t\t$super(el, params);\r\n\t},\r\n\t\r\n\t/**\r\n\t * Display fields to render tree node, it's a js expresssion, like: \"[code]+'-'+[name]\"\r\n\t * \r\n\t * @param {String or undefined} displayFields - Display fields, it's a js expresssion, like: \"[code]+'-'+[name]\"\r\n\t * @return {String or this}\r\n\t */\r\n\tdisplayFields: function(displayFields) {\r\n\t\tif(displayFields === undefined) {\r\n\t\t\tvar dispFields = this._displayFields;\r\n\t\t\tif(dispFields) {\r\n\t\t\t\treturn dispFields;\r\n\t\t\t} else {\r\n\t\t\t\tvar dataset = this._dataset;\r\n\t\t\t\tvar dispField = dataset.nameField() || dataset.codeField() || dataset.keyField();\r\n\t\t\t\tif(dispField) {\r\n\t\t\t\t\treturn '[' + dispField + ']';\r\n\t\t\t\t}\r\n\t\t\t\tjslet.Checker.test('DBTreeView.displayFields', dispField).required();\r\n\t\t\t}\r\n\t\t}\r\n\t\tdisplayFields = jQuery.trim(displayFields);\r\n\t\tjslet.Checker.test('DBTreeView.displayFields', displayFields).required().isString();\r\n\t\tthis._displayFields = displayFields;\r\n\t},\r\n\t\r\n\t/**\r\n\t * If icon class is stored one field, you can set this property to display different tree node icon.\r\n\t * \r\n\t * @param {String or undefined} iconClassField - If icon class is stored one field, you can set this property to display different tree node icon.\r\n\t * @return {String or this}\r\n\t */\r\n\ticonClassField: function(iconClassField) {\r\n\t\tif(iconClassField === undefined) {\r\n\t\t\treturn this._iconClassField;\r\n\t\t}\r\n\t\ticonClassField = jQuery.trim(iconClassField);\r\n\t\tjslet.Checker.test('DBTreeView.iconClassField', iconClassField).isString();\r\n\t\tthis._iconClassField = iconClassField;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify if there is a check box on tree node\r\n\t * \r\n\t * @param {Boolean or undefined} hasCheckBox - Identify if there is a check box on tree node.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\thasCheckBox: function(hasCheckBox) {\r\n\t\tif(hasCheckBox === undefined) {\r\n\t\t\treturn this._hasCheckBox;\r\n\t\t}\r\n\t\tthis._hasCheckBox = hasCheckBox ? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * If true, when you check one tree node, its children and its parent will be checked too;\r\n\t * \r\n\t * @param {Boolean or undefined} correlateCheck - If true, when you check one tree node, its children and its parent will be checked too.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\tcorrelateCheck: function(correlateCheck) {\r\n\t\tif(correlateCheck === undefined) {\r\n\t\t\treturn this._correlateCheck;\r\n\t\t}\r\n\t\tthis._correlateCheck = correlateCheck ? true: false;\r\n\t},\r\n\t\r\n\tonlyCheckChildren: function(onlyCheckChildren) {\r\n\t\tif(onlyCheckChildren === undefined) {\r\n\t\t\treturn this._onlyCheckChildren;\r\n\t\t}\r\n\t\tthis._onlyCheckChildren = onlyCheckChildren ? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify if the checkbox is read only or not, ignored if \"hasCheckBox\" is false\r\n\t * \r\n\t * @param {Boolean or undefined} readOnly - Checkbox is readonly or not, ignored if hasCheckBox = false.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\treadOnly: function(readOnly) {\r\n\t\tif(readOnly === undefined) {\r\n\t\t\treturn this._readOnly;\r\n\t\t}\r\n\t\tthis._readOnly = readOnly ? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify the nodes which level is from 0 to \"expandLevel\" will be expanded when initialize tree.\r\n\t * \r\n\t * @param {Integer or undefined} expandLevel - Identify the nodes which level is from 0 to \"expandLevel\" will be expanded when initialize tree.\r\n\t * @return {Integer or this}\r\n\t */\r\n\texpandLevel: function(expandLevel) {\r\n\t\tif(expandLevel === undefined) {\r\n\t\t\treturn this._expandLevel;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTreeView.expandLevel', expandLevel).isGTEZero();\r\n\t\tthis._expandLevel = parseInt(expandLevel);\r\n\t},\r\n\t\r\n\tonItemClick: function(onItemClick) {\r\n\t\tif(onItemClick === undefined) {\r\n\t\t\treturn this._onItemClick;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTreeView.onItemClick', onItemClick).isFunction();\r\n\t\tthis._onItemClick = onItemClick;\r\n\t},\r\n\t\r\n\tonItemDblClick: function(onItemDblClick) {\r\n\t\tif(onItemDblClick === undefined) {\r\n\t\t\treturn this._onItemDblClick;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTreeView.onItemDblClick', onItemDblClick).isFunction();\r\n\t\tthis._onItemDblClick = onItemDblClick;\r\n\t},\r\n\t\r\n\tbeforeCheckBoxClick: function(beforeCheckBoxClick) {\r\n\t\tif(beforeCheckBoxClick === undefined) {\r\n\t\t\treturn this._beforeCheckBoxClick;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTreeView.beforeCheckBoxClick', beforeCheckBoxClick).isFunction();\r\n\t\tthis._beforeCheckBoxClick = beforeCheckBoxClick;\r\n\t},\r\n\t\r\n\tafterCheckBoxClick: function(afterCheckBoxClick) {\r\n\t\tif(afterCheckBoxClick === undefined) {\r\n\t\t\treturn this._afterCheckBoxClick;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTreeView.afterCheckBoxClick', afterCheckBoxClick).isFunction();\r\n\t\tthis._afterCheckBoxClick = afterCheckBoxClick;\r\n\t},\r\n\t\r\n\t/**\r\n\t * {Event} You can use this event to customize your tree node icon flexibly.\r\n\t * Pattern: \r\n\t *   function(keyValue, level, isLeaf){}\r\n\t *   //keyValue: String, key value of tree node;\r\n\t *   //level: Integer, tree node level;\r\n\t *   //isLeaf: Boolean, Identify if the tree node is the leaf node.\r\n\t */\r\n\tonGetIconClass: function(onGetIconClass) {\r\n\t\tif(onGetIconClass === undefined) {\r\n\t\t\treturn this._onGetIconClass;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTreeView.onGetIconClass', onGetIconClass).isFunction();\r\n\t\tthis._onGetIconClass = onGetIconClass;\r\n\t},\r\n\t\r\n\tonRenderItem: function(onRenderItem) {\r\n\t\tif(onRenderItem === undefined) {\r\n\t\t\treturn this._onRenderItem;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTreeView.onRenderItem', onRenderItem).isFunction();\r\n\t\tthis._onRenderItem = onRenderItem;\r\n\t},\r\n\t\r\n\tonCreateContextMenu: function(onCreateContextMenu) {\r\n\t\tif(onCreateContextMenu === undefined) {\r\n\t\t\treturn this._onCreateContextMenu;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBTreeView.onCreateContextMenu', onCreateContextMenu).isFunction();\r\n\t\tthis._onCreateContextMenu = onCreateContextMenu;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn el.tagName.toLowerCase() == 'div';\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\tZ.scrBarSize = jslet.scrollbarSize() + 1;\r\n\t\t\r\n\t\tif (Z._keyField === undefined) {\r\n\t\t\tZ._keyField = Z._dataset.keyField();\r\n\t\t}\r\n\t\tvar ti = jqEl.attr('tabindex');\r\n\t\tif (!ti) {\r\n\t\t\tjqEl.attr('tabindex', -1);\r\n\t\t}\r\n\t\tjqEl.keydown(function(event){\r\n\t\t\tif (Z._doKeydown(event.which)) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t}\r\n\t\t});\r\n\t\tjqEl.on('mouseenter', 'td.jl-tree-text', function(event){\r\n\t\t\tjQuery(this).addClass('jl-tree-nodes-hover');\r\n\t\t});\r\n\t\tjqEl.on('mouseleave', 'td.jl-tree-text', function(event){\r\n\t\t\tjQuery(this).removeClass('jl-tree-nodes-hover');\r\n\t\t});\r\n\t\tif (!jqEl.hasClass('jl-tree')) {\r\n\t\t\tjqEl.addClass('jl-tree');\r\n\t\t}\r\n        var notFF = ((typeof Z.el.onmousewheel) == 'object'); //firefox or nonFirefox browser\r\n        var wheelEvent = (notFF ? 'mousewheel' : 'DOMMouseScroll');\r\n        jqEl.on(wheelEvent, function (event) {\r\n            var originalEvent = event.originalEvent;\r\n            var num = notFF ? originalEvent.wheelDelta / -120 : originalEvent.detail / 3;\r\n            Z.listvm.setVisibleStartRow(Z.listvm.getVisibleStartRow() + num);\r\n       \t\tevent.preventDefault();\r\n        });\r\n\t\t\r\n\t\tZ.renderAll();\r\n\t\tZ.refreshControl(jslet.data.RefreshEvent.scrollEvent(this._dataset.recno()));\r\n\t\tZ._createContextMenu();\t\t\r\n\t\tjslet.resizeEventBus.subscribe(Z);\r\n\t}, // end bind\r\n\t\r\n\t/**\r\n\t * @override\r\n\t*/\r\n\trenderAll: function () {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\tZ.evaluator = new jslet.Expression(Z._dataset, Z.displayFields());\r\n\t\t\r\n\t\tjqEl.html('');\r\n\t\tZ.oldWidth = jqEl.width();\r\n\t\tZ.oldHeight = jqEl.height();\r\n\t\tZ.nodeHeight = Z.iconWidth =  parseInt(jslet.ui.getCssValue('jl-tree', 'line-height'));\r\n\t\tvar strHeight = jqEl[0].style.height; \r\n\t\tif(strHeight.indexOf('%') > 0) {\r\n\t\t\tZ.treePanelHeight = jqEl.parent().height() * parseFloat(strHeight) / 100;\r\n\t\t} else {\r\n\t\t\tZ.treePanelHeight = jqEl.height();\r\n\t\t}\r\n\t\tZ.treePanelWidth = jqEl.width();\r\n\t\tZ.nodeCount = Math.floor(Z.treePanelHeight / Z.nodeHeight);\r\n\r\n\t\tZ._initVm();\r\n\t\tZ._initFrame();\r\n\t}, // end renderAll\r\n\t\r\n\t_initFrame: function(){\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\t\t\r\n\t\tjqEl.find('.jl-tree-container').off();\r\n\t\tjqEl.find('.jl-tree-scrollbar').off();\r\n\t\t\t\r\n\t\tvar lines = [], i, cnt;\r\n\t\tfor(i = 0; i < 5; i++){//Default cells for lines is 5\r\n\t\t\tlines.push('<td class=\"jl-tree-lines\" ');\r\n\t\t\tlines.push(jslet.ui.DBTreeView.NODETYPE);\r\n\t\t\tlines.push('=\"0\"></td>');\r\n\t\t}\r\n\t\tvar s = lines.join(''),\r\n\t\t\ttmpl = ['<div class=\"jl-tree-container\">'];\r\n\t\tfor(i = 0, cnt = Z.nodeCount; i < cnt; i++){\r\n\t\t\ttmpl.push('<table class=\"jl-tree-nodes\" cellpadding=\"0\" cellspacing=\"0\"><tr>');\r\n\t\t\ttmpl.push(s);\r\n\t\t\ttmpl.push('<td class=\"jl-tree-expander\" ');\r\n\t\t\ttmpl.push(jslet.ui.DBTreeView.NODETYPE);//expander\r\n\t\t\ttmpl.push('=\"1\"></td><td ');\r\n\t\t\ttmpl.push(jslet.ui.DBTreeView.NODETYPE);//checkbox\r\n\t\t\ttmpl.push('=\"2\"></td><td ');\r\n\t\t\ttmpl.push(jslet.ui.DBTreeView.NODETYPE);//icon\r\n\t\t\ttmpl.push('=\"3\"></td><td class=\"jl-tree-text\" ');\r\n\t\t\ttmpl.push(jslet.ui.DBTreeView.NODETYPE);//text\r\n\t\t\ttmpl.push('=\"9\" nowrap=\"nowrap\"></td></tr></table>');\r\n\t\t}\r\n\t\ttmpl.push('</div><div class=\"jl-tree-scrollbar\"><div class=\"jl-tree-tracker\"></div></div>');\r\n\t\tjqEl.html(tmpl.join(''));\r\n\t\t\r\n\t\tvar treePnl = jqEl.find('.jl-tree-container');\r\n\t\ttreePnl.on('click', function(event){\r\n\t\t\tZ._doRowClick(event.target);\r\n\t\t});\r\n\t\ttreePnl.on('dblclick', function(event){\r\n\t\t\tZ._doRowDblClick(event.target);\r\n\t\t});\r\n\t\tZ.listvm.setVisibleCount(Z.nodeCount);\r\n\t\tvar sb = jqEl.find('.jl-tree-scrollbar');\r\n\t\t\r\n\t\tsb.on('scroll',function(){\r\n\t\t\tvar numb = Math.ceil(this.scrollTop/Z.nodeHeight);\r\n\t\t\tif (numb != Z.listvm.getVisibleStartRow()) {\r\n\t\t\t\tZ._skip_ = true;\r\n\t\t\t\ttry {\r\n\t\t\t\t\tZ.listvm.setVisibleStartRow(numb);\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tZ._skip_ = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\t\r\n\t},\r\n\t\r\n\tresize: function(){\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\theight = jqEl.height(),\r\n\t\t\twidth = jqEl.width();\r\n\t\tif (width != Z.oldWidth){\r\n\t\t\tZ.oldWidth = width;\r\n\t\t\tZ.treePanelWidth = jqEl.innerWidth();\r\n\t\t\tZ._fillData();\r\n\t\t}\r\n\t\tif (height != Z.oldHeight){\r\n\t\t\tZ.oldHeight = height;\r\n\t\t\tZ.treePanelHeight = jqEl.innerHeight();\r\n\t\t\tZ.nodeCount = Math.floor(height / Z.nodeHeight) - 1;\r\n\t\t\tZ._initFrame();\r\n\t\t}\r\n\t},\r\n\t\r\n\thasChildren: function() {\r\n\t\treturn this.listvm.hasChildren();\r\n\t},\r\n\t\r\n\t_initVm:function(){\r\n\t\tvar Z=this;\r\n\t\tZ.listvm = new jslet.ui.ListViewModel(Z._dataset, true);\r\n\t\tZ.listvm.refreshModel(Z._expandLevel);\r\n\t\tZ.listvm.fixedRows=0;\r\n\t\t\r\n\t\tZ.listvm.onTopRownoChanged=function(rowno){\r\n\t\t\trowno = Z.listvm.getCurrentRowno();\r\n\t\t\tZ._fillData();\r\n\t\t\tZ._doCurrentRowChanged(rowno);\r\n\t\t\tZ._syncScrollBar(rowno);\r\n\t\t};\r\n\t\t\r\n\t\tZ.listvm.onVisibleCountChanged=function(){\r\n\t\t\tZ._fillData();\r\n\t\t\tvar allCount = Z.listvm.getNeedShowRowCount();\r\n\t\t\tjQuery(Z.el).find('.jl-tree-tracker').height(Z.nodeHeight * allCount);\r\n\t\t};\r\n\t\t\r\n\t\tZ.listvm.onCurrentRownoChanged=function(prevRowno, rowno){\r\n\t\t\tZ._doCurrentRowChanged(rowno);\r\n\t\t};\r\n\t\t\r\n\t\tZ.listvm.onNeedShowRowsCountChanged = function(allCount){\r\n\t\t\tZ._fillData();\r\n\t\t\tjQuery(Z.el).find('.jl-tree-tracker').height(Z.nodeHeight * (allCount + 2));\r\n\t\t};\r\n\t\t\r\n\t\tZ.listvm.onCheckStateChanged = function(){\r\n\t\t\tZ._fillData();\r\n\t\t};\r\n\t},\r\n\t\r\n\t_doKeydown: function(keyCode){\r\n\t\tvar Z = this, result = false;\r\n\t\tif (keyCode === jslet.ui.KeyCode.SPACE){//space\r\n\t\t\tZ._doCheckBoxClick();\r\n\t\t\tresult = true;\r\n\t\t} else if (keyCode === jslet.ui.KeyCode.UP) {//KEY_UP\r\n\t\t\tZ.listvm.priorRow();\r\n\t\t\tresult = true;\r\n\t\t} else if (keyCode === jslet.ui.KeyCode.DOWN) {//KEY_DOWN\r\n\t\t\tZ.listvm.nextRow();\r\n\t\t\tresult = true;\r\n\t\t} else if (keyCode === jslet.ui.KeyCode.LEFT) {//KEY_LEFT\r\n\t\t\tif (jslet.locale.isRtl) {\r\n\t\t\t\tZ.listvm.expand();\r\n\t\t\t} else {\r\n\t\t\t\tZ.listvm.collapse();\r\n\t\t\t}\r\n\t\t\tresult = true;\r\n\t\t} else if (keyCode === jslet.ui.KeyCode.RIGHT) {//KEY_RIGHT\r\n\t\t\tif (jslet.locale.isRtl) {\r\n\t\t\t\tZ.listvm.collapse();\r\n\t\t\t} else {\r\n\t\t\t\tZ.listvm.expand();\r\n\t\t\t}\r\n\t\t\tresult = true;\r\n\t\t} else if (keyCode === jslet.ui.KeyCode.PAGEUP) {//KEY_PAGEUP\r\n\t\t\tZ.listvm.priorPage();\r\n\t\t\tresult = true;\r\n\t\t} else if (keyCode === jslet.ui.KeyCode.PAGEDOWN) {//KEY_PAGEDOWN\r\n\t\t\tZ.listvm.nextPage();\r\n\t\t\tresult = true;\r\n\t\t}\r\n\t\treturn result;\r\n\t},\r\n\t\r\n\t_getTrByRowno: function(rowno){\r\n\t\tvar nodes = jQuery(this.el).find('.jl-tree-nodes'), row;\r\n\t\tfor(var i = 0, cnt = nodes.length; i < cnt; i++){\r\n\t\t\trow = nodes[i].rows[0];\r\n\t\t\tif (row.jsletrowno == rowno) {\r\n\t\t\t\treturn row;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\t\r\n\t_doCurrentRowChanged: function(rowno){\r\n\t\tvar Z = this;\r\n\t\tif (Z.prevRow){\r\n\t\t\tjQuery(Z._getTextTd(Z.prevRow)).removeClass(jslet.ui.htmlclass.TREENODECLASS.selected);\r\n\t\t}\r\n\t\tvar otr = Z._getTrByRowno(rowno);\r\n\t\tif (otr) {\r\n\t\t\tjQuery(Z._getTextTd(otr)).addClass(jslet.ui.htmlclass.TREENODECLASS.selected);\r\n\t\t}\r\n\t\tZ.prevRow = otr;\r\n\t},\r\n\t\r\n\t_getTextTd: function(otr){\r\n\t\treturn otr.cells[otr.cells.length - 1];\r\n\t},\r\n\t\r\n\t_doExpand: function(){\r\n\t\tthis.expand();\r\n\t},\r\n\t\r\n\t_doRowClick: function(treeNode){\r\n\t\tvar Z = this,\r\n\t\t\tnodeType = treeNode.getAttribute(jslet.ui.DBTreeView.NODETYPE);\r\n\t\tif(!nodeType) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (nodeType != '0') {\r\n\t\t\tZ._syncToDs(treeNode);\r\n\t\t}\r\n\t\tif (nodeType == '1' || nodeType == '2'){ //expander\r\n\t\t\tvar item = Z.listvm.getCurrentRow();\r\n\t\t\tif (nodeType == '1' && item.children && item.children.length > 0){\r\n\t\t\t\tif (item.expanded) {\r\n\t\t\t\t\tZ.collapse();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tZ.expand();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (nodeType == '2'){//checkbox\r\n\t\t\t\tZ._doCheckBoxClick();\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(nodeType == '9') {\r\n\t\t\tZ._doCheckBoxClick();\r\n\t\t\tif(Z._onItemClick) {\r\n\t\t\t\tZ._onItemClick.call(Z);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\t_doRowDblClick: function(treeNode){\r\n\t\tthis._syncToDs(treeNode);\r\n\t\tvar nodeType = treeNode.getAttribute(jslet.ui.DBTreeView.NODETYPE);\r\n\t\tif (this._onItemDblClick && nodeType == '9') {\r\n\t\t\tthis._onItemDblClick.call(this);\r\n\t\t}\r\n\t},\r\n\t\r\n\t_doCheckBoxClick: function(){\r\n\t\tvar Z = this;\r\n\t\tif (Z._readOnly) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar node = Z.listvm.getCurrentRow();\r\n\t\tif(!node.hasCheckbox) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (Z._beforeCheckBoxClick && !Z._beforeCheckBoxClick.call(Z)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tZ.listvm.checkNode(!Z._dataset.selected()? 1:0, Z._correlateCheck, Z._onlyCheckChildren);\r\n\t\tif (Z._afterCheckBoxClick) {\r\n\t\t\tZ._afterCheckBoxClick.call(Z);\r\n\t\t}\r\n\t},\r\n\t\r\n\t_syncToDs: function(otr){\r\n\t\tvar rowno = -1, k;\r\n\t\twhile(true){\r\n\t\t\tk = otr.jsletrowno;\r\n\t\t\tif (k === 0 || k){\r\n\t\t\t\trowno = k;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\totr = otr.parentNode;\r\n\t\t\tif (!otr) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (rowno < 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.listvm.setCurrentRowno(rowno);\r\n\t\tthis._dataset.recno(this.listvm.getCurrentRecno());\r\n\t},\r\n\t\r\n\t_fillData: function(){\r\n\t\tvar Z = this,\r\n\t\t\tvCnt = Z.listvm.getVisibleCount(), \r\n\t\t\ttopRowno = Z.listvm.getVisibleStartRow(),\r\n\t\t\tallCnt = Z.listvm.getNeedShowRowCount(),\r\n\t\t\tavailbleCnt = vCnt + topRowno,\r\n\t\t\tindex = 0,\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\tnodes = jqEl.find('.jl-tree-nodes'), node;\r\n\t\tif (Z._isRendering) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tZ._isRendering = true;\r\n\t\tZ._skip_ = true;\r\n\t\tvar oldRecno = Z._dataset.recnoSilence(),\r\n\t\t\tpreRowNo = Z.listvm.getCurrentRowno(),\r\n\t\t\tajustScrBar = true, maxNodeWidth = 0, nodeWidth;\r\n\t\ttry{\r\n\t\t\tif (allCnt < availbleCnt){\r\n\t\t\t\tfor(var i = availbleCnt - allCnt; i > 0; i--){\r\n\t\t\t\t\tnode = nodes[vCnt - i];\r\n\t\t\t\t\tnode.style.display = 'none';\r\n\t\t\t\t}\r\n\t\t\t\tajustScrBar = false; \r\n\t\t\t} else {\r\n\t\t\t\tallCnt = availbleCnt;\r\n\t\t\t}\r\n\t\t\tvar endRow = allCnt - 1;\r\n\t\t\t\r\n\t\t\tfor(var k = topRowno; k <= endRow; k++){\r\n\t\t\t\tnode = nodes[index++];\r\n\t\t\t\tnodeWidth = Z._fillNode(node, k);\r\n\t\t\t\tif (ajustScrBar && maxNodeWidth < Z.treePanelWidth){\r\n\t\t\t\t\tif (k == endRow && nodeWidth < Z.treePanelWidth) {\r\n\t\t\t\t\t\tajustScrBar = false;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmaxNodeWidth = Math.max(maxNodeWidth, nodeWidth);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (k == endRow && ajustScrBar){\r\n\t\t\t\t\tnode.style.display = 'none';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnode.style.display = '';\r\n\t\t\t\t\tnode.jsletrowno = k;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} finally {\r\n\t\t\tZ.listvm.setCurrentRowno(preRowNo, false);\r\n\t\t\tZ._dataset.recnoSilence(oldRecno);\r\n\t\t\tZ._isRendering = false;\r\n\t\t\tZ._skip_ = false;\r\n\t\t}\r\n\t},\r\n\r\n\t_getCheckClassName: function(expanded){\r\n\t\tif (!expanded) {\r\n\t\t\treturn jslet.ui.htmlclass.TREECHECKBOXCLASS.unChecked;\r\n\t\t}\r\n\t\tif (expanded == 2) { //mixed checked\r\n\t\t\treturn jslet.ui.htmlclass.TREECHECKBOXCLASS.mixedChecked;\r\n\t\t}\r\n\t\treturn jslet.ui.htmlclass.TREECHECKBOXCLASS.checked;\r\n\t},\r\n\t\r\n\t_fillNode: function(nodeTbl, rowNo){\r\n\t\tvar row = nodeTbl.rows[0],\r\n\t\t\tZ = this,\r\n\t\t\titem = Z.listvm.setCurrentRowno(rowNo, true),\r\n\t\t\tcells = row.cells, \r\n\t\t\tcellCnt = cells.length, \r\n\t\t\trequiredCnt = item.level + 4,\r\n\t\t\totd, i, cnt;\r\n\t\tZ._dataset.recnoSilence(Z.listvm.getCurrentRecno());\r\n\t\trow.jsletrowno = rowNo;\r\n\t\tif (cellCnt < requiredCnt){\r\n\t\t\tfor(i = 1, cnt = requiredCnt - cellCnt; i <= cnt; i++){\r\n\t\t\t\totd = row.insertCell(0);\r\n\t\t\t\tjQuery(otd).addClass('jl-tree-lines').attr('jsletline', 1);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (cellCnt >= requiredCnt){\r\n\t\t\tfor(i = 0, cnt = cellCnt - requiredCnt; i < cnt; i++){\r\n\t\t\t\tcells[i].style.display = 'none';\r\n\t\t\t}\r\n\t\t\tfor(i = cellCnt - requiredCnt; i < requiredCnt; i++){\r\n\t\t\t\tcells[i].style.display = '';\r\n\t\t\t}\r\n\t\t}\r\n\t\tcellCnt = cells.length;\r\n\t\t//Line\r\n\t\tvar pitem = item, k = 1, totalWidth = Z.iconWidth * item.level;\r\n\t\tfor(i = item.level; i > 0; i--){\r\n\t\t\totd = row.cells[cellCnt- 4 - k++];\r\n\t\t\tpitem = pitem.parent;\r\n\t\t\tif (pitem.islast) {\r\n\t\t\t\totd.className = jslet.ui.htmlclass.TREELINECLASS.empty;\r\n\t\t\t} else {\r\n\t\t\t\totd.className = jslet.ui.htmlclass.TREELINECLASS.line;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//expander\r\n\t\tvar oexpander = row.cells[cellCnt- 4];\r\n\t\toexpander.noWrap = true;\r\n\t\toexpander.style.display = '';\r\n\t\tif (item.children && item.children.length > 0) {\r\n\t\t\tif (!item.islast) {\r\n\t\t\t\toexpander.className = item.expanded ? jslet.ui.htmlclass.TREELINECLASS.minus : jslet.ui.htmlclass.TREELINECLASS.plus;\r\n\t\t\t} else {\r\n\t\t\t\toexpander.className = item.expanded ? jslet.ui.htmlclass.TREELINECLASS.minusBottom : jslet.ui.htmlclass.TREELINECLASS.plusBottom;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (!item.islast) {\r\n\t\t\t\toexpander.className = jslet.ui.htmlclass.TREELINECLASS.join;\r\n\t\t\t} else {\r\n\t\t\t\toexpander.className = jslet.ui.htmlclass.TREELINECLASS.joinBottom;\r\n\t\t\t}\r\n\t\t}\r\n\t\ttotalWidth += Z.iconWidth;\r\n\t\t\t\t\r\n\t\t// CheckBox\r\n\t\tvar flag = Z._hasCheckBox && Z._dataset.checkSelectable();\r\n\t\tvar node = Z.listvm.getCurrentRow();\r\n\t\tnode.hasCheckbox = flag;\r\n\t\tvar ocheckbox = row.cells[cellCnt- 3];\r\n\t\tif (flag) {\r\n\t\t\tocheckbox.noWrap = true;\r\n\t\t\tocheckbox.className = Z._getCheckClassName(Z._dataset.selected());\r\n\t\t\tocheckbox.style.display = '';\r\n\t\t\ttotalWidth += Z.iconWidth;\r\n\t\t} else {\r\n\t\t\tocheckbox.style.display = 'none';\r\n\t\t}\r\n\t\t//Icon\r\n\t\tvar oIcon = row.cells[cellCnt- 2],\r\n\t\t\tclsName = 'jl-tree-icon',\r\n\t\t\ticonClsId = null;\r\n\r\n\t\tvar isLeaf = !(item.children && item.children.length > 0);\r\n\t\tif(Z._iconClassField || Z._onGetIconClass) {\r\n\t\t\tif(Z._iconClassField) {\r\n\t\t\t\ticonClsId = Z._dataset.getFieldValue(Z._iconClassField);\r\n\t\t\t} else if (Z._onGetIconClass) {\r\n\t\t\t\ticonClsId = Z._onGetIconClass.call(Z, Z._dataset.keyValue(), item.level, isLeaf); //keyValue, level, isLeaf\r\n\t\t\t}\r\n\t\t\tif (iconClsId) {\r\n\t\t\t\tclsName += ' '+ iconClsId;\r\n\t\t\t}\r\n\t\t\tif (oIcon.className != clsName) {\r\n\t\t\t\toIcon.className = clsName;\r\n\t\t\t}\r\n\t\t\toIcon.style.display = '';\r\n\t\t\ttotalWidth += Z.iconWidth;\r\n\t\t} else {\r\n\t\t\toIcon.style.display = 'none';\r\n\t\t}\r\n\t\t//Text\r\n\t\tvar text = Z.evaluator.eval() || '      ';\r\n\t\tjslet.ui.textMeasurer.setElement(Z.el);\r\n\t\tvar width = Math.round(jslet.ui.textMeasurer.getWidth(text)) + 10;\r\n\t\ttotalWidth += width + 10;\r\n\t\tjslet.ui.textMeasurer.setElement();\r\n\t\tvar oText = row.cells[cellCnt- 1];\r\n\t\toText.style.width = width + 'px';\r\n\t\tvar jqTd = jQuery(oText);\r\n\t\tjqTd.html(text);\r\n\t\tif (item.isbold) {\r\n\t\t\tjqTd.addClass('jl-tree-child-checked');\r\n\t\t} else {\r\n\t\t\tjqTd.removeClass('jl-tree-child-checked');\r\n\t\t}\r\n\t\tif(Z._onRenderItem) {\r\n\t\t\tZ._onRenderItem.call(Z, oIcon, oText, item.level, isLeaf); //keyValue, level, isLeaf\r\n\t\t}\r\n\t\treturn totalWidth;\r\n\t},\r\n\t\t\r\n\t_updateCheckboxState: function(){\r\n\t\tvar Z = this, \r\n\t\t\toldRecno = Z._dataset.recnoSilence(),\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\tnodes = jqEl.find('.jl-tree-nodes'),\r\n\t\t\trowNo, cellCnt, row;\r\n\t\ttry{\r\n\t\t\tfor(var i = 0, cnt = nodes.length; i < cnt; i++){\r\n\t\t\t\trow = nodes[i].rows[0];\r\n\t\t\t\tcellCnt = row.cells.length;\r\n\t\r\n\t\t\t\trowNo = row.jsletrowno;\r\n\t\t\t\tif(rowNo) {\r\n\t\t\t\t\tZ.listvm.setCurrentRowno(rowNo, true);\r\n\t\t\t\t\tZ._dataset.recnoSilence(Z.listvm.getCurrentRecno());\r\n\t\t\t\t\trow.cells[cellCnt- 3].className = Z._getCheckClassName(Z._dataset.selected());\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} finally {\r\n\t\t\tZ._dataset.recnoSilence(oldRecno);\r\n\t\t}\r\n\t},\r\n\t\r\n\t_syncScrollBar: function(){\r\n\t\tvar Z = this;\r\n\t\tif (Z._skip_) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tjQuery(Z.el).find('.jl-tree-scrollbar').scrollTop(Z.nodeHeight * Z.listvm.getVisibleStartRow());\r\n\t},\r\n\t\t\r\n\texpand: function () {\r\n\t\tthis.listvm.expand();\r\n\t},\r\n\t\r\n\tcollapse: function () {\r\n\t\tthis.listvm.collapse();\r\n\t},\r\n\t\r\n\texpandAll: function () {\r\n\t\tthis.listvm.expandAll();\r\n\t},\r\n\t\r\n\tcollapseAll: function () {\r\n\t\tthis.listvm.collapseAll();\r\n\t},\r\n\t\r\n\t_createContextMenu: function () {\r\n\t\tif (!jslet.ui.Menu) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar Z = this;\r\n\t\tvar menuCfg = { type: 'Menu', onItemClick: Z._menuItemClick, items: []};\r\n\t\tif (Z._hasCheckBox) {\r\n\t\t\tmenuCfg.items.push({ id: 'checkAll', name: jslet.locale.DBTreeView.checkAll });\r\n\t\t\tmenuCfg.items.push({ id: 'uncheckAll', name: jslet.locale.DBTreeView.uncheckAll });\r\n\t\t\tmenuCfg.items.push({ name: '-' });\r\n\t\t}\r\n\t\tmenuCfg.items.push({ id: 'expandAll', name: jslet.locale.DBTreeView.expandAll });\r\n\t\tmenuCfg.items.push({ id: 'collapseAll', name: jslet.locale.DBTreeView.collapseAll});\r\n\t\tif (Z._onCreateContextMenu) {\r\n\t\t\tZ._onCreateContextMenu.call(Z, menuCfg.items);\r\n\t\t}\r\n\t\tif (menuCfg.items.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tZ.contextMenu = jslet.ui.createControl(menuCfg);\r\n\t\tjQuery(Z.el).on('contextmenu', function (event) {\r\n\t\t\tvar node = event.target,\r\n\t\t\t\tnodeType = node.getAttribute(jslet.ui.DBTreeView.NODETYPE);\r\n\t\t\tif(!nodeType || nodeType == '0') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tZ._syncToDs(node);\r\n\t\t\tZ.contextMenu.showContextMenu(event, Z);\r\n\t\t});\r\n\t},\r\n\t\r\n\t_menuItemClick: function (menuid, checked) {\r\n\t\tif (menuid == 'expandAll') {\r\n\t\t\tthis.expandAll();\r\n\t\t} else if (menuid == 'collapseAll') {\r\n\t\t\tthis.collapseAll();\r\n\t\t} else if (menuid == 'checkAll') {\r\n\t\t\tthis.listvm.checkChildNodes(true, this._correlateCheck);\r\n\t\t} else if (menuid == 'uncheckAll') {\r\n\t\t\tthis.listvm.checkChildNodes(false, this._correlateCheck);\r\n\t\t}\r\n\t},\r\n\t\r\n\trefreshControl: function (evt) {\r\n\t\tvar Z = this,\r\n\t\t\tevtType = evt.eventType;\r\n\t\tif (evtType == jslet.data.RefreshEvent.CHANGEMETA) {\r\n\t\t\t//empty\r\n\t\t} else if (evtType == jslet.data.RefreshEvent.UPDATEALL) {\r\n\t\t\tZ.renderAll();\r\n\t\t} else if (evtType == jslet.data.RefreshEvent.INSERT ||\r\n\t\t\tevtType == jslet.data.RefreshEvent.DELETE){\r\n\t\t\tZ.listvm.refreshModel(Z._expandLevel);\r\n\t\t\tif(evtType == jslet.data.RefreshEvent.INSERT) {\r\n\t\t\t\tZ.listvm.syncDataset();\r\n\t\t\t}\r\n\t\t} else if (evtType == jslet.data.RefreshEvent.UPDATERECORD ||\r\n\t\t\tevtType == jslet.data.RefreshEvent.UPDATECOLUMN){\r\n\t\t\tZ._fillData();\r\n\t\t} else if (evtType == jslet.data.RefreshEvent.SELECTALL) {\r\n\t\t\tif (Z._hasCheckBox) {\r\n\t\t\t\tZ._fillData();\r\n\t\t\t}\r\n\t\t} else if (evtType == jslet.data.RefreshEvent.SELECTRECORD) {\r\n\t\t\tif (Z._hasCheckBox) {\r\n\t\t\t\tZ.listvm.checkNode(Z._dataset.selected(), Z._correlateCheck, Z._onlyCheckChildren);\r\n\t\t\t}\r\n\t\t} else if (evtType == jslet.data.RefreshEvent.SCROLL) {\r\n\t\t\tZ.listvm.syncDataset();\r\n\t\t}\r\n\t}, // end refreshControl\r\n\t\t\r\n\t/**\r\n\t * Run when container size changed, it's revoked by jslet.resizeeventbus.\r\n\t * \r\n\t */\r\n\tcheckSizeChanged: function(){\r\n\t\tthis.resize();\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\t\r\n\t\tjslet.resizeEventBus.unsubscribe(Z);\r\n\t\tjqEl.find('.jl-tree-nodes').off();\r\n\t\tZ.listvm.destroy();\r\n\t\tZ.listvm = null;\r\n\t\tZ.prevRow = null;\r\n\t\t\r\n\t\t$super();\r\n\t}\r\n});\r\n\r\njslet.ui.htmlclass.TREELINECLASS = {\r\n\t\tline : 'jl-tree-lines jl-tree-line',// '|'\r\n\t\tjoin : 'jl-tree-lines jl-tree-join',// |-\r\n\t\tjoinBottom : 'jl-tree-lines jl-tree-join-bottom',// |_\r\n\t\tminus : 'jl-tree-lines jl-tree-minus',// O-\r\n\t\tminusBottom : 'jl-tree-lines jl-tree-minus-bottom',// o-_\r\n\t\tnoLineMinus : 'jl-tree-lines jl-tree-noline-minus',// o-\r\n\t\tplus : 'jl-tree-lines jl-tree-plus',// o+\r\n\t\tplusBottom : 'jl-tree-lines jl-tree-plus-bottom',// o+_\r\n\t\tnoLinePlus : 'jl-tree-lines jl-tree-noline-plus',// o+\r\n\t\tempty : 'jl-tree-empty'\r\n};\r\njslet.ui.htmlclass.TREECHECKBOXCLASS = {\r\n//\t\tcheckbox : 'jl-tree-checkbox',\r\n\tchecked : 'jl-tree-checkbox jl-tree-checked',\r\n\tunChecked : 'jl-tree-checkbox jl-tree-unchecked',\r\n\tmixedChecked : 'jl-tree-checkbox jl-tree-mixedchecked'\r\n};\r\n\r\njslet.ui.htmlclass.TREENODECLASS = {\r\n\tselected : 'jl-tree-selected',\r\n\tchildChecked : 'jl-tree-child-checked',\r\n\ttreeNodeLevel : 'jl-tree-child-level'\r\n};\r\n\r\njslet.ui.DBTreeView.NODETYPE = 'data-nodetype';\r\n\r\njslet.ui.register('DBTreeView', jslet.ui.DBTreeView);\r\njslet.ui.DBTreeView.htmlTemplate = '<div></div>';\r\n\r\n\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * Inner Class for DBTable and DBTreeView control\r\n */\r\n\"use strict\";\r\njslet.ui.ListViewModel = function (dataset, isTree) {// boolean, identify if it's tree model\r\n\tvar visibleCount = 0,\r\n\t\tvisibleStartRow = 0,\r\n\t\tvisibleEndRow = 0,\r\n\t\tneedShowRows = null,//Array of all rows that need show, all of these rows's status will be 'expanded'\r\n\t\tallRows = null,//Array of all rows, include 'expanded' and 'collapsed' rows\r\n\t\tcurrentRowno = 0,\r\n\t\tcurrentRecno = 0;\r\n\tthis.onTopRownoChanged = null; //Event handler: function(rowno){}\r\n\tthis.onVisibleCountChanged = null; //Event handler: function(visibleRowCount){}\r\n\tthis.onCurrentRownoChanged = null; //Event handler: function(rowno){}\r\n\tthis.onNeedShowRowsCountChanged = null; //Event handler: function(needShowCount){}\r\n\tthis.onCheckStateChanged = null;  //Event handler: function(){}\r\n\t\t\r\n\tthis.fixedRows = 0;\r\n\tvar initial = function () {\r\n\t\tif (!isTree) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar ds = dataset;\r\n\t\tif (!ds._parentField || !ds._keyField) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t};\r\n\tinitial();\r\n\t\r\n\tthis.refreshModel = function (expandLevel) {\r\n\t\tif (!isTree) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(expandLevel === undefined) {\r\n\t\t\texpandLevel = -1;\r\n\t\t}\r\n\t\tvar dsObj = dataset, \r\n\t\t\thiddenCnt = 0, \r\n\t\t\trecno, \r\n\t\t\tallCnt = dsObj.recordCount(), \r\n\t\t\tchildCnt, \r\n\t\t\tresult = [], \r\n\t\t\tpId,\r\n\t\t\toldRecno = dsObj.recnoSilence();\r\n\t\ttry {\r\n\t\t\tdsObj.recnoSilence(this.fixedRows);\r\n\t\t\tvar level = 0, \r\n\t\t\t\tpnodes = [], \r\n\t\t\t\tnode, pnode, \r\n\t\t\t\ttmpNode, tmpKeyValue,\r\n\t\t\t\tcurrRec, keyValue, recCnt;\r\n\t\t\tfor(recno = 0, recCnt = dsObj.recordCount(); recno < recCnt; recno++) {\r\n\t\t\t\tdsObj.recnoSilence(recno);\r\n\t\t\t\tkeyValue = dsObj.keyValue();\r\n\t\t\t\tlevel = 0;\r\n\t\t\t\tpnode = null;\r\n\t\t\t\tpId = dsObj.parentValue();\r\n\t\t\t\tfor(var m = pnodes.length - 1; m>=0; m--) {\r\n\t\t\t\t\ttmpNode = pnodes[m];\r\n\t\t\t\t\ttmpKeyValue = tmpNode.keyvalue; \r\n\t\t\t\t\tif (tmpKeyValue !== null && \r\n\t\t\t\t\t\ttmpKeyValue !== undefined && \r\n\t\t\t\t\t\ttmpKeyValue !== '' && \r\n\t\t\t\t\t\ttmpKeyValue == pId) {\r\n\t\t\t\t\t\tlevel = tmpNode.level + 1;\r\n\t\t\t\t\t\tpnode = tmpNode;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (pnode){\r\n\t\t\t\t\tfor(var k = pnodes.length - 1; k > m; k--) {\r\n\t\t\t\t\t\tpnodes.pop();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tcurrRec = dsObj.getRecord();\r\n\t\t\t\tvar expanded = true;\r\n\t\t\t\tif(expandLevel >= 0 && level <= expandLevel) {\r\n\t\t\t\t\texpanded = true;\r\n\t\t\t\t} else { \r\n\t\t\t\t\texpanded = dsObj.expanded();\r\n\t\t\t\t}\r\n\t\t\t\tnode = { parent: pnode, recno: recno, keyvalue: keyValue, expanded: expanded, isbold: 0, level: level };\r\n\t\t\t\tpnodes.push(node);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\tif (pnode){\r\n\t\t\t\t\tif (!pnode.children) {\r\n\t\t\t\t\t\tpnode.children = [];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpnode.children.push(node);\r\n\t\t\t\t\tthis._updateParentNodeBoldByChecked(node);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.push(node);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t} //end for recno\r\n\t\t} finally {\r\n\t\t\tdsObj.recnoSilence(oldRecno);\r\n\t\t}\r\n\t\tallRows = result;\r\n\t\tthis._setLastFlag(result);\r\n\t\tthis._refreshNeedShowRows();\r\n\t};\r\n\t\t\r\n\tthis._updateParentNodeBoldByChecked = function(node){\r\n\t\tif (!dataset.selectedByRecno(node.recno) || !node.parent) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar pnode = node.parent;\r\n\t\twhile(true){\r\n\t\t\tif (pnode.isbold) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tpnode.isbold = 1;\r\n\t\t\tpnode = pnode.parent;\r\n\t\t\tif (!pnode) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tthis._updateParentNodeBoldByNotChecked = function(node){\r\n\t\tif (dataset.selectedByRecno(node.recno) || !node.parent) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar pnode = node.parent, cnode;\r\n\t\twhile(true){\r\n\t\t\tif (pnode.children){\r\n\t\t\t\tfor(var i = 0, cnt = pnode.children.length; i < cnt; i++){\r\n\t\t\t\t\tcnode = pnode.children[i];\r\n\t\t\t\t\tif (dataset.selectedByRecno(cnode.recno)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tpnode.isbold = 0;\r\n\t\t\t}\r\n\t\t\tpnode = pnode.parent;\r\n\t\t\tif (!pnode) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t\t\r\n\tthis._setLastFlag = function (nodes) {\r\n\t\tif (!nodes || nodes.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar node;\r\n\t\tnodes[nodes.length - 1].islast = true;\r\n\t\tfor (var i = 0, cnt = nodes.length; i < cnt; i++) {\r\n\t\t\tnode = nodes[i];\r\n\t\t\tif (node.children && node.children.length > 0) {\r\n\t\t\t\tthis._setLastFlag(node.children);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n\t\r\n\tthis._refreshNeedShowRows = function (notFireChangedEvent) {\r\n\t\tif (!isTree) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar result = [], node;\r\n\t\tif (!allRows) {\r\n\t\t\tthis.refreshModel();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar preCnt = needShowRows ? needShowRows.length: 0;\r\n\t\tneedShowRows = [];\r\n\t\tthis._findVisibleNode(allRows);\r\n\t\tvar currCnt = needShowRows.length;\r\n\t\tif (!notFireChangedEvent && this.onNeedShowRowsCountChanged){\r\n\t\t\tthis.onNeedShowRowsCountChanged(currCnt);\r\n\t\t}\r\n\t};\r\n\t\r\n\tthis.hasChildren = function (recno) {\r\n\t\tif (!isTree) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (!recno) {\r\n\t\t\trecno = dataset.recno();\r\n\t\t}\r\n\t\tvar node = this._innerFindNode(allRows, recno);\r\n\t\tif (node === null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\treturn node.children && node.children.length > 0;\r\n\t};\r\n\t\r\n\tthis.getLevel = function (recno) {\r\n\t\tif (!isTree) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (!recno) {\r\n\t\t\trecno = dataset.recno();\r\n\t\t}\r\n\t\tvar node = this._innerFindNode(allRows, recno);\r\n\t\tif (node === null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\treturn node.level;\r\n\t};\r\n\t\r\n\tthis._findVisibleNode = function (nodes) {\r\n\t\tif (!nodes) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar node;\r\n\t\tfor (var i = 0, cnt = nodes.length; i < cnt; i++) {\r\n\t\t\tnode = nodes[i];\r\n\t\t\tneedShowRows.push(node);\r\n\t\t\tif (node.expanded){\r\n\t\t\t\tthis._findVisibleNode(node.children);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t\r\n\tthis.rownoToRecno = function (rowno) {\r\n\t\tif (!isTree) {\r\n\t\t\treturn rowno + this.fixedRows;\r\n\t\t}\r\n\t\tif (rowno < 0) {\r\n\t\t\trowno = rowno + this.fixedRows;\r\n\t\t\treturn rowno >= 0 ? rowno : -1;\r\n\t\t}\r\n\t\tif (rowno >= needShowRows.length) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\treturn needShowRows[rowno].recno;\r\n\t};\r\n\t\r\n\tthis.recnoToRowno = function (recno) {\r\n\t\tif (!isTree) {\r\n\t\t\treturn recno - this.fixedRows;\r\n\t\t}\r\n\t\tfor(var i = 0, cnt = needShowRows.length; i < cnt; i++){\r\n\t\t\tif (needShowRows[i].recno == recno) {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1;\r\n\t};\r\n\t\r\n\tthis.setVisibleStartRow = function (rowno, notFireEvt) {\r\n\t\tif (rowno >= 0) {\r\n\t\t\tvar maxVisibleNo = this.getNeedShowRowCount() + 1 - visibleCount;\r\n\t\t\tif (rowno > maxVisibleNo) {\r\n\t\t\t\trowno = maxVisibleNo;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (rowno < 0) {\r\n\t\t\trowno = 0;\r\n\t\t}\r\n\t\tif (visibleStartRow == rowno) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvisibleStartRow = rowno;\r\n\t\tvisibleEndRow = rowno + visibleCount - 1;\r\n\t\tif (!notFireEvt && this.onTopRownoChanged) {\r\n\t\t\tthis.onTopRownoChanged(rowno);\r\n\t\t}\r\n\t};\r\n\t\r\n\tthis.getVisibleStartRow = function () {\r\n\t\treturn visibleStartRow;\r\n\t};\r\n\t\r\n\tthis.setVisibleEndRow = function(endRow){\r\n\t\tvisibleEndRow = endRow;\r\n\t};\r\n\t\r\n\tthis.getVisibleEndRow = function(){\r\n\t\treturn visibleEndRow;\r\n\t};\r\n\t\r\n\tthis.setVisibleCount = function (count, notFireEvt) {\r\n\t\tif (visibleCount == count) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvisibleCount = count;\r\n\t\tvisibleEndRow = visibleStartRow + count - 1;\r\n\t\tif (!notFireEvt && this.onVisibleCountChanged) {\r\n\t\t\tthis.onVisibleCountChanged(count);\r\n\t\t}\r\n\t};\r\n\t\r\n\tthis.getVisibleCount = function () {\r\n\t\treturn visibleCount;\r\n\t};\r\n\t\r\n\tthis.getNeedShowRowCount = function () {\r\n\t\tif (!isTree) {\r\n\t\t\treturn dataset.recordCount()- this.fixedRows;\r\n\t\t}\r\n\t\treturn needShowRows.length;\r\n\t};\r\n\t\r\n\tthis.getCurrentRow = function(){\r\n\t\treturn needShowRows[currentRowno];\r\n\t};\r\n\t\r\n\tthis.skipSetCurrentRowno = function() {\r\n\t\tthis._skipSetCurrentRowno = true;\r\n\t};\r\n\t\r\n\tthis.setCurrentRowno = function (rowno, notFireEvt, checkVisible) {\r\n\t\tif(this._skipSetCurrentRowno) {\r\n\t\t\tthis._skipSetCurrentRowno = false;\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif(rowno === undefined) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar preRowno = currentRowno, recno = 0, currRow=null;\r\n\t\tif (rowno < 0){//In the fixed row area\r\n\t\t\tvar lowestRowno = -1 * this.fixedRows;\r\n\t\t\tif (rowno < lowestRowno) {\r\n\t\t\t\trowno = lowestRowno;\r\n\t\t\t}\r\n\t\t\trecno = this.fixedRows + rowno;\r\n\t\t} else {\r\n\t\t\tvar maxRow = this.getNeedShowRowCount();\r\n\t\t\tif(maxRow === 0) {\r\n\t\t\t\tcurrentRowno = 0;\r\n\t\t\t\tcurrentRecno = -1;\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tif (rowno >= maxRow) {\r\n\t\t\t\trowno = maxRow - 1;\r\n\t\t\t}\r\n\t\t\tif (!isTree) {\r\n\t\t\t\trecno = rowno + this.fixedRows;\r\n\t\t\t} else {\r\n\t\t\t\tcurrRow = needShowRows[rowno];\r\n\t\t\t\trecno = currRow.recno;\r\n\t\t\t}\r\n\t\t\tif (checkVisible) {\r\n\t\t\t\tif (rowno >= 0 && rowno < visibleStartRow){\r\n\t\t\t\t\tthis.setVisibleStartRow(rowno);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (rowno >= visibleStartRow + visibleCount) {\r\n\t\t\t\t\t\tthis.setVisibleStartRow(rowno - visibleCount + 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n//\t\tif (recno >= 0){\r\n//\t\t\tif(!dataset.recno(recno)) {\r\n//\t\t\t\treturn null;\r\n//\t\t\t}\r\n//\t\t}\r\n\t\tcurrentRowno = rowno;\r\n\t\tcurrentRecno = recno;\r\n\t\tif (!notFireEvt && this.onCurrentRownoChanged) {\r\n\t\t\tthis.onCurrentRownoChanged(preRowno, currentRowno);\r\n\t\t}\r\n\t\treturn currRow;\r\n\t};\r\n\t\r\n\tthis.getCurrentRowno = function () {\r\n\t\treturn currentRowno;\r\n\t};\r\n\t\r\n\tthis.getCurrentRecno = function() {\r\n\t\treturn currentRecno;\r\n\t};\r\n\t\r\n\tthis.nextRow = function () {\r\n\t\tdataset.confirm();\r\n\t\tthis.setCurrentRowno(currentRowno + 1, false, true);\r\n\t};\r\n\t\r\n\tthis.priorRow = function (num) {\r\n\t\tdataset.confirm();\r\n\t\tthis.setCurrentRowno(currentRowno - 1, false, true);\r\n\t};\r\n\t\r\n\tthis.nextPage = function () {\r\n\t\tdataset.confirm();\r\n\t\tthis.setVisibleStartRow(visibleStartRow + visibleCount);\r\n\t\tthis.setCurrentRowno(visibleStartRow);\r\n\t};\r\n\t\r\n\tthis.priorPage = function () {\r\n\t\tdataset.confirm();\r\n\t\tthis.setVisibleStartRow(visibleStartRow - visibleCount);\r\n\t\tthis.setCurrentRowno(visibleStartRow);\r\n\t};\r\n\t\r\n\tthis._innerFindNode = function (nodes, recno) {\r\n\t\tvar node, nextNode;\r\n\t\tfor (var i = 0, cnt = nodes.length - 1; i <= cnt; i++) {\r\n\t\t\tnode = nodes[i];\r\n\t\t\tif (node.recno == recno) {\r\n\t\t\t\treturn node;\r\n\t\t\t}\r\n\t\t\tif (node.children) {\r\n\t\t\t\tvar result = this._innerFindNode(node.children, recno);\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n\t\r\n\tthis.expand = function (callbackFn) {\r\n\t\tif (!isTree) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar node = this._innerFindNode(allRows, dataset.recno());\r\n\t\tif (node === null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tdataset.confirm();\r\n\t\tvar oldRecno = dataset.recnoSilence();\r\n\t\ttry {\r\n\t\t\tnode.expanded = node.children ? true : false;\r\n\t\t\tdataset.recnoSilence(node.recno);\r\n\t\t\tdataset.expanded(node.expanded);\r\n\t\t\tvar p = node;\r\n\t\t\twhile (true) {\r\n\t\t\t\tp = p.parent;\r\n\t\t\t\tif (!p) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (!p.expanded) {\r\n\t\t\t\t\tdataset.recnoSilence(p.recno);\r\n\t\t\t\t\tdataset.expanded(true);\r\n\t\t\t\t\tp.expanded = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} finally {\r\n\t\t\tdataset.recnoSilence(oldRecno);\r\n\t\t}\r\n\t\tthis._refreshNeedShowRows();\r\n\t\tif (callbackFn) {\r\n\t\t\tcallbackFn();\r\n\t\t}\r\n\t};\r\n\t\r\n\tthis.collapse = function (callbackFn) {\r\n\t\tif (!isTree) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar node = this._innerFindNode(allRows, dataset.recno());\r\n\t\tif (node === null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tdataset.confirm();\r\n\t\tvar oldRecno = dataset.recnoSilence();\r\n\t\ttry {\r\n\t\t\tdataset.recnoSilence(node.recno);\r\n\t\t\tdataset.expanded(false);\r\n\t\t\tnode.expanded = false;\r\n\t\t} finally {\r\n\t\t\tdataset.recnoSilence(oldRecno);\r\n\t\t}\r\n\t\t\r\n\t\tthis._refreshNeedShowRows();\r\n\t\tif (callbackFn) {\r\n\t\t\tcallbackFn();\r\n\t\t}\r\n\t};\r\n\t\r\n\tthis._iterateNode = function (nodes, callbackFn) {\r\n\t\tvar node;\r\n\t\tfor (var i = 0, cnt = nodes.length; i < cnt; i++) {\r\n\t\t\tnode = nodes[i];\r\n\t\t\tif (node.children) {\r\n\t\t\t\tif (callbackFn) {\r\n\t\t\t\t\tcallbackFn(node);\r\n\t\t\t\t}\r\n\t\t\t\tif (node.children && node.children.length > 0) {\r\n\t\t\t\t\tthis._iterateNode(node.children, callbackFn);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n\t\r\n\tthis._callbackFn = function (node, expanded) {\r\n\t\tvar oldRecno = dataset.recnoSilence();\r\n\t\ttry {\r\n\t\t\tdataset.recnoSilence(node.recno);\r\n\t\t\tdataset.expanded(expanded);\r\n\t\t\tnode.expanded = expanded;\r\n\t\t} finally {\r\n\t\t\tdataset.recnoSilence(oldRecno);\r\n\t\t}\r\n\t};\r\n\t\r\n\tthis.expandAll = function (callbackFn) {\r\n\t\tif (!isTree) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tdataset.confirm();\r\n\t\tvar Z = this;\r\n\t\tZ._iterateNode(allRows, function (node) {\r\n\t\t\tZ._callbackFn(node, true); \r\n\t\t});\r\n\t\tZ._refreshNeedShowRows();\r\n\t\tif (callbackFn) {\r\n\t\t\tcallbackFn();\r\n\t\t}\r\n\t};\r\n\t\r\n\tthis.collapseAll = function (callbackFn) {\r\n\t\tif (!isTree) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tdataset.confirm();\r\n\t\tvar Z = this;\r\n\t\tZ._iterateNode(allRows, function (node) {\r\n\t\t\tZ._callbackFn(node, false); \r\n\t\t});\r\n\t\tZ._refreshNeedShowRows();\r\n\t\tif (callbackFn) {\r\n\t\t\tcallbackFn();\r\n\t\t}\r\n\t};\r\n\t\r\n\tthis.syncDataset = function(){\r\n\t\tvar recno = dataset.recno();\r\n\t\tif(recno < 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar node = this._innerFindNode(allRows, dataset.recno()),\r\n\t\t\tpnode = node.parent;\r\n\t\tif (pnode && !pnode.expanded){\r\n\t\t\twhile(true){\r\n\t\t\t\tif (!pnode.expanded) {\r\n\t\t\t\t\tpnode.expanded = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tpnode = pnode.parent;\r\n\t\t\t\tif (!pnode) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._refreshNeedShowRows();\r\n\t\tvar rowno = this.recnoToRowno(recno);\r\n\t\tthis.setCurrentRowno(rowno, false, true);\r\n\t};\r\n\t\r\n\tthis.checkNode = function(state, relativeCheck, onlyCheckChildren){\r\n\t\tvar node = this.getCurrentRow();\r\n//\t\tif (node.state == state) {\r\n//\t\t\treturn;\r\n//\t\t}\r\n\t\tdataset.selected(state ? 1 : 0);\r\n\r\n\t\tif (relativeCheck){\r\n\t\t\tif (node.children && node.children.length > 0) {\r\n\t\t\t\tthis._updateChildState(node, state);\r\n\t\t\t}\r\n\t\t\tif (node.parent && !onlyCheckChildren) {\r\n\t\t\t\tthis._updateParentState(node, state);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (state) {\r\n\t\t\tthis._updateParentNodeBoldByChecked(node);\r\n\t\t} else {\r\n\t\t\tthis._updateParentNodeBoldByNotChecked(node);\r\n\t\t}\r\n\t\t\r\n\t\tif (this.onCheckStateChanged) {\r\n\t\t\tthis.onCheckStateChanged();\r\n\t\t}\r\n\t};\r\n\t\r\n\tthis.checkChildNodes = function(state, relativeCheck){\r\n\t\tvar node = this.getCurrentRow();\r\n\t\tdataset.selected(state ? 1 : 0);\r\n\r\n\t\tif (node.children && node.children.length > 0) {\r\n\t\t\tthis._updateChildState(node, state);\r\n\t\t}\r\n\t\tif (relativeCheck){\r\n\t\t\tif (node.parent) {\r\n\t\t\t\tthis._updateParentState(node, state);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (state) {\r\n\t\t\tthis._updateParentNodeBoldByChecked(node);\r\n\t\t} else {\r\n\t\t\tthis._updateParentNodeBoldByNotChecked(node);\r\n\t\t}\r\n\t\t\r\n\t\tif (this.onCheckStateChanged) {\r\n\t\t\tthis.onCheckStateChanged();\r\n\t\t}\r\n\t};\r\n\t\r\n\tthis._updateChildState = function(node, state){\r\n\t\tvar oldRecno = dataset.recnoSilence(),\r\n\t\t\tchildNode;\r\n\t\ttry{\r\n\t\t\tfor(var i = 0, cnt = node.children.length; i < cnt; i++){\r\n\t\t\t\tchildNode = node.children[i];\r\n\t\t\t\tdataset.recnoSilence(childNode.recno);\r\n\t\t\t\tdataset.selected(state);\r\n\t\t\t\tif (childNode.children && childNode.children.length > 0) {\r\n\t\t\t\t\tthis._updateChildState(childNode, state);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} finally {\r\n\t\t\tdataset.recnoSilence(oldRecno);\r\n\t\t}\r\n\t};\r\n\t\r\n\tthis._updateParentState = function(node, state){\r\n\t\tvar pNode = node.parent;\r\n\t\tif (!pNode) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar childNode, newState, childState;\r\n\t\tif (state != 2){\r\n\t\t\tfor(var i = 0, cnt = pNode.children.length; i < cnt; i++){\r\n\t\t\t\tchildNode = pNode.children[i];\r\n\t\t\t\tchildState = dataset.selectedByRecno(childNode.recno);\r\n\t\t\t\tif (childState == 2){\r\n\t\t\t\t\tnewState = 2;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (i === 0){\r\n\t\t\t\t\tnewState = childState;\r\n\t\t\t\t} else if (newState != childState){\r\n\t\t\t\t\tnewState =2;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}//end for\r\n\t\t} else {\r\n\t\t\tnewState = state;\r\n\t\t}\r\n\t\tvar pState = dataset.selectedByRecno(pNode.recno);\r\n\t\tif (pState != newState){\r\n\t\t\tvar oldRecno = dataset.recnoSilence();\r\n\t\t\ttry{\r\n\t\t\t\tdataset.recnoSilence(pNode.recno);\r\n\t\t\t\tdataset.selected(newState);\r\n\t\t\t}finally{\r\n\t\t\t\tdataset.recnoSilence(oldRecno);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._updateParentState(pNode, newState);\r\n\t};\r\n\t\r\n\tthis.reset = function() {\r\n\t\tvisibleCount = 0;\r\n\t\tvisibleStartRow = 0;\r\n\t\tvisibleEndRow = 0;\r\n\t\tneedShowRows = null;\r\n\t\tallRows = null;\r\n\t\tcurrentRowno = 0;\r\n\t\tcurrentRecno = 0;\r\n\t\tthis.fixedRows = 0;\r\n\t};\r\n\t\r\n\tthis.destroy = function(){\r\n\t\tdataset = null;\r\n\t\tallRows = null;\r\n\t\tthis.reset();\r\n\t\tthis.onTopRownoChanged = null;\r\n\t\tthis.onVisibleCountChanged = null;\r\n\t\tthis.onCurrentRownoChanged = null;\r\n\t\tthis.onNeedShowRowsCountChanged = null;\r\n\t\tthis.onCheckStateChanged = null;\r\n\t};\r\n};\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBPlace. \r\n * It's an placeholder for other dbcontrols.\r\n * Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"DBPlace\",dataset: \"dataset\", \"field\":\"fieldName\"};\r\n *\r\n * //1. Declaring:\r\n *  &lt;div data-jslet='jsletParam' />\r\n *\r\n *  //2. Binding\r\n *  &lt;div id=\"ctrlId\"  />\r\n * //Js snippet\r\n * var el = document.getElementById('ctrlId');\r\n * jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n * jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBPlace = jslet.Class.create(jslet.ui.DBFieldControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tthis.allProperties = 'styleClass,dataset,field,expandChildWidth';\r\n\t\tthis.editControl = null;\r\n\t\tthis._expandChildWidth = true;\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\tvar tagName = el.tagName.toLowerCase();\r\n\t\treturn tagName == 'div';\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tvar Z = this;\r\n\t\tZ.renderAll();\r\n\t},\r\n\t\r\n\texpandChildWidth: function(expandChildWidth) {\r\n\t\tif(expandChildWidth === undefined) {\r\n\t\t\treturn this._expandChildWidth;\r\n\t\t}\r\n\t\tthis._expandChildWidth = expandChildWidth? true: false;\r\n\t\treturn this;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trefreshControl: function (evt) {\r\n\t\tvar Z = this,\r\n\t\t\tevtType = evt.eventType;\r\n\t\t// Meta changed \r\n\t\tif (evtType == jslet.data.RefreshEvent.CHANGEMETA &&\r\n\t\t\tZ._field == evt.fieldName && \r\n\t\t\t(evt.metaName == 'editControl' || evt.metaName == 'valueStyle')) {\r\n\t\t\tZ.renderAll();\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}, // end refreshControl\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tvar Z = this;\r\n\t\tZ.removeAllChildControls();\r\n\t\tvar\tfldObj = Z._dataset.getField(Z._field),\r\n\t\t\tparam = fldObj.editControl();\r\n\t\tif (fldObj.valueStyle() == jslet.data.FieldValueStyle.BETWEEN) {\r\n\t\t\tparam = {\r\n\t\t\t\ttype: 'DBBetweenEdit'\r\n\t\t\t};\r\n\t\t}\r\n\t\tparam.dataset = Z._dataset;\r\n\t\tparam.field = Z._field;\r\n\t\tif(Z._tabIndex || Z._tabIndex === 0) {\r\n\t\t\tparam.tabIndex = Z._tabIndex;\r\n\t\t}\r\n\t\tvar dbCtrl = jslet.ui.createControl(param, Z.el);\r\n\t\tif(!Z._expandChildWidth) {\r\n\t\t\tdbCtrl.el.style.width = '100%';\r\n\t\t}\r\n\t\tZ.addChildControl(dbCtrl);\r\n\t\tdbCtrl.tableId(Z._tableId);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tcanFocus: function() {\r\n\t\treturn false;\r\n\t}\r\n});\r\n\r\njslet.ui.register('DBPlace', jslet.ui.DBPlace);\r\njslet.ui.DBPlace.htmlTemplate = '<div></div>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBText is a powerful control, it can input any data type, like:\r\n *\t\tnumber, date etc. Example:\r\n * \r\n * <pre><code>\r\n * var jsletParam = {type:&quot;DBText&quot;,field:&quot;name&quot;};\r\n * //1. Declaring:\r\n * &lt;input id=&quot;ctrlId&quot; type=&quot;text&quot; data-jslet='jsletParam' /&gt;\r\n * or\r\n * &lt;input id=&quot;ctrlId&quot; type=&quot;text&quot; data-jslet='{type:&quot;DBText&quot;,field:&quot;name&quot;}' /&gt;\r\n * \r\n *  //2. Binding\r\n * &lt;input id=&quot;ctrlId&quot; type=&quot;text&quot; data-jslet='jsletParam' /&gt;\r\n * //Js snippet\r\n * var el = document.getElementById('ctrlId');\r\n * jslet.ui.bindControl(el, jsletParam);\r\n * \r\n *  //3. Create dynamically\r\n * jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBText = jslet.Class.create(jslet.ui.DBFieldControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,field,beforeUpdateToDataset,enableInvalidTip,onKeyDown,autoSelectAll';\r\n\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tZ._beforeUpdateToDataset = null;\r\n\t\tZ._enableInvalidTip = true;\r\n\t\t\r\n\t\tZ._enterProcessed = false;\r\n\t\t\r\n\t\tZ._autoSelectAll = true;\r\n\r\n\t\t/**\r\n\t\t * @private\r\n\t\t */\r\n\t\tZ.oldValue = null;\r\n\t\tZ.editMask = null;\r\n\t\tZ._position = null;\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\tbeforeUpdateToDataset: function(beforeUpdateToDataset) {\r\n\t\tif(beforeUpdateToDataset === undefined) {\r\n\t\t\treturn this._beforeUpdateToDataset;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBText.beforeUpdateToDataset', beforeUpdateToDataset).isFunction();\r\n\t\tthis._beforeUpdateToDataset = beforeUpdateToDataset;\r\n\t},\r\n\r\n\tenableInvalidTip: function(enableInvalidTip) {\r\n\t\tif(enableInvalidTip === undefined) {\r\n\t\t\treturn this._enableInvalidTip;\r\n\t\t}\r\n\t\tthis._enableInvalidTip = enableInvalidTip? true: false;\r\n\t},\r\n\r\n\tautoSelectAll: function(autoSelectAll) {\r\n\t\tif(autoSelectAll === undefined) {\r\n\t\t\treturn this._autoSelectAll;\r\n\t\t}\r\n\t\tthis._autoSelectAll = autoSelectAll? true: false;\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn el.tagName.toLowerCase() == 'input' && \r\n\t\t\t\tel.type.toLowerCase() == 'text';\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tvar Z = this;\r\n\t\tZ.renderAll();\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tjqEl.addClass('form-control');\r\n\t\t\r\n\t\tif (Z.doFocus) {\r\n\t\t\tjqEl.on('focus', jQuery.proxy(Z.doFocus, Z));\r\n\t\t}\r\n\t\tif (Z.doBlur) {\r\n\t\t\tjqEl.on('blur', jQuery.proxy(Z.doBlur, Z));\r\n\t\t}\r\n\t\tif (Z.doKeydown) {\r\n\t\t\tjqEl.on('keydown', Z.doKeydown);\r\n\t\t}\r\n\t\tif (Z.doKeypress) {\r\n\t\t\tjqEl.on('keypress', Z.doKeypress);\r\n\t\t}\r\n\t\tZ.doMetaChanged('required');\r\n\t}, // end bind\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoFocus: function () {\r\n\t\tvar Z = this;\r\n\t\tif (Z._skipFocusEvent) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tjslet.ui.focusManager.activeDataset(Z._dataset.name()).activeField(Z._field).activeValueIndex(Z._valueIndex);\r\n\t\tZ.doValueChanged();\r\n\t\tZ.oldValue = Z.el.value;\r\n\t\tif(Z._autoSelectAll) {\r\n\t\t\tjslet.ui.textutil.selectText(Z.el);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoBlur: function () {\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field);\r\n\t\tjslet.ui.focusManager.activeDataset(null).activeField(null).activeValueIndex(null);\r\n\t\tZ._position = jslet.ui.textutil.getCursorPos(Z.el);\r\n\t\tif (fldObj.readOnly() || fldObj.disabled()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar jqEl = jQuery(this);\r\n\t\tif(jqEl.attr('readOnly') || jqEl.attr('disabled')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tZ.updateToDataset();\r\n\t\tZ._isBluring = true;\r\n\t\ttry {\r\n\t\t\tZ.doValueChanged();\r\n\t\t} finally {\r\n\t\t\tZ._isBluring = false;\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoKeydown: function(event) {\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\tvar keyCode = event.which;\r\n\t\t//When press 'enter', write data to dataset.\r\n\t\tvar Z = this.jslet,\r\n\t\t\tK = jslet.ui.KeyCode;\r\n\t\tif(keyCode === K.ENTER) {\r\n\t\t\tZ._enterProcessed = true;\r\n\t\t\tZ.updateToDataset();\r\n\t\t}\r\n\t\t//Process 'ArrowUp', 'ArrowDown', 'PageUp', 'PageDown' key when it is editing. \r\n\t\tvar isEditing = Z._dataset.status() > 0;\r\n\t\tif(isEditing && (keyCode === K.UP || keyCode === K.DOWN || keyCode === K.PAGEUP || keyCode === K.PAGEDOWN)) {\r\n\t\t\tZ._enterProcessed = true;\r\n\t\t\tZ.updateToDataset();\r\n\t\t}\r\n\t\tvar fldObj = Z._dataset.getField(Z._field);\r\n\t\tif (!fldObj.readOnly() && !fldObj.disabled() && (keyCode === K.BACKSPACE || keyCode === K.DELETE)) {\r\n\t\t\tZ._dataset.editRecord();\r\n\t\t}\r\n\t\tif(keyCode === K.LEFT || keyCode === K.RIGHT) { //Arrow-left, Arrow-right\r\n\t\t\tvar pos = jslet.ui.textutil.getCursorPos(Z.el);\r\n\t\t\tif((keyCode === K.LEFT && pos.begin > 0) || \r\n\t\t\t\t\t(keyCode === 39 && pos.begin < Z.el.value.length)) {\r\n\t       \t\tevent.stopImmediatePropagation();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoKeypress: function (event) {\r\n\t\tvar Z = this.jslet,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field);\r\n\t\tif (fldObj.readOnly() || fldObj.disabled()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\tvar keyCode = event.which,\r\n\t\t\texistStr = jslet.getRemainingString(Z.el.value, jslet.ui.textutil.getSelectedText(Z.el)),\r\n\t\t\tcursorPos = jslet.ui.textutil.getCursorPos(Z.el);\r\n\t\tif (!Z._dataset.fieldValidator().checkInputChar(fldObj, String.fromCharCode(keyCode), existStr, cursorPos.begin)) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tZ._dataset.editRecord();\r\n\t\t//When press 'enter', write data to dataset.\r\n\t\tif(keyCode === jslet.ui.KeyCode.ENTER) {\r\n\t\t\tif(!Z._enterProcessed) {\r\n\t\t\t\tZ.updateToDataset();\r\n\t\t\t} else {\r\n\t\t\t\tZ._enterProcessed = false;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Select text.\r\n\t * \r\n\t * @param {Integer} start (Optional) start of cursor position\r\n\t * @param {Integer} end (Optional) end of cursor position\r\n\t */\r\n\tselectText: function(start, end){\r\n\t\tjslet.ui.textutil.selectText(this.el, start, end);\r\n\t},\r\n\t\r\n\t/**\r\n\t * Input a text into text control at current cursor position.\r\n\t * \r\n\t * @param {String} text the text need to be input.\r\n\t */\r\n\tinputText: function(text) {\r\n\t\tif(!text) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBText.inputText#text', text).isString();\r\n\t\t\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field);\r\n\t\tif(fldObj.getType() !== jslet.data.DataType.STRING) {\r\n\t\t\tconsole.warn('Only String Field can be input!');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar ch, chs = [];\r\n\t\tfor(var i = 0, len = text.length; i < len; i++) {\r\n\t\t\tch = text[i];\r\n\t\t\tif (Z._dataset.fieldValidator().checkInputChar(fldObj, ch)) {\r\n\t\t\t\tchs.push(ch);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(!Z._position) {\r\n\t\t\tZ._position = jslet.ui.textutil.getCursorPos(Z.el);\r\n\t\t}\r\n\t\tvar subStr = chs.join(''),\r\n\t\t\tvalue =Z.el.value,\r\n\t\t\tbegin = Z._position.begin,\r\n\t\t\tend = Z._position.end;\r\n\t\tvar prefix = value.substring(0, begin), \r\n\t\t\tsuffix = value.substring(end); \r\n\t\tZ.el.value = prefix + text + suffix;\r\n\t\tZ._position = jslet.ui.textutil.getCursorPos(Z.el);\t\t\r\n\t\tZ.updateToDataset();\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trefreshControl: function ($super, evt, isForce) {\r\n\t\tif($super(evt, isForce) && this.afterRefreshControl) {\r\n\t\t\tthis.afterRefreshControl(evt);\r\n\t\t}\r\n\t}, \r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoMetaChanged: function($super, metaName){\r\n\t\t$super(metaName);\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field);\r\n\t\tif(!metaName || metaName == \"disabled\" || metaName == \"readOnly\") {\r\n\t\t\tjslet.ui.setEditableStyle(Z.el, fldObj.disabled(), fldObj.readOnly(), false, fldObj.required());\r\n\t\t}\r\n\t\t\r\n\t\tif(metaName && metaName == 'required') {\r\n\t\t\tvar jqEl = jQuery(Z.el);\r\n\t\t\tif (fldObj.required()) {\r\n\t\t\t\tjqEl.addClass('jl-ctrl-required');\r\n\t\t\t} else {\r\n\t\t\t\tjqEl.removeClass('jl-ctrl-required');\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(!metaName || metaName == 'editMask') {\r\n\t\t\tvar editMaskCfg = fldObj.editMask();\r\n\t\t\tif (editMaskCfg) {\r\n\t\t\t\tif(!Z.editMask) {\r\n\t\t\t\t\tZ.editMask = new jslet.ui.EditMask();\r\n\t\t\t\t\tZ.editMask.attach(Z.el);\r\n\t\t\t\t}\r\n\t\t\t\tvar mask = editMaskCfg.mask,\r\n\t\t\t\t\tkeepChar = editMaskCfg.keepChar,\r\n\t\t\t\t\ttransform = editMaskCfg.transform;\r\n\t\t\t\tZ.editMask.setMask(mask, keepChar, transform);\r\n\t\t\t} else {\r\n\t\t\t\tif(Z.editMask) {\r\n\t\t\t\t\tZ.editMask.detach();\r\n\t\t\t\t\tZ.editMask = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif(!metaName || metaName == 'tabIndex') {\r\n\t\t\tZ.setTabIndex();\r\n\t\t}\r\n\t\t\r\n\t\tZ.el.maxLength = fldObj.getEditLength();\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoValueChanged: function() {\r\n\t\tvar Z = this;\r\n\t\tif (Z._keep_silence_) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar errObj = Z.getFieldError();\r\n\t\tif(errObj && errObj.message) {\r\n\t\t\tZ.el.value = errObj.inputText || '';\r\n\t\t\tZ.renderInvalid(errObj);\r\n\t\t\treturn;\r\n\t\t} else {\r\n\t\t\tZ.renderInvalid(null);\r\n\t\t}\r\n\t\tvar fldObj = Z._dataset.getField(Z._field);\r\n\t\tvar align = fldObj.alignment();\r\n\t\r\n\t\tif (jslet.locale.isRtl){\r\n\t\t\tif (align == 'left') {\r\n\t\t\t\talign= 'right';\r\n\t\t\t} else {\r\n\t\t\t\talign = 'left';\r\n\t\t\t}\r\n\t\t}\r\n\t\tZ.el.style.textAlign = align;\r\n\t\tvar value;\r\n\t\tif (Z.editMask){\r\n\t\t\tvalue = Z.getText();\r\n\t\t\tZ.editMask.setValue(value);\r\n\t\t} else {\r\n\t\t\tif (document.activeElement != Z.el || Z.el.readOnly || Z._isBluring) {\r\n\t\t\t\tvalue = Z.getText(false);\r\n\t\t\t} else {\r\n\t\t\t\tvalue = Z.getText(true);\r\n\t\t\t}\r\n\t\t\tif(fldObj.getType() === jslet.data.DataType.STRING && fldObj.antiXss()) {\r\n\t\t\t\tvalue = jslet.htmlDecode(value);\r\n\t\t\t}\r\n\t\t\tZ.el.value = value;\r\n\t\t}\r\n\t\tZ.oldValue = Z.el.value;\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tthis.refreshControl(jslet.data.RefreshEvent.updateAllEvent(), true);\r\n\t}, // end renderAll\r\n\r\n\tupdateToDataset: function () {\r\n\t\tvar Z = this;\r\n\t\tif (Z._keep_silence_) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tvar value = Z.el.value;\r\n\t\tif(Z.oldValue == value) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tZ._dataset.editRecord();\r\n\t\tif (this.editMask && !this.editMask.validateValue()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (Z._beforeUpdateToDataset) {\r\n\t\t\tif (!Z._beforeUpdateToDataset.call(Z)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tZ._keep_silence_ = true;\r\n\t\ttry {\r\n\t\t\tif (Z.editMask) {\r\n\t\t\t\tvalue = Z.editMask.getValue();\r\n\t\t\t}\r\n\t\t\tZ._dataset.setFieldText(Z._field, value, Z._valueIndex);\r\n\t\t} finally {\r\n\t\t\tZ._keep_silence_ = false;\r\n\t\t}\r\n\t\tZ.refreshControl(jslet.data.RefreshEvent.updateRecordEvent(Z._field));\r\n\t\treturn true;\r\n\t}, // end updateToDataset\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tvar Z = this;\r\n\t\tjQuery(Z.el).off();\r\n\t\tif (Z.editMask){\r\n\t\t\tZ.editMask.detach();\r\n\t\t\tZ.editMask = null;\r\n\t\t}\r\n\t\tZ._beforeUpdateToDataset = null;\r\n\t\tZ.onKeyDown = null;\r\n\t\t$super();\r\n\t}\r\n});\r\njslet.ui.register('DBText', jslet.ui.DBText);\r\njslet.ui.DBText.htmlTemplate = '<input type=\"text\"></input>';\r\n\r\n/**\r\n * DBPassword\r\n */\r\njslet.ui.DBPassword = jslet.Class.create(jslet.ui.DBText, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn el.tagName.toLowerCase() == 'input' &&\r\n\t\t\tel.type.toLowerCase() == 'password';\r\n\t}\r\n});\r\n\r\njslet.ui.register('DBPassword', jslet.ui.DBPassword);\r\njslet.ui.DBPassword.htmlTemplate = '<input type=\"password\"></input>';\r\n\r\n/**\r\n * DBTextArea\r\n */\r\njslet.ui.DBTextArea = jslet.Class.create(jslet.ui.DBText, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn el.tagName.toLowerCase() == 'textarea';\r\n\t}\r\n});\r\n\r\njslet.ui.register('DBTextArea', jslet.ui.DBTextArea);\r\njslet.ui.DBTextArea.htmlTemplate = '<textarea></textarea>';\r\n\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n* @class DBCustomComboBox: used in jslet.ui.DBComboDlg and jslet.ui.DBDatePicker\r\n*/\r\n\"use strict\";\r\njslet.ui.DBCustomComboBox = jslet.Class.create(jslet.ui.DBFieldControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,field,textReadOnly';\r\n\t\tZ._textReadOnly = false;\r\n\t\tZ.enableInvalidTip = false;\r\n\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\ttextReadOnly: function(textReadOnly) {\r\n\t\tif(textReadOnly === undefined) {\r\n\t\t\treturn this._textReadOnly;\r\n\t\t}\r\n\t\tthis._textReadOnly = textReadOnly ? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tafterBind: function ($super) {\r\n\t\t$super();\r\n\t\t\r\n\t\tif (this._textReadOnly) {\r\n\t\t\tthis.el.childNodes[0].readOnly = true;\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tvar Z = this;\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tif (!jqEl.hasClass('input-group')) {\r\n\t\t\tjqEl.addClass('input-group input-group-sm');\r\n\t\t}\r\n\t\tvar btnCls = Z.comboButtonCls ? Z.comboButtonCls:'fa-caret-down'; \r\n\t\tvar s = '<input type=\"text\" class=\"form-control\">' + \r\n    \t'<span class=\"input-group-btn jl-comb-btn-group\"><button class=\"btn btn-default btn-sm \" tabindex=\"-1\"><i class=\"fa ' + btnCls + '\"></i></button></span>'; \r\n\t\tjqEl.html(s);\r\n\t\tvar dbtext = jqEl.find('[type=\"text\"]')[0];\r\n\t\tZ.textCtrl = new jslet.ui.DBText(dbtext, {\r\n\t\t\ttype: 'dbtext',\r\n\t\t\tdataset: Z._dataset,\r\n\t\t\tfield: Z._textField || Z._field,\r\n\t\t\tenableInvalidTip: true,\r\n\t\t\tvalueIndex: Z._valueIndex,\r\n\t\t\ttabIndex: Z._tabIndex\r\n\t\t});\r\n\t\tjQuery(dbtext).on('keydown', function(event) {\r\n\t\t\tvar keyCode = event.which;\r\n\t\t\tif(keyCode === jslet.ui.KeyCode.BACKSPACE && !this.value) {\r\n\t\t\t\tZ.buttonClick();\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tZ.addChildControl(Z.textCtrl);\r\n\t\t\r\n\t\tvar jqBtn = jqEl.find('button');\r\n\t\tif (this.buttonClick) {\r\n\t\t\t\r\n\t\t\tjqBtn.on('click', function(event){\r\n\t\t\t\tZ.buttonClick(jqBtn[0]);\r\n\t\t\t});\r\n\t\t\tjqBtn.focus(function(event) {\r\n\t\t\t\tjslet.ui.focusManager.activeDataset(Z._dataset.name()).activeField(Z._field).activeValueIndex(Z._valueIndex);\r\n\t\t\t});\r\n\t\t\tjqBtn.blur(function(event) {\r\n\t\t\t\tjslet.ui.focusManager.activeDataset(null).activeField(null).activeValueIndex(null);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\ttableId: function ($super, tableId) {\r\n\t\t$super(tableId);\r\n\t\tthis.textCtrl.tableId(tableId);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tthis.refreshControl();\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinnerFocus: function() {\r\n\t\tvar Z = this;\r\n\t\tif(Z._textReadOnly) {\r\n\t\t\tjQuery(Z.el).find('button').focus();\r\n\t\t} else {\r\n\t\t\tZ.textCtrl.focus();\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoMetaChanged: function($super, metaName){\r\n\t\t$super(metaName);\r\n\t\tvar Z = this;\r\n\t\tif(!metaName || metaName == \"disabled\" || metaName == \"readOnly\") {\r\n\t\t\tvar fldObj = Z._dataset.getField(Z._field),\r\n\t\t\t\tflag = fldObj.disabled() || fldObj.readOnly();\r\n\t\t\tvar jqEl = jQuery(Z.el);\r\n\t\t\tjqEl.find('button').attr(\"disabled\", flag);\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tvar Z = this;\r\n\t\tvar dbbtn = Z.el.childNodes[1];\r\n\t\tdbbtn.onclick = null;\r\n\t\tjQuery(Z.textCtrl.el).off('keydown', this.popupUp);\r\n\t\tZ.textCtrl.destroy();\r\n\t\tZ.textCtrl = null;\r\n\t\t$super();\r\n\t}\r\n});\r\n\r\n\r\n\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBAutoComplete. Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"DBAutoComplete\",field:\"department\", matchType:\"start\"};\r\n * //1. Declaring:\r\n *      &lt;input id=\"cboAuto\" type=\"text\" data-jslet='jsletParam' />\r\n *      \r\n *  //2. Binding\r\n *      &lt;input id=\"cboAuto\" type=\"text\" data-jslet='jsletParam' />\r\n *      //Js snippet\r\n *      var el = document.getElementById('cboAuto');\r\n *      jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n *      jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBAutoComplete = jslet.Class.create(jslet.ui.DBText, {\r\n\t\r\n\tMatchModes: ['start','end', 'any'],\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tif (!Z.allProperties) {\r\n\t\t\tZ.allProperties = 'styleClass,dataset,field,lookupField,minChars,minDelay,displayTemplate,matchMode,beforePopup,onGetFilterField,filterFields';\r\n\t\t}\r\n\t\t\r\n\t\tZ._lookupField = null;\r\n\t\t\r\n\t\tZ._minChars = 0;\r\n\r\n\t\tZ._minDelay = 0;\r\n\t\t\r\n\t\tZ._beforePopup = null;\r\n\t\t\r\n\t\tZ._filterFields = null;\r\n\t\t\r\n\t\tZ._defaultFilterFields = null;\r\n\t\t\r\n\t\tZ._onGetFilterField = null;\r\n\t\t\r\n\t\tZ._matchMode = 'start';\r\n\t\t\r\n\t\tZ._timeoutHandler = null; \r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * Get or set lookup field name.\r\n\t * \r\n\t * @Param {String} lookup field name.\r\n\t * @return {this or String}\r\n\t */\r\n\tlookupField: function(lookupField) {\r\n\t\tif(lookupField === undefined) {\r\n\t\t\treturn this._lookupField;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBAutoComplete.lookupField', lookupField).isString();\r\n\t\tthis._lookupField = lookupField;\r\n\t\treturn this;\r\n\t},\r\n   \r\n\t/**\r\n\t * Get or set minimum characters before searching.\r\n\t * \r\n\t * @Param {Integer} Minimum character before searching.\r\n\t * @return {this or Integer}\r\n\t */\r\n\tminChars: function(minChars) {\r\n\t\tif(minChars === undefined) {\r\n\t\t\treturn this._minChars;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBAutoComplete.minChars', minChars).isGTEZero();\r\n\t\tthis._minChars = parseInt(minChars);\r\n\t\treturn this;\r\n\t},\r\n   \r\n\t/**\r\n\t * Get or set delay time(ms) before auto searching.\r\n\t * \r\n\t * @param {Integer} minDelay Delay time.\r\n\t * @return {this or Integer}\r\n\t */\r\n\tminDelay: function(minDelay) {\r\n\t\tif(minDelay === undefined) {\r\n\t\t\treturn this._minDelay;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBAutoComplete.minDelay', minDelay).isGTEZero();\r\n\t\tthis._minDelay = parseInt(minDelay);\r\n\t\treturn this;\r\n\t},\r\n   \r\n\t/**\r\n\t * Get or set delay time(ms) before auto searching.\r\n\t * \r\n\t * @param {String} matchMode match mode,optional values: 'start', 'end', 'any', default: 'start'\r\n\t * @return {this or String}\r\n\t */\r\n\tmatchMode: function(matchMode) {\r\n\t\tif(matchMode === undefined) {\r\n\t\t\treturn this._matchMode;\r\n\t\t}\r\n\t\tmatchMode = jQuery.trim(matchMode);\r\n\t\tvar checker = jslet.Checker.test('DBAutoComplete.matchMode', matchMode).isString();\r\n\t\tmatchMode = matchMode.toLowerCase();\r\n\t\tchecker.testValue(matchMode).inArray(this.MatchModes);\r\n\t\tthis._matchMode = matchMode;\r\n\t\treturn this;\r\n\t},\r\n   \r\n\t/**\r\n\t * {Function} Before pop up event handler, you can use this to customize the display result.\r\n\t * Pattern: \r\n\t *   function(dataset, inputValue){}\r\n\t *   //dataset: jslet.data.Dataset; \r\n\t *   //inputValue: String\r\n\t */\r\n\tbeforePopup: function(beforePopup) {\r\n\t\tif(beforePopup === undefined) {\r\n\t\t\treturn this._beforePopup;\r\n\t\t}\r\n\t\tthis._beforePopup = beforePopup;\r\n\t\treturn this;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Get or set filter fields, more than one fields are separated with ','.\r\n\t * \r\n\t * @param {String} filterFields filter fields.\r\n\t * @return {this or String}\r\n\t */\r\n\tfilterFields: function(filterFields) {\r\n\t\tvar Z = this;\r\n\t\tif(filterFields === undefined) {\r\n\t\t\treturn Z._filterFields;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBAutoComplete.filterFields', filterFields).isString();\r\n\t\tZ._filterFields = filterFields;\r\n\t\treturn this;\r\n\t},\r\n\t\r\n\t/**\r\n\t * {Function} Get filter field event handler, you can use this to customize the display result.\r\n\t * Pattern: \r\n\t *   function(dataset, inputValue){}\r\n\t *   //dataset: jslet.data.Dataset; \r\n\t *   //inputValue: String\r\n\t *   //return: String Field name\r\n\t */\r\n\tonGetFilterField: function(onGetFilterField) {\r\n\t\tif(onGetFilterField === undefined) {\r\n\t\t\treturn this._onGetFilterField;\r\n\t\t}\r\n\t\tthis._onGetFilterField = onGetFilterField;\r\n\t\treturn this;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn el.tagName.toLowerCase() == 'input' &&\r\n\t\t\tel.type.toLowerCase() == 'text';\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoBlur: function () {\r\n\t\tvar Z = this;\r\n\t\tif (Z.el.disabled || Z.el.readOnly) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar\tfldObj = Z._dataset.getField(Z._field);\r\n\t\tif (fldObj.readOnly() || fldObj.disabled()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (Z.contentPanel && Z.contentPanel.isShowing()) {\r\n\t\t\tif(Z._isSelecting) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar value = Z.el.value, canBlur = true;\r\n\t\t\tif(!Z._lookupField) {\r\n\t\t\t\tfldObj = Z._dataset.getField(Z._field);\r\n\t\t\t\tvar\tlkf = fldObj.lookup(),\r\n\t\t\t\t\tlkds = lkf.dataset();\r\n\t\t\t\tif(value.length > 0 && lkds.recordCount() === 0) {\r\n\t\t\t\t\tcanBlur = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (Z.contentPanel && Z.contentPanel.isShowing()) {\r\n\t\t\t\tZ.contentPanel.closePopup();\r\n\t\t\t}\r\n\t\t\tZ.updateToDataset();\r\n\t\t\tZ.refreshControl(jslet.data.RefreshEvent.updateRecordEvent(Z._field));\r\n\t\t\tif(!canBlur) {\r\n\t\t\t\tZ.el.focus();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tZ.updateToDataset();\r\n\t\t\tZ.refreshControl(jslet.data.RefreshEvent.updateRecordEvent(Z._field));\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoChange: null,\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoKeydown: function (event) {\r\n\t\tif (this.disabled || this.readOnly) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\r\n\t\tvar keyCode = event.which, \r\n\t\t\tZ = this.jslet,\r\n\t\t\tK = jslet.ui.KeyCode;\r\n\t\tif(keyCode >= K.F1 && keyCode <= K.F12 || keyCode === K.SHIFT || keyCode === K.CONTROL || keyCode === K.ALT || \r\n\t\t\t\tkeyCode === K.CAPSLOCK || keyCode === K.INSERT || keyCode === K.HOME || keyCode === K.END || \r\n\t\t\t\tkeyCode === K.PAGEUP || keyCode === K.PAGEDOWN || keyCode === K.LEFT || keyCode === K.RIGHT) { \r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(keyCode === K.ESCAPE && Z.contentPanel) {\r\n\t\t\tZ.contentPanel.closePopup();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (keyCode === K.UP || keyCode === K.DOWN) {\r\n\t\t\tif(Z.contentPanel && Z.contentPanel.isPop) {\r\n\t\t\t\tvar fldObj = Z._dataset.getField(Z._lookupField || Z._field),\r\n\t\t\t\tlkf = fldObj.lookup(),\r\n\t\t\t\tlkds = lkf.dataset();\r\n\t\t\t\tif (keyCode === K.UP) { //up arrow\r\n\t\t\t\t\tlkds.prior();\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t       \t\tevent.stopImmediatePropagation();\r\n\t\t\t\t}\r\n\t\t\t\tif (keyCode === K.DOWN) {//down arrow\r\n\t\t\t\t\tlkds.next();\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t       \t\tevent.stopImmediatePropagation();\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif(!Z.tableId()) {\r\n\t\t\t\t\tZ._invokePopup();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t} \r\n\r\n\t\tif (keyCode === K.DELETE || keyCode === K.BACKSPACE || keyCode === K.IME) {\r\n\t\t\tZ._invokePopup();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (keyCode !== K.ENTER && keyCode !== K.TAB) {\r\n\t\t\tZ._invokePopup();\r\n\t\t} else if (Z.contentPanel) {\r\n\t\t\tif(Z.contentPanel.isShowing()) {\r\n\t\t\t\tZ.contentPanel.confirmSelect();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoKeypress: function (event) {\r\n\t\tif (this.disabled || this.readOnly) {\r\n\t\t\treturn;\r\n\t\t}\r\n//\t\tvar keyCode = event.keyCode ? event.keyCode : \r\n//\t\t\tevent.which\t? event.which: event.charCode;\r\n//\t\tvar Z = this.jslet;\r\n//\t\tif (keyCode != 13 && keyCode != 9) {\r\n//\t\t\tZ._invokePopup();\r\n//\t\t} else if (Z.contentPanel) {\r\n//\t\t\tif(Z.contentPanel.isShowing()) {\r\n//\t\t\t\tZ.contentPanel.confirmSelect();\r\n//\t\t\t}\r\n//\t\t}\r\n\t},\r\n\r\n\t_invokePopup: function () {\r\n\t\tvar Z = this;\r\n\t\tif (Z._timeoutHandler) {\r\n\t\t\tclearTimeout(Z._timeoutHandler);\r\n\t\t}\r\n\t\tvar delayTime = 100;\r\n\t\tif (Z._minDelay) {\r\n\t\t\tdelayTime = parseInt(Z._minDelay);\r\n\t\t}\r\n\t\t\r\n\t\tZ._timeoutHandler = setTimeout(function () {\r\n\t\t\tZ._populate(Z.el.value); \r\n\t\t}, delayTime);\r\n\t},\r\n\r\n\t_getDefaultFilterFields: function(lookupFldObj) {\r\n\t\tvar Z = this;\r\n\t\tif(Z._defaultFilterFields) {\r\n\t\t\treturn Z._defaultFilterFields;\r\n\t\t}\r\n\t\tvar codeFld = lookupFldObj.codeField(),\r\n\t\t\tnameFld = lookupFldObj.nameField(),\r\n\t\t\tlkDs = lookupFldObj.dataset(),\r\n\t\t\tcodeFldObj = lkDs.getField(codeFld),\r\n\t\t\tnameFldObj = lkDs.getField(nameFld),\r\n\t\t\tarrFields = [];\r\n\t\tif(codeFldObj && codeFldObj.visible()) {\r\n\t\t\tarrFields.push(codeFld);\r\n\t\t}\r\n\t\tif(codeFld != nameFld && nameFldObj && nameFldObj.visible()) {\r\n\t\t\tarrFields.push(nameFld);\r\n\t\t}\r\n\t\tZ._defaultFilterFields = arrFields;\r\n\t\treturn arrFields;\r\n\t},\r\n\t\r\n\t_getFilterFields: function(lkFldObj, inputValue) {\r\n\t\tvar Z = this;\r\n\t\tvar filterFlds = null;\r\n\t\t\r\n\t\tvar eventFunc = jslet.getFunction(Z._onGetFilterField);\r\n\t\tif (eventFunc) {\r\n\t\t\tfilterFlds = eventFunc.call(Z, lkFldObj.dataset(), inputValue);\r\n\t\t\tjslet.Checker.test('DBAutoComplete.onGetFilterField#return', filterFlds).isString();\r\n\t\t}\r\n\t\tfilterFlds = filterFlds || Z._filterFields;\r\n\t\tvar arrFields;\r\n\t\tif (filterFlds) {\r\n\t\t\tarrFields = filterFlds.split(',');\r\n\t\t} else {\r\n\t\t\tarrFields = Z._getDefaultFilterFields(lkFldObj);\r\n\t\t}\r\n\t\tif(arrFields.length === 0) {\r\n\t\t\tthrow new Error('Not specified [filter fields]!');\r\n\t\t}\r\n\t\tvar filterValue = inputValue;\r\n\t\tif (Z._matchMode == 'start') {\r\n\t\t\tfilterValue = filterValue + '%';\r\n\t\t} else {\r\n\t\t\tif (Z._matchMode == 'end') {\r\n\t\t\t\tfilterValue = '%' + filterValue;\r\n\t\t\t} else {\r\n\t\t\t\tfilterValue = '%' + filterValue + '%';\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar fldName, result = '';\r\n\t\tfor(var i = 0, len = arrFields.length; i < len; i++) {\r\n\t\t\tfldName = arrFields[i];\r\n\t\t\tif(i > 0) {\r\n\t\t\t\tresult += ' || ';\r\n\t\t\t}\r\n\t\t\tresult += 'like([' + fldName + '],\"' + filterValue + '\")';\r\n\t\t}\r\n\t\treturn result;\r\n\t},\r\n\t\r\n\t_populate: function (inputValue) {\r\n\t\tvar Z = this;\r\n\t\tif (Z._minChars > 0 && inputValue && inputValue.length < Z._minChars) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar fldObj = Z._dataset.getField(Z._lookupField || Z._field),\r\n\t\t\tlkFld = fldObj.lookup();\r\n\t\tif (!lkFld) {\r\n\t\t\tconsole.error(Z._field + ' is NOT a lookup field!');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tvar lkds = lkFld.dataset(),\r\n\t\t\toldFlag = lkds.autoRefreshHostDataset();\r\n\t\tlkds.autoRefreshHostDataset(false);\r\n\t\ttry {\r\n\t\t\tvar\teditFilter = lkFld.editFilter();\r\n\t\t\tvar eventFunc = jslet.getFunction(Z._beforePopup);\r\n\t\t\tif (eventFunc) {\r\n\t\t\t\teventFunc.call(Z, lkds, inputValue, editFilter);\r\n\t\t\t} else if (inputValue) {\r\n\t\t\t\tvar filter = Z._getFilterFields(lkFld, inputValue);\r\n\t\t\t\tif(editFilter) {\r\n\t\t\t\t\tif(filter) {\r\n\t\t\t\t\t\tfilter = '(' + editFilter + ') && (' + filter + ')';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tfilter = editFilter;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tlkds.filter(filter);\r\n\t\t\t\tlkds.filtered(true);\r\n\t\t\t} else {\r\n\t\t\t\tif(editFilter) {\r\n\t\t\t\t\tlkds.filter(editFilter);\r\n\t\t\t\t\tlkds.filtered(true);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlkds.filter(null);\r\n\t\t\t\t\tif(!lkds.fixedFilter()) {\r\n\t\t\t\t\t\tlkds.filtered(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} finally {\r\n\t\t\tlkds.autoRefreshHostDataset(oldFlag);\r\n\t\t}\r\n\t\t//Clear field value which specified by 'lookupField'.\r\n\t\tif(Z._lookupField) {\r\n\t\t\tZ._dataset.getRecord()[Z._lookupField] = null;\r\n\t\t}\r\n\t\tif (!Z.contentPanel) {\r\n\t\t\tZ.contentPanel = new jslet.ui.DBAutoCompletePanel(Z);\r\n\t\t} else {\r\n\t\t\tif(Z.contentPanel.isShowing()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tjslet.ui.PopupPanel.excludedElement = Z.el;\r\n\t\tvar jqEl = jQuery(Z.el),\r\n\t\t\tr = jqEl.offset(),\r\n\t\t\th = jqEl.outerHeight(),\r\n\t\t\tx = r.left,\r\n\t\t\ty = r.top + h;\r\n\t\t\r\n\t\tif (jslet.locale.isRtl){\r\n\t\t\tx = x + jqEl.outerWidth() - Z.contentPanel.dlgWidth;\r\n\t\t}\r\n\t\tZ.contentPanel.showPopup(x, y, 0, h);\r\n\t},\r\n\t\r\n\t_destroyPopPanel: function() {\r\n\t\tvar Z = this;\r\n\t\tif (Z.contentPanel){\r\n\t\t\tZ.contentPanel.destroy();\r\n\t\t\tZ.contentPanel = null;\r\n\t\t}\r\n\t},\r\n\t\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoLookupChanged: function (isMetaChanged) {\r\n\t\tif(isMetaChanged) {\r\n\t\t\tthis._destroyPopPanel();\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tthis._destroyPopPanel();\r\n\t\tjQuery(this.el).off();\r\n\t\t$super();\r\n\t}\r\n\t\r\n});\r\n\r\n/**\r\n * @private\r\n * @class DBAutoCompletePanel\r\n * \r\n */\r\njslet.ui.DBAutoCompletePanel = function (autoCompleteObj) {\r\n\tvar Z = this;\r\n\tZ.dlgWidth = 320;\r\n\tZ.dlgHeight = 180;\r\n\r\n\tvar lkf, lkds;\r\n\tZ.comboCfg = autoCompleteObj;\r\n\tZ.dataset = autoCompleteObj.dataset();\r\n\tZ.field = autoCompleteObj.lookupField() || autoCompleteObj.field();\r\n\t\r\n\tZ.panel = null;\r\n\tZ.lkDataset = null;\r\n\tZ.popup = new jslet.ui.PopupPanel();\r\n\tZ.isPop = false;\r\n\r\n\tZ.create = function () {\r\n\t\tif (!Z.panel) {\r\n\t\t\tZ.panel = document.createElement('div');\r\n\t\t\tZ.panel.style.width = '100%';\r\n\t\t\tZ.panel.style.height = '100%';\r\n\t\t\tjQuery(Z.panel).on(\"mousedown\", function(event){\r\n\t\t\t\tZ.comboCfg._isSelecting = true;\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t});\r\n\t\t}\r\n\t\t//process variable\r\n\t\tvar fldObj = Z.dataset.getField(Z.field),\r\n\t\t\tlkfld = fldObj.lookup(),\r\n\t\t\tlkds = lkfld.dataset();\r\n\t\tZ.lkDataset = lkds;\r\n\t\tvar fields = lkds.getNormalFields(),\r\n\t\t\ttotalChars = 0;\r\n\t\tfor(var i = 0, len = fields.length; i < len; i++) {\r\n\t\t\tfldObj = fields[i];\r\n\t\t\tif(fldObj.visible()) {\r\n\t\t\t\ttotalChars += fldObj.displayWidth();\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar totalWidth = totalChars * (jslet.global.defaultCharWidth || 12) + 30;\r\n\t\tZ.dlgWidth = totalWidth;\r\n\t\tif(Z.dlgWidth < 150) {\r\n\t\t\tZ.dlgWidth = 150;\r\n\t\t}\r\n\t\tif(Z.dlgWidth > 500) {\r\n\t\t\tZ.dlgWidth = 500;\r\n\t\t}\r\n\r\n\t\tZ.panel.innerHTML = '';\r\n\r\n\t\tvar cntw = Z.dlgWidth - 4,\r\n\t\t\tcnth = Z.dlgHeight - 4,\r\n\t\t\ttableparam = { type: 'DBTable', dataset: lkds, readOnly: true, noborder:true, hasSelectCol: false, hasSeqCol: false, hideHead: true };\r\n\t\ttableparam.onRowClick = Z.confirmSelect;\r\n\r\n\t\tZ.otable = jslet.ui.createControl(tableparam, Z.panel, '100%', cnth);\r\n\t\tZ.otable.el.focus();\r\n\t\tZ.otable.el.style.border = \"0\";\r\n\t\t\r\n\t\treturn Z.panel;\r\n\t};\r\n\r\n\tZ.confirmSelect = function () {\r\n\t\tZ.comboCfg._isSelecting = true;\r\n\t\tvar fldValue = Z.lkDataset.keyValue();\r\n\t\tif (fldValue || fldValue === 0) {\r\n\t\t\tZ.dataset.setFieldValue(Z.field, fldValue, Z.valueIndex);\t\t\t\r\n\t\t\tZ.comboCfg.el.focus();\r\n\t\t}\r\n\t\tif (Z.comboCfg.afterSelect) {\r\n\t\t\tZ.comboCfg.afterSelect(Z.dataset, Z.lkDataset);\r\n\t\t}\r\n\t\tZ.closePopup();\r\n\t};\r\n\r\n\tZ.showPopup = function (left, top, ajustX, ajustY) {\r\n\t\tif (!Z.panel) {\r\n\t\t\tZ.panel = Z.create();\r\n\t\t}\r\n\t\tZ.comboCfg._isSelecting = false;\r\n\t\tZ.isPop = true;\r\n\t\tvar p = Z.popup.getPopupPanel();\r\n\t\tp.style.padding = '0';\r\n\t\tZ.popup.setContent(Z.panel);\r\n\t\tZ.popup.onHidePopup = Z.doClosePopup;\r\n\t\tZ.popup.show(left, top, Z.dlgWidth, Z.dlgHeight, ajustX, ajustY);\r\n\t};\r\n\r\n\tZ.doClosePopup = function () {\r\n\t\tZ.isPop = false;\r\n\t\tvar oldRecno = Z.lkDataset.recno() || 0;\r\n\t\ttry {\r\n\t\t\tZ.lkDataset.filter(null);\r\n\t\t} finally {\r\n\t\t\tif(oldRecno >= 0) {\r\n\t\t\t\tZ.lkDataset.recno(oldRecno);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t\r\n\tZ.closePopup = function () {\r\n\t\tZ.popup.hide();\r\n\t};\r\n\t\r\n\tZ.isShowing = function(){\r\n\t\tif (Z.popup) {\r\n\t\t\treturn Z.popup.isShowing;\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t};\r\n\t\r\n\tZ.destroy = function(){\r\n\t\tjQuery(Z.panel).off();\r\n\t\tZ.otable.onRowClick = null;\r\n\t\tZ.otable.destroy();\r\n\t\tZ.otable = null;\r\n\t\tZ.panel = null;\r\n\t\tZ.popup.destroy();\r\n\t\tZ.popup = null;\r\n\t\tZ.comboCfg = null;\r\n\t\tZ.dataset = null;\r\n\t\tZ.field = null;\r\n\t\tZ.lkDataset = null;\r\n\t};\r\n};\r\n\r\njslet.ui.register('DBAutoComplete', jslet.ui.DBAutoComplete);\r\njslet.ui.DBAutoComplete.htmlTemplate = '<input type=\"text\"></input>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBBetweenEdit. \r\n * It implements \"From ... To ...\" style editor. This editor usually use in query parameter editor.\r\n * Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"DBBetweenEdit\",\"field\":\"dateFld\"};\r\n *\r\n * //1. Declaring:\r\n *  &lt;div data-jslet='jsletParam' />\r\n *\r\n *  //2. Binding\r\n *  &lt;div id=\"ctrlId\"  />\r\n * //Js snippet\r\n * var el = document.getElementById('ctrlId');\r\n * jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n * jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBBetweenEdit = jslet.Class.create(jslet.ui.DBFieldControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tthis.allProperties = 'styleClass,dataset,field';\r\n\t\tthis._minEleId = null;\r\n\t\tthis._maxEleId = null;\r\n\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\tvar tagName = el.tagName.toLowerCase();\r\n\t\treturn tagName == 'div';\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tvar Z = this;\r\n\t\tZ.renderAll();\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trefreshControl: function (evt) {\r\n\t\treturn;\r\n\t}, // end refreshControl\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tvar Z = this;\r\n\t\tZ.removeAllChildControls();\r\n\t\tjslet.ui.textMeasurer.setElement(Z.el);\r\n\t\tvar lbl = jslet.locale.Dataset.betweenLabel;\r\n\t\tif (!lbl) {\r\n\t\t\tlbl = '-';\r\n\t\t}\r\n\t\tlbl = '&nbsp;' + lbl + '&nbsp;';\r\n\t\tvar w = jslet.ui.textMeasurer.getWidth(lbl);\r\n\r\n\t\tvar template = ['<table style=\"width:100%;margin:0px\" cellspacing=\"0\" cellpadding=\"0\"><col /><col width=\"', w,\r\n\t\t\t\t'px\" /><col /><tbody><tr><td></td><td>', lbl,\r\n\t\t\t\t'</td><td></td></tr></tbody></table>'];\r\n\t\tZ.el.innerHTML = template.join('');\r\n\t\tvar arrTd = jQuery(Z.el).find('td'),\r\n\t\t\tminTd = arrTd[0],\r\n\t\t\tmaxTd = arrTd[2],\r\n\t\t\tfldObj = Z._dataset.getField(Z._field),\r\n\t\t\tparam = fldObj.editControl();\r\n\r\n\t\tparam.dataset = Z._dataset;\r\n\t\tparam.field = Z._field;\r\n\t\tparam.valueIndex = 0;\r\n\t\tvar dbctrl = jslet.ui.createControl(param, minTd);\r\n\t\tZ._minEleId = dbctrl.el.id;\r\n\t\t\r\n\t\tdbctrl.el.style.width = '98%';\r\n\t\tZ.addChildControl(dbctrl);\r\n\t\t\r\n\t\tparam.valueIndex = 1;\r\n\t\tdbctrl = jslet.ui.createControl(param, maxTd);\r\n\t\tdbctrl.el.style.width = '98%';\r\n\t\tZ._maxEleId = dbctrl.el.id;\r\n\t\tZ.addChildControl(dbctrl);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\ttableId: function($super, tableId){\r\n\t\t$super(tableId);\r\n\t\tjslet('#'+ this._minEleId).tableId(tableId);\r\n\t\tjslet('#'+ this._maxEleId).tableId(tableId);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinnerFocus: function() {\r\n\t\tjslet('#'+ this._minEleId).focus();\r\n\t}\r\n\t\r\n});\r\n\r\njslet.ui.register('DBBetweenEdit', jslet.ui.DBBetweenEdit);\r\njslet.ui.DBBetweenEdit.htmlTemplate = '<div></div>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBCheckBox. \r\n * Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"DBCheckBox\", dataset:\"employee\", field:\"married\"};\r\n * \r\n * //1. Declaring:\r\n * &lt;input type='checkbox' data-jslet='type:\"DBCheckBox\",dataset:\"employee\", field:\"married\"' />\r\n * or\r\n * &lt;div data-jslet='jsletParam' />\r\n *\r\n *  //2. Binding\r\n * &lt;input id=\"ctrlId\" type=\"checkbox\" />\r\n * //Js snippet\r\n * var el = document.getElementById('ctrlId');\r\n * jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n * jslet.ui.createControl(jsletParam, document.body);\r\n * \r\n * </code></pre>\r\n */\r\n\r\n/**\r\n* DBCheckBox\r\n*/\r\n\"use strict\";\r\njslet.ui.DBCheckBox = jslet.Class.create(jslet.ui.DBFieldControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.isCheckBox = true;\r\n\t\tZ.allProperties = 'styleClass,dataset,field,beforeClick';\r\n\t\tZ._beforeClick = null;\r\n\t\t\r\n\t\tZ._skipRefresh = false;\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\tbeforeClick: function(beforeClick) {\r\n\t\tif(beforeClick === undefined) {\r\n\t\t\treturn this._beforeClick;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBCheckBox.beforeClick', beforeClick).isFunction();\r\n\t\tthis._beforeClick = beforeClick;\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn el.tagName.toLowerCase() == 'input' &&\r\n\t\t\tel.type.toLowerCase() == 'checkbox';\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tvar Z = this;\r\n\t\tZ.renderAll();\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tif(!jqEl.hasClass('jl-dbcheck')) {\r\n\t\t\tjqEl.addClass('jl-dbcheck');\r\n\t\t}\r\n\t\tjqEl.on('click', Z._doClick);\r\n\t\tjqEl.focus(function(event) {\r\n\t\t\tjslet.ui.focusManager.activeDataset(Z._dataset.name()).activeField(Z._field).activeValueIndex(Z._valueIndex);\r\n\t\t});\r\n\t\tjqEl.blur(function(event) {\r\n\t\t\tjslet.ui.focusManager.activeDataset(null).activeField(null).activeValueIndex(null);\r\n\t\t});\r\n\t\tjqEl.addClass('checkbox-inline');\r\n\t}, // end bind\r\n\r\n\t_doClick: function (event) {\r\n\t\tvar Z = this.jslet;\r\n\t\tif (Z._beforeClick) {\r\n\t\t\tvar result = Z._beforeClick.call(Z, Z.el);\r\n\t\t\tif (!result) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tZ.updateToDataset();\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoMetaChanged: function($super, metaName){\r\n\t\t$super(metaName);\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field);\r\n\t\tif(!metaName || metaName == \"disabled\" || metaName == \"readOnly\") {\r\n\t\t\tvar disabled = fldObj.disabled() || fldObj.readOnly();\r\n\t\t\tjslet.ui.setEditableStyle(Z.el, disabled, disabled, false, fldObj.required());\r\n\t\t\tZ.setTabIndex();\r\n\t\t}\r\n\t\tif(!metaName || metaName == 'tabIndex') {\r\n\t\t\tZ.setTabIndex();\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoValueChanged: function() {\r\n\t\tvar Z = this;\r\n\t\tif(Z._skipRefresh) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar fldObj = Z._dataset.getField(Z._field),\r\n\t\t\tvalue = Z.getValue();\r\n\t\tif (value) {\r\n\t\t\tZ.el.checked = true;\r\n\t\t} else {\r\n\t\t\tZ.el.checked = false;\r\n\t\t}\r\n\t},\r\n\t\r\n\tfocus: function() {\r\n\t\tthis.el.focus();\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tthis.refreshControl(jslet.data.RefreshEvent.updateAllEvent(), true);\r\n\t}, // end renderAll\r\n\r\n\tupdateToDataset: function () {\r\n\t\tvar Z = this;\r\n\t\tif (Z._keep_silence_) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar fldObj = Z._dataset.getField(Z._field),\r\n\t\t\tvalue = Z.el.checked;\r\n\t\tZ._keep_silence_ = true;\r\n\t\ttry {\r\n\t\t\tZ._dataset.setFieldValue(Z._field, value, Z._valueIndex);\r\n\t\t} finally {\r\n\t\t\tZ._keep_silence_ = false;\r\n\t\t}\r\n\t}, // end updateToDataset\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tjQuery(this.el).off();\r\n\t\t$super();\r\n\t}\r\n});\r\n\r\njslet.ui.register('DBCheckBox', jslet.ui.DBCheckBox);\r\njslet.ui.DBCheckBox.htmlTemplate = '<input type=\"checkbox\"></input>';\r\n\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBCheckBoxGroup. \r\n * Display a group of checkbox. Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"DBCheckBoxGroup\",dataset:\"employee\",field:\"department\", columnCount: 3};\r\n * \r\n * //1. Declaring:\r\n * &lt;div data-jslet='type:\"DBCheckBoxGroup\",dataset:\"employee\",field:\"department\", columnCount: 3' />\r\n * or\r\n * &lt;div data-jslet='jsletParam' />\r\n *  \r\n *  //2. Binding\r\n * &lt;div id=\"ctrlId\"  />\r\n * //Js snippet\r\n * var el = document.getElementById('ctrlId');\r\n * jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n * jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBCheckBoxGroup = jslet.Class.create(jslet.ui.DBFieldControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,field,columnCount,hasSelectAllBox';\r\n\t\t/**\r\n\t\t * {Integer} Column count\r\n\t\t */\r\n\t\tZ._columnCount = 99999;\r\n\t\t\r\n\t\tZ._itemIds = null;\r\n\t\t\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\tcolumnCount: function(columnCount) {\r\n\t\tif(columnCount === undefined) {\r\n\t\t\treturn this._columnCount;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBCheckBoxGroup.columnCount', columnCount).isGTEZero();\r\n\t\tthis._columnCount = parseInt(columnCount);\r\n\t},\r\n\t\r\n\thasSelectAllBox: function(hasSelectAllBox) {\r\n\t\tif(hasSelectAllBox === undefined) {\r\n\t\t\treturn this._hasSelectAllBox;\r\n\t\t}\r\n\t\tthis._hasSelectAllBox = hasSelectAllBox? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\tvar tagName = el.tagName.toLowerCase();\r\n\t\treturn tagName == 'div';\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tvar Z = this;\r\n\t\tZ.renderAll();\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tjqEl.on('keydown', function(event) {\r\n\t\t\tvar keyCode = event.which, idx, activeEle, activeId;\r\n\t\t\t\r\n\t\t\tif(keyCode === jslet.ui.KeyCode.LEFT) { //Arrow Left\r\n\t\t\t\tif(!Z._itemIds || Z._itemIds.length === 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tactiveEle = document.activeElement;\r\n\t\t\t\tactiveId = activeEle && activeEle.id;\r\n\t\t\t\t\r\n\t\t\t\tidx = Z._itemIds.indexOf(activeId);\r\n\t\t\t\tif(idx === 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tdocument.getElementById(Z._itemIds[idx - 1]).focus();\r\n\t\t\t\tevent.preventDefault();\r\n\t       \t\tevent.stopImmediatePropagation();\r\n\t\t\t} else if( keyCode === jslet.ui.KeyCode.RIGHT) { //Arrow Right\r\n\t\t\t\tif(!Z._itemIds || Z._itemIds.length === 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tactiveEle = document.activeElement;\r\n\t\t\t\tactiveId = activeEle && activeEle.id;\r\n\t\t\t\t\r\n\t\t\t\tidx = Z._itemIds.indexOf(activeId);\r\n\t\t\t\tif(idx === Z._itemIds.length - 1) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tdocument.getElementById(Z._itemIds[idx + 1]).focus();\r\n\t\t\t\tevent.preventDefault();\r\n\t       \t\tevent.stopImmediatePropagation();\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tjqEl.on('click', 'input[type=\"checkbox\"]', function (event) {\r\n\t\t\tvar ctrl = this;\r\n\t\t\twindow.setTimeout(function(){ //Defer firing 'updateToDataset' when this control is in DBTable to make row changed firstly.\r\n\t\t\t\tevent.delegateTarget.jslet.updateToDataset(ctrl);\r\n\t\t\t}, 5);\r\n\t\t});\r\n\t\tjqEl.on('focus', 'input[type=\"checkbox\"]', function (event) {\r\n\t\t\tjslet.ui.focusManager.activeDataset(Z._dataset.name()).activeField(Z._field).activeValueIndex(Z._valueIndex);\r\n\t\t});\r\n\t\tjqEl.on('blur', 'input[type=\"checkbox\"]', function (event) {\r\n\t\t\tjslet.ui.focusManager.activeDataset(null).activeField(null).activeValueIndex(null);\r\n\t\t});\r\n\t\tjqEl.addClass('form-control');//Bootstrap class\r\n\t\tjqEl.css('height', 'auto');\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoMetaChanged: function($super, metaName){\r\n\t\t$super(metaName);\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field);\r\n\t\tif(!metaName || metaName == \"disabled\" || metaName == \"readOnly\" || metaName == 'tabIndex') {\r\n\t\t\tvar disabled = fldObj.disabled(),\r\n\t\t\t\treadOnly = fldObj.readOnly();\r\n\t\t\tdisabled = disabled || readOnly;\r\n\t\t\tvar chkBoxes = jQuery(Z.el).find('input[type=\"checkbox\"]'),\r\n\t\t\t\tchkEle, \r\n\t\t\t\ttabIndex = fldObj.tabIndex(),\r\n\t\t\t\trequired = fldObj.required();\r\n\t\t\tfor(var i = 0, cnt = chkBoxes.length; i < cnt; i++){\r\n\t\t\t\tchkEle = chkBoxes[i];\r\n\t\t\t\tjslet.ui.setEditableStyle(chkEle, disabled, readOnly, false, required);\r\n\t\t\t\tchkEle.tabIndex = tabIndex;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoValueChanged: function() {\r\n\t\tvar Z = this;\r\n\t\tif (Z._keep_silence_) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar checkboxs = jQuery(Z.el).find('input[type=\"checkbox\"]'),\r\n\t\t\tchkcnt = checkboxs.length, \r\n\t\t\tcheckbox, i;\r\n\t\tfor (i = 0; i < chkcnt; i++) {\r\n\t\t\tcheckbox = checkboxs[i];\r\n\t\t\tif(jQuery(checkbox).hasClass('jl-selectall')) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tcheckbox.checked = false;\r\n\t\t}\r\n\t\tvar values = Z.getValue();\r\n\t\tif(values && values.length > 0) {\r\n\t\t\tvar valueCnt = values.length, value;\r\n\t\t\tfor (i = 0; i < chkcnt; i++) {\r\n\t\t\t\tcheckbox = checkboxs[i];\r\n\t\t\t\tfor (var j = 0; j < valueCnt; j++) {\r\n\t\t\t\t\tvalue = values[j];\r\n\t\t\t\t\tif (value == checkbox.value) {\r\n\t\t\t\t\t\tcheckbox.checked = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoLookupChanged: function () {\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field), \r\n\t\t\tlkf = fldObj.lookup();\r\n\t\tif (!lkf) {\r\n\t\t\tconsole.error(jslet.formatMessage(jslet.locale.Dataset.lookupNotFound,\r\n\t\t\t\t\t[fldObj.name()]));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(fldObj.valueStyle() != jslet.data.FieldValueStyle.MULTIPLE) {\r\n\t\t\tfldObj.valueStyle(jslet.data.FieldValueStyle.MULTIPLE);\r\n\t\t}\r\n\t\t\r\n\t\tvar lkds = lkf.dataset(),\r\n\t\t\tlkCnt = lkds.recordCount();\r\n\t\tif(lkCnt === 0) {\r\n\t\t\tZ.el.innerHTML = jslet.locale.DBCheckBoxGroup.noOptions;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tZ._itemIds = [];\r\n\t\tvar template = ['<table cellpadding=\"0\" cellspacing=\"0\">'],\r\n\t\t\tisNewRow = false;\r\n\t\tvar editFilter = lkf.editFilter();\r\n\t\tZ._innerEditFilterExpr = null;\r\n\t\tvar editItemDisabled = lkf.editItemDisabled();\r\n\t\tif(editFilter) {\r\n\t\t\tZ._innerEditFilterExpr = new jslet.Expression(lkds, editFilter);\r\n\t\t}\r\n\t\tvar disableOption = false,\r\n\t\t\tk = -1,\r\n\t\t\titemId;\r\n\t\tif(Z._hasSelectAllBox && lkCnt > 0) {\r\n\t\t\ttemplate.push('<tr>');\r\n\t\t\titemId = jslet.nextId();\r\n\t\t\ttemplate.push('<td style=\"white-space: nowrap;vertical-align:middle\"><input type=\"checkbox\" class=\"jl-selectall\"');\r\n\t\t\ttemplate.push(' id=\"');\r\n\t\t\ttemplate.push(itemId);\r\n\t\t\ttemplate.push('\"/><label for=\"');\r\n\t\t\ttemplate.push(itemId);\r\n\t\t\ttemplate.push('\">');\r\n\t\t\ttemplate.push(jslet.locale.DBCheckBoxGroup.selectAll);\r\n\t\t\ttemplate.push('</label></td>');\r\n\t\t\tk = 0;\r\n\t\t\tZ._itemIds.push(itemId);\r\n\t\t}\r\n\t\tZ.el.innerHTML = '';\r\n\t\tvar oldRecno = lkds.recnoSilence();\r\n\t\ttry {\r\n\t\t\tfor (var i = 0; i < lkCnt; i++) {\r\n\t\t\t\tlkds.recnoSilence(i);\r\n\t\t\t\tdisableOption = false;\r\n\t\t\t\tif(Z._innerEditFilterExpr && !Z._innerEditFilterExpr.eval()) {\r\n\t\t\t\t\tif(!editItemDisabled) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdisableOption = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tk++;\r\n\t\t\t\tisNewRow = (k % Z._columnCount === 0);\r\n\t\t\t\tif (isNewRow) {\r\n\t\t\t\t\tif (k > 0) {\r\n\t\t\t\t\t\ttemplate.push('</tr>');\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttemplate.push('<tr>');\r\n\t\t\t\t}\r\n\t\t\t\titemId = jslet.nextId();\r\n\t\t\t\tZ._itemIds.push(itemId);\r\n\t\t\t\ttemplate.push('<td style=\"white-space: nowrap; \"><input type=\"checkbox\" value=\"');\r\n\t\t\t\ttemplate.push(lkds.getFieldValue(lkf.keyField()));\r\n\t\t\t\ttemplate.push('\" id=\"');\r\n\t\t\t\ttemplate.push(itemId);\r\n\t\t\t\ttemplate.push('\" ' + (disableOption? ' disabled': '') + '/><label for=\"');\r\n\t\t\t\ttemplate.push(itemId);\r\n\t\t\t\ttemplate.push('\">');\r\n\t\t\t\ttemplate.push(lkf.getCurrentDisplayValue());\r\n\t\t\t\ttemplate.push('</label></td>');\r\n\t\t\t\tisNewRow = (k % Z._columnCount === 0);\r\n\t\t\t} // end for\r\n\t\t\tif (lkCnt > 0) {\r\n\t\t\t\ttemplate.push('</tr>');\r\n\t\t\t}\r\n\t\t\ttemplate.push('</table>');\r\n\t\t\tZ.el.innerHTML = template.join('');\r\n\t\t} finally {\r\n\t\t\tlkds.recnoSilence(oldRecno);\r\n\t\t}\r\n\t\tZ.doMetaChanged();\r\n\t}, // end renderOptions\r\n\r\n\tupdateToDataset: function(currCheckBox) {\r\n\t\tvar Z = this;\r\n\t\tif (Z._is_silence_) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar allBoxes = jQuery(Z.el).find('input[type=\"checkbox\"]'), chkBox, j, allCnt;\r\n\t\tif(jQuery(currCheckBox).hasClass('jl-selectall')) {\r\n\t\t\tvar isAllSelected = currCheckBox.checked;\r\n\t\t\tfor(j = 0, allCnt = allBoxes.length; j < allCnt; j++){\r\n\t\t\t\tchkBox = allBoxes[j];\r\n\t\t\t\tif(chkBox == currCheckBox) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (!chkBox.disabled) {\r\n\t\t\t\t\tchkBox.checked = isAllSelected;\r\n\t\t\t\t}\r\n\t\t\t} //end for j\r\n\t\t\t\r\n\t\t}\r\n\t\tvar fldObj = Z._dataset.getField(Z._field),\r\n\t\t\tlimitCount = fldObj.valueCountLimit();\r\n\t\t\r\n\t\tvar values = [], count = 0;\r\n\t\tfor(j = 0, allCnt = allBoxes.length; j < allCnt; j++){\r\n\t\t\tchkBox = allBoxes[j];\r\n\t\t\tif(jQuery(chkBox).hasClass('jl-selectall')) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (chkBox.checked) {\r\n\t\t\t\tvalues.push(chkBox.value);\r\n\t\t\t\tcount ++;\r\n\t\t\t}\r\n\t\t} //end for j\r\n\r\n\t\tif (limitCount && count > limitCount) {\r\n\t\t\tcurrCheckBox.checked = !currCheckBox.checked;\r\n\t\t\tjslet.showInfo(jslet.formatMessage(jslet.locale.DBCheckBoxGroup.invalidCheckedCount,\r\n\t\t\t\t\t[''\t+ limitCount]));\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tZ._is_silence_ = true;\r\n\t\ttry {\r\n\t\t\tZ._dataset.setFieldValue(Z._field, values);\r\n\t\t} finally {\r\n\t\t\tZ._is_silence_ = false;\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinnerFocus: function() {\r\n\t\tvar itemIds = this._itemIds;\r\n\t\tif (itemIds && itemIds.length > 0) {\r\n\t\t\tdocument.getElementById(itemIds[0]).focus();\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tvar Z = this, \r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\tif(!jqEl.hasClass(\"jl-checkboxgroup\")) {\r\n\t\t\tjqEl.addClass(\"jl-checkboxgroup\");\r\n\t\t}\r\n\t\tZ.refreshControl(jslet.data.RefreshEvent.updateAllEvent(), true);\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tvar jqEl = jQuery(this.el);\r\n\t\tjqEl.off();\r\n\t\t$super();\r\n\t}\r\n});\r\n\r\njslet.ui.register('DBCheckBoxGroup', jslet.ui.DBCheckBoxGroup);\r\njslet.ui.DBCheckBoxGroup.htmlTemplate = '<div></div>';\r\n\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBCombodlg. \r\n * Show data on a popup panel, it can display tree style or table style. \r\n * Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"DBCombodlg\",dataset:\"employee\",field:\"department\", textReadOnly:true};\r\n * \r\n * //1. Declaring:\r\n * &lt;div data-jslet='type:\"DBCombodlg\",dataset:\"employee\",field:\"department\", textReadOnly:true' />\r\n * or\r\n * &lt;div data-jslet='jsletParam' />\r\n *  \r\n *  //2. Binding\r\n * &lt;div id=\"ctrlId\"  />\r\n * //Js snippet\r\n * var el = document.getElementById('ctrlId');\r\n * jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n * jslet.ui.createControl(jsletParam, document.body);\r\n * \r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBComboSelect = jslet.Class.create(jslet.ui.DBCustomComboBox, {\r\n\tshowStyles: ['auto', 'table', 'tree'],\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,field,textField,searchField,popupHeight,popupWidth,showStyle,textReadOnly,onGetSearchField,correlateCheck,autoSelected';\r\n\t\tZ._textField = null;\r\n\t\t\r\n\t\tZ._showStyle = 'auto';\r\n\t\t\r\n\t\tZ._popupWidth = 300;\r\n\r\n\t\tZ._popupHeight = 300;\r\n\t\t\r\n\t\tZ._contentPanel = null;\r\n\t\t\r\n\t\tZ._pickupField = null;\r\n\t\t\r\n\t\tZ._onGetSearchField = null;\r\n\t\t\r\n\t\tZ._correlateCheck = false;\r\n\t\t\r\n\t\tZ._autoSelected = true;\r\n\t\t\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * Get or set the field name of text box.\r\n\t * \r\n\t * @param textField {String} Field name of text box.\r\n\t * @return {String or this}\r\n\t */\r\n\ttextField: function(textField) {\r\n\t\tif(textField === undefined) {\r\n\t\t\treturn this._textField;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBComboSelect.textField', textField).required().isString();\r\n\t\tthis._textField = textField.trim();\r\n\t},\r\n\t\r\n\t/**\r\n\t * Get or set popup panel height.\r\n\t * \r\n\t * @param popupHeight {Integer} Popup panel height.\r\n\t * @return {Integer or this}\r\n\t */\r\n\tpopupHeight: function(popupHeight) {\r\n\t\tif(popupHeight === undefined) {\r\n\t\t\treturn this._popupHeight;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBComboSelect.popupHeight', popupHeight).isGTEZero();\r\n\t\tthis._popupHeight = parseInt(popupHeight);\r\n\t},\r\n\r\n\t/**\r\n\t * Get or set popup panel width.\r\n\t * \r\n\t * @param popupHeight {Integer} Popup panel width.\r\n\t * @return {Integer or this}\r\n\t */\r\n\tpopupWidth: function(popupWidth) {\r\n\t\tif(popupWidth === undefined) {\r\n\t\t\treturn this._popupWidth;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBComboSelect.popupWidth', popupWidth).isGTEZero();\r\n\t\tthis._popupWidth = parseInt(popupWidth);\r\n\t},\r\n\t\t\r\n\t/**\r\n\t * Get or set panel content style.\r\n\t * \r\n\t * @param {String} Optional value: auto, table, tree.\r\n\t * @return {String or this}\r\n\t */\r\n\tshowStyle: function(showStyle) {\r\n\t\tif(showStyle === undefined) {\r\n\t\t\treturn this._showStyle;\r\n\t\t}\r\n\t\tshowStyle = jQuery.trim(showStyle);\r\n\t\tvar checker = jslet.Checker.test('DBComboSelect.showStyle', showStyle).isString();\r\n\t\tshowStyle = showStyle.toLowerCase();\r\n\t\tchecker.testValue(showStyle).inArray(this.showStyles);\r\n\t\tthis._showStyle = showStyle;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Get or set onGetSearchField event handler.\r\n\t * \r\n\t * @param {Function} Optional onGetSearchField event handler.\r\n\t * @return {Function or this}\r\n\t */\r\n\tonGetSearchField: function(onGetSearchField) {\r\n\t\tif(onGetSearchField === undefined) {\r\n\t\t\treturn this._onGetSearchField;\r\n\t\t}\r\n\t\tthis._onGetSearchField = onGetSearchField;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Identify if correlate check the tree nodes or not.\r\n\t * \r\n\t * @param {Boolean} correlateCheck \r\n\t * @return {Boolean or this}\r\n\t */\r\n\tcorrelateCheck: function(correlateCheck) {\r\n\t\tif(correlateCheck === undefined) {\r\n\t\t\treturn this._correlateCheck;\r\n\t\t}\r\n\t\tthis._correlateCheck = correlateCheck;\r\n\t},\r\n\t\r\n\t/**\r\n\t * Automatically select the finding record when searching record.\r\n\t * \r\n\t * @param {Boolean} autoSelected true - Automatically select record, false - otherwise.\r\n\t * @return {Boolean or this}\r\n\t */\r\n\tautoSelected: function(autoSelected) {\r\n\t\tif(autoSelected === undefined) {\r\n\t\t\treturn this._autoSelected;\r\n\t\t}\r\n\t\tthis._autoSelected = autoSelected;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn true;\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tafterBind: function ($super) {\r\n\t\t$super();\r\n\t\t\r\n\t\tif (this._contentPanel) {\r\n\t\t\tthis._contentPanel = null;\r\n\t\t}\r\n\t},\r\n\r\n\tbuttonClick: function (btnEle) {\r\n\t\tvar Z = this, \r\n\t\t\tel = Z.el, \r\n\t\t\tfldObj = Z._dataset.getField(Z._field), \r\n\t\t\tlkf = fldObj.lookup(),\r\n\t\t\tjqEl = jQuery(el);\r\n\t\tif (fldObj.readOnly() || fldObj.disabled()) {\r\n\t\t\treturn;\t\t\r\n\t\t}\r\n\t\tif (lkf === null || lkf === undefined) {\r\n\t\t\tthrow new Error(Z._field + ' is NOT a lookup field!');\r\n\t\t}\r\n\t\tvar style = Z._showStyle;\r\n\t\tif (Z._showStyle == 'auto') {\r\n\t\t\tstyle = lkf.parentField() ? 'tree' : 'table';\r\n\t\t}\r\n\t\tif (!Z._contentPanel) {\r\n\t\t\tZ._contentPanel = new jslet.ui.DBComboSelectPanel(Z);\r\n\t\t\tZ._contentPanel.showStyle = style;\r\n\t\t\tZ._contentPanel.customButtonLabel = Z.customButtonLabel;\r\n\t\t\tZ._contentPanel.onCustomButtonClick = Z.onCustomButtonClick;\r\n\t\t\tif (Z._popupWidth) {\r\n\t\t\t\tZ._contentPanel.popupWidth = Z._popupWidth;\r\n\t\t\t}\r\n\t\t\tif (Z._popupHeight) {\r\n\t\t\t\tZ._contentPanel.popupHeight = Z._popupHeight;\r\n\t\t\t}\r\n\t\t}\r\n\t\tjslet.ui.PopupPanel.excludedElement = btnEle;\r\n\t\tvar r = jqEl.offset(), h = jqEl.outerHeight(), x = r.left, y = r.top + h;\r\n\t\tif (jslet.locale.isRtl){\r\n\t\t\tx = x + jqEl.outerWidth();\r\n\t\t}\r\n\t\tZ._contentPanel.showPopup(x, y, 0, h);\r\n\t},\r\n\t\r\n\tclosePopup: function(){\r\n\t\tif(this._contentPanel) {\r\n\t\t\tthis._contentPanel.closePopup();\r\n\t\t}\r\n\t\tthis._contentPanel = null;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoLookupChanged: function (isMetaChanged) {\r\n\t\tif(isMetaChanged) {\r\n\t\t\tthis._destroyPopPanel();\r\n\t\t}\r\n\t},\r\n\t\r\n\t_destroyPopPanel: function() {\r\n\t\tvar Z = this;\r\n\t\tif (Z._contentPanel){\r\n\t\t\tZ._contentPanel.destroy();\r\n\t\t\tZ._contentPanel = null;\r\n\t\t}\r\n\t\tjslet.ui.PopupPanel.excludedElement = null;\t\t\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tthis._destroyPopPanel();\r\n\t\t$super();\r\n\t}\r\n});\r\n\r\njslet.ui.DBComboSelectPanel = function (comboSelectObj) {\r\n\tvar Z = this;\r\n\r\n\tZ.showStyle = 'auto';\r\n\r\n\tZ.customButtonLabel = null;\r\n\tZ.onCustomButtonClick = null;\r\n\tZ.popupWidth = 350;\r\n\tZ.popupHeight = 350;\r\n\tZ._isShowing = false;\r\n\t\r\n\tvar otree, otable, showType, valueSeperator = ',', lkf, lkds, self = this;\r\n\tZ.comboSelectObj = comboSelectObj;\r\n\r\n\tZ.dataset = comboSelectObj._dataset;\r\n\tZ.field = comboSelectObj._field;\r\n\tZ.fieldObject = Z.dataset.getField(Z.field);\r\n\tZ.panel = null;\r\n\tZ.searchBoxEle = null;\r\n\t\r\n\tZ.popup = new jslet.ui.PopupPanel();\r\n\tZ.popup.onHidePopup = function() {\r\n\t\tZ._isShowing = false;\r\n\t\tZ._restoreLkDsEvent();\r\n\t\tif(Z.comboSelectObj) {\r\n\t\t\tZ.comboSelectObj.focus();\r\n\t\t}\r\n\t};\r\n\tZ._confirmSelectDebounce = jslet.debounce(this._confirmSelect, 50);\r\n};\r\n\r\njslet.ui.DBComboSelectPanel.prototype = {\r\n\t\t\r\n\tlookupDs: function() {\r\n\t\treturn this.fieldObject.lookup().dataset();\r\n\t},\r\n\t\r\n\tisMultiple: function() {\r\n\t\treturn this.fieldObject && this.fieldObject.valueStyle() === jslet.data.FieldValueStyle.MULTIPLE;\r\n\t},\r\n\t\t\r\n\tshowPopup: function (left, top, ajustX, ajustY) {\r\n\t\tvar Z = this;\r\n\t\tif(Z._isShowing) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tZ._initSelected();\r\n\t\tvar showType = Z.showStyle.toLowerCase();\r\n\t\tif (!Z.panel) {\r\n\t\t\tZ.panel = Z._create();\r\n\t\t} else {\r\n\t\t\tvar ojslet = Z.otree ? Z.otree : Z.otable;\r\n\t\t\tojslet.dataset().addLinkedControl(ojslet);\r\n\t\t\twindow.setTimeout(function(){\r\n\t\t\t\tojslet.renderAll();\r\n\t\t\t}, 1);\r\n\t\t}\r\n\t\tif(showType == 'table') {\r\n\t\t\tvar fields = Z.lookupDs().getNormalFields(),\r\n\t\t\t\tfldObj, totalChars = 0;\r\n\t\t\tfor(var i = 0, len = fields.length; i < len; i++) {\r\n\t\t\t\tfldObj = fields[i];\r\n\t\t\t\tif(fldObj.visible()) {\r\n\t\t\t\t\ttotalChars += fldObj.displayWidth();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar totalWidth = totalChars * (jslet.global.defaultCharWidth || 12) + 40;\r\n\t\t\tZ.popupWidth = totalWidth;\r\n\t\t\tif(Z.popupWidth < 150) {\r\n\t\t\t\tZ.popupWidth = 150;\r\n\t\t\t}\r\n\t\t\tif(Z.popupWidth > 500) {\r\n\t\t\t\tZ.popupWidth = 500;\r\n\t\t\t}\r\n\t\t}\r\n\t\tZ._setLookupDsEvent();\r\n\t\tZ._isShowing = true;\r\n\t\tZ.popup.setContent(Z.panel, '100%', '100%');\r\n\t\tZ.popup.show(left, top, Z.popupWidth, Z.popupHeight, ajustX, ajustY);\r\n\t\tZ._showTips(jslet.locale.DBComboSelect.find);\r\n\t\tZ._focus();\r\n\t},\r\n\r\n\tclosePopup: function () {\r\n\t\tvar Z = this;\r\n\t\tZ.popup.hide();\r\n\t\tvar dispCtrl = Z.otree ? Z.otree : Z.otable;\r\n\t\tif(dispCtrl) {\r\n\t\t\tdispCtrl.dataset().removeLinkedControl(dispCtrl);\r\n\t\t}\r\n\t},\r\n\t\r\n\t_setLookupDsEvent: function() {\r\n\t\tvar Z = this;\r\n\t\tif(Z.isMultiple()) {\r\n\t\t\tvar fldObj = Z.dataset.getField(Z.field),\r\n\t\t\t\tlkfld = fldObj.lookup();\r\n\t\t\tvar lkDs = lkfld.dataset();\r\n\t\t\tZ._oldLkDsCheckSelectable = null;\r\n\t\t\tif(lkfld.onlyLeafLevel()) {\r\n\t\t\t\tZ._oldLkDsCheckSelectable = lkDs.onCheckSelectable();\r\n\t\t\t\tlkDs.onCheckSelectable(function(){\r\n\t\t\t\t\treturn !this.hasChildren();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tlkDs = Z.lookupDs();\r\n\t\t\tZ._oldLkDsListener = lkDs.datasetListener();\r\n\t\t\tlkDs.datasetListener(function(eventType) {\r\n\t\t\t\tif(Z._oldLkDsListener) {\r\n\t\t\t\t\tZ._oldLkDsListener.call(lkDs, eventType);\r\n\t\t\t\t}\r\n\t\t\t\tif(eventType === jslet.data.DatasetEvent.AFTERSELECT) {\r\n\t\t\t\t\tZ._confirmSelectDebounce.call(Z);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t},\r\n\t\r\n\t_restoreLkDsEvent: function() {\r\n\t\tvar Z = this;\r\n\t\tif(Z.isMultiple()) {\r\n\t\t\tvar fldObj = Z.dataset.getField(Z.field),\r\n\t\t\t\tlkfld = fldObj.lookup();\r\n\t\t\tvar lkDs = lkfld.dataset();\r\n\t\t\tlkDs.onCheckSelectable(Z._oldLkDsCheckSelectable? Z._oldLkDsCheckSelectable: null);\r\n\t\t\tlkDs.datasetListener(Z._oldLkDsListener? Z._oldLkDsListener: null);\r\n\t\t}\r\n\t\t\r\n\t},\r\n\t\r\n\t_create: function () {\r\n\t\tvar Z = this;\r\n\t\tif (!Z.panel) {\r\n\t\t\tZ.panel = document.createElement('div');\r\n\t\t}\r\n\r\n\t\t//process variable\r\n\t\tvar fldObj = Z.dataset.getField(Z.field),\r\n\t\t\tlkfld = fldObj.lookup(),\r\n\t\t\tpfld = lkfld.parentField(),\r\n\t\t\tshowType = Z.showStyle.toLowerCase(),\r\n\t\t\tlkds = Z.lookupDs();\r\n\r\n\t\tvar template = ['<div class=\"jl-combopnl-tip\" style=\"display:none\"></div>',\r\n\t\t                '<div class=\"jl-combopnl-head\"><label class=\"col-xs-4\"></label>',\r\n\t\t                '<div class=\"col-xs-8 input-group input-group-sm\">',\r\n\t\t                '<input class=\"form-control\" type=\"text\" size=\"10\"></input>',\r\n\t\t                '<span class=\"input-group-btn\">',\r\n\t\t                '<button class=\"jl-combopnl-search btn btn-secondary\" type=\"button\"><i class=\"fa fa-search\"></i></button>',\r\n\t\t                '<button class=\"jl-combopnl-closesearch btn btn-secondary\" type=\"button\"><i class=\"fa fa-times\"></i></button>',\r\n\t\t                '</span>',\r\n\t\t                '</div></div>',\r\n\t\t                '<div class=\"jl-combopnl-content\"></div>'];\r\n\r\n\t\tZ.panel.innerHTML = template.join('');\r\n\t\tvar jqPanel = jQuery(Z.panel),\r\n\t\t\tjqPh = jqPanel.find('.jl-combopnl-head');\r\n\t\tjqPanel.on('keydown', function(event){\r\n\t\t\tvar keyCode = event.which;\r\n\t\t\tif(keyCode === jslet.ui.KeyCode.ESCAPE) {\r\n\t\t\t\tZ.closePopup();\r\n\t\t\t}\r\n\t\t\tif(event.ctrlKey && keyCode === jslet.ui.KeyCode.F) {\r\n\t\t\t\tjqPanel.find('.jl-combopnl-head').slideDown();\r\n\t\t\t\tZ.searchBoxEle.focus();\r\n\t\t\t\tevent.preventDefault();\r\n\t       \t\tevent.stopImmediatePropagation();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t\tZ.searchBoxEle = jqPh.find('input')[0];\r\n\t\tjQuery(Z.searchBoxEle).on('keydown', jQuery.proxy(Z._findData, Z));\r\n\t\t\r\n\t\tjqPanel.find('.jl-combopnl-closesearch').click(function() {\r\n\t\t\tjqPanel.find('.jl-combopnl-head').slideUp();\r\n\t\t\tZ._focus();\r\n\t\t});\r\n\t\tvar contentPanel = jqPanel.find('.jl-combopnl-content')[0];\r\n\r\n\t\t//create popup content\r\n\t\tif (showType == 'tree') {\r\n\t\t\tvar treeParam = { \r\n\t\t\t\ttype: 'DBTreeView', \r\n\t\t\t\tdataset: lkds, \r\n\t\t\t\treadOnly: false, \r\n\t\t\t\tdisplayFields: lkfld.displayFields(), \r\n\t\t\t\thasCheckBox: Z.isMultiple(),\r\n\t\t\t\texpandLevel:1\r\n\t\t\t};\r\n\r\n\t\t\tif (!Z.isMultiple()) {\r\n\t\t\t\ttreeParam.onItemClick = jQuery.proxy(Z._confirmAndClose, Z);\r\n\t\t\t}\r\n\t\t\ttreeParam.correlateCheck = Z.comboSelectObj.correlateCheck();\r\n\t\t\twindow.setTimeout(function(){\r\n\t\t\t\tZ.otree = jslet.ui.createControl(treeParam, contentPanel, '100%', '100%');\r\n\t\t\t}, 1);\r\n\t\t} else {\r\n\t\t\tvar tableParam = { type: 'DBTable', dataset: lkds, readOnly: true, hasSelectCol: Z.isMultiple(), hasSeqCol: false, \r\n\t\t\t\t\thasFindDialog: false, hasFilterDialog: false };\r\n\t\t\tif (!Z.isMultiple()) {\r\n\t\t\t\ttableParam.onRowClick = jQuery.proxy(Z._confirmAndClose, Z);\r\n\t\t\t}\r\n\t\t\twindow.setTimeout(function(){\r\n\t\t\t\tZ.otable = jslet.ui.createControl(tableParam, contentPanel, '100%', '100%');\r\n\t\t\t}, 1);\r\n\t\t}\r\n\t\treturn Z.panel;\r\n\t},\r\n\r\n\t_initSelected: function () {\r\n\t\tvar Z = this;\r\n\t\tvar fldValue = Z.comboSelectObj.getValue(), \r\n\t\t\tlkds = Z.lookupDs();\r\n\r\n\t\tvar fldObj = Z.dataset.getField(Z.field),\r\n\t\t\tlkfld = fldObj.lookup();\r\n\r\n\t\tif(lkfld.onlyLeafLevel()) {\r\n\t\t\tlkds.onCheckSelectable(function(){\r\n\t\t\t\treturn !this.hasChildren();\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (!Z.isMultiple()) {\r\n\t\t\tif (fldValue) {\r\n\t\t\t\tlkds.findByKey(fldValue);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlkds.disableControls();\r\n\t\ttry {\r\n\t\t\tlkds.selectAll(false);\r\n\t\t\tif (fldValue) {\r\n\t\t\t\tvar arrKeyValues = fldValue;\r\n\t\t\t\tif(!jslet.isArray(fldValue)) {\r\n\t\t\t\t\tarrKeyValues = fldValue.split(jslet.global.valueSeparator);\r\n\t\t\t\t}\r\n\t\t\t\tfor (var i = 0, len = arrKeyValues.length; i < len; i++){\r\n\t\t\t\t\tlkds.selectByKeyValue(true, arrKeyValues[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} finally {\r\n\t\t\tlkds.enableControls();\r\n\t\t}\r\n\t},\r\n\r\n\t_findData: function (event) {\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\tif (event.which != 13) {//enter\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar Z = this;\r\n\t\tvar findFldName = Z.comboSelectObj.searchField, \r\n\t\t\tfindingValue = this.searchBoxEle.value;\r\n\t\tif (!findingValue) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar eventFunc = jslet.getFunction(Z.comboSelectObj.onGetSearchField);\r\n\t\tif (eventFunc) {\r\n\t\t\tfindFldName = eventFunc.call(findingValue);\r\n\t\t}\r\n\t\tvar findFldNames = null;\r\n\t\tvar lkds = Z.lookupDs();\r\n\t\tif(!findFldName) {\r\n\t\t\tfindFldNames = [];\r\n\t\t\tvar fields = lkds.getNormalFields(), fldObj;\r\n\t\t\tfor(var i = 0, len = fields.length; i < len; i++) {\r\n\t\t\t\tfldObj = fields[i];\r\n\t\t\t\tif(fldObj.visible()) {\r\n\t\t\t\t\tfindFldNames.push(fldObj.name());\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tfindFldNames = findFldName.split(',');\r\n\t\t}\r\n\t\tif(!findFldNames || findFldNames.length === 0) {\r\n\t\t\tconsole.warn('Search field NOT specified! Can\\'t search data!');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar\tcurrRecno = lkds.recno() + 1;\r\n\t\tvar found = lkds.findByField(findFldNames, findingValue, currRecno, true, 'any');\r\n\t\tif(!found) {\r\n\t\t\tfound = lkds.findByField(findFldNames, findingValue, 0, true, 'any');\r\n\t\t}\r\n\t\tif(found && Z.comboSelectObj.autoSelected()) {\r\n\t\t\tlkds.select(true);\r\n\t\t}\r\n\t\tif(!found) {\r\n\t\t\tZ._showTips(jslet.locale.DBComboSelect.notFound);\r\n\t\t}\r\n\t\tevent.currentTarget.focus();\r\n\t\treturn;\r\n\t\t\r\n\t},\r\n\r\n\t_focus: function() {\r\n\t\tvar Z = this;\r\n\t\twindow.setTimeout(function(){\r\n\t\t\tvar dbCtrl = Z.otable || Z.otree;\r\n\t\t\tif(dbCtrl) {\r\n\t\t\t\tdbCtrl.el.focus();\r\n\t\t\t}\r\n\t\t}, 10);\r\n\t},\r\n\t\r\n\t_showTips: function (tips) {\r\n\t\tvar jqPanel = jQuery(this.panel);\r\n\t\tjqPanel.find('.jl-combopnl-tip').html(tips).slideDown();\r\n\t\twindow.setTimeout(function() {\r\n\t\t\tjqPanel.find('.jl-combopnl-tip').slideUp();\r\n\t\t}, 1500);\r\n\t},\r\n\t\r\n\t_confirmSelect: function () {\r\n\t\tvar Z = this;\r\n\t\tvar fldValue = Z.comboSelectObj.getValue(),\r\n\t\t\tfldObj = Z.dataset.getField(Z.field),\r\n\t\t\tlkfld = fldObj.lookup(),\r\n\t\t\tisMulti = Z.isMultiple(),\r\n\t\t\tlookupDs = Z.lookupDs();\r\n\t\t\r\n\t\tif (isMulti) {\r\n\t\t\tfldValue = lookupDs.selectedKeyValues();\r\n\t\t} else {\r\n\t\t\tfldValue = lookupDs.keyValue();\r\n\t\t}\r\n\r\n\t\tZ.dataset.setFieldValue(Z.field, fldValue, Z._valueIndex);\r\n\t\tif (!isMulti && Z.comboSelectObj._afterSelect) {\r\n\t\t\tZ.comboSelectObj._afterSelect(Z.dataset, lookupDs);\r\n\t\t}\r\n\t},\r\n\t\r\n\t_confirmAndClose: function () {\r\n\t\tthis._confirmSelect();\r\n\t\tthis.closePopup();\r\n\t},\r\n\r\n\tdestroy: function(){\r\n\t\tvar Z = this;\r\n\t\tZ._restoreLkDsEvent();\r\n\t\tZ.popup.onHidePopup = null;\r\n\t\tif (Z.otree){\r\n\t\t\tZ.otree.destroy();\r\n\t\t\tZ.otree = null;\r\n\t\t}\r\n\t\tif (Z.otable){\r\n\t\t\tZ.otable.destroy();\r\n\t\t\tZ.otable = null;\r\n\t\t}\r\n\t\tZ.comboSelectObj = null;\r\n\t\t\r\n\t\tjQuery(Z.searchBoxEle).off();\r\n\t\tZ.fieldObject = null;\r\n\t\t\r\n\t\tZ.searchBoxEle = null;\r\n\t\tZ.popup = null;\r\n\t\tZ.panel = null;\r\n\t}\r\n};\r\n\r\njslet.ui.register('DBComboSelect', jslet.ui.DBComboSelect);\r\njslet.ui.DBComboSelect.htmlTemplate = '<div></div>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBDataLabel. \r\n * Show field value in a html label. \r\n * Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"DBDataLabel\",dataset:\"employee\",field:\"department\"};\r\n * \r\n * //1. Declaring:\r\n * &lt;label data-jslet='type:\"DBDataLabel\",dataset:\"employee\",field:\"department\"' />\r\n * or\r\n * &lt;label data-jslet='jsletParam' />\r\n *\r\n *  //2. Binding\r\n * &lt;label id=\"ctrlId\"  />\r\n * //Js snippet\r\n * var el = document.getElementById('ctrlId');\r\n * jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n * jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBDataLabel = jslet.Class.create(jslet.ui.DBFieldControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tthis.allProperties = 'styleClass,dataset,field';\r\n\t\t\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tthis.renderAll();\r\n\t\tjQuery(this.el).addClass('form-control-static jl-datalabel');//Bootstrap class\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn el.tagName.toLowerCase() == 'label';\r\n\t},\r\n\r\n\tdoValueChanged: function() {\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field);\r\n\t\tvar text = Z.getText();\r\n\t\tZ.el.innerHTML = text;\r\n\t\tZ.el.title = text;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tthis.refreshControl(jslet.data.RefreshEvent.updateAllEvent(), true);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tcanFocus: function() {\r\n\t\treturn false;\r\n\t}\r\n});\r\n\r\njslet.ui.register('DBDataLabel', jslet.ui.DBDataLabel);\r\njslet.ui.DBDataLabel.htmlTemplate = '<label></label>';\r\n\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBDatePicker. Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"DBDatePicker\",dataset:\"employee\",field:\"birthday\", textReadOnly:true};\r\n * \r\n * //1. Declaring:\r\n * &lt;div data-jslet='type:\"DBDatePicker\",dataset:\"employee\",field:\"birthday\", textReadOnly:true' />\r\n * or\r\n * &lt;div data-jslet='jsletParam' />\r\n * \r\n *  //2. Binding\r\n * &lt;div id=\"ctrlId\"  />\r\n * //Js snippet\r\n * var el = document.getElementById('ctrlId');\r\n * jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n * jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBDatePicker = jslet.Class.create(jslet.ui.DBCustomComboBox, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,field,textReadOnly,popupWidth, popupHeight';\r\n\t\t\r\n\t\t/**\r\n\t\t * {Integer} Popup panel width\r\n\t\t */\r\n\t\tZ._popupWidth = 260;\r\n\r\n\t\t/**\r\n\t\t * {Integer} Popup panel height\r\n\t\t */\r\n\t\tZ._popupHeight = 226;\r\n\r\n\t\tZ.popup = new jslet.ui.PopupPanel();\r\n\t\t\r\n\t\tZ.popup.onHidePopup = function() {\r\n\t\t\tZ.focus();\r\n\t\t};\r\n\t\t\r\n\t\tZ.comboButtonCls = 'fa-calendar';\r\n\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\tpopupHeight: function(popupHeight) {\r\n\t\tif(popupHeight === undefined) {\r\n\t\t\treturn this._popupHeight;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBDatePicker.popupHeight', popupHeight).isGTEZero();\r\n\t\tthis._popupHeight = parseInt(popupHeight);\r\n\t},\r\n\r\n\tpopupWidth: function(popupWidth) {\r\n\t\tif(popupWidth === undefined) {\r\n\t\t\treturn this._popupWidth;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBDatePicker.popupWidth', popupWidth).isGTEZero();\r\n\t\tthis._popupWidth = parseInt(popupWidth);\r\n\t},\r\n\t\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn true;\r\n\t},\r\n\r\n\tbuttonClick: function (btnEle) {\r\n\t\tvar el = this.el, \r\n\t\t\tZ = this, \r\n\t\t\tfldObj = Z._dataset.getField(Z._field),\r\n\t\t\tjqEl = jQuery(el);\r\n\t\tif (fldObj.readOnly() || fldObj.disabled()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar width = Z._popupWidth,\r\n\t\t\theight = Z._popupHeight,\r\n\t\t\tdateValue = Z.getValue(),\r\n\t\t\trange = fldObj.dataRange(),\r\n\t\t\tminDate = null,\r\n\t\t\tmaxDate = null;\r\n\t\t\r\n\t\tif (range){\r\n\t\t\tif (range.min) {\r\n\t\t\t\tminDate = range.min;\r\n\t\t\t}\r\n\t\t\tif (range.max) {\r\n\t\t\t\tmaxDate = range.max;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!Z.contentPanel) {\r\n\t\t\tZ.contentPanel = jslet.ui.createControl({ type: 'Calendar', value: dateValue, minDate: minDate, maxDate: maxDate,\r\n\t\t\t\tonDateSelected: function (date) {\r\n\t\t\t\t\tZ._dataset.setFieldValue(Z._field, new Date(date.getTime()), Z._valueIndex);\r\n\t\t\t\t\tZ.popup.hide();\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tZ.el.focus();\r\n\t\t\t\t\t} catch(e) {\r\n\t\t\t\t\t\t//Ignore\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, null, width + 'px', height + 'px', true); //Hide panel first\r\n\t\t}\r\n\t\t\r\n\t\tjslet.ui.PopupPanel.excludedElement = btnEle;//event.element();\r\n\t\tvar r = jqEl.offset(), \r\n\t\t\th = jqEl.outerHeight(), \r\n\t\t\tx = r.left, y = r.top + h;\r\n\t\tif (jslet.locale.isRtl){\r\n\t\t\tx = x + jqEl.outerWidth();\r\n\t\t}\r\n\t\tZ.popup.setContent(Z.contentPanel.el, '100%', '100%');\r\n\t\tZ.contentPanel.el.style.display = 'block';\r\n\t\tZ.contentPanel.setValue(dateValue);\r\n\t\tZ.popup.show(x, y, width + 3, height + 3, 0, h);\r\n\t\tZ.contentPanel.focus();\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tvar Z = this;\r\n\t\tif(Z.contentPanel) {\r\n\t\t\tZ.contentPanel.destroy();\r\n\t\t\tZ.contentPanel = null;\r\n\t\t}\r\n\t\tZ.popup.destroy();\r\n\t\tZ.popup = null;\r\n\t\t$super();\r\n\t}\r\n\t\r\n});\r\n\r\njslet.ui.register('DBDatePicker', jslet.ui.DBDatePicker);\r\njslet.ui.DBDatePicker.htmlTemplate = '<div></div>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBHtml. \r\n * Display html text from one field. \r\n * Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"DBHtml\",dataset:\"employee\",field:\"comment\"};\r\n * \r\n * //1. Declaring:\r\n * &lt;div data-jslet='type:\"DBHtml\",dataset:\"employee\",field:\"comment\"' />\r\n * or\r\n * &lt;div data-jslet='jsletParam' />\r\n * \r\n *  //2. Binding\r\n * &lt;div id=\"ctrlId\"  />\r\n * //Js snippet\r\n * var el = document.getElementById('ctrlId');\r\n * jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n * jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBHtml = jslet.Class.create(jslet.ui.DBFieldControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tthis.allProperties = 'styleClass,dataset,field';\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tthis.renderAll();\r\n\t\tjQuery(this.el).addClass('form-control');\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn el.tagName.toLowerCase() == 'div';\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoValueChanged: function() {\r\n\t\tvar content = this.getText();\r\n\t\tthis.el.innerHTML = content;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tthis.refreshControl(jslet.data.RefreshEvent.updateAllEvent(), true);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tcanFocus: function() {\r\n\t\treturn false;\r\n\t}\r\n\r\n});\r\n\r\njslet.ui.register('DBHtml', jslet.ui.DBHtml);\r\njslet.ui.DBHtml.htmlTemplate = '<div style=\"width:200px;height:200px\"></div>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBImage. \r\n * Display an image which store in database or which's path store in database. \r\n * Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"DBImage\",dataset:\"employee\",field:\"photo\"};\r\n * \r\n * //1. Declaring:\r\n * &lt;img data-jslet='{type:\"DBImage\",dataset:\"employee\",field:\"photo\"}' />\r\n * or\r\n * &lt;img data-jslet='jsletParam' />\r\n *\r\n *  //2. Binding\r\n * &lt;img id=\"ctrlId\"  />\r\n * //Js snippet\r\n * var el = document.getElementById('ctrlId');\r\n * jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n * jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBImage = jslet.Class.create(jslet.ui.DBFieldControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,field,locked,baseUrl,altField';\r\n\t\t/**\r\n\t\t * Stop refreshing image when move dataset's cursor.\r\n\t\t */\r\n\t\tZ._locked = false;\r\n\t\t/**\r\n\t\t * {String} The base url\r\n\t\t */\r\n\t\tZ._baseUrl = null;\r\n\t\t\r\n\t\tZ._altField = null;\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\tbaseUrl: function(baseUrl) {\r\n\t\tif(baseUrl === undefined) {\r\n\t\t\treturn this._baseUrl;\r\n\t\t}\r\n\t\tbaseUrl = jQuery.trim(baseUrl);\r\n\t\tjslet.Checker.test('DBImage.baseUrl', baseUrl).isString();\r\n\t\tthis._baseUrl = baseUrl;\r\n\t},\r\n   \r\n\taltField: function(altField) {\r\n\t\tif(altField === undefined) {\r\n\t\t\treturn this._altField;\r\n\t\t}\r\n\t\taltField = jQuery.trim(altField);\r\n\t\tjslet.Checker.test('DBImage.altField', altField).isString();\r\n\t\tthis._altField = altField;\r\n\t},\r\n   \r\n\tlocked: function(locked) {\r\n\t\tif(locked === undefined) {\r\n\t\t\treturn this._locked;\r\n\t\t}\r\n\t\tthis._locked = locked;\r\n\t},\r\n   \r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn el.tagName.toLowerCase() == 'img';\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tthis.renderAll();\r\n\t\tjQuery(this.el).addClass('img-responsive img-rounded');\r\n\t\t\r\n\t}, // end bind\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoValueChanged: function() {\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field);\r\n\t\tif (Z._locked) {\r\n\t\t\tZ.el.alt = jslet.locale.DBImage.lockedImageTips;\r\n\t\t\tZ.el.src = '';\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar srcURL = Z.getValue();\r\n\t\tif (!srcURL) {\r\n\t\t\tsrcURL = '';\r\n\t\t} else {\r\n\t\t\tif (Z._baseUrl) {\r\n\t\t\t\tsrcURL = Z._baseUrl + srcURL;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (Z.el.src != srcURL) {\r\n\t\t\tvar altText = srcURL;\r\n\t\t\tif(Z._altField) {\r\n\t\t\t\taltText = Z._dataset.getFieldText(Z._altField);\r\n\t\t\t}\r\n\t\t\tZ.el.alt = altText;\r\n\t\t\tZ.el.src = srcURL;\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tthis.refreshControl(jslet.data.RefreshEvent.updateAllEvent(), true);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tcanFocus: function() {\r\n\t\treturn false;\r\n\t}\r\n});\r\n\r\njslet.ui.register('DBImage', jslet.ui.DBImage);\r\njslet.ui.DBImage.htmlTemplate = '<img></img>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBLabel. \r\n * Display field name, use this control to void hard-coding field name, and you can change field name dynamically. \r\n * Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"DBLabel\",dataset:\"employee\",field:\"department\"};\r\n * \r\n * //1. Declaring:\r\n * &lt;label data-jslet='type:\"DBLabel\",dataset:\"employee\",field:\"department\"' />\r\n * or\r\n * &lt;label data-jslet='jsletParam' />\r\n *\r\n *  //2. Binding\r\n * &lt;label id=\"ctrlId\"  />\r\n * //Js snippet\r\n * var el = document.getElementById('ctrlId');\r\n * jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n * jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBLabel = jslet.Class.create(jslet.ui.DBFieldControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tthis.allProperties = 'styleClass,dataset,field';\r\n\t\tthis.isLabel = true;\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tjQuery(this.el).addClass('control-label');\r\n\t\tthis.renderAll();\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn el.tagName.toLowerCase() == 'label';\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoMetaChanged: function(metaName) {\r\n\t\tif(metaName && jslet.ui.DBLabel.METANAMES.indexOf(metaName) < 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar Z = this, subType = Z._fieldMeta,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field),\r\n\t\t\tcontent = '';\r\n\t\tif(!fldObj) {\r\n\t\t\tthrow new Error('Field: ' + this._field + ' NOT exist!');\r\n\t\t}\r\n\t\tif((!subType || subType == 'label') && (!metaName || metaName == 'label' || metaName == 'required')) {\r\n\t\t\tif (fldObj.required()) {\r\n\t\t\t\tcontent += '<span class=\"jl-lbl-required\">' + \r\n\t\t\t\t\tjslet.ui.DBLabel.REQUIREDCHAR + '</span>';\r\n\t\t\t}\r\n\t\t\tcontent += fldObj.displayLabel();\r\n\t\t\tZ.el.innerHTML = content || '';\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(subType && subType == 'tip' && \r\n\t\t\t(!metaName || metaName == subType)) {\r\n\t\t\tcontent = fldObj.tip();\r\n\t\t\tZ.el.innerHTML = content || '';\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(subType  && subType == 'error' && \r\n\t\t\t(metaName && metaName == subType)) {\r\n\t\t\tvar errObj = Z.getFieldError();\r\n\t\t\tcontent = errObj && errObj.message;\r\n\t\t\tZ.el.innerHTML = content || '';\r\n\t\t\treturn;\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tvar jqEl = jQuery(this.el),\r\n\t\t\tsubType = this.fieldMeta();\r\n\t\t\r\n\t\tthis.refreshControl(jslet.data.RefreshEvent.updateAllEvent());\r\n\t\tif(subType == 'error') {\r\n\t\t\tif(!jqEl.hasClass('jl-lbl-error')) {\r\n\t\t\t\tjqEl.addClass('jl-lbl-error');\r\n\t\t\t}\r\n\t\t} else \r\n\t\tif(subType == 'tip') {\r\n\t\t\tif(!jqEl.hasClass('jl-lbl-tip')) {\r\n\t\t\t\tjqEl.addClass('jl-lbl-tip');\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif(!jqEl.hasClass('jl-lbl')) {\r\n\t\t\t\tjqEl.addClass('jl-lbl');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n\r\njslet.ui.DBLabel.REQUIREDCHAR = '*';\r\njslet.ui.DBLabel.METANAMES = ['label', 'required', 'tip', 'error'];\r\njslet.ui.register('DBLabel', jslet.ui.DBLabel);\r\njslet.ui.DBLabel.htmlTemplate = '<label></label>';\r\n\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBList. \r\n * Show data on list, it can display tree style or table style. \r\n * Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"DBList\",dataset:\"employee\",field:\"department\"};\r\n * \r\n * //1. Declaring:\r\n * &lt;div data-jslet='type:\"DBList\",dataset:\"employee\",field:\"department\"' />\r\n * or\r\n * &lt;div data-jslet='jsletParam' />\r\n *  \r\n *  //2. Binding\r\n * &lt;div id=\"ctrlId\"  />\r\n * //Js snippet\r\n * var el = document.getElementById('ctrlId');\r\n * jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n * jslet.ui.createControl(jsletParam, document.body);\r\n * \r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBList = jslet.Class.create(jslet.ui.DBFieldControl, {\r\n\tshowStyles: ['auto', 'table', 'tree'],\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,field,showStyle,correlateCheck';\r\n\t\t\r\n\t\tZ._showStyle = 'auto';\r\n\t\t\r\n\t\tZ._correlateCheck = false;\r\n\t\t\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * Get or set panel content style.\r\n\t * \r\n\t * @param {String} Optional value: auto, table, tree.\r\n\t * @return {String or this}\r\n\t */\r\n\tshowStyle: function(showStyle) {\r\n\t\tif(showStyle === undefined) {\r\n\t\t\treturn this._showStyle;\r\n\t\t}\r\n\t\tshowStyle = jQuery.trim(showStyle);\r\n\t\tvar checker = jslet.Checker.test('DBComboSelect.showStyle', showStyle).isString();\r\n\t\tshowStyle = showStyle.toLowerCase();\r\n\t\tchecker.testValue(showStyle).inArray(this.showStyles);\r\n\t\tthis._showStyle = showStyle;\r\n\t},\r\n\t\r\n\tcorrelateCheck: function(correlateCheck) {\r\n\t\tif(correlateCheck === undefined) {\r\n\t\t\treturn this._correlateCheck;\r\n\t\t}\r\n\t\tthis._correlateCheck = correlateCheck;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn el.tagName.toLowerCase() == 'div';\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tthis.renderAll();\r\n\t},\r\n\t\r\n\trenderAll: function() {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\tif(jqEl.hasClass('jl-dblist')) {\r\n\t\t\tjqEl.addClass('jl-dblist');\r\n\t\t}\r\n\t\tvar fldObj = Z._dataset.getField(Z._field),\r\n\t\t\tlkfld = fldObj.lookup(),\r\n\t\t\tpfld = lkfld.parentField(),\r\n\t\t\tshowType = Z._showStyle.toLowerCase(),\r\n\t\t\tlkds = lkfld.dataset(),\r\n\t\t\tisMulti = fldObj.valueStyle() === jslet.data.FieldValueStyle.MULTIPLE;\r\n\t\tif(showType == 'auto' && pfld) {\r\n\t\t\tshowType = 'tree';\r\n\t\t}\r\n\t\tif (showType == 'tree') {\r\n\t\t\tvar treeParam = { \r\n\t\t\t\ttype: 'DBTreeView', \r\n\t\t\t\tdataset: lkds, \r\n\t\t\t\treadOnly: false, \r\n\t\t\t\tdisplayFields: lkfld.displayFields(), \r\n\t\t\t\thasCheckBox: isMulti,\r\n\t\t\t\tcorrelateCheck: Z._correlateCheck,\r\n\t\t\t\texpandLevel: 99\r\n\t\t\t};\r\n\t\t\tif(isMulti) {\r\n\t\t\t\ttreeParam.afterCheckBoxClick = function() {\r\n\t\t\t\t\tZ.updateToDataset();\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\ttreeParam.onItemClick = function() {\r\n\t\t\t\t\tZ.updateToDataset();\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\r\n\t\t\twindow.setTimeout(function() {\r\n\t\t\t\tjslet.ui.createControl(treeParam, Z.el, '100%', '100%');\r\n\t\t\t\tjQuery(Z.el.childNodes[0]).on('focus', function(event) {\r\n\t\t\t\t\tjslet.ui.focusManager.activeDataset(Z._dataset.name()).activeField(Z._field).activeValueIndex(Z._valueIndex);\r\n\t\t\t\t}).on('blur', function(event) {\r\n\t\t\t\t\tjslet.ui.focusManager.activeDataset(null).activeField(null).activeValueIndex(null);\r\n\t\t\t\t});\r\n\t\t\t}, 1);\r\n\t\t} else {\r\n\t\t\tvar tableParam = { type: 'DBTable', dataset: lkds, readOnly: true, hasSelectCol: isMulti, hasSeqCol: false, hasFindDialog: false, hasFilterDialog: false};\r\n\t\t\tif(isMulti) {\r\n\t\t\t\ttableParam.afterSelect = tableParam.afterSelectAll = function() {\r\n\t\t\t\t\tZ.updateToDataset();\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\ttableParam.onRowClick = function() {\r\n\t\t\t\t\tZ.updateToDataset();\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\twindow.setTimeout(function() {\r\n\t\t\t\tjslet.ui.createControl(tableParam, Z.el, '100%', '100%');\r\n\t\t\t}, 1);\r\n\t\t}\r\n\t\t\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoMetaChanged: function($super, metaName) {\r\n\t\t$super(metaName);\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field);\r\n\t\tif(!metaName || metaName == \"disabled\" || metaName == \"readOnly\") {\r\n\t\t\tZ.el.disabled = true;\r\n\t\t} else {\r\n\t\t\tZ.el.disabled = false;\r\n\t\t}\r\n\t\t\r\n\t\tif(metaName && metaName == 'required') {\r\n\t\t\tvar jqEl = jQuery(Z.el);\r\n\t\t\tif (fldObj.required()) {\r\n\t\t\t\tjqEl.addClass('jl-ctrl-required');\r\n\t\t\t} else {\r\n\t\t\t\tjqEl.removeClass('jl-ctrl-required');\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif(!metaName || metaName == 'tabIndex') {\r\n\t\t\tZ.setTabIndex();\r\n\t\t}\r\n\t\t\r\n\t},\r\n\t\r\n\tupdateToDataset: function () {\r\n\t\tvar Z = this;\r\n\t\tif (Z._keep_silence_) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\tvar fldObj = Z._dataset.getField(Z._field),\r\n\t\t\tlkfld = fldObj.lookup(),\r\n\t\t\tlkds = lkfld.dataset(),\r\n\t\t\tisMulti = fldObj.valueStyle() === jslet.data.FieldValueStyle.MULTIPLE,\r\n\t\t\tvalue;\r\n\t\tif(!isMulti) {\r\n\t\t\tvalue = lkds.keyValue();\r\n\t\t} else {\r\n\t\t\tvalue = lkds.selectedKeyValues();\r\n\t\t}\r\n\t\tZ._dataset.editRecord();\r\n\t\tZ._keep_silence_ = true;\r\n\t\ttry {\r\n\t\t\tZ._dataset.setFieldValue(Z._field, value, Z._valueIndex);\r\n\t\t} finally {\r\n\t\t\tZ._keep_silence_ = false;\r\n\t\t}\r\n\t\tZ.refreshControl(jslet.data.RefreshEvent.updateRecordEvent(Z._field));\r\n\t\treturn true;\r\n\t}, // end updateToDataset\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoValueChanged: function() {\r\n\t\tvar Z = this;\r\n\t\tif (Z._keep_silence_) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar errObj = Z.getFieldError();\r\n\t\tif(errObj && errObj.message) {\r\n\t\t\tZ.el.value = errObj.inputText || '';\r\n\t\t\tZ.renderInvalid(errObj);\r\n\t\t\treturn;\r\n\t\t} else {\r\n\t\t\tZ.renderInvalid(null);\r\n\t\t}\r\n\t\tvar fldObj = Z._dataset.getField(Z._field),\r\n\t\t\tfldValue = fldObj.getValue(),\r\n\t\t\tlkfld = fldObj.lookup(),\r\n\t\t\tpfld = lkfld.parentField(),\r\n\t\t\tlkds = lkfld.dataset(),\r\n\t\t\tisMulti = fldObj.valueStyle() === jslet.data.FieldValueStyle.MULTIPLE;\r\n\t\tif(!isMulti) {\r\n\t\t\tlkds.findByKey(fldValue);\r\n\t\t} else {\r\n\t\t\tlkds.disableControls();\r\n\t\t\ttry {\r\n\t\t\t\tlkds.selectAll(false);\r\n\t\t\t\tif(fldValue) {\r\n\t\t\t\t\tfor(var i = 0, len = fldValue.length; i < len; i++) {\r\n\t\t\t\t\t\tlkds.findByKey(fldValue[i]);\r\n\t\t\t\t\t\tlkds.selected(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} finally {\r\n\t\t\t\tlkds.enableControls();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super) {\r\n\t\tvar Z = this;\r\n\t\t$super();\r\n\t}\r\n});\r\n\r\njslet.ui.register('DBList', jslet.ui.DBList);\r\njslet.ui.DBList.htmlTemplate = '<div></div>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBLookupLabel. \r\n * Display field value according to another field and its value.\r\n * Example:\r\n * <pre><code>\r\n * \t\tvar jsletParam = {type:\"DBLookupLabel\",dataset:\"department\",lookupField:\"deptcode\", lookupValue: '0101', returnField: 'name'};\r\n * \r\n * //1. Declaring:\r\n *\t  &lt;label data-jslet='{type:\"DBLookupLabel\",dataset:\"department\",lookupField:\"deptcode\", lookupValue: \"0101\", returnField: \"name\"}' />\r\n *\t  or\r\n *\t  &lt;label data-jslet='jsletParam' />\r\n *\t  \r\n *  //2. Binding\r\n *\t  &lt;label id=\"ctrlId\"  />\r\n *  \t//Js snippet\r\n * \t\tvar el = document.getElementById('ctrlId');\r\n *  \tjslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n *  \tjslet.ui.createControl(jsletParam, document.body);\r\n *  \t\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBLookupLabel = jslet.Class.create(jslet.ui.DBControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,lookupField,returnField,lookupValue';\r\n\t\tZ.requiredProperties = 'lookupValue,lookupField,returnField';\r\n\r\n\t\t/**\r\n\t\t * {String} Lookup field name.\r\n\t\t */\r\n\t\tZ.lookupField = null;\r\n\t\t/**\r\n\t\t * {String} Lookup field value.\r\n\t\t */\r\n\t\tZ.lookupValue = null;\r\n\t\t/**\r\n\t\t * {String} Return field name.\r\n\t\t */\r\n\t\tZ.returnField = null;\r\n\t\t\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tthis.renderAll();\r\n\t\tjQuery(this.el).addClass('form-control');\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn el.tagName.toLowerCase() == 'label';\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trefreshControl: function (evt, isForce) {\r\n\t\tif (evt.eventType != jslet.data.RefreshEvent.UPDATEALL) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!isForce) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar Z = this;\r\n\t\tvar result = Z.dataset.lookup(Z.lookupField, Z.lookupValue,\r\n\t\t\t\tZ.returnField);\r\n\t\tif (result === null) {\r\n\t\t\tresult = 'NOT found: ' + Z.lookupValue;\r\n\t\t}\r\n\t\tZ.el.innerHTML = result;\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tthis.refreshControl(jslet.data.RefreshEvent.updateAllEvent, true);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tcanFocus: function() {\r\n\t\treturn false;\r\n\t}\r\n});\r\njslet.ui.register('DBLookupLabel', jslet.ui.DBLookupLabel);\r\njslet.ui.DBLookupLabel.htmlTemplate = '<label></label>';\r\n\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBRadioGroup. \r\n * Display a group of radio that user can select one option. Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"DBRadioGroup\",dataset:\"employee\",field:\"department\"};\r\n * \r\n * //1. Declaring:\r\n * &lt;div data-jslet='type:\"DBRadioGroup\",dataset:\"employee\",field:\"department\"'' />\r\n * or\r\n * &lt;div data-jslet='jsletParam' />\r\n * \r\n *  //2. Binding\r\n * &lt;div id=\"ctrlId\"  />\r\n * //Js snippet\r\n * var el = document.getElementById('ctrlId');\r\n * jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n * jslet.ui.createControl(jsletParam, document.body);\r\n * \r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBRadioGroup = jslet.Class.create(jslet.ui.DBFieldControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,field,columnCount';\r\n\t\t/**\r\n\t\t * {Integer} Column count\r\n\t\t */\r\n\t\tZ._columnCount = 99999;\r\n\t\t\r\n\t\tZ._itemIds = null;\r\n\t\t\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\tcolumnCount: function(columnCount) {\r\n\t\tif(columnCount === undefined) {\r\n\t\t\treturn this._columnCount;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBRadioGroup.columnCount', columnCount).isGTEZero();\r\n\t\tthis._columnCount = parseInt(columnCount);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\tvar tagName = el.tagName.toLowerCase();\r\n\t\treturn tagName == 'div';\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tvar Z = this;\r\n\t\tZ.renderAll();\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tjqEl.on('keydown', function(event) {\r\n\t\t\tvar keyCode = event.which, idx, activeEle, activeId;\r\n\t\t\t\r\n\t\t\tif(keyCode === jslet.ui.KeyCode.LEFT) { //Arrow Left\r\n\t\t\t\tif(!Z._itemIds || Z._itemIds.length === 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tactiveEle = document.activeElement;\r\n\t\t\t\tactiveId = activeEle && activeEle.id;\r\n\t\t\t\t\r\n\t\t\t\tidx = Z._itemIds.indexOf(activeId);\r\n\t\t\t\tif(idx === 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tdocument.getElementById(Z._itemIds[idx - 1]).focus();\r\n\t\t\t\tevent.preventDefault();\r\n\t       \t\tevent.stopImmediatePropagation();\r\n\t\t\t} else if( keyCode === jslet.ui.KeyCode.RIGHT) { //Arrow Right\r\n\t\t\t\tif(!Z._itemIds || Z._itemIds.length === 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tactiveEle = document.activeElement;\r\n\t\t\t\tactiveId = activeEle && activeEle.id;\r\n\t\t\t\t\r\n\t\t\t\tidx = Z._itemIds.indexOf(activeId);\r\n\t\t\t\tif(idx === Z._itemIds.length - 1) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tdocument.getElementById(Z._itemIds[idx + 1]).focus();\r\n\t\t\t\tevent.preventDefault();\r\n\t       \t\tevent.stopImmediatePropagation();\r\n\t\t\t}\r\n\t\t});\r\n\t\tjqEl.on('click', 'input[type=\"radio\"]', function(event){\r\n\t\t\tvar ctrl = this;\r\n\t\t\twindow.setTimeout(function(){ //Defer firing 'updateToDataset' when this control is in DBTable to make row changed firstly.\r\n\t\t\t\tevent.delegateTarget.jslet.updateToDataset(ctrl);\r\n\t\t\t}, 5);\r\n\t\t});\r\n\t\tjqEl.on('focus', 'input[type=\"radio\"]', function (event) {\r\n\t\t\tjslet.ui.focusManager.activeDataset(Z._dataset.name()).activeField(Z._field).activeValueIndex(Z._valueIndex);\r\n\t\t});\r\n\t\tjqEl.on('blur', 'input[type=\"radio\"]', function (event) {\r\n\t\t\tjslet.ui.focusManager.activeDataset(null).activeField(null).activeValueIndex(null);\r\n\t\t});\r\n\t\tjqEl.addClass('form-control');\r\n\t\tjqEl.css('height', 'auto');\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoMetaChanged: function($super, metaName) {\r\n\t\t$super(metaName);\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field);\r\n\t\tif(!metaName || metaName == \"disabled\" || metaName == \"readOnly\" || metaName == 'tabIndex') {\r\n\t\t\tvar disabled = fldObj.disabled(),\r\n\t\t\t\treadOnly = fldObj.readOnly();\r\n\t\t\r\n\t\t\tZ.disabled = disabled || readOnly;\r\n\t\t\tdisabled = Z.disabled;\r\n\t\t\tvar radios = jQuery(Z.el).find('input[type=\"radio\"]'),\r\n\t\t\t\trequired = fldObj.required(),\r\n\t\t\t\tradioEle,\r\n\t\t\t\ttabIdx = fldObj.tabIndex();\r\n\t\t\t\r\n\t\t\tfor(var i = 0, cnt = radios.length; i < cnt; i++){\r\n\t\t\t\tradioEle = radios[i];\r\n\t\t\t\tjslet.ui.setEditableStyle(radioEle, disabled, readOnly, false, required);\r\n\t\t\t\tradioEle.tabIndex = tabIdx;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoValueChanged: function() {\r\n\t\tvar Z = this;\r\n\t\tif (Z._keep_silence_) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar value = Z.getValue(),\r\n\t\t\tradios = jQuery(Z.el).find('input[type=\"radio\"]'), \r\n\t\t\tradio;\r\n\t\tfor(var i = 0, cnt = radios.length; i < cnt; i++){\r\n\t\t\tradio = radios[i];\r\n\t\t\tradio.checked = (value == jQuery(radio.parentNode).attr('value'));\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoLookupChanged: function () {\r\n\t\tvar Z = this;\r\n\t\tvar fldObj = Z._dataset.getField(Z._field), lkf = fldObj.lookup();\r\n\t\tif (!lkf) {\r\n\t\t\tconsole.error(jslet.formatMessage(jslet.locale.Dataset.lookupNotFound,\r\n\t\t\t\t\t[fldObj.name()]));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar lkds = lkf.dataset(),\r\n\t\t\tcnt = lkds.recordCount();\r\n\t\tif(cnt === 0) {\r\n\t\t\tZ.el.innerHTML = jslet.locale.DBRadioGroup.noOptions;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar oldRecno = lkds.recno();\r\n\t\ttry {\r\n\t\t\tvar template = ['<table cellpadding=\"0\" cellspacing=\"0\">'],\r\n\t\t\t\tisNewRow = false, \r\n\t\t\t\titemId;\r\n\t\t\tvar editFilter = lkf.editFilter();\r\n\t\t\tZ._innerEditFilterExpr = null;\r\n\t\t\tvar editItemDisabled = lkf.editItemDisabled();\r\n\t\t\tif(editFilter) {\r\n\t\t\t\tZ._innerEditFilterExpr = new jslet.Expression(lkds, editFilter);\r\n\t\t\t}\r\n\t\t\tvar disableOption = false, k = -1;\r\n\t\t\t\r\n\t\t\tZ._itemIds = [];\r\n\t\t\tfor (var i = 0; i < cnt; i++) {\r\n\t\t\t\tlkds.recnoSilence(i);\r\n\t\t\t\tdisableOption = false;\r\n\t\t\t\tif(Z._innerEditFilterExpr && !Z._innerEditFilterExpr.eval()) {\r\n\t\t\t\t\tif(!editItemDisabled) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdisableOption = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tk++;\r\n\t\t\t\tisNewRow = (k % Z._columnCount === 0);\r\n\t\t\t\tif (isNewRow) {\r\n\t\t\t\t\tif (k > 0) {\r\n\t\t\t\t\t\ttemplate.push('</tr>');\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttemplate.push('<tr>');\r\n\t\t\t\t}\r\n\t\t\t\titemId = jslet.nextId();\r\n\t\t\t\tZ._itemIds.push(itemId);\r\n\t\t\t\ttemplate.push('<td style=\"white-space: nowrap;vertical-align:middle\" value=\"');\r\n\t\t\t\ttemplate.push(lkds.getFieldValue(lkf.keyField()));\r\n\t\t\t\ttemplate.push('\"><input name=\"');\r\n\t\t\t\ttemplate.push(Z._field);\r\n\t\t\t\ttemplate.push('\" type=\"radio\" id=\"');\r\n\t\t\t\ttemplate.push(itemId);\r\n\t\t\t\ttemplate.push('\" ' + (disableOption? ' disabled': '') + '/><label for=\"');\r\n\t\t\t\ttemplate.push(itemId);\r\n\t\t\t\ttemplate.push('\">');\r\n\t\t\t\ttemplate.push(lkf.getCurrentDisplayValue());\r\n\t\t\t\ttemplate.push('</label></td>');\r\n\t\t\t} // end while\r\n\t\t\tif (cnt > 0) {\r\n\t\t\t\ttemplate.push('</tr>');\r\n\t\t\t}\r\n\t\t\ttemplate.push('</table>');\r\n\t\t\tZ.el.innerHTML = template.join('');\r\n\t\t} finally {\r\n\t\t\tlkds.recnoSilence(oldRecno);\r\n\t\t}\r\n\t\tZ.doMetaChanged();\r\n\t}, // end renderOptions\r\n\r\n\tupdateToDataset: function(currCheckBox) {\r\n\t\tvar Z = this;\r\n\t\tif (Z._keep_silence_ || Z.disabled) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tZ._keep_silence_ = true;\r\n\t\ttry {\r\n\t\t\tZ._dataset.setFieldValue(Z._field, jQuery(currCheckBox.parentNode).attr('value'));\r\n\t\t\tcurrCheckBox.checked = true;\r\n\t\t} finally {\r\n\t\t\tZ._keep_silence_ = false;\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinnerFocus: function() {\r\n\t\tvar itemIds = this._itemIds;\r\n\t\tif (itemIds && itemIds.length > 0) {\r\n\t\t\tdocument.getElementById(itemIds[0]).focus();\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tvar Z = this, \r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\tif(!jqEl.hasClass(\"jl-radiogroup\")) {\r\n\t\t\tjqEl.addClass(\"jl-radiogroup\");\r\n\t\t}\r\n\t\tZ.refreshControl(jslet.data.RefreshEvent.updateAllEvent(), true);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tvar jqEl = jQuery(this.el);\r\n\t\tjqEl.off();\r\n\t\t$super();\r\n\t}\r\n});\r\n\r\njslet.ui.register('DBRadioGroup', jslet.ui.DBRadioGroup);\r\njslet.ui.DBRadioGroup.htmlTemplate = '<div></div>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBRangeSelect. \r\n * Display a select which options produce with 'beginItem' and 'endItem'. Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"DBRangeSelect\",dataset:\"employee\",field:\"age\",beginItem:10,endItem:100,step:5};\r\n * \r\n * //1. Declaring:\r\n * &lt;select data-jslet='type:\"DBRangeSelect\",dataset:\"employee\",field:\"age\",beginItem:10,endItem:100,step:5' />\r\n * or\r\n * &lt;select data-jslet='jsletParam' />\r\n * \r\n *  //2. Binding\r\n * &lt;select id=\"ctrlId\"  />\r\n * //Js snippet\r\n * var el = document.getElementById('ctrlId');\r\n * jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n * jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBRangeSelect = jslet.Class.create(jslet.ui.DBFieldControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,field,beginItem,endItem,step';\r\n\t\tif (!Z.requiredProperties) {\r\n\t\t\tZ.requiredProperties = 'field,beginItem,endItem,step';\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * {Integer} Begin item \r\n\t\t */\r\n\t\tZ._beginItem = 0;\r\n\t\t/**\r\n\t\t * {Integer} End item\r\n\t\t */\r\n\t\tZ._endItem = 10;\r\n\t\t/**\r\n\t\t * {Integer} Step\r\n\t\t */\r\n\t\tZ._step = 1;\r\n\t\t\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\tbeginItem: function(beginItem) {\r\n\t\tif(beginItem === undefined) {\r\n\t\t\treturn this._beginItem;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBRangeSelect.beginItem', beginItem).isNumber();\r\n\t\tthis._beginItem = parseInt(beginItem);\r\n\t},\r\n\r\n\tendItem: function(endItem) {\r\n\t\tif(endItem === undefined) {\r\n\t\t\treturn this._endItem;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBRangeSelect.endItem', endItem).isNumber();\r\n\t\tthis._endItem = parseInt(endItem);\r\n\t},\r\n\r\n\tstep: function(step) {\r\n\t\tif(step === undefined) {\r\n\t\t\treturn this._step;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBRangeSelect.step', step).isNumber();\r\n\t\tthis._step = parseInt(step);\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn (el.tagName.toLowerCase() == 'select');\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field),\r\n\t\t\tvalueStyle = fldObj.valueStyle();\r\n\t\t\r\n\t\tif(Z.el.multiple && valueStyle != jslet.data.FieldValueStyle.MULTIPLE) {\r\n\t\t\tfldObj.valueStyle(jslet.data.FieldValueStyle.MULTIPLE);\r\n\t\t} else if(valueStyle == jslet.data.FieldValueStyle.MULTIPLE && !Z.el.multiple) {\r\n\t\t\tZ.el.multiple = \"multiple\";\t\r\n\t\t}\r\n\t\tZ.renderAll();\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tjqEl.on('change', Z._doChanged);// end observe\r\n\t\tjqEl.focus(function(event) {\r\n\t\t\tjslet.ui.focusManager.activeDataset(Z._dataset.name()).activeField(Z._field).activeValueIndex(Z._valueIndex);\r\n\t\t});\r\n\t\tjqEl.blur(function(event) {\r\n\t\t\tjslet.ui.focusManager.activeDataset(null).activeField(null).activeValueIndex(null);\r\n\t\t});\r\n\t\tif(Z.el.multiple) {\r\n\t\t\tjqEl.on('click', 'option', function () {\r\n\t\t\t\tZ._currOption = this;\r\n\t\t\t});// end observe\r\n\t\t}\r\n\t\tjqEl.addClass('form-control');//Bootstrap class\r\n\t}, // end bind\r\n\r\n\t_doChanged: function (event) {\r\n\t\tvar Z = this.jslet;\r\n\t\tif(Z.el.multiple) {\r\n\t\t\tif(Z.inProcessing) {\r\n\t\t\t\tZ.inProcessing = false;\r\n\t\t\t}\r\n\t\t\tvar fldObj = Z._dataset.getField(Z._field),\r\n\t\t\t\tlimitCount = fldObj.valueCountLimit();\r\n\t\t\tif(limitCount) {\r\n\t\t\t\tvar values = Z.getValue(),\r\n\t\t\t\t\tcount = 1;\r\n\t\t\t\tif(jslet.isArray(values)) {\r\n\t\t\t\t\tcount = values.length;\r\n\t\t\t\t}\r\n\t\t\t\tif (count >= limitCount) {\r\n\t\t\t\t\tjslet.showInfo(jslet.formatMessage(jslet.locale.DBCheckBoxGroup.invalidCheckedCount,\r\n\t\t\t\t\t\t\t[''\t+ limitCount]));\r\n\t\t\t\t\t\r\n\t\t\t\t\twindow.setTimeout(function(){\r\n\t\t\t\t\t\tif(Z._currOption) {\r\n\t\t\t\t\t\t\tZ.inProcessing = true;\r\n\t\t\t\t\t\t\tZ._currOption.selected = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 10);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.jslet.updateToDataset();\r\n\t},\r\n\t\t\r\n\trenderOptions: function () {\r\n\t\tvar Z = this,\r\n\t\t\tarrhtm = [];\r\n\t\t\r\n\t\tvar fldObj = Z._dataset.getField(Z._field);\r\n\t\tif (!fldObj.required()){\r\n\t\t\tarrhtm.push('<option value=\"_null_\">');\r\n\t\t\tarrhtm.push(fldObj.nullText());\r\n\t\t\tarrhtm.push('</option>');\r\n\t\t}\r\n\r\n\t\tfor (var i = Z._beginItem; i <= Z._endItem; i += Z._step) {\r\n\t\t\tarrhtm.push('<option value=\"');\r\n\t\t\tarrhtm.push(i);\r\n\t\t\tarrhtm.push('\">');\r\n\t\t\tarrhtm.push(i);\r\n\t\t\tarrhtm.push('</option>');\r\n\t\t}\r\n\t\tjQuery(Z.el).html(arrhtm.join(''));\r\n\t}, // end renderOptions\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoMetaChanged: function($super, metaName){\r\n\t\t$super(metaName);\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field);\r\n\t\tif(!metaName || metaName == \"disabled\" || metaName == \"readOnly\") {\r\n\t\t\tvar disabled = fldObj.disabled() || fldObj.readOnly();\r\n\t\t\tZ.el.disabled = disabled;\r\n\t\t\tjslet.ui.setEditableStyle(Z.el, disabled, disabled, true, fldObj.required());\r\n\t\t}\r\n\t\tif(!metaName || metaName == 'tabIndex') {\r\n\t\t\tZ.setTabIndex();\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoValueChanged: function() {\r\n\t\tvar Z = this;\r\n\t\tif (Z._keep_silence_) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!Z.el.multiple) {\r\n\t\t\tvar value = Z.getValue();\r\n\t\t\tif (value !== null) {\r\n\t\t\t\tZ.el.value = value;\r\n\t\t\t} else {\r\n\t\t\t\tZ.el.value = null;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar arrValue = Z.getValue(),\r\n\t\t\t\toptCnt = Z.el.options.length, opt, selected, i;\r\n\t\t\tZ._keep_silence_ = true;\r\n\t\t\ttry {\r\n\t\t\t\tfor (i = 0; i < optCnt; i++) {\r\n\t\t\t\t\topt = Z.el.options[i];\r\n\t\t\t\t\tif (opt) {\r\n\t\t\t\t\t\topt.selected = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar j, vcnt = arrValue.length - 1;\r\n\t\t\t\tfor (i = 0; i < optCnt; i++) {\r\n\t\t\t\t\topt = Z.el.options[i];\r\n\t\t\t\t\tfor (j = vcnt; j >= 0; j--) {\r\n\t\t\t\t\t\tselected = (arrValue[j] == opt.value);\r\n\t\t\t\t\t\tif (selected) {\r\n\t\t\t\t\t\t\topt.selected = selected;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} // end for j\r\n\t\t\t\t} // end for i\r\n\t\t\t} finally {\r\n\t\t\t\tZ._keep_silence_ = false;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\tfocus: function() {\r\n\t\tthis.el.focus();\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tthis.renderOptions();\r\n\t\tthis.refreshControl(jslet.data.RefreshEvent.updateAllEvent(), true);\r\n\t},\r\n\r\n\tupdateToDataset: function () {\r\n\t\tvar Z = this;\r\n\t\tif (Z._keep_silence_) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar value,\r\n\t\t\tisMulti = Z.el.multiple;\r\n\t\tif (!isMulti) {\r\n\t\t\tvalue = Z.el.value;\r\n\t\t\tvar fldObj = Z._dataset.getField(Z._field);\r\n\t\t\tif (value == '_null_' && !fldObj.required()) {\r\n\t\t\t\tvalue = null;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar opts = jQuery(Z.el).find('option'),\r\n\t\t\t\toptCnt = opts.length - 1, opt;\r\n\t\t\tvalue = [];\r\n\t\t\tfor (var i = 0; i <= optCnt; i++) {\r\n\t\t\t\topt = opts[i];\r\n\t\t\t\tif (opt.selected) {\r\n\t\t\t\t\tvalue.push(opt.value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tZ._keep_silence_ = true;\r\n\t\ttry {\r\n\t\t\tif (!isMulti) {\r\n\t\t\t\tZ._dataset.setFieldValue(Z._field, value, Z._valueIndex);\r\n\t\t\t} else {\r\n\t\t\t\tZ._dataset.setFieldValue(Z._field, value);\r\n\t\t\t}\r\n\t\t} finally {\r\n\t\t\tZ._keep_silence_ = false;\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tjQuery(this.el).off();\r\n\t\t$super();\r\n\t}\r\n});\r\n\r\njslet.ui.register('DBRangeSelect', jslet.ui.DBRangeSelect);\r\njslet.ui.DBRangeSelect.htmlTemplate = '<select></select>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBRating. \r\n * A control which usually displays some star to user, and user can click to rate something. Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"DBRating\",dataset:\"employee\",field:\"grade\", itemCount: 5};\r\n * \r\n * //1. Declaring:\r\n * &lt;div data-jslet='type:\"DBRating\",dataset:\"employee\",field:\"grade\"', itemCount: 5' />\r\n * or\r\n * &lt;div data-jslet='jsletParam' />\r\n * \r\n *  //2. Binding\r\n * &lt;div id=\"ctrlId\"  />\r\n * //Js snippet\r\n * var el = document.getElementById('ctrlId');\r\n * jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n * jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBRating = jslet.Class.create(jslet.ui.DBFieldControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,field,itemCount,splitCountitemWidth';\r\n\t\t/**\r\n\t\t * {Integer} Rate item count, In other words, the count of 'Star' sign.\r\n\t\t */\r\n\t\tZ._itemCount = 5;\r\n\t\t/**\r\n\t\t * {Integer} You can use it to split the 'Star' sign to describe decimal like: 1.5, 1.25.\r\n\t\t * SplitCount equals 2, that means cut 'Star' sign into two part, it can express: 0, 0.5, 1, 1.5, ...\r\n\t\t */\r\n\t\tZ._splitCount = 1;\r\n\t\t/**\r\n\t\t * {Integer} The width of one 'Star' sign.\r\n\t\t */\r\n\t\tZ._itemWidth = 20;\r\n\t\t/**\r\n\t\t * {Boolean} Required or not. If it is not required, you can rate 0 by double clicking first item. \r\n\t\t */\r\n\t\tZ._required = false;\r\n\t\t/**\r\n\t\t * {Boolean} read only or not.\r\n\t\t */\r\n\t\tZ._readOnly = false;\r\n\t\t\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\titemCount: function(itemCount) {\r\n\t\tif(itemCount === undefined) {\r\n\t\t\treturn this._itemCount;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBRating.itemCount', itemCount).isGTZero();\r\n\t\tthis._itemCount = parseInt(itemCount);\r\n\t},\r\n\r\n\tsplitCount: function(splitCount) {\r\n\t\tif(splitCount === undefined) {\r\n\t\t\treturn this._splitCount;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBRating.splitCount', splitCount).isGTZero();\r\n\t\tthis._splitCount = parseInt(splitCount);\r\n\t},\r\n\r\n\titemWidth: function(itemWidth) {\r\n\t\tif(itemWidth === undefined) {\r\n\t\t\treturn this._itemWidth;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBRating.itemWidth', itemWidth).isGTZero();\r\n\t\tthis._itemWidth = parseInt(itemWidth);\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn el.tagName.toLowerCase() == 'div';\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tvar Z = this;\r\n\r\n\t\tZ.renderAll();\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tjqEl.on('mousedown', 'td', Z._mouseDown);\r\n\t\tjqEl.on('mousemove', 'td', Z._mouseMove);\r\n\t\tjqEl.on('mouseout', 'td', Z._mouseOut);\r\n\t\tjqEl.on('mouseup', 'td', Z._mouseUp);\r\n\t}, // end bind\r\n\r\n\t_mouseMove: function domove(event) {\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\tvar rating = event.delegateTarget, Z = rating.jslet;\r\n\t\tif (Z._readOnly) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar jqRating = jQuery(rating),\r\n\t\t\tx1 = event.pageX - jqRating.offset().left,\r\n\t\t\tk = Math.ceil(x1 / Z.splitWidth), offsetW,\r\n\t\t\toRow = rating.firstChild.rows[0],\r\n\t\t\titemCnt = oRow.cells.length;\r\n\r\n\t\tvar valueNo = this.cellIndex + 1;\r\n\t\tfor (var i = 0; i < itemCnt; i++) {\r\n\t\t\tvar oitem = oRow.cells[i];\r\n\t\t\tZ._setBackgroundPos(oitem, Z._getPosX(i % Z._splitCount, i < valueNo ? 1: 2));\r\n\t\t}\r\n\t},\r\n\r\n\t_mouseOut: function doout(event) {\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\tvar Z = event.delegateTarget.jslet;\r\n\t\tif (Z._readOnly) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tZ.doValueChanged();\r\n\t},\r\n\r\n\t_mouseDown: function dodown(event) {\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\tvar rating = event.delegateTarget,\r\n\t\tZ = rating.jslet;\r\n\t\tif (Z._readOnly) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar oRow = rating.firstChild.rows[0],\r\n\t\t\titemCnt = oRow.cells.length;\r\n\t\t\r\n\t\t//if can set zero and current item is first one, then clear value\r\n\t\tvar k = this.cellIndex+1;\r\n\t\tif (!Z._required && k == 1) {\r\n\t\t\tk = (Z.value * Z._splitCount) == 1 ? 0 : 1;\r\n\t\t}\r\n\t\tZ.value = k / Z._splitCount;\r\n\t\tZ._dataset.setFieldValue(Z._field, Z.value, Z._valueIndex);\r\n\t\tZ.doValueChanged();\r\n\t},\r\n\r\n\t_mouseUp: function(event) {\r\n\t\tevent = jQuery.event.fix( event || window.event );\r\n\t\tvar rating = event.delegateTarget,\r\n\t\t\toRow = rating.firstChild.rows[0],\r\n\t\t\tZ = rating.jslet;\r\n\t\tif (Z._readOnly) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (Z._selectedItem >= 0) {\r\n\t\t\tvar oitem = oRow.cells[Z._selectedItem];\r\n\t\t\tZ._setBackgroundPos(oitem, Z._selectedPx);\r\n\t\t}\r\n\t},\r\n\r\n\t_getPosX: function(index, status){\r\n\t\tvar Z = this, isRtl = jslet.locale.isRtl,bgX;\r\n\t\tbgX = 0 - status * Z._itemWidth;\r\n\t\tif (isRtl){\r\n\t\t\tbgX += (index+1)*Z.splitWidth - Z._itemWidth;\r\n\t\t} else {\r\n\t\t\tbgX -= index * Z.splitWidth;\r\n\t\t}\r\n\t\treturn bgX;\r\n\t},\r\n\t\r\n\t_setBackgroundPos: function (oitem, posX) {\r\n\t\tif (oitem.style.backgroundPositionX !== undefined) {\r\n\t\t\toitem.style.backgroundPositionX = posX + 'px';\r\n\t\t} else {\r\n\t\t\toitem.style.backgroundPosition = posX + 'px 0px';\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoMetaChanged: function($super, metaName){\r\n\t\t$super(metaName);\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field);\r\n\t\tif(!metaName || metaName == \"disabled\" || metaName == \"readOnly\") {\r\n\t\t\tZ._readOnly = fldObj.disabled() || fldObj.readOnly();\r\n\t\t}\r\n\t\tif(!metaName || metaName == \"required\") {\r\n\t\t\tZ._required = fldObj.required();\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoValueChanged: function() {\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field),\r\n\t\t\tvalue = Z.getValue(),\r\n\t\t\titemCnt = Z._itemCount * Z._splitCount,\r\n\t\t\tvalueNo = Math.ceil(value * Z._splitCount),\r\n\t\t\toitem, offsetW, bgX, ratingRow = Z.el.firstChild.rows[0],\r\n\t\t\tbgW = Z._itemWidth * 2,\r\n\t\t\tisRtl = jslet.locale.isRtl;\r\n\t\t\r\n\t\tZ.value = value;\r\n\t\tfor (var i = 0; i < itemCnt; i++) {\r\n\t\t\toitem = ratingRow.childNodes[i];\r\n\t\t\tZ._setBackgroundPos(oitem, Z._getPosX(i % Z._splitCount, i < valueNo ? 0: 2));\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tvar Z = this, \r\n\t\t\tfldObj = Z._dataset.getField(Z._field);\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tif (!jqEl.hasClass('jl-rating')) {\r\n\t\t\tjqEl.addClass('jl-rating');\r\n\t\t}\r\n\t\tjqEl.html('<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"table-layout:fixed;border-collapse:collapse\"><tr></tr></table>');\r\n\r\n\t\tvar oitem, itemCnt = Z._itemCount * Z._splitCount,\r\n\t\t\totr = Z.el.firstChild.rows[0];\r\n\t\t\t\r\n\t\tZ.splitWidth = parseInt(Z._itemWidth / Z._splitCount);\r\n\t\tfor (var i = 1; i <= itemCnt; i++) {\r\n\t\t\toitem = document.createElement('td');\r\n\t\t\toitem.className = 'jl-rating-item';\r\n\t\t\toitem.style.width = Z.splitWidth + 'px';\r\n\t\t\toitem.style.height = Z._itemWidth + 'px';\r\n\t\t\toitem.title = i / Z._splitCount;\r\n\t\t\totr.appendChild(oitem);\r\n\t\t}\r\n\t\tjqEl.width(Z._itemCount * Z._itemWidth);\r\n\t\tZ.refreshControl(jslet.data.RefreshEvent.updateAllEvent(), true);\r\n\t}, // end renderAll\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tvar jqEl = jQuery(this.el);\r\n\t\tjqEl.off();\r\n\t\t\r\n\t\t$super();\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tcanFocus: function() {\r\n\t\treturn false;\r\n\t}\r\n\t\r\n});\r\n\r\njslet.ui.DBRating.CHECKED = 0;\r\njslet.ui.DBRating.UNCHECKED = 1;\r\njslet.ui.DBRating.FOCUS = 2;\r\n\r\njslet.ui.register('DBRating', jslet.ui.DBRating);\r\njslet.ui.DBRating.htmlTemplate = '<Div></Div>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBSelect. Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"DBSelect\",dataset:\"employee\",field:\"department\"};\r\n * \r\n * //1. Declaring:\r\n * &lt;select data-jslet='type:\"DBSelect\",dataset:\"employee\",field:\"department\"' />\r\n * or\r\n * &lt;select data-jslet='jsletParam' />\r\n *\r\n *  //2. Binding\r\n * &lt;select id=\"ctrlId\"  />\r\n * //Js snippet\r\n * var el = document.getElementById('ctrlId');\r\n * jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n * jslet.ui.createControl(jsletParam, document.body);\r\n * \r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBSelect = jslet.Class.create(jslet.ui.DBFieldControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,field,groupField,lookupDataset';\r\n\r\n\t\tZ._groupField = null;\r\n\t\t\r\n\t\tZ._lookupDataset = null;\r\n\t\t\r\n\t\tZ._enableInvalidTip = true;\r\n\t\t\r\n\t\tZ._innerEditFilterExpr = null;\r\n\t\t\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * {String} Group field name, you can use this to group options.\r\n\t * Detail to see html optgroup element.\r\n\t */\r\n\tgroupField: function(groupField) {\r\n\t\tif(groupField === undefined) {\r\n\t\t\treturn this._groupField;\r\n\t\t}\r\n\t\tgroupField = jQuery.trim(groupField);\r\n\t\tjslet.Checker.test('DBSelect.groupField', groupField).isString();\r\n\t\tthis._groupField = groupField;\r\n\t},\r\n\t\r\n\t/**\r\n\t * {String or jslet.data.Dataset} It will use this dataset to render Select Options.\r\n\t */\r\n\tlookupDataset: function(lookupDataset) {\r\n\t\tif(lookupDataset === undefined) {\r\n\t\t\treturn this._lookupDataset;\r\n\t\t}\r\n\r\n\t\tif (jslet.isString(lookupDataset)) {\r\n\t\t\tlookupDataset = jslet.data.dataModule.get(jQuery.trim(lookupDataset));\r\n\t\t}\r\n\t\t\r\n\t\tjslet.Checker.test('DBSelect.lookupDataset', lookupDataset).isClass(jslet.data.Dataset.className);\r\n\t\tthis._lookupDataset = lookupDataset;\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\treturn (el.tagName.toLowerCase() == 'select');\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field),\r\n\t\t\tvalueStyle = fldObj.valueStyle();\r\n\t\t\r\n\t\tif(Z.el.multiple && valueStyle != jslet.data.FieldValueStyle.MULTIPLE) {\r\n\t\t\tfldObj.valueStyle(jslet.data.FieldValueStyle.MULTIPLE);\r\n\t\t} else if(valueStyle == jslet.data.FieldValueStyle.MULTIPLE && !Z.el.multiple) {\r\n\t\t\tZ.el.multiple = \"multiple\";\t\r\n\t\t}\r\n\t\tZ.renderAll();\r\n\r\n\t\tvar jqEl = jQuery(Z.el);\r\n\t\tjqEl.on('change', Z._doChanged);\r\n\t\tjqEl.focus(function(event) {\r\n\t\t\tjslet.ui.focusManager.activeDataset(Z._dataset.name()).activeField(Z._field).activeValueIndex(Z._valueIndex);\r\n\t\t});\r\n\t\tjqEl.blur(function(event) {\r\n\t\t\tjslet.ui.focusManager.activeDataset(null).activeField(null).activeValueIndex(null);\r\n\t\t});\r\n\t\tif(Z.el.multiple) {\r\n\t\t\tjqEl.on('click', 'option', Z._doCheckLimitCount);\r\n\t\t}\r\n\t\tjqEl.addClass('form-control');//Bootstrap class\r\n\t\tZ.doMetaChanged('required');\r\n\t}, // end bind\r\n\r\n\t_doChanged: function (event) {\r\n\t\tvar Z = this.jslet;\r\n\t\tif(Z.el.multiple) {\r\n\t\t\tif(Z.inProcessing) {\r\n\t\t\t\tZ.inProcessing = false;\r\n\t\t\t}\r\n\t\t\tvar fldObj = Z._dataset.getField(Z._field),\r\n\t\t\t\tlimitCount = fldObj.valueCountLimit();\r\n\r\n\t\t\tif(limitCount) {\r\n\t\t\t\tvar values = Z._dataset.getFieldValue(Z._field),\r\n\t\t\t\t\tcount = 1;\r\n\t\t\t\tif(jslet.isArray(values)) {\r\n\t\t\t\t\tcount = values.length;\r\n\t\t\t\t}\r\n\t\t\t\tif (count >= limitCount) {\r\n\t\t\t\t\tjslet.showInfo(jslet.formatMessage(jslet.locale.DBCheckBoxGroup.invalidCheckedCount,\r\n\t\t\t\t\t\t\t[''\t+ limitCount]));\r\n\t\t\t\t\t\r\n\t\t\t\t\twindow.setTimeout(function(){\r\n\t\t\t\t\t\tif(Z._currOption) {\r\n\t\t\t\t\t\t\tZ.inProcessing = true;\r\n\t\t\t\t\t\t\tZ._currOption.selected = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 10);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.jslet.updateToDataset();\r\n\t},\r\n\t\r\n\t_doCheckLimitCount: function(event) {\r\n\t\tvar Z = event.delegateTarget.jslet;\r\n\t\tZ._currOption = this;\r\n\t},\r\n\r\n\t_setDefaultValue: function(fldObj, firstItemValue) {\r\n\t\tif(!firstItemValue || !fldObj.required()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar dftValue = fldObj.defaultValue();\r\n\t\tif(dftValue) {\r\n\t\t\tvar lkds = fldObj.lookup().dataset();\r\n\t\t\tvar found = lkds.findByKey(dftValue);\r\n\t\t\tif(found) {\r\n\t\t\t\treturn;\r\n\t\t\t} else {\r\n\t\t\t\tdftValue = null;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif(!dftValue) {\r\n\t\t\tfldObj.defaultValue(firstItemValue);\r\n\t\t}\r\n\t\tif(this._dataset.changedStatus() && !fldObj.getValue()) {\r\n\t\t\tfldObj.setValue(firstItemValue);\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoLookupChanged: function () {\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field),\r\n\t\t\tlkf = fldObj.lookup();\r\n\t\tif(Z._lookupDataset) {\r\n\t\t\tlkf = new jslet.data.FieldLookup();\r\n\t\t\tlkf.dataset(Z._lookupDataset);\r\n\t\t} else {\r\n\t\t\tif (!lkf) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar lkds = lkf.dataset(),\r\n\t\t\tgroupIsLookup = false,\r\n\t\t\tgroupLookup, \r\n\t\t\tgroupFldObj, \r\n\t\t\textraIndex;\r\n\r\n\t\tif (Z._groupField) {\r\n\t\t\tgroupFldObj = lkds.getField(Z._groupField);\r\n\t\t\tif (groupFldObj === null) {\r\n\t\t\t\tthrow 'NOT found field: ' + Z._groupField + ' in ' + lkds.name();\r\n\t\t\t}\r\n\t\t\tgroupLookup = groupFldObj.lookup();\r\n\t\t\tgroupIsLookup = (groupLookup !== null);\r\n\t\t\tif (groupIsLookup) {\r\n\t\t\t\textraIndex = Z._groupField + '.' + groupLookup.codeField();\r\n\t\t\t} else {\r\n\t\t\t\textraIndex = Z._groupField;\r\n\t\t\t}\r\n\t\t\tvar indfld = lkds.indexFields();\r\n\t\t\tif (indfld) {\r\n\t\t\t\tlkds.indexFields(extraIndex + ';' + indfld);\r\n\t\t\t} else {\r\n\t\t\t\tlkds.indexFields(extraIndex);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar preGroupValue = null, groupValue, groupDisplayValue, content = [];\r\n\r\n\t\tif (!Z.el.multiple && !fldObj.required()){\r\n\t\t\tcontent.push('<option value=\"_null_\">');\r\n\t\t\tcontent.push(fldObj.nullText());\r\n\t\t\tcontent.push('</option>');\r\n\t\t}\r\n\t\tvar oldRecno = lkds.recno(),\r\n\t\t\toptValue, optDispValue, \r\n\t\t\tfirstItemValue = null,\r\n\t\t\teditFilter = lkf.editFilter();\r\n\t\tZ._innerEditFilterExpr = null;\r\n\t\tvar editItemDisabled = lkf.editItemDisabled();\r\n\t\tif(editFilter) {\r\n\t\t\tZ._innerEditFilterExpr = new jslet.Expression(lkds, editFilter);\r\n\t\t}\r\n\t\tvar disableOption = false;\r\n\t\ttry {\r\n\t\t\tfor (var i = 0, cnt = lkds.recordCount(); i < cnt; i++) {\r\n\t\t\t\tlkds.recnoSilence(i);\r\n\t\t\t\tdisableOption = false;\r\n\t\t\t\tif(Z._innerEditFilterExpr && !Z._innerEditFilterExpr.eval()) {\r\n\t\t\t\t\tif(!editItemDisabled) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdisableOption = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (Z._groupField) {\r\n\t\t\t\t\tgroupValue = lkds.getFieldValue(Z._groupField);\r\n\t\t\t\t\tif (groupValue != preGroupValue) {\r\n\t\t\t\t\t\tif (preGroupValue !== null) {\r\n\t\t\t\t\t\t\tcontent.push('</optgroup>');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (groupIsLookup) {\r\n\t\t\t\t\t\t\tif (!groupLookup.dataset()\r\n\t\t\t\t\t\t\t\t\t\t\t.findByField(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tgroupLookup\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.keyField(),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tgroupValue)) {\r\n\t\t\t\t\t\t\t\tthrow 'Not found: [' + groupValue + '] in Dataset: [' +\r\n\t\t\t\t\t\t\t\t\tgroupLookup.dataset().name() +\r\n\t\t\t\t\t\t\t\t\t']field: [' + groupLookup.keyField() + ']';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tgroupDisplayValue = groupLookup.getCurrentDisplayValue();\r\n\t\t\t\t\t\t} else\r\n\t\t\t\t\t\t\tgroupDisplayValue = groupValue;\r\n\r\n\t\t\t\t\t\tcontent.push('<optgroup label=\"');\r\n\t\t\t\t\t\tcontent.push(groupDisplayValue);\r\n\t\t\t\t\t\tcontent.push('\">');\r\n\t\t\t\t\t\tpreGroupValue = groupValue;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tcontent.push('<option value=\"');\r\n\t\t\t\toptValue = lkds.getFieldValue(lkf.keyField());\r\n\t\t\t\tif(firstItemValue === null) {\r\n\t\t\t\t\tfirstItemValue = optValue;\r\n\t\t\t\t}\r\n\t\t\t\tcontent.push(optValue);\r\n\t\t\t\tcontent.push('\"'+ (disableOption? ' disabled': '') +  '>');\r\n\t\t\t\tcontent.push(lkf.getCurrentDisplayValue());\r\n\t\t\t\tcontent.push('</option>');\r\n\t\t\t} // end for\r\n\t\t\tif (preGroupValue !== null) {\r\n\t\t\t\tcontent.push('</optgroup>');\r\n\t\t\t}\r\n\t\t\tjQuery(Z.el).html(content.join(''));\r\n\t\t\tZ._setDefaultValue(fldObj, firstItemValue);\r\n\t\t\tZ.doValueChanged();\r\n\t\t} finally {\r\n\t\t\tlkds.recnoSilence(oldRecno);\r\n\t\t}\r\n\t}, // end renderOptions\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoMetaChanged: function($super, metaName){\r\n\t\t$super(metaName);\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field);\r\n\t\tif(!metaName || metaName == \"disabled\" || metaName == \"readOnly\") {\r\n\t\t\tvar disabled = fldObj.disabled() || fldObj.readOnly();\r\n\t\t\tZ.el.disabled = disabled;\r\n\t\t\tjslet.ui.setEditableStyle(Z.el, disabled, disabled, true, fldObj.required());\r\n\t\t}\r\n\t\tif(metaName && metaName == 'required') {\r\n\t\t\tvar jqEl = jQuery(Z.el);\r\n\t\t\tif (fldObj.required()) {\r\n\t\t\t\tjqEl.addClass('jl-ctrl-required');\r\n\t\t\t} else {\r\n\t\t\t\tjqEl.removeClass('jl-ctrl-required');\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(!metaName || metaName == 'tabIndex') {\r\n\t\t\tZ.setTabIndex();\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoValueChanged: function() {\r\n\t\tvar Z = this;\r\n\t\tif (Z._skipRefresh) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar errObj = Z.getFieldError();\r\n\t\tif(errObj && errObj.message) {\r\n\t\t\tZ.el.value = errObj.inputText;\r\n\t\t\tZ.renderInvalid(errObj);\r\n\t\t\treturn;\r\n\t\t} else {\r\n\t\t\tZ.renderInvalid(null);\r\n\t\t}\r\n\t\tvar value = Z.getValue();\r\n\t\tif(!Z.el.multiple && value === Z.el.value) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar i, optCnt = Z.el.options.length, \r\n\t\t\topt;\r\n\t\tfor (i = 0; i < optCnt; i++) {\r\n\t\t\topt = Z.el.options[i];\r\n\t\t\tif (opt) {\r\n\t\t\t\topt.selected = false;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tvar fldObj = Z._dataset.getField(Z._field);\r\n\t\tif (!Z.el.multiple) {\r\n\t\t\tif(!Z._checkOptionEditable(fldObj, value)) {\r\n\t\t\t\tvalue = null;\r\n\t\t\t}\r\n\t\t\tif (value === null){\r\n\t\t\t\tif (!fldObj.required()) {\r\n\t\t\t\t\tvalue = '_null_';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tZ.el.value = value;\r\n\t\t} else {\r\n\t\t\tvar arrValue = value;\r\n\t\t\tif(arrValue === null || arrValue.length === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\tvar vcnt = arrValue.length - 1, selected;\r\n\t\t\tZ._skipRefresh = true;\r\n\t\t\ttry {\r\n\t\t\t\tfor (i = 0; i < optCnt; i++) {\r\n\t\t\t\t\topt = Z.el.options[i];\r\n\r\n\t\t\t\t\tfor (var j = vcnt; j >= 0; j--) {\r\n\t\t\t\t\t\tselected = (arrValue[j] == opt.value);\r\n\t\t\t\t\t\tif (selected) {\r\n\t\t\t\t\t\t\topt.selected = selected;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} // end for j\r\n\t\t\t\t} // end for i\r\n\t\t\t} finally {\r\n\t\t\t\tZ._skipRefresh = false;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n \r\n\t_checkOptionEditable: function(fldObj, fldValue) {\r\n\t\tvar Z = this;\r\n\t\tif(!Z._innerEditFilterExpr || fldValue === null || fldValue === undefined || fldValue === '') {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tvar lkDs = fldObj.lookup().dataset(); \r\n\t\tif(lkDs.findByKey(fldValue) && !Z._innerEditFilterExpr.eval()) {\r\n\t\t\treturn false;\r\n\t\t} else {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tthis.refreshControl(jslet.data.RefreshEvent.updateAllEvent(), true);\r\n\t},\r\n\r\n\tupdateToDataset: function () {\r\n\t\tvar Z = this;\r\n\t\tif (Z._skipRefresh) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar opt, value,\r\n\t\t\tisMulti = Z.el.multiple;\r\n\t\tif (!isMulti) {\r\n\t\t\tvalue = Z.el.value;\r\n\t\t\tif (!value) {\r\n\t\t\t\topt = Z.el.options[Z.el.selectedIndex];\r\n\t\t\t\tvalue = opt.innerHTML;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar opts = jQuery(Z.el).find('option'),\r\n\t\t\t\toptCnt = opts.length - 1;\r\n\t\t\tvalue = [];\r\n\t\t\tfor (var i = 0; i <= optCnt; i++) {\r\n\t\t\t\topt = opts[i];\r\n\t\t\t\tif (opt.selected) {\r\n\t\t\t\t\tvalue.push(opt.value ? opt.value : opt.innerHTML);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tZ._skipRefresh = true;\r\n\t\ttry {\r\n\t\t\tif (!isMulti) {\r\n\t\t\t\tvar fldObj = Z._dataset.getField(Z._field);\r\n\t\t\t\tif (value == '_null_' && !fldObj.required()) {\r\n\t\t\t\t\tvalue = null;\r\n\t\t\t\t}\r\n\t\t\t\tZ._dataset.setFieldValue(Z._field, value, Z._valueIndex);\r\n\t\t\t} else {\r\n\t\t\t\tZ._dataset.setFieldValue(Z._field, value);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t} finally {\r\n\t\t\tZ._skipRefresh = false;\r\n\t\t}\r\n\t}, // end updateToDataset\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tthis._currOption = null;\r\n\t\tjQuery(this.el).off();\r\n\t\t$super();\r\n\t}\r\n});\r\n\r\njslet.ui.register('DBSelect', jslet.ui.DBSelect);\r\njslet.ui.DBSelect.htmlTemplate = '<select></select>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBSpinEdit. \r\n * <pre><code>\r\n * var jsletParam = {type:\"DBSpinEdit\",dataset:\"employee\",field:\"age\", minValue:18, maxValue: 100, step: 5};\r\n * \r\n * //1. Declaring:\r\n * &lt;div data-jslet='type:\"DBSpinEdit\",dataset:\"employee\",field:\"age\", minValue:18, maxValue: 100, step: 5' />\r\n * or\r\n * &lt;div data-jslet='jsletParam' />\r\n *\r\n *  //2. Binding\r\n * &lt;div id=\"ctrlId\"  />\r\n * //Js snippet\r\n * var el = document.getElementById('ctrlId');\r\n * jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n * jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBSpinEdit = jslet.Class.create(jslet.ui.DBFieldControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,field,step';\r\n\r\n\t\tZ._step = 1;\r\n\t\t\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * {Integer} Step value.\r\n\t */\r\n\tstep: function(step) {\r\n\t\tif(step === undefined) {\r\n\t\t\treturn this._step;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBSpinEdit.step', step).isNumber();\r\n\t\tthis._step = step;\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\tvar tag = el.tagName.toLowerCase();\r\n\t\treturn tag == 'div';\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\tif(!jqEl.hasClass('jl-spinedit')) {\r\n\t\t\tjqEl.addClass('input-group jl-spinedit');\r\n\t\t}\r\n\t\tZ._createControl();\r\n\t\tZ.renderAll();\r\n\t},\r\n\r\n\t_createControl: function() {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\ts = '<input type=\"text\" class=\"form-control\">' + \r\n\t\t    \t'<div class=\"jl-spinedit-btn-group\">' +\r\n\t\t    \t'<button class=\"btn btn-default jl-spinedit-up\" tabindex=\"-1\"><i class=\"fa fa-caret-up\"></i></button>' + \r\n\t\t    \t'<button class=\"btn btn-default jl-spinedit-down\" tabindex=\"-1\"><i class=\"fa fa-caret-down\"></i></button>';\r\n\t\tjqEl.html(s);\r\n\t\t\r\n\t\tvar editor = jqEl.find('input')[0],\r\n\t\t\tupButton = jqEl.find('.jl-spinedit-up')[0],\r\n\t\t\tdownButton = jqEl.find('.jl-spinedit-down')[0];\r\n\t\tZ.editor = editor;\r\n\t\tjQuery(Z.editor).on(\"keydown\", function(event){\r\n\t\t\tif(Z._isDisabled()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar keyCode = event.keyCode;\r\n\t\t\tif(keyCode === jslet.ui.KeyCode.UP) {\r\n\t\t\t\tZ.decValue();\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif(keyCode === jslet.ui.KeyCode.DOWN) {\r\n\t\t\t\tZ.incValue();\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t});\r\n\t\tnew jslet.ui.DBText(editor, {\r\n\t\t\tdataset: Z._dataset,\r\n\t\t\tfield: Z._field,\r\n\t\t\tbeforeUpdateToDataset: Z.beforeUpdateToDataset,\r\n\t\t\tvalueIndex: Z._valueIndex,\r\n\t\t\ttabIndex: Z._tabIndex\r\n\t\t});\r\n\t\t\r\n\t\tvar jqBtn = jQuery(upButton);\r\n\t\tjqBtn.on('click', function () {\r\n\t\t\tZ.incValue();\r\n\t\t});\r\n\t\t\r\n\t\tjqBtn.focus(function(event) {\r\n\t\t\tjslet.ui.focusManager.activeDataset(Z._dataset.name()).activeField(Z._field).activeValueIndex(Z._valueIndex);\r\n\t\t});\r\n\t\tjqBtn.blur(function(event) {\r\n\t\t\tjslet.ui.focusManager.activeDataset(null).activeField(null).activeValueIndex(null);\r\n\t\t});\r\n\t\t\r\n\t\tjqBtn = jQuery(downButton);\r\n\t\tjqBtn.on('click', function () {\r\n\t\t\tZ.decValue();\r\n\t\t});\r\n\t\t\r\n\t\tjqBtn.focus(function(event) {\r\n\t\t\tjslet.ui.focusManager.activeDataset(Z._dataset.name()).activeField(Z._field).activeValueIndex(Z._valueIndex);\r\n\t\t});\r\n\t\tjqBtn.blur(function(event) {\r\n\t\t\tjslet.ui.focusManager.activeDataset(null).activeField(null).activeValueIndex(null);\r\n\t\t});\r\n\t},\r\n\t\r\n\t_isDisabled: function() {\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field);\r\n\t\treturn fldObj.disabled() || fldObj.readOnly();\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbeforeUpdateToDataset: function () {\r\n\t\tvar Z = this,\r\n\t\t\tval = Z.el.value;\r\n\t\tvar fldObj = Z._dataset.getField(Z._field),\r\n\t\t\trange = fldObj.dataRange(),\r\n\t\t\tminValue = Number.NEGATIVE_INFINITY, \r\n\t\t\tmaxValue = Number.POSITIVE_INFINITY;\r\n\t\t\r\n\t\tif(range) {\r\n\t\t\tif(range.min || range.min === 0) {\r\n\t\t\t\tminValue = parseFloat(range.min);\r\n\t\t\t}\r\n\t\t\tif(range.max || range.min === 0) {\r\n\t\t\t\tmaxValue = parseFloat(range.max);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (val) {\r\n\t\t\tval = parseFloat(val);\r\n\t\t}\r\n\t\tjQuery(Z.el).attr('aria-valuenow', val);\r\n\t\tZ.el.value = val;\r\n\t\treturn true;\r\n\t},\r\n\r\n\tsetValueToDataset: function (val) {\r\n\t\tvar Z = this;\r\n\t\tif (Z.silence) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tZ.silence = true;\r\n\t\tif (val === undefined) {\r\n\t\t\tval = Z.value;\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tZ._dataset.setFieldValue(Z._field, val, Z._valueIndex);\r\n\t\t} finally {\r\n\t\t\tZ.silence = false;\r\n\t\t}\r\n\t},\r\n\r\n\tincValue: function () {\r\n\t\tvar Z = this,\r\n\t\t\tval = Z.getValue();\r\n\t\tif (!val) {\r\n\t\t\tval = 0;\r\n\t\t}\r\n\t\tvar maxValue = Z._getRange().maxValue;\r\n\t\tif (val === maxValue) {\r\n\t\t\treturn;\r\n\t\t} else if (val < maxValue) {\r\n\t\t\tval += Z._step;\r\n\t\t} else {\r\n\t\t\tval = maxValue;\r\n\t\t}\r\n\t\tif (val > maxValue) {\r\n\t\t\tval = maxValue;\r\n\t\t}\r\n\t\tjQuery(Z.el).attr('aria-valuenow', val);\r\n\t\tZ.setValueToDataset(val);\r\n\t},\r\n\r\n\t_getRange: function() {\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field),\r\n\t\t\trange = fldObj.dataRange(),\r\n\t\t\tminValue = Number.NEGATIVE_INFINITY, \r\n\t\t\tmaxValue = Number.POSITIVE_INFINITY;\r\n\t\t\r\n\t\tif(range) {\r\n\t\t\tif(range.min || range.min === 0) {\r\n\t\t\t\tminValue = parseFloat(range.min);\r\n\t\t\t}\r\n\t\t\tif(range.max || range.min === 0) {\r\n\t\t\t\tmaxValue = parseFloat(range.max);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {minValue: minValue, maxValue: maxValue};\r\n\t},\r\n\t\r\n\tdecValue: function () {\r\n\t\tvar Z = this,\r\n\t\t\tval = Z.getValue();\r\n\t\tif (!val) {\r\n\t\t\tval = 0;\r\n\t\t}\r\n\t\tvar minValue = Z._getRange().minValue;\r\n\t\tif (val === minValue) {\r\n\t\t\treturn;\r\n\t\t} else if (val > minValue) {\r\n\t\t\tval -= Z._step;\r\n\t\t} else {\r\n\t\t\tval = minValue;\r\n\t\t}\r\n\t\tif (val < minValue)\r\n\t\t\tval = minValue;\r\n\t\tjQuery(Z.el).attr('aria-valuenow', val);\r\n\t\tZ.setValueToDataset(val);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinnerFocus: function() {\r\n\t\tthis.editor.focus();\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoMetaChanged: function($super, metaName) {\r\n\t\t$super(metaName);\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(this.el),\r\n\t\t\tfldObj = Z._dataset.getField(Z._field);\r\n\t\t\r\n\t\tif(!metaName || metaName == 'disabled' || metaName == 'readOnly') {\r\n\t\t\tvar disabled = fldObj.disabled() || fldObj.readOnly(),\r\n\t\t\t\tjqUpBtn = jqEl.find('.jl-spinedit-up'),\r\n\t\t\t\tjqDownBtn = jqEl.find('.jl-spinedit-down');\r\n\t\t\t\t\r\n\t\t\tif (disabled) {\r\n\t\t\t\tjqUpBtn.attr('disabled', 'disabled');\r\n\t\t\t\tjqDownBtn.attr('disabled', 'disabled');\r\n\t\t\t} else {\r\n\t\t\t\tjqUpBtn.attr('disabled', false);\r\n\t\t\t\tjqDownBtn.attr('disabled', false);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(!metaName || metaName == 'dataRange') {\r\n\t\t\tvar range = fldObj.dataRange();\r\n\t\t\tjqEl.attr('aria-valuemin', range && (range.min || range.min === 0) ? range.min: '');\r\n\t\t\tjqEl.attr('aria-valuemin', range && (range.max || range.max === 0) ? range.max: '');\r\n\t\t}\r\n\t\tif(!metaName || metaName == 'tabIndex') {\r\n\t\t\tZ.setTabIndex();\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function(){\r\n\t\tthis.refreshControl(jslet.data.RefreshEvent.updateAllEvent(), true);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\ttableId: function($super, tableId){\r\n\t\t$super(tableId);\r\n\t\tthis.editor.jslet.tableId(tableId);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function(){\r\n\t\tvar jqEl = jQuery(this.el);\r\n\t\tjQuery(this.editor).off();\r\n\t\tthis.editor = null;\r\n\t\tjqEl.find('.jl-upbtn-up').off();\r\n\t\tjqEl.find('.jl-downbtn-up').off();\r\n\t}\r\n\t\r\n});\r\njslet.ui.register('DBSpinEdit', jslet.ui.DBSpinEdit);\r\njslet.ui.DBSpinEdit.htmlTemplate = '<div></div>';\r\n\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBTimePicker is used for time inputting. Example:\r\n * <pre><code>\r\n * var jsletParam = {type:\"DBTimePicker\",field:\"time\"};\r\n * //1. Declaring:\r\n *  &lt;input id=\"ctrlId\" type=\"text\" data-jslet='jsletParam' />\r\n *  or\r\n *  &lt;input id=\"ctrlId\" type=\"text\" data-jslet='{type:\"DBTimePicker\",field:\"time\"}' />\r\n *  \r\n *  //2. Binding\r\n *  &lt;input id=\"ctrlId\" type=\"text\" data-jslet='jsletParam' />\r\n *  //Js snippet\r\n *  var el = document.getElementById('ctrlId');\r\n *  jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n *  jslet.ui.createControl(jsletParam, document.body);\r\n *\r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBTimePicker = jslet.Class.create(jslet.ui.DBFieldControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,field,is12Hour,hasSecond';\r\n\t\t\r\n\t\tZ._is12Hour = false;\r\n\t\t\r\n\t\tZ._hasSecond = false;\r\n\t\t\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\tis12Hour: function(is12Hour) {\r\n\t\tif(is12Hour === undefined) {\r\n\t\t\treturn this._is12Hour;\r\n\t\t}\r\n\t\tthis._is12Hour = is12Hour? true: false;\r\n\t},\r\n\r\n\thasSecond: function(hasSecond) {\r\n\t\tif(hasSecond === undefined) {\r\n\t\t\treturn this._hasSecond;\r\n\t\t}\r\n\t\tthis._hasSecond = hasSecond? true: false;\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\tvar tagName = el.tagName.toLowerCase();\r\n\t\treturn tagName == 'div' || tagName == 'span';\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\tif(!jqEl.hasClass('jl-timepicker')) {\r\n\t\t\tjqEl.addClass('form-control jl-timepicker');\r\n\t\t}\r\n\t\tZ.renderAll();\r\n\t\tjqEl.on('change', 'select', function(event){\r\n\t\t\tZ.updateToDataset();\r\n\t\t});\r\n\t}, // end bind\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\tfldObj = Z._dataset.getField(Z._field),\r\n\t\t\trange = fldObj.dataRange(),\r\n\t\t\tminTimePart = {hour: 0, minute: 0, second: 0},\r\n\t\t\tmaxTimePart = {hour: 23, minute: 59, second: 59};\r\n\t\t\r\n\t\tif(range) {\r\n\t\t\tif(range.min) {\r\n\t\t\t\tminTimePart = Z._splitTime(range.min);\r\n\t\t\t}\r\n\t\t\tif(range.max) {\r\n\t\t\t\tmaxTimePart = Z._splitTime(range.max);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar\ttmpl = [];\r\n\t\t\r\n\t\ttmpl.push('<select class=\"jl-time-hour\">');\r\n\t\tif(Z._is12Hour) {\r\n\t\t\tvar minHour = minTimePart.hour;\r\n\t\t\tvar maxHour = maxTimePart.hour;\r\n\t\t\tvar min = 100, max = 0, hour;\r\n\t\t\tfor(var k = minHour; k < maxHour; k++) {\r\n\t\t\t\thour = k;\r\n\t\t\t\tif( k > 11) {\r\n\t\t\t\t\thour = k - 12;\r\n\t\t\t\t}\r\n\t\t\t\tmin = Math.min(min, hour);\r\n\t\t\t\tmax = Math.max(max, hour);\r\n\t\t\t}\r\n\t\t\ttmpl.push(Z._getOptions(min, max));\r\n\t\t} else {\r\n\t\t\ttmpl.push(Z._getOptions(minTimePart.hour, maxTimePart.hour || 23));\r\n\t\t}\r\n\t\ttmpl.push('</select>');\r\n\t\t\r\n\t\ttmpl.push('<select class=\"jl-time-minute\">');\r\n\t\ttmpl.push(Z._getOptions(0, 59));\r\n\t\ttmpl.push('</select>');\r\n\t\t\r\n\t\tif(Z._hasSecond) {\r\n\t\t\ttmpl.push('<select class=\"jl-time-second\">');\r\n\t\t\ttmpl.push(Z._getOptions(0, 59));\r\n\t\t\ttmpl.push('</select>');\r\n\t\t}\r\n\t\t\r\n\t\tif(Z._is12Hour) {\r\n\t\t\ttmpl.push('<select class=\"jl-time-ampm\"><option value=\"am\">AM</option><option value=\"pm\">PM</option></select>');\r\n\t\t}\r\n\t\tjqEl.html(tmpl.join(''));\r\n\t\tZ.refreshControl(jslet.data.RefreshEvent.updateAllEvent(), true);\r\n\t}, // end renderAll\r\n\r\n\t_getOptions: function(begin, end) {\r\n\t\tvar result = [], value;\r\n\t\tfor(var i = begin; i <= end; i++) {\r\n\t\t\tif( i < 10) {\r\n\t\t\t\tvalue = '0' + i;\r\n\t\t\t} else {\r\n\t\t\t\tvalue = '' + i;\r\n\t\t\t}\r\n\t\t\tresult.push('<option value=\"');\r\n\t\t\tresult.push(i);\r\n\t\t\tresult.push('\">');\r\n\t\t\tresult.push(value);\r\n\t\t\tresult.push('</option>');\r\n\t\t}\r\n\t\treturn result.join('');\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoMetaChanged: function($super, metaName){\r\n\t\t$super(metaName);\r\n\t\tvar Z = this,\r\n\t\t\tfldObj = Z._dataset.getField(Z._field);\r\n\t\tif(!metaName || metaName == \"disabled\" || metaName == \"readOnly\" || metaName == 'tabIndex') {\r\n\t\t\tvar disabled = fldObj.disabled() || fldObj.readOnly();\r\n\t\t\tvar items = jQuery(Z.el).find(\"select\"), item,\r\n\t\t\t\trequired = fldObj.required(),\r\n\t\t\t\ttabIdx = fldObj.tabIndex();\r\n\t\t\tfor(var i = 0, cnt = items.length; i < cnt; i++){\r\n\t\t\t\titem = items[i];\r\n\t\t\t\titem.disabled = disabled;\r\n\t\t\t\tjslet.ui.setEditableStyle(item, disabled, disabled, true, required);\r\n\t\t\t\titem.tabIndex = tabIdx;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdoValueChanged: function() {\r\n\t\tvar Z = this;\r\n\t\tif (Z._keep_silence_) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar value = Z.getValue(),\r\n\t\t\ttimePart = Z._splitTime(value),\r\n\t\t\thour = timePart.hour,\r\n\t\t\tjqEl = jQuery(Z.el),\r\n\t\t\tjqHour = jqEl.find('.jl-time-hour'),\r\n\t\t\tjqMinute = jqEl.find('.jl-time-minute');\r\n\t\t\r\n\t\tif(Z._is12Hour) {\r\n\t\t\tvar jqAmPm = jqEl.find('.jl-time-ampm');\r\n\t\t\tjqAmPm.prop('selectedIndex', hour < 12 ? 0: 1);\r\n\t\t\tif(hour > 11) {\r\n\t\t\t\thour -= 12;\r\n\t\t\t}\r\n\t\t}\r\n\t\tjqHour.val(hour);\r\n\t\tjqMinute.val(timePart.minute);\r\n\t\tif(Z._hasSecond) {\r\n\t\t\tjqMinute = jqEl.find('.jl-time-second');\r\n\t\t\tjqMinute.val(timePart.second);\r\n\t\t}\r\n\t},\r\n\t \r\n\t_splitTime: function(value) {\r\n\t\tvar\thour = 0,\r\n\t\t\tminute = 0,\r\n\t\t\tsecond = 0;\r\n\t\tif(value) {\r\n\t\t\tif(jslet.isDate(value)) {\r\n\t\t\t\thour = value.getHours();\r\n\t\t\t\tminute = value.getMinutes();\r\n\t\t\t\tsecond = value.getSeconds();\r\n\t\t\t} else if(jslet.isString(value)) {\r\n\t\t\t\tvar parts = value.split(\":\");\r\n\t\t\t\thour = parseInt(parts[0]);\r\n\t\t\t\tif(parts.length > 1) {\r\n\t\t\t\t\tminute = parseInt(parts[1]);\r\n\t\t\t\t}\r\n\t\t\t\tif(parts.length > 2) {\r\n\t\t\t\t\tsecond = parseInt(parts[2]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {hour: hour, minute: minute, second: second};\r\n\t},\r\n\t\r\n\t_prefix: function(value) {\r\n\t\tif(parseInt(value) < 10) {\r\n\t\t\treturn '0' + value;\r\n\t\t}\r\n\t\treturn value;\r\n\t},\r\n\t\r\n\tupdateToDataset: function () {\r\n\t\tvar Z = this;\r\n\t\tif (Z._keep_silence_) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tZ._keep_silence_ = true;\r\n\t\ttry {\r\n\t\t\tvar jqEl = jQuery(Z.el),\r\n\t\t\t\tfldObj = Z._dataset.getField(Z._field),\r\n\t\t\t\tvalue = null, hour;\r\n\t\t\tif(fldObj.getType() != jslet.data.DataType.DATE) {\r\n\t\t\t\tvalue = [];\r\n\t\t\t\tif(Z._is12Hour && jqEl.find('.jl-time-ampm').prop(\"selectedIndex\") > 0) {\r\n\t\t\t\t\thour = parseInt(jqEl.find('.jl-time-hour').val()) + 12;\r\n\t\t\t\t\tvalue.push(hour);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvalue.push(Z._prefix(jqEl.find('.jl-time-hour').val()));\r\n\t\t\t\t}\r\n\t\t\t\tvalue.push(':');\r\n\t\t\t\tvalue.push(Z._prefix(jqEl.find('.jl-time-minute').val()));\r\n\t\t\t\tif(Z._hasSecond) {\r\n\t\t\t\t\tvalue.push(':');\r\n\t\t\t\t\tvalue.push(Z._prefix(jqEl.find('.jl-time-second').val()));\r\n\t\t\t\t}\r\n\t\t\t\tvalue = value.join('');\r\n\t\t\t} else {\r\n\t\t\t\tvalue = Z.getValue();\r\n\t\t\t\tif(!value) {\r\n\t\t\t\t\tvalue = new Date();\r\n\t\t\t\t}\r\n\t\t\t\thour = parseInt(jqEl.find('.jl-time-hour').val());\r\n\t\t\t\tif(Z._is12Hour && jqEl.find('.jl-time-ampm').prop(\"selectedIndex\") > 0) {\r\n\t\t\t\t\thour += 12;\r\n\t\t\t\t}\r\n\t\t\t\tvar minute = parseInt(jqEl.find('.jl-time-minute').val());\r\n\t\t\t\tvar second = 0;\r\n\t\t\t\tif(Z._hasSecond) {\r\n\t\t\t\t\tsecond = parseInt(jqEl.find('.jl-time-second').val());\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvalue.setHours(hour);\r\n\t\t\t\tvalue.setMinutes(minute);\r\n\t\t\t\tvalue.setSeconds(second);\r\n\t\t\t}\r\n\t\t\tZ._dataset.setFieldValue(Z._field, value, Z._valueIndex);\r\n\t\t} finally {\r\n\t\t\tZ._keep_silence_ = false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}, // end updateToDataset\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinnerFocus: function() {\r\n\t\tvar jqEl = jQuery(this.el);\r\n\t\tjqEl.find('.jl-time-hour').focus();\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tjQuery(this.el).off();\r\n\t\t$super();\r\n\t}\r\n});\r\njslet.ui.register('DBTimePicker', jslet.ui.DBTimePicker);\r\njslet.ui.DBTimePicker.htmlTemplate = '<div></div>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBError. \r\n * Display dataset error.\r\n * \r\n * Example:\r\n * <pre><code>\r\n *  var jsletParam = {type:\"DBError\",dataset:\"employee\"};\r\n *  \r\n * //1. Declaring:\r\n *  &lt;div data-jslet='type:\"DBError\",dataset:\"employee\"' />\r\n *  or\r\n *  &lt;div data-jslet='jsletParam' />\r\n *  \r\n *  //2. Binding\r\n *  &lt;div id=\"ctrlId\"  />\r\n *  //Js snippet\r\n *  var el = document.getElementById('ctrlId');\r\n *  jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n *  jslet.ui.createControl(jsletParam, document.body);\r\n *  \r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBError = jslet.Class.create(jslet.ui.DBControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tthis.allProperties = 'styleClass,dataset';\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\tvar tagName = el.tagName.toLowerCase();\r\n\t\treturn tagName == 'div';\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\tif (!jqEl.hasClass('jl-errorpanel')) {\r\n\t\t\tjqEl.addClass('jl-errorpanel');\r\n\t\t}\r\n\r\n\t\tZ.renderAll();\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trefreshControl: function (evt) {\r\n\t\tif (evt && evt.eventType == jslet.data.RefreshEvent.ERROR) {\r\n\t\t\tthis.el.innerHTML = evt.message || '';\r\n\t\t}\r\n\t}, // end refreshControl\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tthis.refreshControl();\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tvar Z = this;\r\n\t\t\t\t\r\n\t\t$super();\r\n\t}\r\n\r\n});\r\n\r\njslet.ui.register('DBError', jslet.ui.DBError);\r\njslet.ui.DBError.htmlTemplate = '<div></div>';\r\n\n/*!\r\n * Jslet Javascript Framework v4.0.0\r\n * https://github.com/jslet/jslet/\r\n *\r\n * Copyright 2016 Jslet Team and other contributors\r\n * Released under the MIT license\r\n */\r\n\r\n/**\r\n * @class DBPageBar. \r\n * Functions:\r\n * 1. First page, Prior Page, Next Page, Last Page;\r\n * 2. Can go to specified page;\r\n * 3. Can specify page size on runtime;\r\n * 4. Need not write any code;\r\n * \r\n * Example:\r\n * <pre><code>\r\n *  var jsletParam = {type:\"DBPageBar\",dataset:\"bom\",pageSizeList:[20,50,100,200]};\r\n *  \r\n * //1. Declaring:\r\n *  &lt;div data-jslet='type:\"DBPageBar\",dataset:\"bom\",pageSizeList:[20,50,100,200]' />\r\n *  or\r\n *  &lt;div data-jslet='jsletParam' />\r\n *\r\n *  //2. Binding\r\n *  &lt;div id=\"ctrlId\"  />\r\n *  //Js snippet\r\n *  var el = document.getElementById('ctrlId');\r\n *  jslet.ui.bindControl(el, jsletParam);\r\n *\r\n *  //3. Create dynamically\r\n *  jslet.ui.createControl(jsletParam, document.body);\r\n *  \r\n * </code></pre>\r\n */\r\n\"use strict\";\r\njslet.ui.DBPageBar = jslet.Class.create(jslet.ui.DBControl, {\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tinitialize: function ($super, el, params) {\r\n\t\tvar Z = this;\r\n\t\tZ.allProperties = 'styleClass,dataset,showPageSize,pageSizeList';\r\n\t\tZ._showPageSize = true;\r\n\t\t\r\n\t\tZ._pageSizeList = [100, 200, 500];\r\n\r\n\t\tZ._currPageCount = 0;\r\n\t\t\r\n\t\t$super(el, params);\r\n\t},\r\n\r\n\t/**\r\n\t * {Boolean} Identify if the \"Page Size\" part shows or not\r\n\t */\r\n\tshowPageSize: function(showPageSize) {\r\n\t\tif(showPageSize === undefined) {\r\n\t\t\treturn this._showPageSize;\r\n\t\t}\r\n\t\tthis._showPageSize = showPageSize ? true: false;\r\n\t},\r\n\t\r\n\t/**\r\n\t * {Integer[]) Array of integer, like: [50,100,200]\r\n\t */\r\n\tpageSizeList: function(pageSizeList) {\r\n\t\tif(pageSizeList === undefined) {\r\n\t\t\treturn this._pageSizeList;\r\n\t\t}\r\n\t\tjslet.Checker.test('DBPageBar.pageSizeList', pageSizeList).isArray();\r\n\t\tvar size;\r\n\t\tfor(var i = 0, len = pageSizeList.length; i < len; i++) {\r\n\t\t\tsize = pageSizeList[i];\r\n\t\t\tjslet.Checker.test('DBPageBar.pageSizeList', size).isGTZero();\r\n\t\t}\r\n\t\tthis._pageSizeList = pageSizeList;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tisValidTemplateTag: function (el) {\r\n\t\tvar tagName = el.tagName.toLowerCase();\r\n\t\treturn tagName == 'div';\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tbind: function () {\r\n\t\tvar Z = this,\r\n\t\t\tjqEl = jQuery(Z.el);\r\n\t\tif (!jqEl.hasClass('jl-pagebar')) {\r\n\t\t\tjqEl.addClass('jl-pagebar');\r\n\t\t}\r\n\t\tvar template = [\r\n\t\t'<div class=\"form-inline form-group\">',\r\n\t  \t'<select class=\"form-control input-sm jl-pb-pagesize\" title=\"', jslet.locale.DBPageBar.pageSize, '\"></select>',\r\n\t    '<button class=\"btn btn-default btn-sm jl-pb-first\" title=\"', jslet.locale.DBPageBar.first, '\"><i class=\"fa fa-angle-double-left\" aria-hidden=\"true\"></i></button>',\r\n\t    '<button class=\"btn btn-default btn-sm jl-pb-prior\" title=\"', jslet.locale.DBPageBar.prior, '\"><i class=\"fa fa-angle-left\" aria-hidden=\"true\"></i></button>',\r\n\t    '<button class=\"btn btn-default btn-sm jl-pb-next\" title=\"', jslet.locale.DBPageBar.next, '\"><i class=\"fa fa-angle-right\" aria-hidden=\"true\"></i></button>',\r\n\t    '<button class=\"btn btn-default btn-sm jl-pb-last\" title=\"', jslet.locale.DBPageBar.last, '\"><i class=\"fa fa-angle-double-right\" aria-hidden=\"true\"></i></button>',\r\n\t    '<button class=\"btn btn-default btn-sm jl-pb-refresh\" title=\"', jslet.locale.DBPageBar.refresh, '\"><i class=\"fa fa-refresh\" aria-hidden=\"true\"></i></button>',\r\n\t  \t'<select class=\"form-control input-sm jl-pb-pagenum\" title=\"', jslet.locale.DBPageBar.pageNum, '\"></select>',\r\n\t    '</div>'];\r\n\t\t\r\n\t\tjqEl.html(template.join(''));\r\n\r\n\t\tZ._jqPageSize = jqEl.find('.jl-pb-pagesize');\r\n\t\tif (Z._showPageSize) {\r\n\t\t\tZ._jqPageSize.removeClass('jl-hidden');\r\n\t\t\tvar pgSizeList = Z._pageSizeList;\r\n\t\t\tvar cnt = pgSizeList.length, s = '', pageSize;\r\n\t\t\tfor (var i = 0; i < cnt; i++) {\r\n\t\t\t\tpageSize = pgSizeList[i];\r\n\t\t\t\ts += '<option value=\"' + pageSize + '\">' + pageSize + '</option>';\r\n\t\t\t}\r\n\r\n\t\t\tZ._jqPageSize.html(s);\r\n\t\t\tif(cnt > 0) {\r\n\t\t\t\tZ._dataset.pageSize(parseInt(pgSizeList[0]));\r\n\t\t\t}\r\n\t\t\tZ._jqPageSize.on('change', function (event) {\r\n\t\t\t\tvar dsObj = Z.dataset();\r\n\t\t\t\tdsObj.pageNo(1);\r\n\t\t\t\tdsObj.pageSize(parseInt(this.value));\r\n\t\t\t\tdsObj.requery();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tZ._jqPageSize.addClass('jl-hidden');\r\n\t\t}\r\n\r\n\t\tZ._jqFirstBtn = jqEl.find('.jl-pb-first');\r\n\t\tZ._jqPriorBtn = jqEl.find('.jl-pb-prior');\r\n\t\tZ._jqNextBtn = jqEl.find('.jl-pb-next');\r\n\t\tZ._jqLastBtn = jqEl.find('.jl-pb-last');\r\n\t\tZ._jqRefreshBtn = jqEl.find('.jl-pb-refresh');\r\n\t\tZ._jqPageNum = jqEl.find('.jl-pb-pagenum');\r\n\t\t\r\n\t\tZ._jqFirstBtn.on('click', function (event) {\r\n\t\t\tif(this.disabled) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar dsObj = Z.dataset();\r\n\t\t\tdsObj.pageNo(1);\r\n\t\t\tdsObj.requery();\r\n\t\t});\r\n\r\n\t\tZ._jqPriorBtn.on('click', function (event) {\r\n\t\t\tif(this.disabled) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar dsObj = Z.dataset(),\r\n\t\t\t\tnum = dsObj.pageNo();\r\n\t\t\tif (num == 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tdsObj.pageNo(num - 1);\r\n\t\t\tdsObj.requery();\r\n\t\t});\r\n\r\n\t\tZ._jqPageNum.on('change', function (event) {\r\n\t\t\tvar dsObj = Z.dataset();\r\n\t\t\tvar num = parseInt(this.value);\r\n\t\t\tdsObj.pageNo(num);\r\n\t\t\tdsObj.requery();\r\n\t\t});\r\n\r\n\t\tZ._jqNextBtn.on('click', function (event) {\r\n\t\t\tif(this.disabled) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar dsObj = Z.dataset(),\r\n\t\t\t\tnum = dsObj.pageNo();\r\n\t\t\tif (num >= dsObj.pageCount()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tdsObj.pageNo(++num);\r\n\t\t\tdsObj.requery();\r\n\t\t});\r\n\r\n\t\tZ._jqLastBtn.on('click', function (event) {\r\n\t\t\tif(this.disabled) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar dsObj = Z.dataset();\r\n\r\n\t\t\tif (dsObj.pageCount() < 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tdsObj.pageNo(dsObj.pageCount());\r\n\t\t\tdsObj.requery();\r\n\t\t});\r\n\r\n\t\tZ._jqRefreshBtn.on('click', function (event) {\r\n\t\t\tZ.dataset().requery();\r\n\t\t});\r\n\r\n\t\tZ.renderAll();\r\n\t},\r\n\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trefreshControl: function (evt) {\r\n\t\tif (evt && evt.eventType != jslet.data.RefreshEvent.CHANGEPAGE) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis._refreshPageNum();\r\n\t\tthis._refreshButtonStatus();\r\n\t},\r\n\r\n\t_refreshPageNum: function() {\r\n\t\tvar Z = this,\r\n\t\t\tnum = Z._dataset.pageNo(), \r\n\t\t\tcount = Z._dataset.pageCount();\r\n\t\tif(count !== Z._currPageCount) {\r\n\t\t\tvar s = '';\r\n\t\t\tfor(var i = 1; i <= count; i++) {\r\n\t\t\t\ts += '<option value=\"' + i + '\">' + i + '</option>';\r\n\t\t\t}\r\n\t\t\tZ._jqPageNum.html(s);\r\n\t\t\tZ._currPageCount = count;\r\n\t\t}\r\n\t\tZ._jqPageNum.val(num);\r\n\t},\r\n\t\r\n\t_refreshButtonStatus: function() {\r\n\t\tvar Z = this, \r\n\t\t\tds = Z._dataset,\r\n\t\t\tpageNo = ds.pageNo(),\r\n\t\t\tpageCnt = ds.pageCount(),\r\n\t\t\tprevDisabled = true,\r\n\t\t\tnextDisabled = true;\r\n\t\tif(pageNo > 1) {\r\n\t\t\tprevDisabled = false;\r\n\t\t}\r\n\t\tif(pageNo < pageCnt) {\r\n\t\t\tnextDisabled = false;\r\n\t\t}\r\n\t\tZ._jqFirstBtn.attr('disabled', prevDisabled);\r\n\t\tZ._jqPriorBtn.attr('disabled', prevDisabled);\r\n\t\tZ._jqNextBtn.attr('disabled', nextDisabled);\r\n\t\tZ._jqLastBtn.attr('disabled', nextDisabled);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\trenderAll: function () {\r\n\t\tthis.refreshControl();\r\n\t},\r\n\t\r\n\t/**\r\n\t * @override\r\n\t */\r\n\tdestroy: function($super){\r\n\t\tvar Z = this;\r\n\t\tif(Z._jqPageSize) {\r\n\t\t\tZ._jqPageSize.off();\r\n\t\t\tZ._jqPageSize = null;\r\n\t\t}\r\n\t\tZ._jqFirstBtn.off();\r\n\t\tZ._jqPriorBtn.off();\r\n\t\tZ._jqNextBtn.off();\r\n\t\tZ._jqLastBtn.off();\r\n\t\tZ._jqPageNum.off();\r\n\t\tZ._jqRefreshBtn.off();\r\n\r\n\t\tZ._jqFirstBtn = null;\r\n\t\tZ._jqPriorBtn = null;\r\n\t\tZ._jqNextBtn = null;\r\n\t\tZ._jqLastBtn = null;\r\n\t\tZ._jqPageNum = null;\r\n\t\tZ._jqRefreshBtn = null;\r\n\t\t\r\n\t\t$super();\r\n\t}\r\n\r\n});\r\n\r\njslet.ui.register('DBPageBar', jslet.ui.DBPageBar);\r\njslet.ui.DBPageBar.htmlTemplate = '<div></div>';\r\n\n/* jshint ignore:start */\r\n\treturn jslet;\r\n});//end of define\r\n/* jshint ignore:end */"],"sourceRoot":"/source/"}